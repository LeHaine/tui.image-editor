{"version":3,"sources":["webpack://tui.ImageEditor/webpack/universalModuleDefinition","webpack://tui.ImageEditor/webpack/bootstrap","webpack://tui.ImageEditor/./node_modules/core-js-pure/es/promise/index.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/features/promise/index.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/a-function.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/a-possible-prototype.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/add-to-unscopables.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/an-instance.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/an-object.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/array-includes.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/check-correctness-of-iteration.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/classof-raw.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/classof.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/correct-prototype-getter.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/create-iterator-constructor.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/create-non-enumerable-property.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/create-property-descriptor.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/define-iterator.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/descriptors.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/document-create-element.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/dom-iterables.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/engine-is-browser.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/engine-is-ios.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/engine-is-node.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/engine-is-webos-webkit.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/engine-user-agent.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/engine-v8-version.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/enum-bug-keys.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/export.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/fails.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/function-bind-context.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/get-built-in.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/get-iterator-method.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/global.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/has.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/hidden-keys.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/host-report-errors.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/html.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/ie8-dom-define.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/indexed-object.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/inspect-source.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/internal-state.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/is-array-iterator-method.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/is-forced.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/is-object.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/is-pure.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/iterate.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/iterator-close.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/iterators-core.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/iterators.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/microtask.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/native-promise-constructor.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/native-symbol.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/native-weak-map.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/new-promise-capability.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/object-create.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/object-define-properties.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/object-define-property.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/object-get-own-property-descriptor.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/object-get-prototype-of.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/object-keys-internal.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/object-keys.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/object-property-is-enumerable.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/object-set-prototype-of.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/object-to-string.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/path.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/perform.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/promise-resolve.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/redefine-all.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/redefine.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/require-object-coercible.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/set-global.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/set-species.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/set-to-string-tag.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/shared-key.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/shared-store.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/shared.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/species-constructor.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/string-multibyte.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/task.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/to-absolute-index.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/to-indexed-object.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/to-integer.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/to-length.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/to-object.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/to-primitive.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/to-string-tag-support.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/uid.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/use-symbol-as-uid.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/well-known-symbol.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/modules/es.aggregate-error.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/modules/es.array.iterator.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/modules/es.object.to-string.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/modules/es.promise.all-settled.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/modules/es.promise.any.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/modules/es.promise.finally.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/modules/es.promise.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/modules/es.string.iterator.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/modules/esnext.aggregate-error.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/modules/esnext.promise.all-settled.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/modules/esnext.promise.any.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/modules/esnext.promise.try.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/modules/web.dom-collections.iterator.js","webpack://tui.ImageEditor/(webpack)/buildin/global.js","webpack://tui.ImageEditor/./src/css/index.styl","webpack://tui.ImageEditor/./src/index.js","webpack://tui.ImageEditor/./src/js/command/addIcon.js","webpack://tui.ImageEditor/./src/js/command/addImageObject.js","webpack://tui.ImageEditor/./src/js/command/addObject.js","webpack://tui.ImageEditor/./src/js/command/addShape.js","webpack://tui.ImageEditor/./src/js/command/addText.js","webpack://tui.ImageEditor/./src/js/command/applyFilter.js","webpack://tui.ImageEditor/./src/js/command/changeIconColor.js","webpack://tui.ImageEditor/./src/js/command/changeSelection.js","webpack://tui.ImageEditor/./src/js/command/changeShape.js","webpack://tui.ImageEditor/./src/js/command/changeText.js","webpack://tui.ImageEditor/./src/js/command/changeTextStyle.js","webpack://tui.ImageEditor/./src/js/command/clearObjects.js","webpack://tui.ImageEditor/./src/js/command/flip.js","webpack://tui.ImageEditor/./src/js/command/loadImage.js","webpack://tui.ImageEditor/./src/js/command/loadJson.js","webpack://tui.ImageEditor/./src/js/command/removeFilter.js","webpack://tui.ImageEditor/./src/js/command/removeObject.js","webpack://tui.ImageEditor/./src/js/command/resize.js","webpack://tui.ImageEditor/./src/js/command/resizeCanvasDimension.js","webpack://tui.ImageEditor/./src/js/command/rotate.js","webpack://tui.ImageEditor/./src/js/command/setObjectPosition.js","webpack://tui.ImageEditor/./src/js/command/setObjectProperties.js","webpack://tui.ImageEditor/./src/js/component/cropper.js","webpack://tui.ImageEditor/./src/js/component/filter.js","webpack://tui.ImageEditor/./src/js/component/flip.js","webpack://tui.ImageEditor/./src/js/component/freeDrawing.js","webpack://tui.ImageEditor/./src/js/component/icon.js","webpack://tui.ImageEditor/./src/js/component/imageLoader.js","webpack://tui.ImageEditor/./src/js/component/jsonLoader.js","webpack://tui.ImageEditor/./src/js/component/line.js","webpack://tui.ImageEditor/./src/js/component/resize.js","webpack://tui.ImageEditor/./src/js/component/rotation.js","webpack://tui.ImageEditor/./src/js/component/shape.js","webpack://tui.ImageEditor/./src/js/component/text.js","webpack://tui.ImageEditor/./src/js/component/zoom.js","webpack://tui.ImageEditor/./src/js/consts.js","webpack://tui.ImageEditor/./src/js/drawingMode/cropper.js","webpack://tui.ImageEditor/./src/js/drawingMode/freeDrawing.js","webpack://tui.ImageEditor/./src/js/drawingMode/icon.js","webpack://tui.ImageEditor/./src/js/drawingMode/lineDrawing.js","webpack://tui.ImageEditor/./src/js/drawingMode/resize.js","webpack://tui.ImageEditor/./src/js/drawingMode/shape.js","webpack://tui.ImageEditor/./src/js/drawingMode/text.js","webpack://tui.ImageEditor/./src/js/drawingMode/zoom.js","webpack://tui.ImageEditor/./src/js/extension/arrowLine.js","webpack://tui.ImageEditor/./src/js/extension/colorFilter.js","webpack://tui.ImageEditor/./src/js/extension/cropzone.js","webpack://tui.ImageEditor/./src/js/extension/emboss.js","webpack://tui.ImageEditor/./src/js/extension/mask.js","webpack://tui.ImageEditor/./src/js/extension/sharpen.js","webpack://tui.ImageEditor/./src/js/factory/command.js","webpack://tui.ImageEditor/./src/js/factory/errorMessage.js","webpack://tui.ImageEditor/./src/js/graphics.js","webpack://tui.ImageEditor/./src/js/helper/selectionModifyHelper.js","webpack://tui.ImageEditor/./src/js/helper/shapeFilterFillHelper.js","webpack://tui.ImageEditor/./src/js/helper/shapeResizeHelper.js","webpack://tui.ImageEditor/./src/js/imageEditor.js","webpack://tui.ImageEditor/./src/js/interface/command.js","webpack://tui.ImageEditor/./src/js/interface/component.js","webpack://tui.ImageEditor/./src/js/interface/drawingMode.js","webpack://tui.ImageEditor/./src/js/invoker.js","webpack://tui.ImageEditor/./src/js/polyfill.js","webpack://tui.ImageEditor/./src/js/util.js","webpack://tui.ImageEditor/external {\"commonjs\":[\"fabric\",\"fabric\"],\"commonjs2\":[\"fabric\",\"fabric\"],\"amd\":\"fabric\",\"root\":\"fabric\"}","webpack://tui.ImageEditor/external {\"commonjs\":\"tui-code-snippet\",\"commonjs2\":\"tui-code-snippet\",\"amd\":\"tui-code-snippet\",\"root\":[\"tui\",\"util\"]}"],"names":["module","exports","ImageEditor","ICON","componentNames","command","name","commandNames","ADD_ICON","execute","graphics","type","options","iconComp","getComponent","add","then","objectProps","undoData","object","getObject","objId","undo","remove","Promise","resolve","commandFactory","register","ADD_IMAGE_OBJECT","imgUrl","addImageObject","ADD_OBJECT","reject","contains","rejectMessages","addedObject","noObject","SHAPE","ADD_SHAPE","shapeComp","TEXT","ADD_TEXT","text","textComp","undoObject","redo","textObject","FILTER","cachedUndoDataForSilent","makeUndoData","prevfilterOption","mask","APPLY_FILTER","isSilent","filterComp","maskObj","maskObjId","isType","invalidParameters","snippet","extend","isRedo","getOptions","setUndoData","setActiveObject","CHANGE_ICON_COLOR","color","targetObj","getColor","setColor","icon","CHANGE_SELECTION","props","forEach","prop","setObjectProperties","datum","forEachOwnProperties","value","key","CHANGE_SHAPE","change","shape","CHANGE_TEXT","getText","textObj","styles","undoValue","CHANGE_TEXT_STYLE","setStyle","CLEAR_OBJECTS","objects","removeAll","FLIP","FLIP_IMAGE","flipComp","setting","getCurrentSetting","set","IMAGE_LOADER","LOAD_IMAGE","imageName","loader","prevImage","getCanvasImage","prevImageWidth","width","prevImageHeight","height","filter","objectItem","evented","getImageName","image","load","newImage","oldWidth","oldHeight","newWidth","newHeight","JSON_LOADER","LOAD_JSON","json","texComp","objs","map","obj","selectionStyle","fObjectOptions","SELECTION_STYLE","originX","originY","initialize","_addFabricObject","REMOVE_FILTER","REMOVE_OBJECT","removeObjectById","length","RESIZE","RESIZE_IMAGE","dimensions","resizeComp","originalDimensions","getOriginalDimensions","getCurrentDimensions","resize","RESIZE_CANVAS_DIMENSION","dimension","size","cssMaxWidth","cssMaxHeight","setCssMaxDimension","adjustCanvasDimension","ROTATION","rotationComp","angle","getCurrentAngle","ROTATE_IMAGE","args","rotate","SET_OBJECT_POSITION","posInfo","objectId","getObjectProperties","setObjectPosition","renderAll","SET_OBJECT_PROPERTIES","MOUSE_MOVE_THRESHOLD","DEFAULT_OPTION","presetRatio","top","left","Cropper","CROPPER","_cropzone","_startX","_startY","_withShiftKey","_listeners","keydown","_onKeyDown","bind","keyup","_onKeyUp","mousedown","_onFabricMouseDown","mousemove","_onFabricMouseMove","mouseup","_onFabricMouseUp","canvas","getCanvas","forEachObject","Cropzone","strokeWidth","cornerSize","cornerColor","fill","CROPZONE_DEFAULT_OPTIONS","cropSelectionStyle","discardActiveObject","on","selection","defaultCursor","fabric","util","addListener","document","cropzone","off","removeListener","visible","fEvent","target","coord","getPointer","e","x","y","pointer","Math","abs","_calcRectDimensionFromPoint","canvasWidth","getWidth","canvasHeight","getHeight","startX","startY","listeners","cropRect","containsCropzone","imageData","url","toDataURL","isValid","_getPresetPropertiesForCropSize","originalWidth","originalHeight","standardSize","getScale","orignalValue","scaleWidth","sizeValue","scaleHeight","keyCode","keyCodes","SHIFT","Component","filters","Image","Mask","Sharpen","Emboss","ColorFilter","Filter","sourceImg","_getSourceImage","imgFilter","_getFilter","_createFilter","_changeFilterValues","_apply","action","unsupportedOperation","_removeFilter","callback","push","result","applyFilters","filterObj","fabricType","_getFabricFilterType","ImageFilter","item","i","charAt","toUpperCase","slice","Flip","canvasImage","flipX","flipY","newSetting","isChangingFlipX","isChangingFlipY","flip","setImageProperties","_invertAngle","_flipObjects","parseFloat","setCoords","current","FreeDrawing","FREE_DRAWING","oColor","Color","isDrawingMode","setBrush","brush","freeDrawingBrush","toRgba","pathMap","arrow","cancel","Icon","_oColor","_pathMap","_type","_iconColor","_handlers","iconColor","path","_createIcon","_icon","controlStyle","createObjectProperties","pathInfos","get","Path","_startPoint","fire","events","moveOriginPointer","scaleX","scaleY","OBJECT_ADDED","imageOption","padding","crossOrigin","ImageLoader","img","promise","backgroundImage","setCanvasImage","_setBackgroundImage","oImage","loadImage","setBackgroundImage","getElement","loadingImageFailed","JsonLoader","_loadJson","loadJson","loadFromJSON","getObjects","loadingJsonFailed","Line","LINE","_width","arrowType","head","tail","_arrowType","setHeadOption","points","_line","ArrowLine","stroke","eventNames","_createLineEventObjectProperties","x2","y2","params","x1","y1","startPosition","endPosition","Resize","_dimensions","_originalDimensions","dimensionsWidth","dimensionsHeight","scaleValues","adjustCanvasDimensionBase","setOriginalDimensions","Rotation","oldAngle","oldImageCenter","getCenterPoint","newImageCenter","_rotateForEachObject","angleDiff","centerDiff","objCenter","radian","degreesToRadians","newObjCenter","rotatePoint","additionalAngle","setAngle","SHAPE_INIT_OPTIONS","rx","ry","SHAPE_DEFAULT_OPTIONS","DEFAULT_TYPE","DEFAULT_WIDTH","DEFAULT_HEIGHT","makeFabricFillOption","createStaticCanvas","fillOption","fillType","extOption","newStaticCanvas","Shape","_shapeObj","_options","_isSelected","uniformScaling","extendOption","_extendOptions","shapeObj","_createInstance","objectProperties","_bindEventOnShape","_resetPositionFillFilter","unsupportedType","hasFillOption","fillProp","SHAPE_FILL_TYPE","fillImage","filterOption","COLOR","originalShapeObj","instance","Rect","Ellipse","Triangle","selectionStyles","self","added","resizeHelper","setOrigins","selected","deselected","modified","currentObj","adjustOriginToCenter","modifiedInGroup","activeSelection","_fillFilterRePositionInGroupSelection","moving","rotating","scaling","setCursor","startPointX","startPointY","isRegular","KEY_CODES","patternSourceCanvas","originalAngle","addWithUpdate","addTransformToObject","calcTransformMatrix","defaultStyles","resetStyles","fontStyle","fontWeight","textAlign","underline","DBCLICK_TIME","Text","_defaultStyles","_selectedObj","_editingObj","select","_onFabricSelect","selectClear","_onFabricSelectClear","_onFabricScaling","textChanged","_onFabricTextChanged","_textarea","_ratio","_lastClickTime","Date","getTime","_editingObjInfos","isPrevEditing","adjustOriginPosition","setCanvasRatio","editStatus","getPointByOrigin","newText","_setInitPos","position","isExisty","autofocus","IText","enterEditing","selectAll","getActiveObject","activeObj","styleObj","val","_getTextDecorationAdaptObject","textDecoration","state","canvasElement","getCanvasElement","cssWidth","parseInt","style","maxWidth","originWidth","linethrough","overline","ratio","getCanvasRatio","textareaStyle","ceil","setTimeout","editingObj","editingObjInfos","textContent","transWidth","transHeight","display","stamp","TEXT_CHANGED","scrollLeft","scrollTop","fontSize","getSelectedObj","setSelectedInfo","_fireAddText","originPointer","originPosition","clientPosition","clientX","clientY","newClickTime","_isDoubleClick","isEditing","TEXT_EDITING","DEFAULT_SCROLL_OPTION","opacity","selectable","hoverCursor","DEFAULT_VERTICAL_SCROLL_RATIO","SIZE","MARGIN","BORDER_RADIUS","DEFAULT_HORIZONTAL_SCROLL_RATIO","DEFAULT_ZOOM_LEVEL","ZOOM_CHANGED","OBJECT_MODIFIED","KEY_DOWN","KEY_UP","HAND_STARTED","HAND_STOPPED","Zoom","ZOOM","zoomArea","_centerPoints","zoomLevel","zoomMode","zoomModes","DEFAULT","startZoom","_onMouseDownWithZoomMode","moveZoom","_onMouseMoveWithZoomMode","stopZoom","_onMouseUpWithZoomMode","startHand","_onMouseDownWithHandMode","moveHand","_onMouseMoveWithHandMode","stopHand","_onMouseUpWithHandMode","zoomChanged","_changeScrollState","_startHandModeWithSpaceBar","_endHandModeWithSpaceBar","aspectRatio","_verticalScroll","_horizontalScroll","_startTextEditingHandler","_stopTextEditingHandler","isTextEditing","withSpace","SPACE","startHandMode","endHandMode","_changeObjectsEventedState","_startHandPoint","endZoomInMode","HAND","deltaX","deltaY","min","center","_getCenterPoint","_isMaxZoomLevel","prevZoomLevel","zoomToPoint","_fireZoomChanged","centerPoints","pop","prevX","prevY","_isDefaultZoomLevel","point","setViewportTransform","_movePointOfZoom","viewport","tl","tr","bl","viewportWidth","viewportHeight","horizontalScrollWidth","horizontalScrollHeight","horizontalScrollLeft","horizontalScrollMargin","horizontalScrollBorderRadius","verticalScrollWidth","verticalScrollHeight","verticalScrollTop","verticalScrollMargin","verticalScrollBorderRadius","_addScrollBar","scrollBarTid","clearTimeout","calcViewportBoundaries","ZOOM_HELP_MENUS","COMMAND_HELP_MENUS","DELETE_HELP_MENUS","HELP_MENUS","SHAPE_TYPE","OBJ_TYPE","CROPZONE","filterType","VINTAGE","SEPIA2","REMOVE_COLOR","COLOR_FILTER","REMOVE_WHITE","BLEND_COLOR","BLEND","lockSkewingX","lockSkewingY","bringForward","hasRotatingPoint","hasBorders","lockScalingFlip","lockRotation","OBJECT_ACTIVATED","OBJECT_MOVED","OBJECT_SCALED","OBJECT_CREATED","OBJECT_ROTATED","ICON_CREATE_RESIZE","ICON_CREATE_END","ADD_OBJECT_AFTER","MOUSE_DOWN","MOUSE_UP","MOUSE_MOVE","MOUSE_WHEEL","REDO_STACK_CHANGED","UNDO_STACK_CHANGED","SELECTION_CLEARED","SELECTION_CREATED","EXECUTE_COMMAND","AFTER_UNDO","AFTER_REDO","INPUT_BOX_EDITING_STARTED","INPUT_BOX_EDITING_STOPPED","FOCUS","BLUR","IMAGE_RESIZED","selectorNames","COLOR_PICKER_INPUT_BOX","historyNames","LOAD_MASK_IMAGE","ADD_MASK_IMAGE","CROP","drawingModes","drawingMenuNames","Z","Y","C","V","BACKSPACE","DEL","ARROW_DOWN","ARROW_UP","borderColor","transparentCorners","invalidDrawingMode","isLock","noActiveObject","rotation","defaultIconPath","defaultRotateRangeValues","realTimeEvent","max","defaultDrawRangeValues","defaultShapeStrokeValues","defaultTextRangeValues","defaultFilterRangeValues","tintOpacityRange","useDecimal","removewhiteDistanceRange","brightnessRange","noiseRange","pixelateRange","colorfilterThresholdRange","blurFilterRange","emptyCropRectValues","LEFT","TOP","WIDTH","HEIGHT","defaultResizePixelValues","CropperDrawingMode","cropper","components","start","end","DrawingMode","FreeDrawingMode","freeDrawing","IconDrawingMode","LineDrawingMode","LINE_DRAWING","lineDrawing","ResizeDrawingMode","ShapeDrawingMode","TextDrawingMode","ZoomDrawingMode","zoom","ARROW_ANGLE","CHEVRON_SIZE_RATIO","TRIANGLE_SIZE_RATIO","RADIAN_CONVERSION_VALUE","createClass","callSuper","_render","ctx","calcLinePoints","fromX","fromY","toX","toY","linePosition","lineWidth","_renderBasicLinePath","_drawDecoratorPath","_renderStroke","beginPath","moveTo","lineTo","_drawDecoratorPathType","_drawTrianglePath","_drawChevronPath","decorateSize","closePath","standardX","standardY","compareX","compareY","atan2","PI","rotatedPosition","changeAngle","getRotatePosition","distance","referencePosition","cos","sin","BaseFilter","threshold","applyTo","canvasEl","context","getContext","getImageData","data","filterColor","sourceFromHex","len","_getColor","_isOutsideThreshold","putImageData","color1","color2","diff","bytes","CORNER_TYPE_TOP_LEFT","CORNER_TYPE_TOP_RIGHT","CORNER_TYPE_MIDDLE_TOP","CORNER_TYPE_MIDDLE_LEFT","CORNER_TYPE_MIDDLE_RIGHT","CORNER_TYPE_MIDDLE_BOTTOM","CORNER_TYPE_BOTTOM_LEFT","CORNER_TYPE_BOTTOM_RIGHT","CORNER_TYPE_LIST","NOOP_FUNCTION","cornerTypeValid","selectedCorner","indexOf","getScaleBasis","diffX","diffY","extendsOptions","_addEventHandler","canvasEventDelegation","eventName","delegationState","isRegistered","canvasEventTrigger","canvasEventRegister","eventTrigger","_onMoving","_onScaling","_renderCropzone","cropzoneDashLineWidth","cropzoneDashLineOffset","originalFlipX","originalFlipY","originalScaleX","originalScaleY","scale","_fillOuterRect","_fillInnerRect","_strokeBorder","lineDashWidth","lineDashOffset","fillStyle","_getCoordinates","save","restore","outerX","outerY","_caculateInnerPosition","strokeStyle","outer","halfWidth","halfHeight","setLineDash","maxLeft","maxTop","transform","corner","settings","_calcScalingSizeFromPointer","isCornerTypeValid","_resizeCropZone","adjustRatioCropzoneSize","leftMaker","topMaker","maxHeight","scaleTo","maxScaleFactor","v","_getCropzoneRectInfo","getBoundingRect","rectTop","rectLeft","rectWidth","rectHeight","rectRight","rectBottom","resizeInfoMap","mt","ml","mr","mb","br","Convolute","matrix","BlendImage","pipelineState","maskCanvasEl","_createCanvasOfMask","maskCtx","_drawMask","_mapData","createCanvasElement","maskImg","translate","drawImage","imgHeight","imgWidth","sourceData","maskData","commands","create","actions","Command","types","messages","UN_IMPLEMENTATION","NO_COMPONENT_NAME","methodName","toLowerCase","func","isArray","isString","forEachArray","CustomEvents","DEFAULT_CSS_MAX_WIDTH","DEFAULT_CSS_MAX_HEIGHT","EXTRA_PX_FOR_PASTE","cssOnly","backstoreOnly","Graphics","element","preserveObjectStacking","backgroundColor","targetObjectForCopyPaste","_objects","_canvas","_drawingMode","NORMAL","_drawingModeMap","_componentMap","_handler","onMouseDown","_onMouseDown","onMouseUp","_onMouseUp","onMouseMove","_onMouseMove","onMouseWheel","_onMouseWheel","onObjectAdded","_onObjectAdded","onObjectRemoved","_onObjectRemoved","onObjectMoved","_onObjectMoved","onObjectScaled","_onObjectScaled","onObjectModified","_onObjectModified","onObjectRotated","_onObjectRotated","onObjectSelected","_onObjectSelected","onPathCreated","_onPathCreated","onSelectionCleared","_onSelectionCleared","onSelectionCreated","_onSelectionCreated","_setObjectCachingToFalse","_setCanvasElement","_createDrawingModeInstances","_createComponents","_attachCanvasEvents","_attachZoomEvents","wrapperEl","clear","parentNode","removeChild","_detachZoomEvents","attachKeyboardZoomEvents","detachKeyboardZoomEvents","theArgs","includesBackground","isValidGroup","isEmpty","hasOwnProperty","_activeObject","activeObject","isSelection","group","Group","getObjectId","ActiveSelection","mode","option","_isSameDrawingMode","stopDrawingMode","drawingModeInstance","_getDrawingModeInstance","getDrawingMode","getZoom","startZoomInMode","zoomOut","resetZoom","changeVisibility","dataUrl","maxDimension","_calcMaxDimension","setCanvasCssDimension","setCanvasBackstoreDimension","centerObject","setDimensions","withRendering","_callbackAfterLoadingImageObject","fromURL","getCenter","getCropzoneRect","setCropzoneRect","getCroppedImageData","drawingMode","compName","setStates","registerPaths","cursorType","hasFilter","clone","keys","targetOrigin","centerOrigin","staticCanvas","StaticCanvas","enableRetinaScaling","modeName","Object","prototype","objectCaching","selectedElement","nodeType","querySelector","nodeName","createElement","appendChild","Canvas","containerClass","_register","getName","wScaleFactor","hScaleFactor","floor","centerPos","handler","event","_removeFabricObject","_lazyFire","items","paramsMaker","existEventDelegation","predefinedKeys","_createTextProperties","makeFillPropertyForUserEvent","targetObject","isGroupSelect","targetObjects","newTargetObject","discardSelection","_cloneObject","addedObjects","getActiveSelectionFromObjects","_cloneObjectItem","all","_copyFabricObjectForPaste","clonedObject","addExtraPx","isReverse","_copyFabricObject","getCanvasSize","rightEdge","bottomEdge","cloned","processForCopiedObject","propertiesToInclude","toJSON","setBackgroundColor","mixin","setCachedUndoDataForDimension","getCachedUndoDataForDimension","makeSelectionUndoData","makeSelectionUndoDatum","cachedUndoDataForChangeDimension","undoDatumMaker","getFillImageFromShape","rePositionFilterTypeFillImage","makeFilterOptionFromFabricImage","makeFillPatternForFilter","resetFillPatternCanvas","reMakePatternImageSource","getCachedCanvasImageElement","FILTER_OPTION_MAP","pixelate","blur","POSITION_DIMENSION_MAP","FILTER_NAME_VALUE_MAP","cachedCanvasImageElement","rotatedShapeCornerDimension","getRotatedDimension","right","bottom","diffLeft","diffTop","cropX","cropY","fillImageMaxSize","calculateFillImageDimensionOutsideCanvas","imageObject","overflowAreaPositionFixer","outDistance","imageLeft","imageTop","calculateDistanceOverflowPart","calculateDimensionLeftTopEdge","calculateDimensionRightBottomEdge","insideCanvasRealImageWidth","insideCanvasRealImageHeight","cropDistance2","cropDistance","compareSize","copiedCanvasElement","makeFillImage","fabricProperty","Pattern","source","repeat","innerImage","newFillImage","reset","toCanvasElement","shapePointNavigation","getShapeEdgePoint","shapeNeighborPointNavigation","linePointsOutsideCanvas","calculateLinePointsOutsideCanvas","reatAngles","calculateLineAngleOfOutsideCanvas","startPointIndex","diffPosition","getReversePositionForFlip","rotationChangePoint1","rotationChangePoint2","isForward","isReverseLeftPositionForFlip","isReverseTopPositionForFlip","minimumPoint","minimumPointIndex","index","endPointIndex1","endPointIndex2","linePointsOfOneVertexIndex","horizontalVerticalAngle","pointIndex","startPoint","endPoint","ax","ay","bx","by","cx","cy","dx","dy","currentCanvasImageAngle","fabricFilterClassName","DIVISOR","rect","circle","triangle","DIMENSION_KEYS","w","h","setStartPoint","originKey","substring","origins","getPositionsOfRotatedOrigin","origin","sx","sy","px","py","r","hasCenterOrigin","adjustOriginByStartPoint","centerPoint","originPositions","adjustOriginByMovingPointer","setPositionByOrigin","adjustDimensionOnScaling","dimensionKeys","maxScale","hasControls","adjustDimensionOnMouseMove","divisor","isTriangle","sqrt","leftTopPoint","rightTopPoint","rightBottomPoint","leftBottomPoint","lt","rt","rb","lb","isScaling","isUndefined","wrapper","includeUI","usageStatistics","activeObjectId","_invoker","Invoker","_graphics","mousewheel","objectActivated","_onObjectActivated","objectMoved","objectScaled","objectRotated","objectAdded","objectModified","createdPath","_onCreatedPath","addText","_onAddText","addObject","_onAddObject","textEditing","_onTextEditing","_onTextChanged","iconCreateResize","_onIconCreateResize","iconCreateEnd","_onIconCreateEnd","selectionCleared","_selectionCleared","selectionCreated","_selectionCreated","_attachInvokerEvents","_attachGraphicsEvents","_attachDomEvents","_setSelectionStyle","applyCropSelectionStyle","applyGroupSelectionStyle","enableGLFiltering","setSelectionStyle","setCropSelectionStyle","eventTarget","addEventListener","removeEventListener","ctrlKey","metaKey","isModifierKey","resetTargetObjectForCopyPaste","pasteObject","clearRedoStack","isDeleteKey","isRemoveReady","isReadyRemoveObject","isColorPickerInputBoxEditing","preventDefault","removeActiveObject","getActiveObjectIdForRemove","removeObject","pushUndoStack","deactivateAll","changeSelectableAll","clearUndoStack","commandName","concat","executeSilent","iterationCount","canvasZoom","getCanvasZoom","imgFile","URL","createObjectURL","loadImageFromURL","revokeObjectURL","startDrawingMode","_flip","_rotate","setDrawingShape","setIconStyle","_setPositions","executeMethodName","_pushAddObjectCommand","_pushModifyObjectCommand","infos","changeCursor","isEmptyUndoStack","isEmptyRedoStack","_detachDomEvents","destroy","centerPosition","keyValue","getObjectPosition","createMessage","errorMessage","errorTypes","executeCallback","undoCallback","Error","apply","getEditor","isFunction","_undoStack","_redoStack","_isLocked","_isSilent","lock","unlock","message","pushRedoStack","_invokeExecution","_fireUndoStackChanged","_invokeUndo","_fireRedoStackChanged","Element","matches","msMatchesSelector","webkitMatchesSelector","closest","s","el","documentElement","parentElement","window","createElementNS","view","classListProp","protoProp","elemCtrProto","objCtr","strTrim","String","trim","replace","arrIndexOf","Array","DOMEx","code","DOMException","checkTokenAndGetIndex","classList","token","test","call","ClassList","elem","trimmedClasses","getAttribute","classes","split","_updateClassName","setAttribute","toString","classListProto","classListGetter","tokens","arguments","l","updated","splice","toggle","force","method","join","defineProperty","classListPropDesc","enumerable","configurable","ex","number","undefined","__defineGetter__","testElement","createMethod","original","DOMTokenList","_toggle","cache","checkUseElems","tid","debouncedCheck","unobserveChanges","observeChanges","observer","MutationObserver","observe","childList","subtree","attributes","disconnect","ignore","createRequest","getOrigin","loc","a","protocol","href","host","Request","origin2","XMLHttpRequest","location","withCredentials","XDomainRequest","xlinkNS","base","bcr","fallback","hash","inProgressCount","isHidden","uses","xhr","observeIfDone","attrUpdateFunc","spec","useEl","setAttributeNS","hasAttribute","onloadFunc","body","svg","onload","innerHTML","responseText","getElementsByTagName","overflow","insertBefore","firstChild","onErrorTimeout","onerror","ontimeout","getBoundingClientRect","getAttributeNS","getElementById","open","send","abort","winLoad","readyState","clamp","keyMirror","makeStyleText","getProperties","toInteger","toCamelCase","isSupportFileApi","getRgb","sendHostName","styleLoad","getSelector","base64ToBlob","fixFloatingPoint","assignmentForDestroy","cls","changeOrigin","flipObject","setCustomProperty","getCustomProperty","capitalizeString","includes","getFillTypeFromOption","getFillTypeFromObject","isShape","getObjectType","isSilentCommand","getHistoryTitle","getHelpMenuBarPosition","isEmptyCropzone","FLOATING_POINT_DIGIT","CSS_PREFIX","hostnameSent","minValue","maxValue","styleStr","targetString","$0","$1","File","FileList","FileReader","alpha","g","b","styleBuffer","tagId","linkElement","styleData","encodeURIComponent","id","targetElement","str","rImageType","mimeString","raw","uInt8Array","header","imageType","atob","rawLength","Uint8Array","charCodeAt","Blob","Number","toFixed","prefix","fObject","customProps","propNames","resultObject","propName","targetArray","compareValue","toStartOfCapital","getFilterType","useAlpha","filterName","historyInfo","detail","first"],"mappings":"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ACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;AClCA;;;;;;;;;;;;ACAA,gBAAgB,mBAAO,CAAC,kGAAgC;;AAExD;;;;;;;;;;;;ACFA,cAAc,mBAAO,CAAC,sFAA0B;AAChD,aAAa,mBAAO,CAAC,4EAAqB;;AAE1C;;;;;;;;;;;;ACHA,gBAAgB,mBAAO,CAAC,kGAAgC;;AAExD;;;;;;;;;;;;ACFA,iBAAiB,mBAAO,CAAC,wFAA2B;;AAEpD;;;;;;;;;;;;ACFA,aAAa,mBAAO,CAAC,4EAAqB;AAC1C,gBAAgB,mBAAO,CAAC,kGAAgC;;AAExD;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;;AAEA;;;;;;;;;;;;ACnBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACTa;AACb,aAAa,mBAAO,CAAC,4EAAqB;AAC1C,+BAA+B,mBAAO,CAAC,oIAAiD;AACxF,eAAe,mBAAO,CAAC,kFAAwB;AAC/C,WAAW,mBAAO,CAAC,wEAAmB;AACtC,WAAW,mBAAO,CAAC,0GAAoC;AACvD,kCAAkC,mBAAO,CAAC,4HAA6C;AACvF,UAAU,mBAAO,CAAC,sEAAkB;;AAEpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,sFAAsF;;AAEtF,iEAAiE;AACjE;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,KAAK;;AAEL;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;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;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,GAAG;AACH;;;;;;;;;;;;ACzDA,eAAe,mBAAO,CAAC,kFAAwB;;AAE/C;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACPa;AACb,YAAY,mBAAO,CAAC,0EAAoB;AACxC,qBAAqB,mBAAO,CAAC,8GAAsC;AACnE,kCAAkC,mBAAO,CAAC,4HAA6C;AACvF,UAAU,mBAAO,CAAC,sEAAkB;AACpC,sBAAsB,mBAAO,CAAC,kGAAgC;AAC9D,cAAc,mBAAO,CAAC,8EAAsB;;AAE5C;AACA;;AAEA,8BAA8B,aAAa;;AAE3C;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,CAAC;;AAED;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;;;;;;;;;;;AC5CA;;;;;;;;;;;;ACAA,aAAa,mBAAO,CAAC,4EAAqB;AAC1C,+BAA+B,mBAAO,CAAC,oIAAiD;AACxF,gBAAgB,mBAAO,CAAC,wEAAmB;AAC3C,aAAa,mBAAO,CAAC,0FAA4B;AACjD,sBAAsB,mBAAO,CAAC,4GAAqC;AACnE,cAAc,mBAAO,CAAC,4FAA6B;;AAEnD;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,+CAA+C,sBAAsB;AACrE;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA,GAAG;AACH;;;;;;;;;;;;ACjFA,aAAa,mBAAO,CAAC,4EAAqB;;AAE1C;;;;;;;;;;;;ACFA;AA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AkB;;AAEpC;;AAEA;AACA;AACA;;;;;;;;;;;;ACPA,aAAa,mBAAO,CAAC,4EAAqB;AAC1C,gBAAgB,mBAAO,CAAC,oFAAyB;;AAEjD;AACA,kDAAkD;;AAElD;;;;;;;;;;;;ACNA,cAAc,mBAAO,CAAC,8EAAsB;AAC5C,YAAY,mBAAO,CAAC,wFAA2B;;AAE/C;AACA,qEAAqE;AACrE,CAAC;AACD;AACA;AACA;AACA,CAAC;;;;;;;;;;;;ACTD,eAAe,mBAAO,CAAC,kFAAwB;AAC/C,gBAAgB,mBAAO,CAAC,oFAAyB;AACjD,sBAAsB,mBAAO,CAAC,kGAAgC;;AAE9D;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACZA,gBAAgB,mBAAO,CAAC,oFAAyB;AACjD,6BAA6B,mBAAO,CAAC,gHAAuC;;AAE5E,sBAAsB,kBAAkB;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;AC1BA,aAAa,mBAAO,CAAC,4EAAqB;AAC1C,YAAY,mBAAO,CAAC,0EAAoB;AACxC,WAAW,mBAAO,CAAC,0GAAoC;AACvD,WAAW,mBAAO,CAAC,wEAAmB;AACtC,oBAAoB,mBAAO,CAAC,8GAAsC;AAClE,aAAa,mBAAO,CAAC,0FAA4B;AACjD,cAAc,mBAAO,CAAC,4FAA6B;;AAEnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AA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AA0B;AACnD,oBAAoB,mBAAO,CAAC,4FAA6B;AACzD,cAAc,mBAAO,CAAC,8EAAsB;AAC5C,kCAAkC,mBAAO,CAAC,4HAA6C;AACvF,yBAAyB,mBAAO,CAAC,sGAAkC;AACnE,WAAW,mBAAO,CAAC,wEAAmB;AACtC,gBAAgB,mBAAO,CAAC,kFAAwB;AAChD,qBAAqB,mBAAO,CAAC,8FAA8B;AAC3D,uBAAuB,mBAAO,CAAC,oGAAiC;AAChE,iCAAiC,mBAAO,CAAC,4GAAqC;AAC9E,cAAc,mBAAO,CAAC,8EAAsB;AAC5C,0BAA0B,mBAAO,CAAC,4FAA6B;AAC/D,eAAe,mBAAO,CAAC,kFAAwB;AAC/C,sBAAsB,mBAAO,CAAC,kGAAgC;AAC9D,iBAAiB,mBAAO,CAAC,kGAAgC;AACzD,cAAc,mBAAO,CAAC,4FAA6B;AACnD,iBAAiB,mBAAO,CAAC,kGAAgC;;AAEzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2DAA2D,YAAY,EAAE;AACzE;AACA,sBAAsB,cAAc,eAAe,cAAc;AACjE;AACA;AACA;AACA,0CAA0C,cAAc;AACxD;AACA;AACA;AACA,CAAC;;AAED;AACA,yDAAyD,cAAc;AACvE,CAAC;;AAED;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA,WAAW;AACX,SAAS;AACT,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG,eAAe;AAClB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,OAAO;AACP;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB;AACvB;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,OAAO;AACP,KAAK;AACL;AACA;AACA;AACA;AACA,GAAG;AACH,oBAAoB,cAAc;AAClC;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,OAAO,GAAG,eAAe;;AAEzB;AACA,uFAAuF,eAAe;AACtG;;AAEA;AACA;AACA;AACA,KAAK,gBAAgB;;AAErB;AACA;AACA;AACA;AACA;AACA;;AAEA,GAAG,2CAA2C;AAC9C;AACA,CAAC;;AAED;AACA;;AAEA;;AAEA;AACA,GAAG,8CAA8C;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED,GAAG,yDAAyD;AAC5D;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED,GAAG,2DAA2D;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAC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","file":"tui-image-editor.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"fabric\")[\"fabric\"], require(\"tui-code-snippet\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"fabric\", \"tui-code-snippet\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"ImageEditor\"] = factory(require(\"fabric\")[\"fabric\"], require(\"tui-code-snippet\"));\n\telse\n\t\troot[\"tui\"] = root[\"tui\"] || {}, root[\"tui\"][\"ImageEditor\"] = factory(root[\"fabric\"], root[\"tui\"][\"util\"]);\n})(window, function(__WEBPACK_EXTERNAL_MODULE_fabric__, __WEBPACK_EXTERNAL_MODULE_tui_code_snippet__) {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/dist\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/index.js\");\n","require('../../modules/es.aggregate-error');\nrequire('../../modules/es.object.to-string');\nrequire('../../modules/es.promise');\nrequire('../../modules/es.promise.all-settled');\nrequire('../../modules/es.promise.any');\nrequire('../../modules/es.promise.finally');\nrequire('../../modules/es.string.iterator');\nrequire('../../modules/web.dom-collections.iterator');\nvar path = require('../../internals/path');\n\nmodule.exports = path.Promise;\n","var parent = require('../../es/promise');\nrequire('../../modules/esnext.aggregate-error');\n// TODO: Remove from `core-js@4`\nrequire('../../modules/esnext.promise.all-settled');\nrequire('../../modules/esnext.promise.try');\nrequire('../../modules/esnext.promise.any');\n\nmodule.exports = parent;\n","module.exports = function (it) {\n  if (typeof it != 'function') {\n    throw TypeError(String(it) + ' is not a function');\n  } return it;\n};\n","var isObject = require('../internals/is-object');\n\nmodule.exports = function (it) {\n  if (!isObject(it) && it !== null) {\n    throw TypeError(\"Can't set \" + String(it) + ' as a prototype');\n  } return it;\n};\n","module.exports = function () { /* empty */ };\n","module.exports = function (it, Constructor, name) {\n  if (!(it instanceof Constructor)) {\n    throw TypeError('Incorrect ' + (name ? name + ' ' : '') + 'invocation');\n  } return it;\n};\n","var isObject = require('../internals/is-object');\n\nmodule.exports = function (it) {\n  if (!isObject(it)) {\n    throw TypeError(String(it) + ' is not an object');\n  } return it;\n};\n","var toIndexedObject = require('../internals/to-indexed-object');\nvar toLength = require('../internals/to-length');\nvar toAbsoluteIndex = require('../internals/to-absolute-index');\n\n// `Array.prototype.{ indexOf, includes }` methods implementation\nvar createMethod = function (IS_INCLUDES) {\n  return function ($this, el, fromIndex) {\n    var O = toIndexedObject($this);\n    var length = toLength(O.length);\n    var index = toAbsoluteIndex(fromIndex, length);\n    var value;\n    // Array#includes uses SameValueZero equality algorithm\n    // eslint-disable-next-line no-self-compare -- NaN check\n    if (IS_INCLUDES && el != el) while (length > index) {\n      value = O[index++];\n      // eslint-disable-next-line no-self-compare -- NaN check\n      if (value != value) return true;\n    // Array#indexOf ignores holes, Array#includes - not\n    } else for (;length > index; index++) {\n      if ((IS_INCLUDES || index in O) && O[index] === el) return IS_INCLUDES || index || 0;\n    } return !IS_INCLUDES && -1;\n  };\n};\n\nmodule.exports = {\n  // `Array.prototype.includes` method\n  // https://tc39.es/ecma262/#sec-array.prototype.includes\n  includes: createMethod(true),\n  // `Array.prototype.indexOf` method\n  // https://tc39.es/ecma262/#sec-array.prototype.indexof\n  indexOf: createMethod(false)\n};\n","var wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar ITERATOR = wellKnownSymbol('iterator');\nvar SAFE_CLOSING = false;\n\ntry {\n  var called = 0;\n  var iteratorWithReturn = {\n    next: function () {\n      return { done: !!called++ };\n    },\n    'return': function () {\n      SAFE_CLOSING = true;\n    }\n  };\n  iteratorWithReturn[ITERATOR] = function () {\n    return this;\n  };\n  // eslint-disable-next-line es/no-array-from, no-throw-literal -- required for testing\n  Array.from(iteratorWithReturn, function () { throw 2; });\n} catch (error) { /* empty */ }\n\nmodule.exports = function (exec, SKIP_CLOSING) {\n  if (!SKIP_CLOSING && !SAFE_CLOSING) return false;\n  var ITERATION_SUPPORT = false;\n  try {\n    var object = {};\n    object[ITERATOR] = function () {\n      return {\n        next: function () {\n          return { done: ITERATION_SUPPORT = true };\n        }\n      };\n    };\n    exec(object);\n  } catch (error) { /* empty */ }\n  return ITERATION_SUPPORT;\n};\n","var toString = {}.toString;\n\nmodule.exports = function (it) {\n  return toString.call(it).slice(8, -1);\n};\n","var TO_STRING_TAG_SUPPORT = require('../internals/to-string-tag-support');\nvar classofRaw = require('../internals/classof-raw');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar TO_STRING_TAG = wellKnownSymbol('toStringTag');\n// ES3 wrong here\nvar CORRECT_ARGUMENTS = classofRaw(function () { return arguments; }()) == 'Arguments';\n\n// fallback for IE11 Script Access Denied error\nvar tryGet = function (it, key) {\n  try {\n    return it[key];\n  } catch (error) { /* empty */ }\n};\n\n// getting tag from ES6+ `Object.prototype.toString`\nmodule.exports = TO_STRING_TAG_SUPPORT ? classofRaw : function (it) {\n  var O, tag, result;\n  return it === undefined ? 'Undefined' : it === null ? 'Null'\n    // @@toStringTag case\n    : typeof (tag = tryGet(O = Object(it), TO_STRING_TAG)) == 'string' ? tag\n    // builtinTag case\n    : CORRECT_ARGUMENTS ? classofRaw(O)\n    // ES3 arguments fallback\n    : (result = classofRaw(O)) == 'Object' && typeof O.callee == 'function' ? 'Arguments' : result;\n};\n","var fails = require('../internals/fails');\n\nmodule.exports = !fails(function () {\n  function F() { /* empty */ }\n  F.prototype.constructor = null;\n  // eslint-disable-next-line es/no-object-getprototypeof -- required for testing\n  return Object.getPrototypeOf(new F()) !== F.prototype;\n});\n","'use strict';\nvar IteratorPrototype = require('../internals/iterators-core').IteratorPrototype;\nvar create = require('../internals/object-create');\nvar createPropertyDescriptor = require('../internals/create-property-descriptor');\nvar setToStringTag = require('../internals/set-to-string-tag');\nvar Iterators = require('../internals/iterators');\n\nvar returnThis = function () { return this; };\n\nmodule.exports = function (IteratorConstructor, NAME, next) {\n  var TO_STRING_TAG = NAME + ' Iterator';\n  IteratorConstructor.prototype = create(IteratorPrototype, { next: createPropertyDescriptor(1, next) });\n  setToStringTag(IteratorConstructor, TO_STRING_TAG, false, true);\n  Iterators[TO_STRING_TAG] = returnThis;\n  return IteratorConstructor;\n};\n","var DESCRIPTORS = require('../internals/descriptors');\nvar definePropertyModule = require('../internals/object-define-property');\nvar createPropertyDescriptor = require('../internals/create-property-descriptor');\n\nmodule.exports = DESCRIPTORS ? function (object, key, value) {\n  return definePropertyModule.f(object, key, createPropertyDescriptor(1, value));\n} : function (object, key, value) {\n  object[key] = value;\n  return object;\n};\n","module.exports = function (bitmap, value) {\n  return {\n    enumerable: !(bitmap & 1),\n    configurable: !(bitmap & 2),\n    writable: !(bitmap & 4),\n    value: value\n  };\n};\n","'use strict';\nvar $ = require('../internals/export');\nvar createIteratorConstructor = require('../internals/create-iterator-constructor');\nvar getPrototypeOf = require('../internals/object-get-prototype-of');\nvar setPrototypeOf = require('../internals/object-set-prototype-of');\nvar setToStringTag = require('../internals/set-to-string-tag');\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\nvar redefine = require('../internals/redefine');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\nvar IS_PURE = require('../internals/is-pure');\nvar Iterators = require('../internals/iterators');\nvar IteratorsCore = require('../internals/iterators-core');\n\nvar IteratorPrototype = IteratorsCore.IteratorPrototype;\nvar BUGGY_SAFARI_ITERATORS = IteratorsCore.BUGGY_SAFARI_ITERATORS;\nvar ITERATOR = wellKnownSymbol('iterator');\nvar KEYS = 'keys';\nvar VALUES = 'values';\nvar ENTRIES = 'entries';\n\nvar returnThis = function () { return this; };\n\nmodule.exports = function (Iterable, NAME, IteratorConstructor, next, DEFAULT, IS_SET, FORCED) {\n  createIteratorConstructor(IteratorConstructor, NAME, next);\n\n  var getIterationMethod = function (KIND) {\n    if (KIND === DEFAULT && defaultIterator) return defaultIterator;\n    if (!BUGGY_SAFARI_ITERATORS && KIND in IterablePrototype) return IterablePrototype[KIND];\n    switch (KIND) {\n      case KEYS: return function keys() { return new IteratorConstructor(this, KIND); };\n      case VALUES: return function values() { return new IteratorConstructor(this, KIND); };\n      case ENTRIES: return function entries() { return new IteratorConstructor(this, KIND); };\n    } return function () { return new IteratorConstructor(this); };\n  };\n\n  var TO_STRING_TAG = NAME + ' Iterator';\n  var INCORRECT_VALUES_NAME = false;\n  var IterablePrototype = Iterable.prototype;\n  var nativeIterator = IterablePrototype[ITERATOR]\n    || IterablePrototype['@@iterator']\n    || DEFAULT && IterablePrototype[DEFAULT];\n  var defaultIterator = !BUGGY_SAFARI_ITERATORS && nativeIterator || getIterationMethod(DEFAULT);\n  var anyNativeIterator = NAME == 'Array' ? IterablePrototype.entries || nativeIterator : nativeIterator;\n  var CurrentIteratorPrototype, methods, KEY;\n\n  // fix native\n  if (anyNativeIterator) {\n    CurrentIteratorPrototype = getPrototypeOf(anyNativeIterator.call(new Iterable()));\n    if (IteratorPrototype !== Object.prototype && CurrentIteratorPrototype.next) {\n      if (!IS_PURE && getPrototypeOf(CurrentIteratorPrototype) !== IteratorPrototype) {\n        if (setPrototypeOf) {\n          setPrototypeOf(CurrentIteratorPrototype, IteratorPrototype);\n        } else if (typeof CurrentIteratorPrototype[ITERATOR] != 'function') {\n          createNonEnumerableProperty(CurrentIteratorPrototype, ITERATOR, returnThis);\n        }\n      }\n      // Set @@toStringTag to native iterators\n      setToStringTag(CurrentIteratorPrototype, TO_STRING_TAG, true, true);\n      if (IS_PURE) Iterators[TO_STRING_TAG] = returnThis;\n    }\n  }\n\n  // fix Array#{values, @@iterator}.name in V8 / FF\n  if (DEFAULT == VALUES && nativeIterator && nativeIterator.name !== VALUES) {\n    INCORRECT_VALUES_NAME = true;\n    defaultIterator = function values() { return nativeIterator.call(this); };\n  }\n\n  // define iterator\n  if ((!IS_PURE || FORCED) && IterablePrototype[ITERATOR] !== defaultIterator) {\n    createNonEnumerableProperty(IterablePrototype, ITERATOR, defaultIterator);\n  }\n  Iterators[NAME] = defaultIterator;\n\n  // export additional methods\n  if (DEFAULT) {\n    methods = {\n      values: getIterationMethod(VALUES),\n      keys: IS_SET ? defaultIterator : getIterationMethod(KEYS),\n      entries: getIterationMethod(ENTRIES)\n    };\n    if (FORCED) for (KEY in methods) {\n      if (BUGGY_SAFARI_ITERATORS || INCORRECT_VALUES_NAME || !(KEY in IterablePrototype)) {\n        redefine(IterablePrototype, KEY, methods[KEY]);\n      }\n    } else $({ target: NAME, proto: true, forced: BUGGY_SAFARI_ITERATORS || INCORRECT_VALUES_NAME }, methods);\n  }\n\n  return methods;\n};\n","var fails = require('../internals/fails');\n\n// Detect IE8's incomplete defineProperty implementation\nmodule.exports = !fails(function () {\n  // eslint-disable-next-line es/no-object-defineproperty -- required for testing\n  return Object.defineProperty({}, 1, { get: function () { return 7; } })[1] != 7;\n});\n","var global = require('../internals/global');\nvar isObject = require('../internals/is-object');\n\nvar document = global.document;\n// typeof document.createElement is 'object' in old IE\nvar EXISTS = isObject(document) && isObject(document.createElement);\n\nmodule.exports = function (it) {\n  return EXISTS ? document.createElement(it) : {};\n};\n","// iterable DOM collections\n// flag - `iterable` interface - 'entries', 'keys', 'values', 'forEach' methods\nmodule.exports = {\n  CSSRuleList: 0,\n  CSSStyleDeclaration: 0,\n  CSSValueList: 0,\n  ClientRectList: 0,\n  DOMRectList: 0,\n  DOMStringList: 0,\n  DOMTokenList: 1,\n  DataTransferItemList: 0,\n  FileList: 0,\n  HTMLAllCollection: 0,\n  HTMLCollection: 0,\n  HTMLFormElement: 0,\n  HTMLSelectElement: 0,\n  MediaList: 0,\n  MimeTypeArray: 0,\n  NamedNodeMap: 0,\n  NodeList: 1,\n  PaintRequestList: 0,\n  Plugin: 0,\n  PluginArray: 0,\n  SVGLengthList: 0,\n  SVGNumberList: 0,\n  SVGPathSegList: 0,\n  SVGPointList: 0,\n  SVGStringList: 0,\n  SVGTransformList: 0,\n  SourceBufferList: 0,\n  StyleSheetList: 0,\n  TextTrackCueList: 0,\n  TextTrackList: 0,\n  TouchList: 0\n};\n","module.exports = typeof window == 'object';\n","var userAgent = require('../internals/engine-user-agent');\n\nmodule.exports = /(?:iphone|ipod|ipad).*applewebkit/i.test(userAgent);\n","var classof = require('../internals/classof-raw');\nvar global = require('../internals/global');\n\nmodule.exports = classof(global.process) == 'process';\n","var userAgent = require('../internals/engine-user-agent');\n\nmodule.exports = /web0s(?!.*chrome)/i.test(userAgent);\n","var getBuiltIn = require('../internals/get-built-in');\n\nmodule.exports = getBuiltIn('navigator', 'userAgent') || '';\n","var global = require('../internals/global');\nvar userAgent = require('../internals/engine-user-agent');\n\nvar process = global.process;\nvar versions = process && process.versions;\nvar v8 = versions && versions.v8;\nvar match, version;\n\nif (v8) {\n  match = v8.split('.');\n  version = match[0] < 4 ? 1 : match[0] + match[1];\n} else if (userAgent) {\n  match = userAgent.match(/Edge\\/(\\d+)/);\n  if (!match || match[1] >= 74) {\n    match = userAgent.match(/Chrome\\/(\\d+)/);\n    if (match) version = match[1];\n  }\n}\n\nmodule.exports = version && +version;\n","// IE8- don't enum bug keys\nmodule.exports = [\n  'constructor',\n  'hasOwnProperty',\n  'isPrototypeOf',\n  'propertyIsEnumerable',\n  'toLocaleString',\n  'toString',\n  'valueOf'\n];\n","'use strict';\nvar global = require('../internals/global');\nvar getOwnPropertyDescriptor = require('../internals/object-get-own-property-descriptor').f;\nvar isForced = require('../internals/is-forced');\nvar path = require('../internals/path');\nvar bind = require('../internals/function-bind-context');\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\nvar has = require('../internals/has');\n\nvar wrapConstructor = function (NativeConstructor) {\n  var Wrapper = function (a, b, c) {\n    if (this instanceof NativeConstructor) {\n      switch (arguments.length) {\n        case 0: return new NativeConstructor();\n        case 1: return new NativeConstructor(a);\n        case 2: return new NativeConstructor(a, b);\n      } return new NativeConstructor(a, b, c);\n    } return NativeConstructor.apply(this, arguments);\n  };\n  Wrapper.prototype = NativeConstructor.prototype;\n  return Wrapper;\n};\n\n/*\n  options.target      - name of the target object\n  options.global      - target is the global object\n  options.stat        - export as static methods of target\n  options.proto       - export as prototype methods of target\n  options.real        - real prototype method for the `pure` version\n  options.forced      - export even if the native feature is available\n  options.bind        - bind methods to the target, required for the `pure` version\n  options.wrap        - wrap constructors to preventing global pollution, required for the `pure` version\n  options.unsafe      - use the simple assignment of property instead of delete + defineProperty\n  options.sham        - add a flag to not completely full polyfills\n  options.enumerable  - export as enumerable property\n  options.noTargetGet - prevent calling a getter on target\n*/\nmodule.exports = function (options, source) {\n  var TARGET = options.target;\n  var GLOBAL = options.global;\n  var STATIC = options.stat;\n  var PROTO = options.proto;\n\n  var nativeSource = GLOBAL ? global : STATIC ? global[TARGET] : (global[TARGET] || {}).prototype;\n\n  var target = GLOBAL ? path : path[TARGET] || (path[TARGET] = {});\n  var targetPrototype = target.prototype;\n\n  var FORCED, USE_NATIVE, VIRTUAL_PROTOTYPE;\n  var key, sourceProperty, targetProperty, nativeProperty, resultProperty, descriptor;\n\n  for (key in source) {\n    FORCED = isForced(GLOBAL ? key : TARGET + (STATIC ? '.' : '#') + key, options.forced);\n    // contains in native\n    USE_NATIVE = !FORCED && nativeSource && has(nativeSource, key);\n\n    targetProperty = target[key];\n\n    if (USE_NATIVE) if (options.noTargetGet) {\n      descriptor = getOwnPropertyDescriptor(nativeSource, key);\n      nativeProperty = descriptor && descriptor.value;\n    } else nativeProperty = nativeSource[key];\n\n    // export native or implementation\n    sourceProperty = (USE_NATIVE && nativeProperty) ? nativeProperty : source[key];\n\n    if (USE_NATIVE && typeof targetProperty === typeof sourceProperty) continue;\n\n    // bind timers to global for call from export context\n    if (options.bind && USE_NATIVE) resultProperty = bind(sourceProperty, global);\n    // wrap global constructors for prevent changs in this version\n    else if (options.wrap && USE_NATIVE) resultProperty = wrapConstructor(sourceProperty);\n    // make static versions for prototype methods\n    else if (PROTO && typeof sourceProperty == 'function') resultProperty = bind(Function.call, sourceProperty);\n    // default case\n    else resultProperty = sourceProperty;\n\n    // add a flag to not completely full polyfills\n    if (options.sham || (sourceProperty && sourceProperty.sham) || (targetProperty && targetProperty.sham)) {\n      createNonEnumerableProperty(resultProperty, 'sham', true);\n    }\n\n    target[key] = resultProperty;\n\n    if (PROTO) {\n      VIRTUAL_PROTOTYPE = TARGET + 'Prototype';\n      if (!has(path, VIRTUAL_PROTOTYPE)) {\n        createNonEnumerableProperty(path, VIRTUAL_PROTOTYPE, {});\n      }\n      // export virtual prototype methods\n      path[VIRTUAL_PROTOTYPE][key] = sourceProperty;\n      // export real prototype methods\n      if (options.real && targetPrototype && !targetPrototype[key]) {\n        createNonEnumerableProperty(targetPrototype, key, sourceProperty);\n      }\n    }\n  }\n};\n","module.exports = function (exec) {\n  try {\n    return !!exec();\n  } catch (error) {\n    return true;\n  }\n};\n","var aFunction = require('../internals/a-function');\n\n// optional / simple context binding\nmodule.exports = function (fn, that, length) {\n  aFunction(fn);\n  if (that === undefined) return fn;\n  switch (length) {\n    case 0: return function () {\n      return fn.call(that);\n    };\n    case 1: return function (a) {\n      return fn.call(that, a);\n    };\n    case 2: return function (a, b) {\n      return fn.call(that, a, b);\n    };\n    case 3: return function (a, b, c) {\n      return fn.call(that, a, b, c);\n    };\n  }\n  return function (/* ...args */) {\n    return fn.apply(that, arguments);\n  };\n};\n","var path = require('../internals/path');\nvar global = require('../internals/global');\n\nvar aFunction = function (variable) {\n  return typeof variable == 'function' ? variable : undefined;\n};\n\nmodule.exports = function (namespace, method) {\n  return arguments.length < 2 ? aFunction(path[namespace]) || aFunction(global[namespace])\n    : path[namespace] && path[namespace][method] || global[namespace] && global[namespace][method];\n};\n","var classof = require('../internals/classof');\nvar Iterators = require('../internals/iterators');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar ITERATOR = wellKnownSymbol('iterator');\n\nmodule.exports = function (it) {\n  if (it != undefined) return it[ITERATOR]\n    || it['@@iterator']\n    || Iterators[classof(it)];\n};\n","var check = function (it) {\n  return it && it.Math == Math && it;\n};\n\n// https://github.com/zloirock/core-js/issues/86#issuecomment-115759028\nmodule.exports =\n  // eslint-disable-next-line es/no-global-this -- safe\n  check(typeof globalThis == 'object' && globalThis) ||\n  check(typeof window == 'object' && window) ||\n  // eslint-disable-next-line no-restricted-globals -- safe\n  check(typeof self == 'object' && self) ||\n  check(typeof global == 'object' && global) ||\n  // eslint-disable-next-line no-new-func -- fallback\n  (function () { return this; })() || Function('return this')();\n","var toObject = require('../internals/to-object');\n\nvar hasOwnProperty = {}.hasOwnProperty;\n\nmodule.exports = function hasOwn(it, key) {\n  return hasOwnProperty.call(toObject(it), key);\n};\n","module.exports = {};\n","var global = require('../internals/global');\n\nmodule.exports = function (a, b) {\n  var console = global.console;\n  if (console && console.error) {\n    arguments.length === 1 ? console.error(a) : console.error(a, b);\n  }\n};\n","var getBuiltIn = require('../internals/get-built-in');\n\nmodule.exports = getBuiltIn('document', 'documentElement');\n","var DESCRIPTORS = require('../internals/descriptors');\nvar fails = require('../internals/fails');\nvar createElement = require('../internals/document-create-element');\n\n// Thank's IE8 for his funny defineProperty\nmodule.exports = !DESCRIPTORS && !fails(function () {\n  // eslint-disable-next-line es/no-object-defineproperty -- requied for testing\n  return Object.defineProperty(createElement('div'), 'a', {\n    get: function () { return 7; }\n  }).a != 7;\n});\n","var fails = require('../internals/fails');\nvar classof = require('../internals/classof-raw');\n\nvar split = ''.split;\n\n// fallback for non-array-like ES3 and non-enumerable old V8 strings\nmodule.exports = fails(function () {\n  // throws an error in rhino, see https://github.com/mozilla/rhino/issues/346\n  // eslint-disable-next-line no-prototype-builtins -- safe\n  return !Object('z').propertyIsEnumerable(0);\n}) ? function (it) {\n  return classof(it) == 'String' ? split.call(it, '') : Object(it);\n} : Object;\n","var store = require('../internals/shared-store');\n\nvar functionToString = Function.toString;\n\n// this helper broken in `3.4.1-3.4.4`, so we can't use `shared` helper\nif (typeof store.inspectSource != 'function') {\n  store.inspectSource = function (it) {\n    return functionToString.call(it);\n  };\n}\n\nmodule.exports = store.inspectSource;\n","var NATIVE_WEAK_MAP = require('../internals/native-weak-map');\nvar global = require('../internals/global');\nvar isObject = require('../internals/is-object');\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\nvar objectHas = require('../internals/has');\nvar shared = require('../internals/shared-store');\nvar sharedKey = require('../internals/shared-key');\nvar hiddenKeys = require('../internals/hidden-keys');\n\nvar OBJECT_ALREADY_INITIALIZED = 'Object already initialized';\nvar WeakMap = global.WeakMap;\nvar set, get, has;\n\nvar enforce = function (it) {\n  return has(it) ? get(it) : set(it, {});\n};\n\nvar getterFor = function (TYPE) {\n  return function (it) {\n    var state;\n    if (!isObject(it) || (state = get(it)).type !== TYPE) {\n      throw TypeError('Incompatible receiver, ' + TYPE + ' required');\n    } return state;\n  };\n};\n\nif (NATIVE_WEAK_MAP || shared.state) {\n  var store = shared.state || (shared.state = new WeakMap());\n  var wmget = store.get;\n  var wmhas = store.has;\n  var wmset = store.set;\n  set = function (it, metadata) {\n    if (wmhas.call(store, it)) throw new TypeError(OBJECT_ALREADY_INITIALIZED);\n    metadata.facade = it;\n    wmset.call(store, it, metadata);\n    return metadata;\n  };\n  get = function (it) {\n    return wmget.call(store, it) || {};\n  };\n  has = function (it) {\n    return wmhas.call(store, it);\n  };\n} else {\n  var STATE = sharedKey('state');\n  hiddenKeys[STATE] = true;\n  set = function (it, metadata) {\n    if (objectHas(it, STATE)) throw new TypeError(OBJECT_ALREADY_INITIALIZED);\n    metadata.facade = it;\n    createNonEnumerableProperty(it, STATE, metadata);\n    return metadata;\n  };\n  get = function (it) {\n    return objectHas(it, STATE) ? it[STATE] : {};\n  };\n  has = function (it) {\n    return objectHas(it, STATE);\n  };\n}\n\nmodule.exports = {\n  set: set,\n  get: get,\n  has: has,\n  enforce: enforce,\n  getterFor: getterFor\n};\n","var wellKnownSymbol = require('../internals/well-known-symbol');\nvar Iterators = require('../internals/iterators');\n\nvar ITERATOR = wellKnownSymbol('iterator');\nvar ArrayPrototype = Array.prototype;\n\n// check on default Array iterator\nmodule.exports = function (it) {\n  return it !== undefined && (Iterators.Array === it || ArrayPrototype[ITERATOR] === it);\n};\n","var fails = require('../internals/fails');\n\nvar replacement = /#|\\.prototype\\./;\n\nvar isForced = function (feature, detection) {\n  var value = data[normalize(feature)];\n  return value == POLYFILL ? true\n    : value == NATIVE ? false\n    : typeof detection == 'function' ? fails(detection)\n    : !!detection;\n};\n\nvar normalize = isForced.normalize = function (string) {\n  return String(string).replace(replacement, '.').toLowerCase();\n};\n\nvar data = isForced.data = {};\nvar NATIVE = isForced.NATIVE = 'N';\nvar POLYFILL = isForced.POLYFILL = 'P';\n\nmodule.exports = isForced;\n","module.exports = function (it) {\n  return typeof it === 'object' ? it !== null : typeof it === 'function';\n};\n","module.exports = true;\n","var anObject = require('../internals/an-object');\nvar isArrayIteratorMethod = require('../internals/is-array-iterator-method');\nvar toLength = require('../internals/to-length');\nvar bind = require('../internals/function-bind-context');\nvar getIteratorMethod = require('../internals/get-iterator-method');\nvar iteratorClose = require('../internals/iterator-close');\n\nvar Result = function (stopped, result) {\n  this.stopped = stopped;\n  this.result = result;\n};\n\nmodule.exports = function (iterable, unboundFunction, options) {\n  var that = options && options.that;\n  var AS_ENTRIES = !!(options && options.AS_ENTRIES);\n  var IS_ITERATOR = !!(options && options.IS_ITERATOR);\n  var INTERRUPTED = !!(options && options.INTERRUPTED);\n  var fn = bind(unboundFunction, that, 1 + AS_ENTRIES + INTERRUPTED);\n  var iterator, iterFn, index, length, result, next, step;\n\n  var stop = function (condition) {\n    if (iterator) iteratorClose(iterator);\n    return new Result(true, condition);\n  };\n\n  var callFn = function (value) {\n    if (AS_ENTRIES) {\n      anObject(value);\n      return INTERRUPTED ? fn(value[0], value[1], stop) : fn(value[0], value[1]);\n    } return INTERRUPTED ? fn(value, stop) : fn(value);\n  };\n\n  if (IS_ITERATOR) {\n    iterator = iterable;\n  } else {\n    iterFn = getIteratorMethod(iterable);\n    if (typeof iterFn != 'function') throw TypeError('Target is not iterable');\n    // optimisation for array iterators\n    if (isArrayIteratorMethod(iterFn)) {\n      for (index = 0, length = toLength(iterable.length); length > index; index++) {\n        result = callFn(iterable[index]);\n        if (result && result instanceof Result) return result;\n      } return new Result(false);\n    }\n    iterator = iterFn.call(iterable);\n  }\n\n  next = iterator.next;\n  while (!(step = next.call(iterator)).done) {\n    try {\n      result = callFn(step.value);\n    } catch (error) {\n      iteratorClose(iterator);\n      throw error;\n    }\n    if (typeof result == 'object' && result && result instanceof Result) return result;\n  } return new Result(false);\n};\n","var anObject = require('../internals/an-object');\n\nmodule.exports = function (iterator) {\n  var returnMethod = iterator['return'];\n  if (returnMethod !== undefined) {\n    return anObject(returnMethod.call(iterator)).value;\n  }\n};\n","'use strict';\nvar fails = require('../internals/fails');\nvar getPrototypeOf = require('../internals/object-get-prototype-of');\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\nvar has = require('../internals/has');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\nvar IS_PURE = require('../internals/is-pure');\n\nvar ITERATOR = wellKnownSymbol('iterator');\nvar BUGGY_SAFARI_ITERATORS = false;\n\nvar returnThis = function () { return this; };\n\n// `%IteratorPrototype%` object\n// https://tc39.es/ecma262/#sec-%iteratorprototype%-object\nvar IteratorPrototype, PrototypeOfArrayIteratorPrototype, arrayIterator;\n\n/* eslint-disable es/no-array-prototype-keys -- safe */\nif ([].keys) {\n  arrayIterator = [].keys();\n  // Safari 8 has buggy iterators w/o `next`\n  if (!('next' in arrayIterator)) BUGGY_SAFARI_ITERATORS = true;\n  else {\n    PrototypeOfArrayIteratorPrototype = getPrototypeOf(getPrototypeOf(arrayIterator));\n    if (PrototypeOfArrayIteratorPrototype !== Object.prototype) IteratorPrototype = PrototypeOfArrayIteratorPrototype;\n  }\n}\n\nvar NEW_ITERATOR_PROTOTYPE = IteratorPrototype == undefined || fails(function () {\n  var test = {};\n  // FF44- legacy iterators case\n  return IteratorPrototype[ITERATOR].call(test) !== test;\n});\n\nif (NEW_ITERATOR_PROTOTYPE) IteratorPrototype = {};\n\n// 25.1.2.1.1 %IteratorPrototype%[@@iterator]()\nif ((!IS_PURE || NEW_ITERATOR_PROTOTYPE) && !has(IteratorPrototype, ITERATOR)) {\n  createNonEnumerableProperty(IteratorPrototype, ITERATOR, returnThis);\n}\n\nmodule.exports = {\n  IteratorPrototype: IteratorPrototype,\n  BUGGY_SAFARI_ITERATORS: BUGGY_SAFARI_ITERATORS\n};\n","module.exports = {};\n","var global = require('../internals/global');\nvar getOwnPropertyDescriptor = require('../internals/object-get-own-property-descriptor').f;\nvar macrotask = require('../internals/task').set;\nvar IS_IOS = require('../internals/engine-is-ios');\nvar IS_WEBOS_WEBKIT = require('../internals/engine-is-webos-webkit');\nvar IS_NODE = require('../internals/engine-is-node');\n\nvar MutationObserver = global.MutationObserver || global.WebKitMutationObserver;\nvar document = global.document;\nvar process = global.process;\nvar Promise = global.Promise;\n// Node.js 11 shows ExperimentalWarning on getting `queueMicrotask`\nvar queueMicrotaskDescriptor = getOwnPropertyDescriptor(global, 'queueMicrotask');\nvar queueMicrotask = queueMicrotaskDescriptor && queueMicrotaskDescriptor.value;\n\nvar flush, head, last, notify, toggle, node, promise, then;\n\n// modern engines have queueMicrotask method\nif (!queueMicrotask) {\n  flush = function () {\n    var parent, fn;\n    if (IS_NODE && (parent = process.domain)) parent.exit();\n    while (head) {\n      fn = head.fn;\n      head = head.next;\n      try {\n        fn();\n      } catch (error) {\n        if (head) notify();\n        else last = undefined;\n        throw error;\n      }\n    } last = undefined;\n    if (parent) parent.enter();\n  };\n\n  // browsers with MutationObserver, except iOS - https://github.com/zloirock/core-js/issues/339\n  // also except WebOS Webkit https://github.com/zloirock/core-js/issues/898\n  if (!IS_IOS && !IS_NODE && !IS_WEBOS_WEBKIT && MutationObserver && document) {\n    toggle = true;\n    node = document.createTextNode('');\n    new MutationObserver(flush).observe(node, { characterData: true });\n    notify = function () {\n      node.data = toggle = !toggle;\n    };\n  // environments with maybe non-completely correct, but existent Promise\n  } else if (Promise && Promise.resolve) {\n    // Promise.resolve without an argument throws an error in LG WebOS 2\n    promise = Promise.resolve(undefined);\n    // workaround of WebKit ~ iOS Safari 10.1 bug\n    promise.constructor = Promise;\n    then = promise.then;\n    notify = function () {\n      then.call(promise, flush);\n    };\n  // Node.js without promises\n  } else if (IS_NODE) {\n    notify = function () {\n      process.nextTick(flush);\n    };\n  // for other environments - macrotask based on:\n  // - setImmediate\n  // - MessageChannel\n  // - window.postMessag\n  // - onreadystatechange\n  // - setTimeout\n  } else {\n    notify = function () {\n      // strange IE + webpack dev server bug - use .call(global)\n      macrotask.call(global, flush);\n    };\n  }\n}\n\nmodule.exports = queueMicrotask || function (fn) {\n  var task = { fn: fn, next: undefined };\n  if (last) last.next = task;\n  if (!head) {\n    head = task;\n    notify();\n  } last = task;\n};\n","var global = require('../internals/global');\n\nmodule.exports = global.Promise;\n","/* eslint-disable es/no-symbol -- required for testing */\nvar V8_VERSION = require('../internals/engine-v8-version');\nvar fails = require('../internals/fails');\n\n// eslint-disable-next-line es/no-object-getownpropertysymbols -- required for testing\nmodule.exports = !!Object.getOwnPropertySymbols && !fails(function () {\n  return !String(Symbol()) ||\n    // Chrome 38 Symbol has incorrect toString conversion\n    // Chrome 38-40 symbols are not inherited from DOM collections prototypes to instances\n    !Symbol.sham && V8_VERSION && V8_VERSION < 41;\n});\n","var global = require('../internals/global');\nvar inspectSource = require('../internals/inspect-source');\n\nvar WeakMap = global.WeakMap;\n\nmodule.exports = typeof WeakMap === 'function' && /native code/.test(inspectSource(WeakMap));\n","'use strict';\nvar aFunction = require('../internals/a-function');\n\nvar PromiseCapability = function (C) {\n  var resolve, reject;\n  this.promise = new C(function ($$resolve, $$reject) {\n    if (resolve !== undefined || reject !== undefined) throw TypeError('Bad Promise constructor');\n    resolve = $$resolve;\n    reject = $$reject;\n  });\n  this.resolve = aFunction(resolve);\n  this.reject = aFunction(reject);\n};\n\n// 25.4.1.5 NewPromiseCapability(C)\nmodule.exports.f = function (C) {\n  return new PromiseCapability(C);\n};\n","var anObject = require('../internals/an-object');\nvar defineProperties = require('../internals/object-define-properties');\nvar enumBugKeys = require('../internals/enum-bug-keys');\nvar hiddenKeys = require('../internals/hidden-keys');\nvar html = require('../internals/html');\nvar documentCreateElement = require('../internals/document-create-element');\nvar sharedKey = require('../internals/shared-key');\n\nvar GT = '>';\nvar LT = '<';\nvar PROTOTYPE = 'prototype';\nvar SCRIPT = 'script';\nvar IE_PROTO = sharedKey('IE_PROTO');\n\nvar EmptyConstructor = function () { /* empty */ };\n\nvar scriptTag = function (content) {\n  return LT + SCRIPT + GT + content + LT + '/' + SCRIPT + GT;\n};\n\n// Create object with fake `null` prototype: use ActiveX Object with cleared prototype\nvar NullProtoObjectViaActiveX = function (activeXDocument) {\n  activeXDocument.write(scriptTag(''));\n  activeXDocument.close();\n  var temp = activeXDocument.parentWindow.Object;\n  activeXDocument = null; // avoid memory leak\n  return temp;\n};\n\n// Create object with fake `null` prototype: use iframe Object with cleared prototype\nvar NullProtoObjectViaIFrame = function () {\n  // Thrash, waste and sodomy: IE GC bug\n  var iframe = documentCreateElement('iframe');\n  var JS = 'java' + SCRIPT + ':';\n  var iframeDocument;\n  iframe.style.display = 'none';\n  html.appendChild(iframe);\n  // https://github.com/zloirock/core-js/issues/475\n  iframe.src = String(JS);\n  iframeDocument = iframe.contentWindow.document;\n  iframeDocument.open();\n  iframeDocument.write(scriptTag('document.F=Object'));\n  iframeDocument.close();\n  return iframeDocument.F;\n};\n\n// Check for document.domain and active x support\n// No need to use active x approach when document.domain is not set\n// see https://github.com/es-shims/es5-shim/issues/150\n// variation of https://github.com/kitcambridge/es5-shim/commit/4f738ac066346\n// avoid IE GC bug\nvar activeXDocument;\nvar NullProtoObject = function () {\n  try {\n    /* global ActiveXObject -- old IE */\n    activeXDocument = document.domain && new ActiveXObject('htmlfile');\n  } catch (error) { /* ignore */ }\n  NullProtoObject = activeXDocument ? NullProtoObjectViaActiveX(activeXDocument) : NullProtoObjectViaIFrame();\n  var length = enumBugKeys.length;\n  while (length--) delete NullProtoObject[PROTOTYPE][enumBugKeys[length]];\n  return NullProtoObject();\n};\n\nhiddenKeys[IE_PROTO] = true;\n\n// `Object.create` method\n// https://tc39.es/ecma262/#sec-object.create\nmodule.exports = Object.create || function create(O, Properties) {\n  var result;\n  if (O !== null) {\n    EmptyConstructor[PROTOTYPE] = anObject(O);\n    result = new EmptyConstructor();\n    EmptyConstructor[PROTOTYPE] = null;\n    // add \"__proto__\" for Object.getPrototypeOf polyfill\n    result[IE_PROTO] = O;\n  } else result = NullProtoObject();\n  return Properties === undefined ? result : defineProperties(result, Properties);\n};\n","var DESCRIPTORS = require('../internals/descriptors');\nvar definePropertyModule = require('../internals/object-define-property');\nvar anObject = require('../internals/an-object');\nvar objectKeys = require('../internals/object-keys');\n\n// `Object.defineProperties` method\n// https://tc39.es/ecma262/#sec-object.defineproperties\n// eslint-disable-next-line es/no-object-defineproperties -- safe\nmodule.exports = DESCRIPTORS ? Object.defineProperties : function defineProperties(O, Properties) {\n  anObject(O);\n  var keys = objectKeys(Properties);\n  var length = keys.length;\n  var index = 0;\n  var key;\n  while (length > index) definePropertyModule.f(O, key = keys[index++], Properties[key]);\n  return O;\n};\n","var DESCRIPTORS = require('../internals/descriptors');\nvar IE8_DOM_DEFINE = require('../internals/ie8-dom-define');\nvar anObject = require('../internals/an-object');\nvar toPrimitive = require('../internals/to-primitive');\n\n// eslint-disable-next-line es/no-object-defineproperty -- safe\nvar $defineProperty = Object.defineProperty;\n\n// `Object.defineProperty` method\n// https://tc39.es/ecma262/#sec-object.defineproperty\nexports.f = DESCRIPTORS ? $defineProperty : function defineProperty(O, P, Attributes) {\n  anObject(O);\n  P = toPrimitive(P, true);\n  anObject(Attributes);\n  if (IE8_DOM_DEFINE) try {\n    return $defineProperty(O, P, Attributes);\n  } catch (error) { /* empty */ }\n  if ('get' in Attributes || 'set' in Attributes) throw TypeError('Accessors not supported');\n  if ('value' in Attributes) O[P] = Attributes.value;\n  return O;\n};\n","var DESCRIPTORS = require('../internals/descriptors');\nvar propertyIsEnumerableModule = require('../internals/object-property-is-enumerable');\nvar createPropertyDescriptor = require('../internals/create-property-descriptor');\nvar toIndexedObject = require('../internals/to-indexed-object');\nvar toPrimitive = require('../internals/to-primitive');\nvar has = require('../internals/has');\nvar IE8_DOM_DEFINE = require('../internals/ie8-dom-define');\n\n// eslint-disable-next-line es/no-object-getownpropertydescriptor -- safe\nvar $getOwnPropertyDescriptor = Object.getOwnPropertyDescriptor;\n\n// `Object.getOwnPropertyDescriptor` method\n// https://tc39.es/ecma262/#sec-object.getownpropertydescriptor\nexports.f = DESCRIPTORS ? $getOwnPropertyDescriptor : function getOwnPropertyDescriptor(O, P) {\n  O = toIndexedObject(O);\n  P = toPrimitive(P, true);\n  if (IE8_DOM_DEFINE) try {\n    return $getOwnPropertyDescriptor(O, P);\n  } catch (error) { /* empty */ }\n  if (has(O, P)) return createPropertyDescriptor(!propertyIsEnumerableModule.f.call(O, P), O[P]);\n};\n","var has = require('../internals/has');\nvar toObject = require('../internals/to-object');\nvar sharedKey = require('../internals/shared-key');\nvar CORRECT_PROTOTYPE_GETTER = require('../internals/correct-prototype-getter');\n\nvar IE_PROTO = sharedKey('IE_PROTO');\nvar ObjectPrototype = Object.prototype;\n\n// `Object.getPrototypeOf` method\n// https://tc39.es/ecma262/#sec-object.getprototypeof\n// eslint-disable-next-line es/no-object-getprototypeof -- safe\nmodule.exports = CORRECT_PROTOTYPE_GETTER ? Object.getPrototypeOf : function (O) {\n  O = toObject(O);\n  if (has(O, IE_PROTO)) return O[IE_PROTO];\n  if (typeof O.constructor == 'function' && O instanceof O.constructor) {\n    return O.constructor.prototype;\n  } return O instanceof Object ? ObjectPrototype : null;\n};\n","var has = require('../internals/has');\nvar toIndexedObject = require('../internals/to-indexed-object');\nvar indexOf = require('../internals/array-includes').indexOf;\nvar hiddenKeys = require('../internals/hidden-keys');\n\nmodule.exports = function (object, names) {\n  var O = toIndexedObject(object);\n  var i = 0;\n  var result = [];\n  var key;\n  for (key in O) !has(hiddenKeys, key) && has(O, key) && result.push(key);\n  // Don't enum bug & hidden keys\n  while (names.length > i) if (has(O, key = names[i++])) {\n    ~indexOf(result, key) || result.push(key);\n  }\n  return result;\n};\n","var internalObjectKeys = require('../internals/object-keys-internal');\nvar enumBugKeys = require('../internals/enum-bug-keys');\n\n// `Object.keys` method\n// https://tc39.es/ecma262/#sec-object.keys\n// eslint-disable-next-line es/no-object-keys -- safe\nmodule.exports = Object.keys || function keys(O) {\n  return internalObjectKeys(O, enumBugKeys);\n};\n","'use strict';\nvar $propertyIsEnumerable = {}.propertyIsEnumerable;\n// eslint-disable-next-line es/no-object-getownpropertydescriptor -- safe\nvar getOwnPropertyDescriptor = Object.getOwnPropertyDescriptor;\n\n// Nashorn ~ JDK8 bug\nvar NASHORN_BUG = getOwnPropertyDescriptor && !$propertyIsEnumerable.call({ 1: 2 }, 1);\n\n// `Object.prototype.propertyIsEnumerable` method implementation\n// https://tc39.es/ecma262/#sec-object.prototype.propertyisenumerable\nexports.f = NASHORN_BUG ? function propertyIsEnumerable(V) {\n  var descriptor = getOwnPropertyDescriptor(this, V);\n  return !!descriptor && descriptor.enumerable;\n} : $propertyIsEnumerable;\n","/* eslint-disable no-proto -- safe */\nvar anObject = require('../internals/an-object');\nvar aPossiblePrototype = require('../internals/a-possible-prototype');\n\n// `Object.setPrototypeOf` method\n// https://tc39.es/ecma262/#sec-object.setprototypeof\n// Works with __proto__ only. Old v8 can't work with null proto objects.\n// eslint-disable-next-line es/no-object-setprototypeof -- safe\nmodule.exports = Object.setPrototypeOf || ('__proto__' in {} ? function () {\n  var CORRECT_SETTER = false;\n  var test = {};\n  var setter;\n  try {\n    // eslint-disable-next-line es/no-object-getownpropertydescriptor -- safe\n    setter = Object.getOwnPropertyDescriptor(Object.prototype, '__proto__').set;\n    setter.call(test, []);\n    CORRECT_SETTER = test instanceof Array;\n  } catch (error) { /* empty */ }\n  return function setPrototypeOf(O, proto) {\n    anObject(O);\n    aPossiblePrototype(proto);\n    if (CORRECT_SETTER) setter.call(O, proto);\n    else O.__proto__ = proto;\n    return O;\n  };\n}() : undefined);\n","'use strict';\nvar TO_STRING_TAG_SUPPORT = require('../internals/to-string-tag-support');\nvar classof = require('../internals/classof');\n\n// `Object.prototype.toString` method implementation\n// https://tc39.es/ecma262/#sec-object.prototype.tostring\nmodule.exports = TO_STRING_TAG_SUPPORT ? {}.toString : function toString() {\n  return '[object ' + classof(this) + ']';\n};\n","module.exports = {};\n","module.exports = function (exec) {\n  try {\n    return { error: false, value: exec() };\n  } catch (error) {\n    return { error: true, value: error };\n  }\n};\n","var anObject = require('../internals/an-object');\nvar isObject = require('../internals/is-object');\nvar newPromiseCapability = require('../internals/new-promise-capability');\n\nmodule.exports = function (C, x) {\n  anObject(C);\n  if (isObject(x) && x.constructor === C) return x;\n  var promiseCapability = newPromiseCapability.f(C);\n  var resolve = promiseCapability.resolve;\n  resolve(x);\n  return promiseCapability.promise;\n};\n","var redefine = require('../internals/redefine');\n\nmodule.exports = function (target, src, options) {\n  for (var key in src) {\n    if (options && options.unsafe && target[key]) target[key] = src[key];\n    else redefine(target, key, src[key], options);\n  } return target;\n};\n","var createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\n\nmodule.exports = function (target, key, value, options) {\n  if (options && options.enumerable) target[key] = value;\n  else createNonEnumerableProperty(target, key, value);\n};\n","// `RequireObjectCoercible` abstract operation\n// https://tc39.es/ecma262/#sec-requireobjectcoercible\nmodule.exports = function (it) {\n  if (it == undefined) throw TypeError(\"Can't call method on \" + it);\n  return it;\n};\n","var global = require('../internals/global');\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\n\nmodule.exports = function (key, value) {\n  try {\n    createNonEnumerableProperty(global, key, value);\n  } catch (error) {\n    global[key] = value;\n  } return value;\n};\n","'use strict';\nvar getBuiltIn = require('../internals/get-built-in');\nvar definePropertyModule = require('../internals/object-define-property');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\nvar DESCRIPTORS = require('../internals/descriptors');\n\nvar SPECIES = wellKnownSymbol('species');\n\nmodule.exports = function (CONSTRUCTOR_NAME) {\n  var Constructor = getBuiltIn(CONSTRUCTOR_NAME);\n  var defineProperty = definePropertyModule.f;\n\n  if (DESCRIPTORS && Constructor && !Constructor[SPECIES]) {\n    defineProperty(Constructor, SPECIES, {\n      configurable: true,\n      get: function () { return this; }\n    });\n  }\n};\n","var TO_STRING_TAG_SUPPORT = require('../internals/to-string-tag-support');\nvar defineProperty = require('../internals/object-define-property').f;\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\nvar has = require('../internals/has');\nvar toString = require('../internals/object-to-string');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar TO_STRING_TAG = wellKnownSymbol('toStringTag');\n\nmodule.exports = function (it, TAG, STATIC, SET_METHOD) {\n  if (it) {\n    var target = STATIC ? it : it.prototype;\n    if (!has(target, TO_STRING_TAG)) {\n      defineProperty(target, TO_STRING_TAG, { configurable: true, value: TAG });\n    }\n    if (SET_METHOD && !TO_STRING_TAG_SUPPORT) {\n      createNonEnumerableProperty(target, 'toString', toString);\n    }\n  }\n};\n","var shared = require('../internals/shared');\nvar uid = require('../internals/uid');\n\nvar keys = shared('keys');\n\nmodule.exports = function (key) {\n  return keys[key] || (keys[key] = uid(key));\n};\n","var global = require('../internals/global');\nvar setGlobal = require('../internals/set-global');\n\nvar SHARED = '__core-js_shared__';\nvar store = global[SHARED] || setGlobal(SHARED, {});\n\nmodule.exports = store;\n","var IS_PURE = require('../internals/is-pure');\nvar store = require('../internals/shared-store');\n\n(module.exports = function (key, value) {\n  return store[key] || (store[key] = value !== undefined ? value : {});\n})('versions', []).push({\n  version: '3.13.0',\n  mode: IS_PURE ? 'pure' : 'global',\n  copyright: ' 2021 Denis Pushkarev (zloirock.ru)'\n});\n","var anObject = require('../internals/an-object');\nvar aFunction = require('../internals/a-function');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar SPECIES = wellKnownSymbol('species');\n\n// `SpeciesConstructor` abstract operation\n// https://tc39.es/ecma262/#sec-speciesconstructor\nmodule.exports = function (O, defaultConstructor) {\n  var C = anObject(O).constructor;\n  var S;\n  return C === undefined || (S = anObject(C)[SPECIES]) == undefined ? defaultConstructor : aFunction(S);\n};\n","var toInteger = require('../internals/to-integer');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\n\n// `String.prototype.{ codePointAt, at }` methods implementation\nvar createMethod = function (CONVERT_TO_STRING) {\n  return function ($this, pos) {\n    var S = String(requireObjectCoercible($this));\n    var position = toInteger(pos);\n    var size = S.length;\n    var first, second;\n    if (position < 0 || position >= size) return CONVERT_TO_STRING ? '' : undefined;\n    first = S.charCodeAt(position);\n    return first < 0xD800 || first > 0xDBFF || position + 1 === size\n      || (second = S.charCodeAt(position + 1)) < 0xDC00 || second > 0xDFFF\n        ? CONVERT_TO_STRING ? S.charAt(position) : first\n        : CONVERT_TO_STRING ? S.slice(position, position + 2) : (first - 0xD800 << 10) + (second - 0xDC00) + 0x10000;\n  };\n};\n\nmodule.exports = {\n  // `String.prototype.codePointAt` method\n  // https://tc39.es/ecma262/#sec-string.prototype.codepointat\n  codeAt: createMethod(false),\n  // `String.prototype.at` method\n  // https://github.com/mathiasbynens/String.prototype.at\n  charAt: createMethod(true)\n};\n","var global = require('../internals/global');\nvar fails = require('../internals/fails');\nvar bind = require('../internals/function-bind-context');\nvar html = require('../internals/html');\nvar createElement = require('../internals/document-create-element');\nvar IS_IOS = require('../internals/engine-is-ios');\nvar IS_NODE = require('../internals/engine-is-node');\n\nvar location = global.location;\nvar set = global.setImmediate;\nvar clear = global.clearImmediate;\nvar process = global.process;\nvar MessageChannel = global.MessageChannel;\nvar Dispatch = global.Dispatch;\nvar counter = 0;\nvar queue = {};\nvar ONREADYSTATECHANGE = 'onreadystatechange';\nvar defer, channel, port;\n\nvar run = function (id) {\n  // eslint-disable-next-line no-prototype-builtins -- safe\n  if (queue.hasOwnProperty(id)) {\n    var fn = queue[id];\n    delete queue[id];\n    fn();\n  }\n};\n\nvar runner = function (id) {\n  return function () {\n    run(id);\n  };\n};\n\nvar listener = function (event) {\n  run(event.data);\n};\n\nvar post = function (id) {\n  // old engines have not location.origin\n  global.postMessage(id + '', location.protocol + '//' + location.host);\n};\n\n// Node.js 0.9+ & IE10+ has setImmediate, otherwise:\nif (!set || !clear) {\n  set = function setImmediate(fn) {\n    var args = [];\n    var i = 1;\n    while (arguments.length > i) args.push(arguments[i++]);\n    queue[++counter] = function () {\n      // eslint-disable-next-line no-new-func -- spec requirement\n      (typeof fn == 'function' ? fn : Function(fn)).apply(undefined, args);\n    };\n    defer(counter);\n    return counter;\n  };\n  clear = function clearImmediate(id) {\n    delete queue[id];\n  };\n  // Node.js 0.8-\n  if (IS_NODE) {\n    defer = function (id) {\n      process.nextTick(runner(id));\n    };\n  // Sphere (JS game engine) Dispatch API\n  } else if (Dispatch && Dispatch.now) {\n    defer = function (id) {\n      Dispatch.now(runner(id));\n    };\n  // Browsers with MessageChannel, includes WebWorkers\n  // except iOS - https://github.com/zloirock/core-js/issues/624\n  } else if (MessageChannel && !IS_IOS) {\n    channel = new MessageChannel();\n    port = channel.port2;\n    channel.port1.onmessage = listener;\n    defer = bind(port.postMessage, port, 1);\n  // Browsers with postMessage, skip WebWorkers\n  // IE8 has postMessage, but it's sync & typeof its postMessage is 'object'\n  } else if (\n    global.addEventListener &&\n    typeof postMessage == 'function' &&\n    !global.importScripts &&\n    location && location.protocol !== 'file:' &&\n    !fails(post)\n  ) {\n    defer = post;\n    global.addEventListener('message', listener, false);\n  // IE8-\n  } else if (ONREADYSTATECHANGE in createElement('script')) {\n    defer = function (id) {\n      html.appendChild(createElement('script'))[ONREADYSTATECHANGE] = function () {\n        html.removeChild(this);\n        run(id);\n      };\n    };\n  // Rest old browsers\n  } else {\n    defer = function (id) {\n      setTimeout(runner(id), 0);\n    };\n  }\n}\n\nmodule.exports = {\n  set: set,\n  clear: clear\n};\n","var toInteger = require('../internals/to-integer');\n\nvar max = Math.max;\nvar min = Math.min;\n\n// Helper for a popular repeating case of the spec:\n// Let integer be ? ToInteger(index).\n// If integer < 0, let result be max((length + integer), 0); else let result be min(integer, length).\nmodule.exports = function (index, length) {\n  var integer = toInteger(index);\n  return integer < 0 ? max(integer + length, 0) : min(integer, length);\n};\n","// toObject with fallback for non-array-like ES3 strings\nvar IndexedObject = require('../internals/indexed-object');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\n\nmodule.exports = function (it) {\n  return IndexedObject(requireObjectCoercible(it));\n};\n","var ceil = Math.ceil;\nvar floor = Math.floor;\n\n// `ToInteger` abstract operation\n// https://tc39.es/ecma262/#sec-tointeger\nmodule.exports = function (argument) {\n  return isNaN(argument = +argument) ? 0 : (argument > 0 ? floor : ceil)(argument);\n};\n","var toInteger = require('../internals/to-integer');\n\nvar min = Math.min;\n\n// `ToLength` abstract operation\n// https://tc39.es/ecma262/#sec-tolength\nmodule.exports = function (argument) {\n  return argument > 0 ? min(toInteger(argument), 0x1FFFFFFFFFFFFF) : 0; // 2 ** 53 - 1 == 9007199254740991\n};\n","var requireObjectCoercible = require('../internals/require-object-coercible');\n\n// `ToObject` abstract operation\n// https://tc39.es/ecma262/#sec-toobject\nmodule.exports = function (argument) {\n  return Object(requireObjectCoercible(argument));\n};\n","var isObject = require('../internals/is-object');\n\n// `ToPrimitive` abstract operation\n// https://tc39.es/ecma262/#sec-toprimitive\n// instead of the ES6 spec version, we didn't implement @@toPrimitive case\n// and the second argument - flag - preferred type is a string\nmodule.exports = function (input, PREFERRED_STRING) {\n  if (!isObject(input)) return input;\n  var fn, val;\n  if (PREFERRED_STRING && typeof (fn = input.toString) == 'function' && !isObject(val = fn.call(input))) return val;\n  if (typeof (fn = input.valueOf) == 'function' && !isObject(val = fn.call(input))) return val;\n  if (!PREFERRED_STRING && typeof (fn = input.toString) == 'function' && !isObject(val = fn.call(input))) return val;\n  throw TypeError(\"Can't convert object to primitive value\");\n};\n","var wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar TO_STRING_TAG = wellKnownSymbol('toStringTag');\nvar test = {};\n\ntest[TO_STRING_TAG] = 'z';\n\nmodule.exports = String(test) === '[object z]';\n","var id = 0;\nvar postfix = Math.random();\n\nmodule.exports = function (key) {\n  return 'Symbol(' + String(key === undefined ? '' : key) + ')_' + (++id + postfix).toString(36);\n};\n","/* eslint-disable es/no-symbol -- required for testing */\nvar NATIVE_SYMBOL = require('../internals/native-symbol');\n\nmodule.exports = NATIVE_SYMBOL\n  && !Symbol.sham\n  && typeof Symbol.iterator == 'symbol';\n","var global = require('../internals/global');\nvar shared = require('../internals/shared');\nvar has = require('../internals/has');\nvar uid = require('../internals/uid');\nvar NATIVE_SYMBOL = require('../internals/native-symbol');\nvar USE_SYMBOL_AS_UID = require('../internals/use-symbol-as-uid');\n\nvar WellKnownSymbolsStore = shared('wks');\nvar Symbol = global.Symbol;\nvar createWellKnownSymbol = USE_SYMBOL_AS_UID ? Symbol : Symbol && Symbol.withoutSetter || uid;\n\nmodule.exports = function (name) {\n  if (!has(WellKnownSymbolsStore, name) || !(NATIVE_SYMBOL || typeof WellKnownSymbolsStore[name] == 'string')) {\n    if (NATIVE_SYMBOL && has(Symbol, name)) {\n      WellKnownSymbolsStore[name] = Symbol[name];\n    } else {\n      WellKnownSymbolsStore[name] = createWellKnownSymbol('Symbol.' + name);\n    }\n  } return WellKnownSymbolsStore[name];\n};\n","'use strict';\nvar $ = require('../internals/export');\nvar getPrototypeOf = require('../internals/object-get-prototype-of');\nvar setPrototypeOf = require('../internals/object-set-prototype-of');\nvar create = require('../internals/object-create');\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\nvar createPropertyDescriptor = require('../internals/create-property-descriptor');\nvar iterate = require('../internals/iterate');\n\nvar $AggregateError = function AggregateError(errors, message) {\n  var that = this;\n  if (!(that instanceof $AggregateError)) return new $AggregateError(errors, message);\n  if (setPrototypeOf) {\n    // eslint-disable-next-line unicorn/error-message -- expected\n    that = setPrototypeOf(new Error(undefined), getPrototypeOf(that));\n  }\n  if (message !== undefined) createNonEnumerableProperty(that, 'message', String(message));\n  var errorsArray = [];\n  iterate(errors, errorsArray.push, { that: errorsArray });\n  createNonEnumerableProperty(that, 'errors', errorsArray);\n  return that;\n};\n\n$AggregateError.prototype = create(Error.prototype, {\n  constructor: createPropertyDescriptor(5, $AggregateError),\n  message: createPropertyDescriptor(5, ''),\n  name: createPropertyDescriptor(5, 'AggregateError')\n});\n\n// `AggregateError` constructor\n// https://tc39.es/ecma262/#sec-aggregate-error-constructor\n$({ global: true }, {\n  AggregateError: $AggregateError\n});\n","'use strict';\nvar toIndexedObject = require('../internals/to-indexed-object');\nvar addToUnscopables = require('../internals/add-to-unscopables');\nvar Iterators = require('../internals/iterators');\nvar InternalStateModule = require('../internals/internal-state');\nvar defineIterator = require('../internals/define-iterator');\n\nvar ARRAY_ITERATOR = 'Array Iterator';\nvar setInternalState = InternalStateModule.set;\nvar getInternalState = InternalStateModule.getterFor(ARRAY_ITERATOR);\n\n// `Array.prototype.entries` method\n// https://tc39.es/ecma262/#sec-array.prototype.entries\n// `Array.prototype.keys` method\n// https://tc39.es/ecma262/#sec-array.prototype.keys\n// `Array.prototype.values` method\n// https://tc39.es/ecma262/#sec-array.prototype.values\n// `Array.prototype[@@iterator]` method\n// https://tc39.es/ecma262/#sec-array.prototype-@@iterator\n// `CreateArrayIterator` internal method\n// https://tc39.es/ecma262/#sec-createarrayiterator\nmodule.exports = defineIterator(Array, 'Array', function (iterated, kind) {\n  setInternalState(this, {\n    type: ARRAY_ITERATOR,\n    target: toIndexedObject(iterated), // target\n    index: 0,                          // next index\n    kind: kind                         // kind\n  });\n// `%ArrayIteratorPrototype%.next` method\n// https://tc39.es/ecma262/#sec-%arrayiteratorprototype%.next\n}, function () {\n  var state = getInternalState(this);\n  var target = state.target;\n  var kind = state.kind;\n  var index = state.index++;\n  if (!target || index >= target.length) {\n    state.target = undefined;\n    return { value: undefined, done: true };\n  }\n  if (kind == 'keys') return { value: index, done: false };\n  if (kind == 'values') return { value: target[index], done: false };\n  return { value: [index, target[index]], done: false };\n}, 'values');\n\n// argumentsList[@@iterator] is %ArrayProto_values%\n// https://tc39.es/ecma262/#sec-createunmappedargumentsobject\n// https://tc39.es/ecma262/#sec-createmappedargumentsobject\nIterators.Arguments = Iterators.Array;\n\n// https://tc39.es/ecma262/#sec-array.prototype-@@unscopables\naddToUnscopables('keys');\naddToUnscopables('values');\naddToUnscopables('entries');\n","// empty\n","'use strict';\nvar $ = require('../internals/export');\nvar aFunction = require('../internals/a-function');\nvar newPromiseCapabilityModule = require('../internals/new-promise-capability');\nvar perform = require('../internals/perform');\nvar iterate = require('../internals/iterate');\n\n// `Promise.allSettled` method\n// https://tc39.es/ecma262/#sec-promise.allsettled\n$({ target: 'Promise', stat: true }, {\n  allSettled: function allSettled(iterable) {\n    var C = this;\n    var capability = newPromiseCapabilityModule.f(C);\n    var resolve = capability.resolve;\n    var reject = capability.reject;\n    var result = perform(function () {\n      var promiseResolve = aFunction(C.resolve);\n      var values = [];\n      var counter = 0;\n      var remaining = 1;\n      iterate(iterable, function (promise) {\n        var index = counter++;\n        var alreadyCalled = false;\n        values.push(undefined);\n        remaining++;\n        promiseResolve.call(C, promise).then(function (value) {\n          if (alreadyCalled) return;\n          alreadyCalled = true;\n          values[index] = { status: 'fulfilled', value: value };\n          --remaining || resolve(values);\n        }, function (error) {\n          if (alreadyCalled) return;\n          alreadyCalled = true;\n          values[index] = { status: 'rejected', reason: error };\n          --remaining || resolve(values);\n        });\n      });\n      --remaining || resolve(values);\n    });\n    if (result.error) reject(result.value);\n    return capability.promise;\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar aFunction = require('../internals/a-function');\nvar getBuiltIn = require('../internals/get-built-in');\nvar newPromiseCapabilityModule = require('../internals/new-promise-capability');\nvar perform = require('../internals/perform');\nvar iterate = require('../internals/iterate');\n\nvar PROMISE_ANY_ERROR = 'No one promise resolved';\n\n// `Promise.any` method\n// https://tc39.es/ecma262/#sec-promise.any\n$({ target: 'Promise', stat: true }, {\n  any: function any(iterable) {\n    var C = this;\n    var capability = newPromiseCapabilityModule.f(C);\n    var resolve = capability.resolve;\n    var reject = capability.reject;\n    var result = perform(function () {\n      var promiseResolve = aFunction(C.resolve);\n      var errors = [];\n      var counter = 0;\n      var remaining = 1;\n      var alreadyResolved = false;\n      iterate(iterable, function (promise) {\n        var index = counter++;\n        var alreadyRejected = false;\n        errors.push(undefined);\n        remaining++;\n        promiseResolve.call(C, promise).then(function (value) {\n          if (alreadyRejected || alreadyResolved) return;\n          alreadyResolved = true;\n          resolve(value);\n        }, function (error) {\n          if (alreadyRejected || alreadyResolved) return;\n          alreadyRejected = true;\n          errors[index] = error;\n          --remaining || reject(new (getBuiltIn('AggregateError'))(errors, PROMISE_ANY_ERROR));\n        });\n      });\n      --remaining || reject(new (getBuiltIn('AggregateError'))(errors, PROMISE_ANY_ERROR));\n    });\n    if (result.error) reject(result.value);\n    return capability.promise;\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar IS_PURE = require('../internals/is-pure');\nvar NativePromise = require('../internals/native-promise-constructor');\nvar fails = require('../internals/fails');\nvar getBuiltIn = require('../internals/get-built-in');\nvar speciesConstructor = require('../internals/species-constructor');\nvar promiseResolve = require('../internals/promise-resolve');\nvar redefine = require('../internals/redefine');\n\n// Safari bug https://bugs.webkit.org/show_bug.cgi?id=200829\nvar NON_GENERIC = !!NativePromise && fails(function () {\n  NativePromise.prototype['finally'].call({ then: function () { /* empty */ } }, function () { /* empty */ });\n});\n\n// `Promise.prototype.finally` method\n// https://tc39.es/ecma262/#sec-promise.prototype.finally\n$({ target: 'Promise', proto: true, real: true, forced: NON_GENERIC }, {\n  'finally': function (onFinally) {\n    var C = speciesConstructor(this, getBuiltIn('Promise'));\n    var isFunction = typeof onFinally == 'function';\n    return this.then(\n      isFunction ? function (x) {\n        return promiseResolve(C, onFinally()).then(function () { return x; });\n      } : onFinally,\n      isFunction ? function (e) {\n        return promiseResolve(C, onFinally()).then(function () { throw e; });\n      } : onFinally\n    );\n  }\n});\n\n// makes sure that native promise-based APIs `Promise#finally` properly works with patched `Promise#then`\nif (!IS_PURE && typeof NativePromise == 'function') {\n  var method = getBuiltIn('Promise').prototype['finally'];\n  if (NativePromise.prototype['finally'] !== method) {\n    redefine(NativePromise.prototype, 'finally', method, { unsafe: true });\n  }\n}\n","'use strict';\nvar $ = require('../internals/export');\nvar IS_PURE = require('../internals/is-pure');\nvar global = require('../internals/global');\nvar getBuiltIn = require('../internals/get-built-in');\nvar NativePromise = require('../internals/native-promise-constructor');\nvar redefine = require('../internals/redefine');\nvar redefineAll = require('../internals/redefine-all');\nvar setPrototypeOf = require('../internals/object-set-prototype-of');\nvar setToStringTag = require('../internals/set-to-string-tag');\nvar setSpecies = require('../internals/set-species');\nvar isObject = require('../internals/is-object');\nvar aFunction = require('../internals/a-function');\nvar anInstance = require('../internals/an-instance');\nvar inspectSource = require('../internals/inspect-source');\nvar iterate = require('../internals/iterate');\nvar checkCorrectnessOfIteration = require('../internals/check-correctness-of-iteration');\nvar speciesConstructor = require('../internals/species-constructor');\nvar task = require('../internals/task').set;\nvar microtask = require('../internals/microtask');\nvar promiseResolve = require('../internals/promise-resolve');\nvar hostReportErrors = require('../internals/host-report-errors');\nvar newPromiseCapabilityModule = require('../internals/new-promise-capability');\nvar perform = require('../internals/perform');\nvar InternalStateModule = require('../internals/internal-state');\nvar isForced = require('../internals/is-forced');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\nvar IS_BROWSER = require('../internals/engine-is-browser');\nvar IS_NODE = require('../internals/engine-is-node');\nvar V8_VERSION = require('../internals/engine-v8-version');\n\nvar SPECIES = wellKnownSymbol('species');\nvar PROMISE = 'Promise';\nvar getInternalState = InternalStateModule.get;\nvar setInternalState = InternalStateModule.set;\nvar getInternalPromiseState = InternalStateModule.getterFor(PROMISE);\nvar NativePromisePrototype = NativePromise && NativePromise.prototype;\nvar PromiseConstructor = NativePromise;\nvar PromiseConstructorPrototype = NativePromisePrototype;\nvar TypeError = global.TypeError;\nvar document = global.document;\nvar process = global.process;\nvar newPromiseCapability = newPromiseCapabilityModule.f;\nvar newGenericPromiseCapability = newPromiseCapability;\nvar DISPATCH_EVENT = !!(document && document.createEvent && global.dispatchEvent);\nvar NATIVE_REJECTION_EVENT = typeof PromiseRejectionEvent == 'function';\nvar UNHANDLED_REJECTION = 'unhandledrejection';\nvar REJECTION_HANDLED = 'rejectionhandled';\nvar PENDING = 0;\nvar FULFILLED = 1;\nvar REJECTED = 2;\nvar HANDLED = 1;\nvar UNHANDLED = 2;\nvar SUBCLASSING = false;\nvar Internal, OwnPromiseCapability, PromiseWrapper, nativeThen;\n\nvar FORCED = isForced(PROMISE, function () {\n  var GLOBAL_CORE_JS_PROMISE = inspectSource(PromiseConstructor) !== String(PromiseConstructor);\n  // V8 6.6 (Node 10 and Chrome 66) have a bug with resolving custom thenables\n  // https://bugs.chromium.org/p/chromium/issues/detail?id=830565\n  // We can't detect it synchronously, so just check versions\n  if (!GLOBAL_CORE_JS_PROMISE && V8_VERSION === 66) return true;\n  // We need Promise#finally in the pure version for preventing prototype pollution\n  if (IS_PURE && !PromiseConstructorPrototype['finally']) return true;\n  // We can't use @@species feature detection in V8 since it causes\n  // deoptimization and performance degradation\n  // https://github.com/zloirock/core-js/issues/679\n  if (V8_VERSION >= 51 && /native code/.test(PromiseConstructor)) return false;\n  // Detect correctness of subclassing with @@species support\n  var promise = new PromiseConstructor(function (resolve) { resolve(1); });\n  var FakePromise = function (exec) {\n    exec(function () { /* empty */ }, function () { /* empty */ });\n  };\n  var constructor = promise.constructor = {};\n  constructor[SPECIES] = FakePromise;\n  SUBCLASSING = promise.then(function () { /* empty */ }) instanceof FakePromise;\n  if (!SUBCLASSING) return true;\n  // Unhandled rejections tracking support, NodeJS Promise without it fails @@species test\n  return !GLOBAL_CORE_JS_PROMISE && IS_BROWSER && !NATIVE_REJECTION_EVENT;\n});\n\nvar INCORRECT_ITERATION = FORCED || !checkCorrectnessOfIteration(function (iterable) {\n  PromiseConstructor.all(iterable)['catch'](function () { /* empty */ });\n});\n\n// helpers\nvar isThenable = function (it) {\n  var then;\n  return isObject(it) && typeof (then = it.then) == 'function' ? then : false;\n};\n\nvar notify = function (state, isReject) {\n  if (state.notified) return;\n  state.notified = true;\n  var chain = state.reactions;\n  microtask(function () {\n    var value = state.value;\n    var ok = state.state == FULFILLED;\n    var index = 0;\n    // variable length - can't use forEach\n    while (chain.length > index) {\n      var reaction = chain[index++];\n      var handler = ok ? reaction.ok : reaction.fail;\n      var resolve = reaction.resolve;\n      var reject = reaction.reject;\n      var domain = reaction.domain;\n      var result, then, exited;\n      try {\n        if (handler) {\n          if (!ok) {\n            if (state.rejection === UNHANDLED) onHandleUnhandled(state);\n            state.rejection = HANDLED;\n          }\n          if (handler === true) result = value;\n          else {\n            if (domain) domain.enter();\n            result = handler(value); // can throw\n            if (domain) {\n              domain.exit();\n              exited = true;\n            }\n          }\n          if (result === reaction.promise) {\n            reject(TypeError('Promise-chain cycle'));\n          } else if (then = isThenable(result)) {\n            then.call(result, resolve, reject);\n          } else resolve(result);\n        } else reject(value);\n      } catch (error) {\n        if (domain && !exited) domain.exit();\n        reject(error);\n      }\n    }\n    state.reactions = [];\n    state.notified = false;\n    if (isReject && !state.rejection) onUnhandled(state);\n  });\n};\n\nvar dispatchEvent = function (name, promise, reason) {\n  var event, handler;\n  if (DISPATCH_EVENT) {\n    event = document.createEvent('Event');\n    event.promise = promise;\n    event.reason = reason;\n    event.initEvent(name, false, true);\n    global.dispatchEvent(event);\n  } else event = { promise: promise, reason: reason };\n  if (!NATIVE_REJECTION_EVENT && (handler = global['on' + name])) handler(event);\n  else if (name === UNHANDLED_REJECTION) hostReportErrors('Unhandled promise rejection', reason);\n};\n\nvar onUnhandled = function (state) {\n  task.call(global, function () {\n    var promise = state.facade;\n    var value = state.value;\n    var IS_UNHANDLED = isUnhandled(state);\n    var result;\n    if (IS_UNHANDLED) {\n      result = perform(function () {\n        if (IS_NODE) {\n          process.emit('unhandledRejection', value, promise);\n        } else dispatchEvent(UNHANDLED_REJECTION, promise, value);\n      });\n      // Browsers should not trigger `rejectionHandled` event if it was handled here, NodeJS - should\n      state.rejection = IS_NODE || isUnhandled(state) ? UNHANDLED : HANDLED;\n      if (result.error) throw result.value;\n    }\n  });\n};\n\nvar isUnhandled = function (state) {\n  return state.rejection !== HANDLED && !state.parent;\n};\n\nvar onHandleUnhandled = function (state) {\n  task.call(global, function () {\n    var promise = state.facade;\n    if (IS_NODE) {\n      process.emit('rejectionHandled', promise);\n    } else dispatchEvent(REJECTION_HANDLED, promise, state.value);\n  });\n};\n\nvar bind = function (fn, state, unwrap) {\n  return function (value) {\n    fn(state, value, unwrap);\n  };\n};\n\nvar internalReject = function (state, value, unwrap) {\n  if (state.done) return;\n  state.done = true;\n  if (unwrap) state = unwrap;\n  state.value = value;\n  state.state = REJECTED;\n  notify(state, true);\n};\n\nvar internalResolve = function (state, value, unwrap) {\n  if (state.done) return;\n  state.done = true;\n  if (unwrap) state = unwrap;\n  try {\n    if (state.facade === value) throw TypeError(\"Promise can't be resolved itself\");\n    var then = isThenable(value);\n    if (then) {\n      microtask(function () {\n        var wrapper = { done: false };\n        try {\n          then.call(value,\n            bind(internalResolve, wrapper, state),\n            bind(internalReject, wrapper, state)\n          );\n        } catch (error) {\n          internalReject(wrapper, error, state);\n        }\n      });\n    } else {\n      state.value = value;\n      state.state = FULFILLED;\n      notify(state, false);\n    }\n  } catch (error) {\n    internalReject({ done: false }, error, state);\n  }\n};\n\n// constructor polyfill\nif (FORCED) {\n  // 25.4.3.1 Promise(executor)\n  PromiseConstructor = function Promise(executor) {\n    anInstance(this, PromiseConstructor, PROMISE);\n    aFunction(executor);\n    Internal.call(this);\n    var state = getInternalState(this);\n    try {\n      executor(bind(internalResolve, state), bind(internalReject, state));\n    } catch (error) {\n      internalReject(state, error);\n    }\n  };\n  PromiseConstructorPrototype = PromiseConstructor.prototype;\n  // eslint-disable-next-line no-unused-vars -- required for `.length`\n  Internal = function Promise(executor) {\n    setInternalState(this, {\n      type: PROMISE,\n      done: false,\n      notified: false,\n      parent: false,\n      reactions: [],\n      rejection: false,\n      state: PENDING,\n      value: undefined\n    });\n  };\n  Internal.prototype = redefineAll(PromiseConstructorPrototype, {\n    // `Promise.prototype.then` method\n    // https://tc39.es/ecma262/#sec-promise.prototype.then\n    then: function then(onFulfilled, onRejected) {\n      var state = getInternalPromiseState(this);\n      var reaction = newPromiseCapability(speciesConstructor(this, PromiseConstructor));\n      reaction.ok = typeof onFulfilled == 'function' ? onFulfilled : true;\n      reaction.fail = typeof onRejected == 'function' && onRejected;\n      reaction.domain = IS_NODE ? process.domain : undefined;\n      state.parent = true;\n      state.reactions.push(reaction);\n      if (state.state != PENDING) notify(state, false);\n      return reaction.promise;\n    },\n    // `Promise.prototype.catch` method\n    // https://tc39.es/ecma262/#sec-promise.prototype.catch\n    'catch': function (onRejected) {\n      return this.then(undefined, onRejected);\n    }\n  });\n  OwnPromiseCapability = function () {\n    var promise = new Internal();\n    var state = getInternalState(promise);\n    this.promise = promise;\n    this.resolve = bind(internalResolve, state);\n    this.reject = bind(internalReject, state);\n  };\n  newPromiseCapabilityModule.f = newPromiseCapability = function (C) {\n    return C === PromiseConstructor || C === PromiseWrapper\n      ? new OwnPromiseCapability(C)\n      : newGenericPromiseCapability(C);\n  };\n\n  if (!IS_PURE && typeof NativePromise == 'function' && NativePromisePrototype !== Object.prototype) {\n    nativeThen = NativePromisePrototype.then;\n\n    if (!SUBCLASSING) {\n      // make `Promise#then` return a polyfilled `Promise` for native promise-based APIs\n      redefine(NativePromisePrototype, 'then', function then(onFulfilled, onRejected) {\n        var that = this;\n        return new PromiseConstructor(function (resolve, reject) {\n          nativeThen.call(that, resolve, reject);\n        }).then(onFulfilled, onRejected);\n      // https://github.com/zloirock/core-js/issues/640\n      }, { unsafe: true });\n\n      // makes sure that native promise-based APIs `Promise#catch` properly works with patched `Promise#then`\n      redefine(NativePromisePrototype, 'catch', PromiseConstructorPrototype['catch'], { unsafe: true });\n    }\n\n    // make `.constructor === Promise` work for native promise-based APIs\n    try {\n      delete NativePromisePrototype.constructor;\n    } catch (error) { /* empty */ }\n\n    // make `instanceof Promise` work for native promise-based APIs\n    if (setPrototypeOf) {\n      setPrototypeOf(NativePromisePrototype, PromiseConstructorPrototype);\n    }\n  }\n}\n\n$({ global: true, wrap: true, forced: FORCED }, {\n  Promise: PromiseConstructor\n});\n\nsetToStringTag(PromiseConstructor, PROMISE, false, true);\nsetSpecies(PROMISE);\n\nPromiseWrapper = getBuiltIn(PROMISE);\n\n// statics\n$({ target: PROMISE, stat: true, forced: FORCED }, {\n  // `Promise.reject` method\n  // https://tc39.es/ecma262/#sec-promise.reject\n  reject: function reject(r) {\n    var capability = newPromiseCapability(this);\n    capability.reject.call(undefined, r);\n    return capability.promise;\n  }\n});\n\n$({ target: PROMISE, stat: true, forced: IS_PURE || FORCED }, {\n  // `Promise.resolve` method\n  // https://tc39.es/ecma262/#sec-promise.resolve\n  resolve: function resolve(x) {\n    return promiseResolve(IS_PURE && this === PromiseWrapper ? PromiseConstructor : this, x);\n  }\n});\n\n$({ target: PROMISE, stat: true, forced: INCORRECT_ITERATION }, {\n  // `Promise.all` method\n  // https://tc39.es/ecma262/#sec-promise.all\n  all: function all(iterable) {\n    var C = this;\n    var capability = newPromiseCapability(C);\n    var resolve = capability.resolve;\n    var reject = capability.reject;\n    var result = perform(function () {\n      var $promiseResolve = aFunction(C.resolve);\n      var values = [];\n      var counter = 0;\n      var remaining = 1;\n      iterate(iterable, function (promise) {\n        var index = counter++;\n        var alreadyCalled = false;\n        values.push(undefined);\n        remaining++;\n        $promiseResolve.call(C, promise).then(function (value) {\n          if (alreadyCalled) return;\n          alreadyCalled = true;\n          values[index] = value;\n          --remaining || resolve(values);\n        }, reject);\n      });\n      --remaining || resolve(values);\n    });\n    if (result.error) reject(result.value);\n    return capability.promise;\n  },\n  // `Promise.race` method\n  // https://tc39.es/ecma262/#sec-promise.race\n  race: function race(iterable) {\n    var C = this;\n    var capability = newPromiseCapability(C);\n    var reject = capability.reject;\n    var result = perform(function () {\n      var $promiseResolve = aFunction(C.resolve);\n      iterate(iterable, function (promise) {\n        $promiseResolve.call(C, promise).then(capability.resolve, reject);\n      });\n    });\n    if (result.error) reject(result.value);\n    return capability.promise;\n  }\n});\n","'use strict';\nvar charAt = require('../internals/string-multibyte').charAt;\nvar InternalStateModule = require('../internals/internal-state');\nvar defineIterator = require('../internals/define-iterator');\n\nvar STRING_ITERATOR = 'String Iterator';\nvar setInternalState = InternalStateModule.set;\nvar getInternalState = InternalStateModule.getterFor(STRING_ITERATOR);\n\n// `String.prototype[@@iterator]` method\n// https://tc39.es/ecma262/#sec-string.prototype-@@iterator\ndefineIterator(String, 'String', function (iterated) {\n  setInternalState(this, {\n    type: STRING_ITERATOR,\n    string: String(iterated),\n    index: 0\n  });\n// `%StringIteratorPrototype%.next` method\n// https://tc39.es/ecma262/#sec-%stringiteratorprototype%.next\n}, function next() {\n  var state = getInternalState(this);\n  var string = state.string;\n  var index = state.index;\n  var point;\n  if (index >= string.length) return { value: undefined, done: true };\n  point = charAt(string, index);\n  state.index += point.length;\n  return { value: point, done: false };\n});\n","// TODO: Remove from `core-js@4`\nrequire('./es.aggregate-error');\n","// TODO: Remove from `core-js@4`\nrequire('./es.promise.all-settled.js');\n","// TODO: Remove from `core-js@4`\nrequire('./es.promise.any');\n","'use strict';\nvar $ = require('../internals/export');\nvar newPromiseCapabilityModule = require('../internals/new-promise-capability');\nvar perform = require('../internals/perform');\n\n// `Promise.try` method\n// https://github.com/tc39/proposal-promise-try\n$({ target: 'Promise', stat: true }, {\n  'try': function (callbackfn) {\n    var promiseCapability = newPromiseCapabilityModule.f(this);\n    var result = perform(callbackfn);\n    (result.error ? promiseCapability.reject : promiseCapability.resolve)(result.value);\n    return promiseCapability.promise;\n  }\n});\n","require('./es.array.iterator');\nvar DOMIterables = require('../internals/dom-iterables');\nvar global = require('../internals/global');\nvar classof = require('../internals/classof');\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\nvar Iterators = require('../internals/iterators');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar TO_STRING_TAG = wellKnownSymbol('toStringTag');\n\nfor (var COLLECTION_NAME in DOMIterables) {\n  var Collection = global[COLLECTION_NAME];\n  var CollectionPrototype = Collection && Collection.prototype;\n  if (CollectionPrototype && classof(CollectionPrototype) !== TO_STRING_TAG) {\n    createNonEnumerableProperty(CollectionPrototype, TO_STRING_TAG, COLLECTION_NAME);\n  }\n  Iterators[COLLECTION_NAME] = Iterators.Array;\n}\n","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function(\"return this\")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n","// extracted by mini-css-extract-plugin","import '@/polyfill';\r\nimport ImageEditor from '@/imageEditor';\r\nimport '@css/index.styl';\r\n\r\n// commands\r\nimport '@/command/addIcon';\r\nimport '@/command/addImageObject';\r\nimport '@/command/addObject';\r\nimport '@/command/addShape';\r\nimport '@/command/addText';\r\nimport '@/command/applyFilter';\r\nimport '@/command/changeIconColor';\r\nimport '@/command/changeShape';\r\nimport '@/command/changeText';\r\nimport '@/command/changeTextStyle';\r\nimport '@/command/clearObjects';\r\nimport '@/command/flip';\r\nimport '@/command/loadImage';\r\nimport '@/command/loadJson';\r\nimport '@/command/removeFilter';\r\nimport '@/command/removeObject';\r\nimport '@/command/resizeCanvasDimension';\r\nimport '@/command/rotate';\r\nimport '@/command/setObjectProperties';\r\nimport '@/command/setObjectPosition';\r\nimport '@/command/changeSelection';\r\nimport '@/command/resize';\r\n\r\nmodule.exports = ImageEditor;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Add an icon\r\n */\r\nimport commandFactory from '@/factory/command';\r\nimport { Promise } from '@/util';\r\nimport { componentNames, commandNames } from '@/consts';\r\n\r\nconst { ICON } = componentNames;\r\n\r\nconst command = {\r\n  name: commandNames.ADD_ICON,\r\n\r\n  /**\r\n   * Add an icon\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @param {string} type - Icon type ('arrow', 'cancel', custom icon name)\r\n   * @param {Object} options - Icon options\r\n   *      @param {string} [options.fill] - Icon foreground color\r\n   *      @param {string} [options.left] - Icon x position\r\n   *      @param {string} [options.top] - Icon y position\r\n   * @returns {Promise}\r\n   */\r\n  execute(graphics, type, options) {\r\n    const iconComp = graphics.getComponent(ICON);\r\n\r\n    return iconComp.add(type, options).then((objectProps) => {\r\n      this.undoData.object = graphics.getObject(objectProps.objId);\r\n\r\n      return objectProps;\r\n    });\r\n  },\r\n\r\n  /**\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @returns {Promise}\r\n   */\r\n  undo(graphics) {\r\n    graphics.remove(this.undoData.object);\r\n\r\n    return Promise.resolve();\r\n  },\r\n};\r\n\r\ncommandFactory.register(command);\r\n\r\nexport default command;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Add an image object\r\n */\r\nimport commandFactory from '@/factory/command';\r\nimport { Promise } from '@/util';\r\nimport { commandNames } from '@/consts';\r\n\r\nconst command = {\r\n  name: commandNames.ADD_IMAGE_OBJECT,\r\n\r\n  /**\r\n   * Add an image object\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @param {string} imgUrl - Image url to make object\r\n   * @returns {Promise}\r\n   */\r\n  execute(graphics, imgUrl) {\r\n    return graphics.addImageObject(imgUrl).then((objectProps) => {\r\n      this.undoData.object = graphics.getObject(objectProps.objId);\r\n\r\n      return objectProps;\r\n    });\r\n  },\r\n\r\n  /**\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @returns {Promise}\r\n   */\r\n  undo(graphics) {\r\n    graphics.remove(this.undoData.object);\r\n\r\n    return Promise.resolve();\r\n  },\r\n};\r\n\r\ncommandFactory.register(command);\r\n\r\nexport default command;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Add an object\r\n */\r\nimport commandFactory from '@/factory/command';\r\nimport { Promise } from '@/util';\r\nimport { commandNames, rejectMessages } from '@/consts';\r\n\r\nconst command = {\r\n  name: commandNames.ADD_OBJECT,\r\n\r\n  /**\r\n   * Add an object\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @param {Object} object - Fabric object\r\n   * @returns {Promise}\r\n   */\r\n  execute(graphics, object) {\r\n    return new Promise((resolve, reject) => {\r\n      if (!graphics.contains(object)) {\r\n        graphics.add(object);\r\n        resolve(object);\r\n      } else {\r\n        reject(rejectMessages.addedObject);\r\n      }\r\n    });\r\n  },\r\n\r\n  /**\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @param {Object} object - Fabric object\r\n   * @returns {Promise}\r\n   */\r\n  undo(graphics, object) {\r\n    return new Promise((resolve, reject) => {\r\n      if (graphics.contains(object)) {\r\n        graphics.remove(object);\r\n        resolve(object);\r\n      } else {\r\n        reject(rejectMessages.noObject);\r\n      }\r\n    });\r\n  },\r\n};\r\n\r\ncommandFactory.register(command);\r\n\r\nexport default command;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Add a shape\r\n */\r\nimport commandFactory from '@/factory/command';\r\nimport { Promise } from '@/util';\r\nimport { componentNames, commandNames } from '@/consts';\r\n\r\nconst { SHAPE } = componentNames;\r\n\r\nconst command = {\r\n  name: commandNames.ADD_SHAPE,\r\n\r\n  /**\r\n   * Add a shape\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @param {string} type - Shape type (ex: 'rect', 'circle', 'triangle')\r\n   * @param {Object} options - Shape options\r\n   *      @param {string} [options.fill] - Shape foreground color (ex: '#fff', 'transparent')\r\n   *      @param {string} [options.stroke] - Shape outline color\r\n   *      @param {number} [options.strokeWidth] - Shape outline width\r\n   *      @param {number} [options.width] - Width value (When type option is 'rect', this options can use)\r\n   *      @param {number} [options.height] - Height value (When type option is 'rect', this options can use)\r\n   *      @param {number} [options.rx] - Radius x value (When type option is 'circle', this options can use)\r\n   *      @param {number} [options.ry] - Radius y value (When type option is 'circle', this options can use)\r\n   *      @param {number} [options.left] - Shape x position\r\n   *      @param {number} [options.top] - Shape y position\r\n   *      @param {number} [options.isRegular] - Whether resizing shape has 1:1 ratio or not\r\n   * @returns {Promise}\r\n   */\r\n  execute(graphics, type, options) {\r\n    const shapeComp = graphics.getComponent(SHAPE);\r\n\r\n    return shapeComp.add(type, options).then((objectProps) => {\r\n      const { objId } = objectProps;\r\n\r\n      this.undoData.object = graphics.getObject(objId);\r\n\r\n      return objectProps;\r\n    });\r\n  },\r\n\r\n  /**\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @returns {Promise}\r\n   */\r\n  undo(graphics) {\r\n    graphics.remove(this.undoData.object);\r\n\r\n    return Promise.resolve();\r\n  },\r\n};\r\n\r\ncommandFactory.register(command);\r\n\r\nexport default command;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Add a text object\r\n */\r\nimport commandFactory from '@/factory/command';\r\nimport { Promise } from '@/util';\r\nimport { componentNames, commandNames, rejectMessages } from '@/consts';\r\nimport {\r\n  setCachedUndoDataForDimension,\r\n  makeSelectionUndoData,\r\n  makeSelectionUndoDatum,\r\n} from '@/helper/selectionModifyHelper';\r\n\r\nconst { TEXT } = componentNames;\r\n\r\nconst command = {\r\n  name: commandNames.ADD_TEXT,\r\n\r\n  /**\r\n   * Add a text object\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @param {string} text - Initial input text\r\n   * @param {Object} [options] Options for text styles\r\n   *     @param {Object} [options.styles] Initial styles\r\n   *         @param {string} [options.styles.fill] Color\r\n   *         @param {string} [options.styles.fontFamily] Font type for text\r\n   *         @param {number} [options.styles.fontSize] Size\r\n   *         @param {string} [options.styles.fontStyle] Type of inclination (normal / italic)\r\n   *         @param {string} [options.styles.fontWeight] Type of thicker or thinner looking (normal / bold)\r\n   *         @param {string} [options.styles.textAlign] Type of text align (left / center / right)\r\n   *         @param {string} [options.styles.textDecoration] Type of line (underline / line-through / overline)\r\n   *     @param {{x: number, y: number}} [options.position] - Initial position\r\n   * @returns {Promise}\r\n   */\r\n  execute(graphics, text, options) {\r\n    const textComp = graphics.getComponent(TEXT);\r\n\r\n    if (this.undoData.object) {\r\n      const undoObject = this.undoData.object;\r\n\r\n      return new Promise((resolve, reject) => {\r\n        if (!graphics.contains(undoObject)) {\r\n          graphics.add(undoObject);\r\n          resolve(undoObject);\r\n        } else {\r\n          reject(rejectMessages.redo);\r\n        }\r\n      });\r\n    }\r\n\r\n    return textComp.add(text, options).then((objectProps) => {\r\n      const { objId } = objectProps;\r\n      const textObject = graphics.getObject(objId);\r\n\r\n      this.undoData.object = textObject;\r\n\r\n      setCachedUndoDataForDimension(\r\n        makeSelectionUndoData(textObject, () => makeSelectionUndoDatum(objId, textObject, false))\r\n      );\r\n\r\n      return objectProps;\r\n    });\r\n  },\r\n\r\n  /**\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @returns {Promise}\r\n   */\r\n  undo(graphics) {\r\n    graphics.remove(this.undoData.object);\r\n\r\n    return Promise.resolve();\r\n  },\r\n};\r\n\r\ncommandFactory.register(command);\r\n\r\nexport default command;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Apply a filter into an image\r\n */\r\nimport snippet from 'tui-code-snippet';\r\nimport commandFactory from '@/factory/command';\r\nimport { componentNames, rejectMessages, commandNames } from '@/consts';\r\n\r\nconst { FILTER } = componentNames;\r\n\r\n/**\r\n * Cached data for undo\r\n * @type {Object}\r\n */\r\nlet cachedUndoDataForSilent = null;\r\n\r\n/**\r\n * Make undoData\r\n * @param {string} type - Filter type\r\n * @param {Object} prevfilterOption - prev Filter options\r\n * @param {Object} options - Filter options\r\n * @returns {object} - undo data\r\n */\r\nfunction makeUndoData(type, prevfilterOption, options) {\r\n  const undoData = {};\r\n\r\n  if (type === 'mask') {\r\n    undoData.object = options.mask;\r\n  }\r\n\r\n  undoData.options = prevfilterOption;\r\n\r\n  return undoData;\r\n}\r\n\r\nconst command = {\r\n  name: commandNames.APPLY_FILTER,\r\n\r\n  /**\r\n   * Apply a filter into an image\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @param {string} type - Filter type\r\n   * @param {Object} options - Filter options\r\n   *  @param {number} options.maskObjId - masking image object id\r\n   * @param {boolean} isSilent - is silent execution or not\r\n   * @returns {Promise}\r\n   */\r\n  execute(graphics, type, options, isSilent) {\r\n    const filterComp = graphics.getComponent(FILTER);\r\n\r\n    if (type === 'mask') {\r\n      const maskObj = graphics.getObject(options.maskObjId);\r\n\r\n      if (!(maskObj && maskObj.isType('image'))) {\r\n        return Promise.reject(rejectMessages.invalidParameters);\r\n      }\r\n\r\n      snippet.extend(options, { mask: maskObj });\r\n      graphics.remove(options.mask);\r\n    }\r\n    if (!this.isRedo) {\r\n      const prevfilterOption = filterComp.getOptions(type);\r\n      const undoData = makeUndoData(type, prevfilterOption, options);\r\n\r\n      cachedUndoDataForSilent = this.setUndoData(undoData, cachedUndoDataForSilent, isSilent);\r\n    }\r\n\r\n    return filterComp.add(type, options);\r\n  },\r\n\r\n  /**\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @param {string} type - Filter type\r\n   * @returns {Promise}\r\n   */\r\n  undo(graphics, type) {\r\n    const filterComp = graphics.getComponent(FILTER);\r\n\r\n    if (type === 'mask') {\r\n      const mask = this.undoData.object;\r\n      graphics.add(mask);\r\n      graphics.setActiveObject(mask);\r\n\r\n      return filterComp.remove(type);\r\n    }\r\n\r\n    // options changed case\r\n    if (this.undoData.options) {\r\n      return filterComp.add(type, this.undoData.options);\r\n    }\r\n\r\n    // filter added case\r\n    return filterComp.remove(type);\r\n  },\r\n};\r\n\r\ncommandFactory.register(command);\r\n\r\nexport default command;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Change icon color\r\n */\r\nimport commandFactory from '@/factory/command';\r\nimport { Promise } from '@/util';\r\nimport { componentNames, rejectMessages, commandNames } from '@/consts';\r\n\r\nconst { ICON } = componentNames;\r\n\r\nconst command = {\r\n  name: commandNames.CHANGE_ICON_COLOR,\r\n\r\n  /**\r\n   * Change icon color\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @param {number} objId -  object id\r\n   * @param {string} color - Color for icon\r\n   * @returns {Promise}\r\n   */\r\n  execute(graphics, objId, color) {\r\n    return new Promise((resolve, reject) => {\r\n      const iconComp = graphics.getComponent(ICON);\r\n      const targetObj = graphics.getObject(objId);\r\n\r\n      if (!targetObj) {\r\n        reject(rejectMessages.noObject);\r\n      }\r\n\r\n      this.undoData.object = targetObj;\r\n      this.undoData.color = iconComp.getColor(targetObj);\r\n      iconComp.setColor(color, targetObj);\r\n      resolve();\r\n    });\r\n  },\r\n\r\n  /**\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @returns {Promise}\r\n   */\r\n  undo(graphics) {\r\n    const iconComp = graphics.getComponent(ICON);\r\n    const { object: icon, color } = this.undoData;\r\n\r\n    iconComp.setColor(color, icon);\r\n\r\n    return Promise.resolve();\r\n  },\r\n};\r\n\r\ncommandFactory.register(command);\r\n\r\nexport default command;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview change selection\r\n */\r\nimport commandFactory from '@/factory/command';\r\nimport { Promise } from '@/util';\r\nimport { commandNames } from '@/consts';\r\nimport { getCachedUndoDataForDimension } from '@/helper/selectionModifyHelper';\r\n\r\nconst command = {\r\n  name: commandNames.CHANGE_SELECTION,\r\n\r\n  execute(graphics, props) {\r\n    if (this.isRedo) {\r\n      props.forEach((prop) => {\r\n        graphics.setObjectProperties(prop.objId, prop);\r\n      });\r\n    } else {\r\n      this.undoData = getCachedUndoDataForDimension();\r\n    }\r\n\r\n    return Promise.resolve();\r\n  },\r\n\r\n  undo(graphics) {\r\n    this.undoData.forEach((datum) => {\r\n      graphics.setObjectProperties(datum.objId, datum);\r\n    });\r\n\r\n    return Promise.resolve();\r\n  },\r\n};\r\n\r\ncommandFactory.register(command);\r\n\r\nexport default command;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview change a shape\r\n */\r\nimport snippet from 'tui-code-snippet';\r\nimport commandFactory from '@/factory/command';\r\nimport { Promise } from '@/util';\r\nimport { componentNames, rejectMessages, commandNames } from '@/consts';\r\n\r\nconst { SHAPE } = componentNames;\r\n\r\n/**\r\n * Cached data for undo\r\n * @type {Object}\r\n */\r\nlet cachedUndoDataForSilent = null;\r\n\r\n/**\r\n * Make undoData\r\n * @param {object} options - shape options\r\n * @param {Component} targetObj - shape component\r\n * @returns {object} - undo data\r\n */\r\nfunction makeUndoData(options, targetObj) {\r\n  const undoData = {\r\n    object: targetObj,\r\n    options: {},\r\n  };\r\n\r\n  snippet.forEachOwnProperties(options, (value, key) => {\r\n    undoData.options[key] = targetObj[key];\r\n  });\r\n\r\n  return undoData;\r\n}\r\n\r\nconst command = {\r\n  name: commandNames.CHANGE_SHAPE,\r\n\r\n  /**\r\n   * Change a shape\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @param {number} objId -  object id\r\n   * @param {Object} options - Shape options\r\n   *      @param {string} [options.fill] - Shape foreground color (ex: '#fff', 'transparent')\r\n   *      @param {string} [options.stroke] - Shape outline color\r\n   *      @param {number} [options.strokeWidth] - Shape outline width\r\n   *      @param {number} [options.width] - Width value (When type option is 'rect', this options can use)\r\n   *      @param {number} [options.height] - Height value (When type option is 'rect', this options can use)\r\n   *      @param {number} [options.rx] - Radius x value (When type option is 'circle', this options can use)\r\n   *      @param {number} [options.ry] - Radius y value (When type option is 'circle', this options can use)\r\n   *      @param {number} [options.left] - Shape x position\r\n   *      @param {number} [options.top] - Shape y position\r\n   *      @param {number} [options.isRegular] - Whether resizing shape has 1:1 ratio or not\r\n   * @param {boolean} isSilent - is silent execution or not\r\n   * @returns {Promise}\r\n   */\r\n  execute(graphics, objId, options, isSilent) {\r\n    const shapeComp = graphics.getComponent(SHAPE);\r\n    const targetObj = graphics.getObject(objId);\r\n\r\n    if (!targetObj) {\r\n      return Promise.reject(rejectMessages.noObject);\r\n    }\r\n\r\n    if (!this.isRedo) {\r\n      const undoData = makeUndoData(options, targetObj);\r\n\r\n      cachedUndoDataForSilent = this.setUndoData(undoData, cachedUndoDataForSilent, isSilent);\r\n    }\r\n\r\n    return shapeComp.change(targetObj, options);\r\n  },\r\n\r\n  /**\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @returns {Promise}\r\n   */\r\n  undo(graphics) {\r\n    const shapeComp = graphics.getComponent(SHAPE);\r\n    const { object: shape, options } = this.undoData;\r\n\r\n    return shapeComp.change(shape, options);\r\n  },\r\n};\r\n\r\ncommandFactory.register(command);\r\n\r\nexport default command;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Change a text\r\n */\r\nimport commandFactory from '@/factory/command';\r\nimport { Promise } from '@/util';\r\nimport { componentNames, rejectMessages, commandNames } from '@/consts';\r\n\r\nconst { TEXT } = componentNames;\r\n\r\nconst command = {\r\n  name: commandNames.CHANGE_TEXT,\r\n\r\n  /**\r\n   * Change a text\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @param {number} objId -  object id\r\n   * @param {string} text - Changing text\r\n   * @returns {Promise}\r\n   */\r\n  execute(graphics, objId, text) {\r\n    const textComp = graphics.getComponent(TEXT);\r\n    const targetObj = graphics.getObject(objId);\r\n\r\n    if (!targetObj) {\r\n      return Promise.reject(rejectMessages.noObject);\r\n    }\r\n\r\n    this.undoData.object = targetObj;\r\n    this.undoData.text = textComp.getText(targetObj);\r\n\r\n    return textComp.change(targetObj, text);\r\n  },\r\n\r\n  /**\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @returns {Promise}\r\n   */\r\n  undo(graphics) {\r\n    const textComp = graphics.getComponent(TEXT);\r\n    const { object: textObj, text } = this.undoData;\r\n\r\n    return textComp.change(textObj, text);\r\n  },\r\n};\r\n\r\ncommandFactory.register(command);\r\n\r\nexport default command;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Change text styles\r\n */\r\nimport snippet from 'tui-code-snippet';\r\nimport commandFactory from '@/factory/command';\r\nimport { Promise } from '@/util';\r\nimport { componentNames, rejectMessages, commandNames } from '@/consts';\r\n\r\nconst { TEXT } = componentNames;\r\n\r\n/**\r\n * Cached data for undo\r\n * @type {Object}\r\n */\r\nlet cachedUndoDataForSilent = null;\r\n\r\n/**\r\n * Make undoData\r\n * @param {object} styles - text styles\r\n * @param {Component} targetObj - text component\r\n * @returns {object} - undo data\r\n */\r\nfunction makeUndoData(styles, targetObj) {\r\n  const undoData = {\r\n    object: targetObj,\r\n    styles: {},\r\n  };\r\n  snippet.forEachOwnProperties(styles, (value, key) => {\r\n    const undoValue = targetObj[key];\r\n    undoData.styles[key] = undoValue;\r\n  });\r\n\r\n  return undoData;\r\n}\r\n\r\nconst command = {\r\n  name: commandNames.CHANGE_TEXT_STYLE,\r\n\r\n  /**\r\n   * Change text styles\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @param {number} objId -  object id\r\n   * @param {Object} styles - text styles\r\n   *     @param {string} [styles.fill] Color\r\n   *     @param {string} [styles.fontFamily] Font type for text\r\n   *     @param {number} [styles.fontSize] Size\r\n   *     @param {string} [styles.fontStyle] Type of inclination (normal / italic)\r\n   *     @param {string} [styles.fontWeight] Type of thicker or thinner looking (normal / bold)\r\n   *     @param {string} [styles.textAlign] Type of text align (left / center / right)\r\n   *     @param {string} [styles.textDecoration] Type of line (underline / line-through / overline)\r\n   * @param {boolean} isSilent - is silent execution or not\r\n   * @returns {Promise}\r\n   */\r\n  execute(graphics, objId, styles, isSilent) {\r\n    const textComp = graphics.getComponent(TEXT);\r\n    const targetObj = graphics.getObject(objId);\r\n\r\n    if (!targetObj) {\r\n      return Promise.reject(rejectMessages.noObject);\r\n    }\r\n    if (!this.isRedo) {\r\n      const undoData = makeUndoData(styles, targetObj);\r\n\r\n      cachedUndoDataForSilent = this.setUndoData(undoData, cachedUndoDataForSilent, isSilent);\r\n    }\r\n\r\n    return textComp.setStyle(targetObj, styles);\r\n  },\r\n\r\n  /**\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @returns {Promise}\r\n   */\r\n  undo(graphics) {\r\n    const textComp = graphics.getComponent(TEXT);\r\n    const { object: textObj, styles } = this.undoData;\r\n\r\n    return textComp.setStyle(textObj, styles);\r\n  },\r\n};\r\n\r\ncommandFactory.register(command);\r\n\r\nexport default command;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Clear all objects\r\n */\r\nimport commandFactory from '@/factory/command';\r\nimport { Promise } from '@/util';\r\nimport { commandNames } from '@/consts';\r\n\r\nconst command = {\r\n  name: commandNames.CLEAR_OBJECTS,\r\n\r\n  /**\r\n   * Clear all objects without background (main) image\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @returns {Promise}\r\n   */\r\n  execute(graphics) {\r\n    return new Promise((resolve) => {\r\n      this.undoData.objects = graphics.removeAll();\r\n      resolve();\r\n    });\r\n  },\r\n\r\n  /**\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @returns {Promise}\r\n   * @ignore\r\n   */\r\n  undo(graphics) {\r\n    graphics.add(this.undoData.objects);\r\n\r\n    return Promise.resolve();\r\n  },\r\n};\r\n\r\ncommandFactory.register(command);\r\n\r\nexport default command;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Flip an image\r\n */\r\nimport commandFactory from '@/factory/command';\r\nimport { componentNames, commandNames } from '@/consts';\r\n\r\nconst { FLIP } = componentNames;\r\n\r\nconst command = {\r\n  name: commandNames.FLIP_IMAGE,\r\n\r\n  /**\r\n   * flip an image\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @param {string} type - 'flipX' or 'flipY' or 'reset'\r\n   * @returns {Promise}\r\n   */\r\n  execute(graphics, type) {\r\n    const flipComp = graphics.getComponent(FLIP);\r\n\r\n    this.undoData.setting = flipComp.getCurrentSetting();\r\n\r\n    return flipComp[type]();\r\n  },\r\n\r\n  /**\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @returns {Promise}\r\n   */\r\n  undo(graphics) {\r\n    const flipComp = graphics.getComponent(FLIP);\r\n\r\n    return flipComp.set(this.undoData.setting);\r\n  },\r\n};\r\n\r\ncommandFactory.register(command);\r\n\r\nexport default command;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Load a background (main) image\r\n */\r\nimport commandFactory from '@/factory/command';\r\nimport { componentNames, commandNames } from '@/consts';\r\n\r\nconst { IMAGE_LOADER } = componentNames;\r\n\r\nconst command = {\r\n  name: commandNames.LOAD_IMAGE,\r\n\r\n  /**\r\n   * Load a background (main) image\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @param {string} imageName - Image name\r\n   * @param {string} imgUrl - Image Url\r\n   * @returns {Promise}\r\n   */\r\n  execute(graphics, imageName, imgUrl) {\r\n    const loader = graphics.getComponent(IMAGE_LOADER);\r\n    const prevImage = loader.getCanvasImage();\r\n    const prevImageWidth = prevImage ? prevImage.width : 0;\r\n    const prevImageHeight = prevImage ? prevImage.height : 0;\r\n    const objects = graphics.removeAll(true).filter((objectItem) => objectItem.type !== 'cropzone');\r\n\r\n    objects.forEach((objectItem) => {\r\n      objectItem.evented = true;\r\n    });\r\n\r\n    this.undoData = {\r\n      name: loader.getImageName(),\r\n      image: prevImage,\r\n      objects,\r\n    };\r\n\r\n    return loader.load(imageName, imgUrl).then((newImage) => ({\r\n      oldWidth: prevImageWidth,\r\n      oldHeight: prevImageHeight,\r\n      newWidth: newImage.width,\r\n      newHeight: newImage.height,\r\n    }));\r\n  },\r\n\r\n  /**\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @returns {Promise}\r\n   */\r\n  undo(graphics) {\r\n    const loader = graphics.getComponent(IMAGE_LOADER);\r\n    const { objects, name, image } = this.undoData;\r\n\r\n    graphics.removeAll(true);\r\n    graphics.add(objects);\r\n\r\n    return loader.load(name, image);\r\n  },\r\n};\r\n\r\ncommandFactory.register(command);\r\n\r\nexport default command;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Load a background (main) image\r\n */\r\nimport { commandNames, componentNames, fObjectOptions } from '@/consts';\r\nimport commandFactory from '@/factory/command';\r\nimport snippet from 'tui-code-snippet';\r\n\r\nconst { JSON_LOADER, TEXT } = componentNames;\r\n\r\nconst command = {\r\n  name: commandNames.LOAD_JSON,\r\n\r\n  execute(graphics, json) {\r\n    const loader = graphics.getComponent(JSON_LOADER);\r\n    const texComp = graphics.getComponent(TEXT);\r\n\r\n    const objects = graphics.removeAll(true).filter((objectItem) => objectItem.type !== 'cropzone');\r\n\r\n    objects.forEach((objectItem) => {\r\n      objectItem.evented = true;\r\n    });\r\n\r\n    this.undoData.objects = objects;\r\n\r\n    return loader.load(json).then((objs) => {\r\n      objs.map((obj) => {\r\n        let selectionStyle = fObjectOptions.SELECTION_STYLE;\r\n        selectionStyle = snippet.extend({}, selectionStyle, {\r\n          originX: 'left',\r\n          originY: 'top',\r\n        });\r\n        obj.set(selectionStyle);\r\n        if (obj.type === 'i-text') {\r\n          texComp.initialize(obj);\r\n        }\r\n\r\n        graphics._addFabricObject(obj);\r\n\r\n        return obj;\r\n      });\r\n\r\n      return objs;\r\n    });\r\n  },\r\n  /**\r\n   * @returns {Promise}\r\n   */\r\n  undo() {\r\n    return Promise.resolve();\r\n  },\r\n};\r\n\r\ncommandFactory.register(command);\r\n\r\nexport default command;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Remove a filter from an image\r\n */\r\nimport commandFactory from '@/factory/command';\r\nimport { componentNames, commandNames } from '@/consts';\r\n\r\nconst { FILTER } = componentNames;\r\n\r\nconst command = {\r\n  name: commandNames.REMOVE_FILTER,\r\n\r\n  /**\r\n   * Remove a filter from an image\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @param {string} type - Filter type\r\n   * @returns {Promise}\r\n   */\r\n  execute(graphics, type) {\r\n    const filterComp = graphics.getComponent(FILTER);\r\n\r\n    this.undoData.options = filterComp.getOptions(type);\r\n\r\n    return filterComp.remove(type);\r\n  },\r\n\r\n  /**\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @param {string} type - Filter type\r\n   * @returns {Promise}\r\n   */\r\n  undo(graphics, type) {\r\n    const filterComp = graphics.getComponent(FILTER);\r\n    const { options } = this.undoData;\r\n\r\n    return filterComp.add(type, options);\r\n  },\r\n};\r\n\r\ncommandFactory.register(command);\r\n\r\nexport default command;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Remove an object\r\n */\r\nimport commandFactory from '@/factory/command';\r\nimport { Promise } from '@/util';\r\nimport { commandNames, rejectMessages } from '@/consts';\r\n\r\nconst command = {\r\n  name: commandNames.REMOVE_OBJECT,\r\n\r\n  /**\r\n   * Remove an object\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @param {number} objId -  object id\r\n   * @returns {Promise}\r\n   */\r\n  execute(graphics, objId) {\r\n    return new Promise((resolve, reject) => {\r\n      this.undoData.objects = graphics.removeObjectById(objId);\r\n      if (this.undoData.objects.length) {\r\n        resolve();\r\n      } else {\r\n        reject(rejectMessages.noObject);\r\n      }\r\n    });\r\n  },\r\n\r\n  /**\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @returns {Promise}\r\n   */\r\n  undo(graphics) {\r\n    graphics.add(this.undoData.objects);\r\n\r\n    return Promise.resolve();\r\n  },\r\n};\r\n\r\ncommandFactory.register(command);\r\n\r\nexport default command;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Resize an image\r\n */\r\nimport commandFactory from '@/factory/command';\r\nimport { componentNames, commandNames } from '@/consts';\r\n\r\nconst { RESIZE } = componentNames;\r\n\r\nconst command = {\r\n  name: commandNames.RESIZE_IMAGE,\r\n\r\n  /**\r\n   * Resize an image\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @param {object} dimensions - Image Dimensions\r\n   * @returns {Promise}\r\n   */\r\n  execute(graphics, dimensions) {\r\n    const resizeComp = graphics.getComponent(RESIZE);\r\n\r\n    let originalDimensions = resizeComp.getOriginalDimensions();\r\n    if (!originalDimensions) {\r\n      originalDimensions = resizeComp.getCurrentDimensions();\r\n    }\r\n\r\n    this.undoData.dimensions = originalDimensions;\r\n\r\n    return resizeComp.resize(dimensions);\r\n  },\r\n\r\n  /**\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @returns {Promise}\r\n   */\r\n  undo(graphics) {\r\n    const resizeComp = graphics.getComponent(RESIZE);\r\n\r\n    return resizeComp.resize(this.undoData.dimensions);\r\n  },\r\n};\r\n\r\ncommandFactory.register(command);\r\n\r\nexport default command;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Resize a canvas\r\n */\r\nimport commandFactory from '@/factory/command';\r\nimport { Promise } from '@/util';\r\nimport { commandNames } from '@/consts';\r\n\r\nconst command = {\r\n  name: commandNames.RESIZE_CANVAS_DIMENSION,\r\n\r\n  /**\r\n   * resize the canvas with given dimension\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @param {{width: number, height: number}} dimension - Max width & height\r\n   * @returns {Promise}\r\n   */\r\n  execute(graphics, dimension) {\r\n    return new Promise((resolve) => {\r\n      this.undoData.size = {\r\n        width: graphics.cssMaxWidth,\r\n        height: graphics.cssMaxHeight,\r\n      };\r\n\r\n      graphics.setCssMaxDimension(dimension);\r\n      graphics.adjustCanvasDimension();\r\n      resolve();\r\n    });\r\n  },\r\n\r\n  /**\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @returns {Promise}\r\n   */\r\n  undo(graphics) {\r\n    graphics.setCssMaxDimension(this.undoData.size);\r\n    graphics.adjustCanvasDimension();\r\n\r\n    return Promise.resolve();\r\n  },\r\n};\r\n\r\ncommandFactory.register(command);\r\n\r\nexport default command;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Rotate an image\r\n */\r\nimport commandFactory from '@/factory/command';\r\nimport { componentNames, commandNames } from '@/consts';\r\n\r\nconst { ROTATION } = componentNames;\r\n\r\n/**\r\n * Cached data for undo\r\n * @type {Object}\r\n */\r\nlet cachedUndoDataForSilent = null;\r\n\r\n/**\r\n * Make undo data\r\n * @param {Component} rotationComp - rotation component\r\n * @returns {object} - undodata\r\n */\r\nfunction makeUndoData(rotationComp) {\r\n  return {\r\n    angle: rotationComp.getCurrentAngle(),\r\n  };\r\n}\r\n\r\nconst command = {\r\n  name: commandNames.ROTATE_IMAGE,\r\n\r\n  /**\r\n   * Rotate an image\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @param {string} type - 'rotate' or 'setAngle'\r\n   * @param {number} angle - angle value (degree)\r\n   * @param {boolean} isSilent - is silent execution or not\r\n   * @returns {Promise}\r\n   */\r\n  execute(graphics, type, angle, isSilent) {\r\n    const rotationComp = graphics.getComponent(ROTATION);\r\n\r\n    if (!this.isRedo) {\r\n      const undoData = makeUndoData(rotationComp);\r\n\r\n      cachedUndoDataForSilent = this.setUndoData(undoData, cachedUndoDataForSilent, isSilent);\r\n    }\r\n\r\n    return rotationComp[type](angle);\r\n  },\r\n\r\n  /**\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @returns {Promise}\r\n   */\r\n  undo(graphics) {\r\n    const rotationComp = graphics.getComponent(ROTATION);\r\n    const [, type, angle] = this.args;\r\n\r\n    if (type === 'setAngle') {\r\n      return rotationComp[type](this.undoData.angle);\r\n    }\r\n\r\n    return rotationComp.rotate(-angle);\r\n  },\r\n};\r\n\r\ncommandFactory.register(command);\r\n\r\nexport default command;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Set object properties\r\n */\r\nimport commandFactory from '@/factory/command';\r\nimport { Promise } from '@/util';\r\nimport { commandNames, rejectMessages } from '@/consts';\r\n\r\nconst command = {\r\n  name: commandNames.SET_OBJECT_POSITION,\r\n\r\n  /**\r\n   * Set object properties\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @param {number} objId -  object id\r\n   * @param {Object} posInfo - position object\r\n   *  @param {number} posInfo.x - x position\r\n   *  @param {number} posInfo.y - y position\r\n   *  @param {string} posInfo.originX - can be 'left', 'center', 'right'\r\n   *  @param {string} posInfo.originY - can be 'top', 'center', 'bottom'\r\n   * @returns {Promise}\r\n   */\r\n  execute(graphics, objId, posInfo) {\r\n    const targetObj = graphics.getObject(objId);\r\n\r\n    if (!targetObj) {\r\n      return Promise.reject(rejectMessages.noObject);\r\n    }\r\n\r\n    this.undoData.objectId = objId;\r\n    this.undoData.props = graphics.getObjectProperties(objId, ['left', 'top']);\r\n\r\n    graphics.setObjectPosition(objId, posInfo);\r\n    graphics.renderAll();\r\n\r\n    return Promise.resolve();\r\n  },\r\n\r\n  /**\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @returns {Promise}\r\n   */\r\n  undo(graphics) {\r\n    const { objectId, props } = this.undoData;\r\n\r\n    graphics.setObjectProperties(objectId, props);\r\n    graphics.renderAll();\r\n\r\n    return Promise.resolve();\r\n  },\r\n};\r\n\r\ncommandFactory.register(command);\r\n\r\nexport default command;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Set object properties\r\n */\r\nimport snippet from 'tui-code-snippet';\r\nimport commandFactory from '@/factory/command';\r\nimport { Promise } from '@/util';\r\nimport { commandNames, rejectMessages } from '@/consts';\r\n\r\nconst command = {\r\n  name: commandNames.SET_OBJECT_PROPERTIES,\r\n\r\n  /**\r\n   * Set object properties\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @param {number} objId -  object id\r\n   * @param {Object} props - properties\r\n   *     @param {string} [props.fill] Color\r\n   *     @param {string} [props.fontFamily] Font type for text\r\n   *     @param {number} [props.fontSize] Size\r\n   *     @param {string} [props.fontStyle] Type of inclination (normal / italic)\r\n   *     @param {string} [props.fontWeight] Type of thicker or thinner looking (normal / bold)\r\n   *     @param {string} [props.textAlign] Type of text align (left / center / right)\r\n   *     @param {string} [props.textDecoration] Type of line (underline / line-through / overline)\r\n   * @returns {Promise}\r\n   */\r\n  execute(graphics, objId, props) {\r\n    const targetObj = graphics.getObject(objId);\r\n\r\n    if (!targetObj) {\r\n      return Promise.reject(rejectMessages.noObject);\r\n    }\r\n\r\n    this.undoData.props = {};\r\n    snippet.forEachOwnProperties(props, (value, key) => {\r\n      this.undoData.props[key] = targetObj[key];\r\n    });\r\n\r\n    graphics.setObjectProperties(objId, props);\r\n\r\n    return Promise.resolve();\r\n  },\r\n\r\n  /**\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @param {number} objId -  object id\r\n   * @returns {Promise}\r\n   */\r\n  undo(graphics, objId) {\r\n    const { props } = this.undoData;\r\n\r\n    graphics.setObjectProperties(objId, props);\r\n\r\n    return Promise.resolve();\r\n  },\r\n};\r\n\r\ncommandFactory.register(command);\r\n\r\nexport default command;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Image crop module (start cropping, end cropping)\r\n */\r\nimport snippet from 'tui-code-snippet';\r\nimport fabric from 'fabric';\r\nimport Component from '@/interface/component';\r\nimport Cropzone from '@/extension/cropzone';\r\nimport { keyCodes, componentNames, CROPZONE_DEFAULT_OPTIONS } from '@/consts';\r\nimport { clamp, fixFloatingPoint } from '@/util';\r\n\r\nconst MOUSE_MOVE_THRESHOLD = 10;\r\nconst DEFAULT_OPTION = {\r\n  presetRatio: null,\r\n  top: -10,\r\n  left: -10,\r\n  height: 1,\r\n  width: 1,\r\n};\r\n\r\n/**\r\n * Cropper components\r\n * @param {Graphics} graphics - Graphics instance\r\n * @extends {Component}\r\n * @class Cropper\r\n * @ignore\r\n */\r\nclass Cropper extends Component {\r\n  constructor(graphics) {\r\n    super(componentNames.CROPPER, graphics);\r\n\r\n    /**\r\n     * Cropzone\r\n     * @type {Cropzone}\r\n     * @private\r\n     */\r\n    this._cropzone = null;\r\n\r\n    /**\r\n     * StartX of Cropzone\r\n     * @type {number}\r\n     * @private\r\n     */\r\n    this._startX = null;\r\n\r\n    /**\r\n     * StartY of Cropzone\r\n     * @type {number}\r\n     * @private\r\n     */\r\n    this._startY = null;\r\n\r\n    /**\r\n     * State whether shortcut key is pressed or not\r\n     * @type {boolean}\r\n     * @private\r\n     */\r\n    this._withShiftKey = false;\r\n\r\n    /**\r\n     * Listeners\r\n     * @type {object.<string, function>}\r\n     * @private\r\n     */\r\n    this._listeners = {\r\n      keydown: this._onKeyDown.bind(this),\r\n      keyup: this._onKeyUp.bind(this),\r\n      mousedown: this._onFabricMouseDown.bind(this),\r\n      mousemove: this._onFabricMouseMove.bind(this),\r\n      mouseup: this._onFabricMouseUp.bind(this),\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Start cropping\r\n   */\r\n  start() {\r\n    if (this._cropzone) {\r\n      return;\r\n    }\r\n    const canvas = this.getCanvas();\r\n\r\n    canvas.forEachObject((obj) => {\r\n      // {@link http://fabricjs.com/docs/fabric.Object.html#evented}\r\n      obj.evented = false;\r\n    });\r\n\r\n    this._cropzone = new Cropzone(\r\n      canvas,\r\n      snippet.extend(\r\n        {\r\n          left: 0,\r\n          top: 0,\r\n          width: 0.5,\r\n          height: 0.5,\r\n          strokeWidth: 0, // {@link https://github.com/kangax/fabric.js/issues/2860}\r\n          cornerSize: 10,\r\n          cornerColor: 'black',\r\n          fill: 'transparent',\r\n        },\r\n        CROPZONE_DEFAULT_OPTIONS,\r\n        this.graphics.cropSelectionStyle\r\n      )\r\n    );\r\n\r\n    canvas.discardActiveObject();\r\n    canvas.add(this._cropzone);\r\n    canvas.on('mouse:down', this._listeners.mousedown);\r\n    canvas.selection = false;\r\n    canvas.defaultCursor = 'crosshair';\r\n\r\n    fabric.util.addListener(document, 'keydown', this._listeners.keydown);\r\n    fabric.util.addListener(document, 'keyup', this._listeners.keyup);\r\n  }\r\n\r\n  /**\r\n   * End cropping\r\n   */\r\n  end() {\r\n    const canvas = this.getCanvas();\r\n    const cropzone = this._cropzone;\r\n\r\n    if (!cropzone) {\r\n      return;\r\n    }\r\n    canvas.remove(cropzone);\r\n    canvas.selection = true;\r\n    canvas.defaultCursor = 'default';\r\n    canvas.off('mouse:down', this._listeners.mousedown);\r\n    canvas.forEachObject((obj) => {\r\n      obj.evented = true;\r\n    });\r\n\r\n    this._cropzone = null;\r\n\r\n    fabric.util.removeListener(document, 'keydown', this._listeners.keydown);\r\n    fabric.util.removeListener(document, 'keyup', this._listeners.keyup);\r\n  }\r\n\r\n  /**\r\n   * Change cropzone visible\r\n   * @param {boolean} visible - cropzone visible state\r\n   */\r\n  changeVisibility(visible) {\r\n    if (this._cropzone) {\r\n      this._cropzone.set({ visible });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * onMousedown handler in fabric canvas\r\n   * @param {{target: fabric.Object, e: MouseEvent}} fEvent - Fabric event\r\n   * @private\r\n   */\r\n  _onFabricMouseDown(fEvent) {\r\n    const canvas = this.getCanvas();\r\n\r\n    if (fEvent.target) {\r\n      return;\r\n    }\r\n\r\n    canvas.selection = false;\r\n    const coord = canvas.getPointer(fEvent.e);\r\n\r\n    this._startX = coord.x;\r\n    this._startY = coord.y;\r\n\r\n    canvas.on({\r\n      'mouse:move': this._listeners.mousemove,\r\n      'mouse:up': this._listeners.mouseup,\r\n    });\r\n  }\r\n\r\n  /**\r\n   * onMousemove handler in fabric canvas\r\n   * @param {{target: fabric.Object, e: MouseEvent}} fEvent - Fabric event\r\n   * @private\r\n   */\r\n  _onFabricMouseMove(fEvent) {\r\n    const canvas = this.getCanvas();\r\n    const pointer = canvas.getPointer(fEvent.e);\r\n    const { x, y } = pointer;\r\n    const cropzone = this._cropzone;\r\n\r\n    if (Math.abs(x - this._startX) + Math.abs(y - this._startY) > MOUSE_MOVE_THRESHOLD) {\r\n      canvas.remove(cropzone);\r\n      cropzone.set(this._calcRectDimensionFromPoint(x, y));\r\n\r\n      canvas.add(cropzone);\r\n      canvas.setActiveObject(cropzone);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get rect dimension setting from Canvas-Mouse-Position(x, y)\r\n   * @param {number} x - Canvas-Mouse-Position x\r\n   * @param {number} y - Canvas-Mouse-Position Y\r\n   * @returns {{left: number, top: number, width: number, height: number}}\r\n   * @private\r\n   */\r\n  _calcRectDimensionFromPoint(x, y) {\r\n    const canvas = this.getCanvas();\r\n    const canvasWidth = canvas.getWidth();\r\n    const canvasHeight = canvas.getHeight();\r\n    const startX = this._startX;\r\n    const startY = this._startY;\r\n    let left = clamp(x, 0, startX);\r\n    let top = clamp(y, 0, startY);\r\n    let width = clamp(x, startX, canvasWidth) - left; // (startX <= x(mouse) <= canvasWidth) - left\r\n    let height = clamp(y, startY, canvasHeight) - top; // (startY <= y(mouse) <= canvasHeight) - top\r\n\r\n    if (this._withShiftKey) {\r\n      // make fixed ratio cropzone\r\n      if (width > height) {\r\n        height = width;\r\n      } else if (height > width) {\r\n        width = height;\r\n      }\r\n\r\n      if (startX >= x) {\r\n        left = startX - width;\r\n      }\r\n\r\n      if (startY >= y) {\r\n        top = startY - height;\r\n      }\r\n    }\r\n\r\n    return {\r\n      left,\r\n      top,\r\n      width,\r\n      height,\r\n    };\r\n  }\r\n\r\n  /**\r\n   * onMouseup handler in fabric canvas\r\n   * @private\r\n   */\r\n  _onFabricMouseUp() {\r\n    const cropzone = this._cropzone;\r\n    const listeners = this._listeners;\r\n    const canvas = this.getCanvas();\r\n\r\n    canvas.setActiveObject(cropzone);\r\n    canvas.off({\r\n      'mouse:move': listeners.mousemove,\r\n      'mouse:up': listeners.mouseup,\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Get cropped image data\r\n   * @param {Object} cropRect cropzone rect\r\n   *  @param {Number} cropRect.left left position\r\n   *  @param {Number} cropRect.top top position\r\n   *  @param {Number} cropRect.width width\r\n   *  @param {Number} cropRect.height height\r\n   * @returns {?{imageName: string, url: string}} cropped Image data\r\n   */\r\n  getCroppedImageData(cropRect) {\r\n    const canvas = this.getCanvas();\r\n    const containsCropzone = canvas.contains(this._cropzone);\r\n    if (!cropRect) {\r\n      return null;\r\n    }\r\n\r\n    if (containsCropzone) {\r\n      canvas.remove(this._cropzone);\r\n    }\r\n\r\n    const imageData = {\r\n      imageName: this.getImageName(),\r\n      url: canvas.toDataURL(cropRect),\r\n    };\r\n\r\n    if (containsCropzone) {\r\n      canvas.add(this._cropzone);\r\n    }\r\n\r\n    return imageData;\r\n  }\r\n\r\n  /**\r\n   * Get cropped rect\r\n   * @returns {Object} rect\r\n   */\r\n  getCropzoneRect() {\r\n    const cropzone = this._cropzone;\r\n\r\n    if (!cropzone.isValid()) {\r\n      return null;\r\n    }\r\n\r\n    return {\r\n      left: cropzone.left,\r\n      top: cropzone.top,\r\n      width: cropzone.width,\r\n      height: cropzone.height,\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Set a cropzone square\r\n   * @param {number} [presetRatio] - preset ratio\r\n   */\r\n  setCropzoneRect(presetRatio) {\r\n    const canvas = this.getCanvas();\r\n    const cropzone = this._cropzone;\r\n\r\n    canvas.discardActiveObject();\r\n    canvas.selection = false;\r\n    canvas.remove(cropzone);\r\n\r\n    cropzone.set(presetRatio ? this._getPresetPropertiesForCropSize(presetRatio) : DEFAULT_OPTION);\r\n\r\n    canvas.add(cropzone);\r\n    canvas.selection = true;\r\n\r\n    if (presetRatio) {\r\n      canvas.setActiveObject(cropzone);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * get a cropzone square info\r\n   * @param {number} presetRatio - preset ratio\r\n   * @returns {{presetRatio: number, left: number, top: number, width: number, height: number}}\r\n   * @private\r\n   */\r\n  _getPresetPropertiesForCropSize(presetRatio) {\r\n    const canvas = this.getCanvas();\r\n    const originalWidth = canvas.getWidth();\r\n    const originalHeight = canvas.getHeight();\r\n\r\n    const standardSize = originalWidth >= originalHeight ? originalWidth : originalHeight;\r\n    const getScale = (value, orignalValue) => (value > orignalValue ? orignalValue / value : 1);\r\n\r\n    let width = standardSize * presetRatio;\r\n    let height = standardSize;\r\n\r\n    const scaleWidth = getScale(width, originalWidth);\r\n    [width, height] = snippet.map([width, height], (sizeValue) => sizeValue * scaleWidth);\r\n\r\n    const scaleHeight = getScale(height, originalHeight);\r\n    [width, height] = snippet.map([width, height], (sizeValue) =>\r\n      fixFloatingPoint(sizeValue * scaleHeight)\r\n    );\r\n\r\n    return {\r\n      presetRatio,\r\n      top: (originalHeight - height) / 2,\r\n      left: (originalWidth - width) / 2,\r\n      width,\r\n      height,\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Keydown event handler\r\n   * @param {KeyboardEvent} e - Event object\r\n   * @private\r\n   */\r\n  _onKeyDown(e) {\r\n    if (e.keyCode === keyCodes.SHIFT) {\r\n      this._withShiftKey = true;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Keyup event handler\r\n   * @param {KeyboardEvent} e - Event object\r\n   * @private\r\n   */\r\n  _onKeyUp(e) {\r\n    if (e.keyCode === keyCodes.SHIFT) {\r\n      this._withShiftKey = false;\r\n    }\r\n  }\r\n}\r\n\r\nexport default Cropper;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Add filter module\r\n */\r\nimport { isUndefined, extend, forEach, filter } from 'tui-code-snippet';\r\nimport fabric from 'fabric';\r\nimport Component from '@/interface/component';\r\nimport { Promise } from '@/util';\r\nimport { rejectMessages, componentNames } from '@/consts';\r\nimport Mask from '@/extension/mask';\r\nimport Sharpen from '@/extension/sharpen';\r\nimport Emboss from '@/extension/emboss';\r\nimport ColorFilter from '@/extension/colorFilter';\r\n\r\nconst { filters } = fabric.Image;\r\n\r\nfilters.Mask = Mask;\r\nfilters.Sharpen = Sharpen;\r\nfilters.Emboss = Emboss;\r\nfilters.ColorFilter = ColorFilter;\r\n\r\n/**\r\n * Filter\r\n * @class Filter\r\n * @param {Graphics} graphics - Graphics instance\r\n * @extends {Component}\r\n * @ignore\r\n */\r\nclass Filter extends Component {\r\n  constructor(graphics) {\r\n    super(componentNames.FILTER, graphics);\r\n  }\r\n\r\n  /**\r\n   * Add filter to source image (a specific filter is added on fabric.js)\r\n   * @param {string} type - Filter type\r\n   * @param {Object} [options] - Options of filter\r\n   * @returns {Promise}\r\n   */\r\n  add(type, options) {\r\n    return new Promise((resolve, reject) => {\r\n      const sourceImg = this._getSourceImage();\r\n      const canvas = this.getCanvas();\r\n      let imgFilter = this._getFilter(sourceImg, type);\r\n      if (!imgFilter) {\r\n        imgFilter = this._createFilter(sourceImg, type, options);\r\n      }\r\n\r\n      if (!imgFilter) {\r\n        reject(rejectMessages.invalidParameters);\r\n      }\r\n\r\n      this._changeFilterValues(imgFilter, options);\r\n\r\n      this._apply(sourceImg, () => {\r\n        canvas.renderAll();\r\n        resolve({\r\n          type,\r\n          action: 'add',\r\n          options,\r\n        });\r\n      });\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Remove filter to source image\r\n   * @param {string} type - Filter type\r\n   * @returns {Promise}\r\n   */\r\n  remove(type) {\r\n    return new Promise((resolve, reject) => {\r\n      const sourceImg = this._getSourceImage();\r\n      const canvas = this.getCanvas();\r\n      const options = this.getOptions(type);\r\n\r\n      if (!sourceImg.filters.length) {\r\n        reject(rejectMessages.unsupportedOperation);\r\n      }\r\n\r\n      this._removeFilter(sourceImg, type);\r\n\r\n      this._apply(sourceImg, () => {\r\n        canvas.renderAll();\r\n        resolve({\r\n          type,\r\n          action: 'remove',\r\n          options,\r\n        });\r\n      });\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Whether this has the filter or not\r\n   * @param {string} type - Filter type\r\n   * @returns {boolean} true if it has the filter\r\n   */\r\n  hasFilter(type) {\r\n    return !!this._getFilter(this._getSourceImage(), type);\r\n  }\r\n\r\n  /**\r\n   * Get a filter options\r\n   * @param {string} type - Filter type\r\n   * @returns {Object} filter options or null if there is no that filter\r\n   */\r\n  getOptions(type) {\r\n    const sourceImg = this._getSourceImage();\r\n    const imgFilter = this._getFilter(sourceImg, type);\r\n    if (!imgFilter) {\r\n      return null;\r\n    }\r\n\r\n    return extend({}, imgFilter.options);\r\n  }\r\n\r\n  /**\r\n   * Change filter values\r\n   * @param {Object} imgFilter object of filter\r\n   * @param {Object} options object\r\n   * @private\r\n   */\r\n  _changeFilterValues(imgFilter, options) {\r\n    forEach(options, (value, key) => {\r\n      if (!isUndefined(imgFilter[key])) {\r\n        imgFilter[key] = value;\r\n      }\r\n    });\r\n    forEach(imgFilter.options, (value, key) => {\r\n      if (!isUndefined(options[key])) {\r\n        imgFilter.options[key] = options[key];\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Apply filter\r\n   * @param {fabric.Image} sourceImg - Source image to apply filter\r\n   * @param {function} callback - Executed function after applying filter\r\n   * @private\r\n   */\r\n  _apply(sourceImg, callback) {\r\n    sourceImg.filters.push();\r\n    const result = sourceImg.applyFilters();\r\n    if (result) {\r\n      callback();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get source image on canvas\r\n   * @returns {fabric.Image} Current source image on canvas\r\n   * @private\r\n   */\r\n  _getSourceImage() {\r\n    return this.getCanvasImage();\r\n  }\r\n\r\n  /**\r\n   * Create filter instance\r\n   * @param {fabric.Image} sourceImg - Source image to apply filter\r\n   * @param {string} type - Filter type\r\n   * @param {Object} [options] - Options of filter\r\n   * @returns {Object} Fabric object of filter\r\n   * @private\r\n   */\r\n  _createFilter(sourceImg, type, options) {\r\n    let filterObj;\r\n    // capitalize first letter for matching with fabric image filter name\r\n    const fabricType = this._getFabricFilterType(type);\r\n    const ImageFilter = fabric.Image.filters[fabricType];\r\n    if (ImageFilter) {\r\n      filterObj = new ImageFilter(options);\r\n      filterObj.options = options;\r\n      sourceImg.filters.push(filterObj);\r\n    }\r\n\r\n    return filterObj;\r\n  }\r\n\r\n  /**\r\n   * Get applied filter instance\r\n   * @param {fabric.Image} sourceImg - Source image to apply filter\r\n   * @param {string} type - Filter type\r\n   * @returns {Object} Fabric object of filter\r\n   * @private\r\n   */\r\n  _getFilter(sourceImg, type) {\r\n    let imgFilter = null;\r\n\r\n    if (sourceImg) {\r\n      const fabricType = this._getFabricFilterType(type);\r\n      const { length } = sourceImg.filters;\r\n      let item, i;\r\n\r\n      for (i = 0; i < length; i += 1) {\r\n        item = sourceImg.filters[i];\r\n        if (item.type === fabricType) {\r\n          imgFilter = item;\r\n          break;\r\n        }\r\n      }\r\n    }\r\n\r\n    return imgFilter;\r\n  }\r\n\r\n  /**\r\n   * Remove applied filter instance\r\n   * @param {fabric.Image} sourceImg - Source image to apply filter\r\n   * @param {string} type - Filter type\r\n   * @private\r\n   */\r\n  _removeFilter(sourceImg, type) {\r\n    const fabricType = this._getFabricFilterType(type);\r\n    sourceImg.filters = filter(sourceImg.filters, (value) => value.type !== fabricType);\r\n  }\r\n\r\n  /**\r\n   * Change filter class name to fabric's, especially capitalizing first letter\r\n   * @param {string} type - Filter type\r\n   * @example\r\n   * 'grayscale' -> 'Grayscale'\r\n   * @returns {string} Fabric filter class name\r\n   */\r\n  _getFabricFilterType(type) {\r\n    return type.charAt(0).toUpperCase() + type.slice(1);\r\n  }\r\n}\r\n\r\nexport default Filter;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Image flip module\r\n */\r\nimport snippet from 'tui-code-snippet';\r\nimport Component from '@/interface/component';\r\nimport { Promise } from '@/util';\r\nimport { componentNames, rejectMessages } from '@/consts';\r\n\r\n/**\r\n * Flip\r\n * @class Flip\r\n * @param {Graphics} graphics - Graphics instance\r\n * @extends {Component}\r\n * @ignore\r\n */\r\nclass Flip extends Component {\r\n  constructor(graphics) {\r\n    super(componentNames.FLIP, graphics);\r\n  }\r\n\r\n  /**\r\n   * Get current flip settings\r\n   * @returns {{flipX: Boolean, flipY: Boolean}}\r\n   */\r\n  getCurrentSetting() {\r\n    const canvasImage = this.getCanvasImage();\r\n\r\n    return {\r\n      flipX: canvasImage.flipX,\r\n      flipY: canvasImage.flipY,\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Set flipX, flipY\r\n   * @param {{flipX: Boolean, flipY: Boolean}} newSetting - Flip setting\r\n   * @returns {Promise}\r\n   */\r\n  set(newSetting) {\r\n    const setting = this.getCurrentSetting();\r\n    const isChangingFlipX = setting.flipX !== newSetting.flipX;\r\n    const isChangingFlipY = setting.flipY !== newSetting.flipY;\r\n\r\n    if (!isChangingFlipX && !isChangingFlipY) {\r\n      return Promise.reject(rejectMessages.flip);\r\n    }\r\n\r\n    snippet.extend(setting, newSetting);\r\n    this.setImageProperties(setting, true);\r\n    this._invertAngle(isChangingFlipX, isChangingFlipY);\r\n    this._flipObjects(isChangingFlipX, isChangingFlipY);\r\n\r\n    return Promise.resolve({\r\n      flipX: setting.flipX,\r\n      flipY: setting.flipY,\r\n      angle: this.getCanvasImage().angle,\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Invert image angle for flip\r\n   * @param {boolean} isChangingFlipX - Change flipX\r\n   * @param {boolean} isChangingFlipY - Change flipY\r\n   */\r\n  _invertAngle(isChangingFlipX, isChangingFlipY) {\r\n    const canvasImage = this.getCanvasImage();\r\n    let { angle } = canvasImage;\r\n\r\n    if (isChangingFlipX) {\r\n      angle *= -1;\r\n    }\r\n    if (isChangingFlipY) {\r\n      angle *= -1;\r\n    }\r\n    canvasImage.rotate(parseFloat(angle)).setCoords(); // parseFloat for -0 to 0\r\n  }\r\n\r\n  /**\r\n   * Flip objects\r\n   * @param {boolean} isChangingFlipX - Change flipX\r\n   * @param {boolean} isChangingFlipY - Change flipY\r\n   * @private\r\n   */\r\n  _flipObjects(isChangingFlipX, isChangingFlipY) {\r\n    const canvas = this.getCanvas();\r\n\r\n    if (isChangingFlipX) {\r\n      canvas.forEachObject((obj) => {\r\n        obj\r\n          .set({\r\n            angle: parseFloat(obj.angle * -1), // parseFloat for -0 to 0\r\n            flipX: !obj.flipX,\r\n            left: canvas.width - obj.left,\r\n          })\r\n          .setCoords();\r\n      });\r\n    }\r\n    if (isChangingFlipY) {\r\n      canvas.forEachObject((obj) => {\r\n        obj\r\n          .set({\r\n            angle: parseFloat(obj.angle * -1), // parseFloat for -0 to 0\r\n            flipY: !obj.flipY,\r\n            top: canvas.height - obj.top,\r\n          })\r\n          .setCoords();\r\n      });\r\n    }\r\n    canvas.renderAll();\r\n  }\r\n\r\n  /**\r\n   * Reset flip settings\r\n   * @returns {Promise}\r\n   */\r\n  reset() {\r\n    return this.set({\r\n      flipX: false,\r\n      flipY: false,\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Flip x\r\n   * @returns {Promise}\r\n   */\r\n  flipX() {\r\n    const current = this.getCurrentSetting();\r\n\r\n    return this.set({\r\n      flipX: !current.flipX,\r\n      flipY: current.flipY,\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Flip y\r\n   * @returns {Promise}\r\n   */\r\n  flipY() {\r\n    const current = this.getCurrentSetting();\r\n\r\n    return this.set({\r\n      flipX: current.flipX,\r\n      flipY: !current.flipY,\r\n    });\r\n  }\r\n}\r\n\r\nexport default Flip;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Free drawing module, Set brush\r\n */\r\nimport fabric from 'fabric';\r\nimport Component from '@/interface/component';\r\nimport { componentNames } from '@/consts';\r\n\r\n/**\r\n * FreeDrawing\r\n * @class FreeDrawing\r\n * @param {Graphics} graphics - Graphics instance\r\n * @extends {Component}\r\n * @ignore\r\n */\r\nclass FreeDrawing extends Component {\r\n  constructor(graphics) {\r\n    super(componentNames.FREE_DRAWING, graphics);\r\n\r\n    /**\r\n     * Brush width\r\n     * @type {number}\r\n     */\r\n    this.width = 12;\r\n\r\n    /**\r\n     * fabric.Color instance for brush color\r\n     * @type {fabric.Color}\r\n     */\r\n    this.oColor = new fabric.Color('rgba(0, 0, 0, 0.5)');\r\n  }\r\n\r\n  /**\r\n   * Start free drawing mode\r\n   * @param {{width: ?number, color: ?string}} [setting] - Brush width & color\r\n   */\r\n  start(setting) {\r\n    const canvas = this.getCanvas();\r\n\r\n    canvas.isDrawingMode = true;\r\n    this.setBrush(setting);\r\n  }\r\n\r\n  /**\r\n   * Set brush\r\n   * @param {{width: ?number, color: ?string}} [setting] - Brush width & color\r\n   */\r\n  setBrush(setting) {\r\n    const brush = this.getCanvas().freeDrawingBrush;\r\n\r\n    setting = setting || {};\r\n    this.width = setting.width || this.width;\r\n    if (setting.color) {\r\n      this.oColor = new fabric.Color(setting.color);\r\n    }\r\n    brush.width = this.width;\r\n    brush.color = this.oColor.toRgba();\r\n  }\r\n\r\n  /**\r\n   * End free drawing mode\r\n   */\r\n  end() {\r\n    const canvas = this.getCanvas();\r\n\r\n    canvas.isDrawingMode = false;\r\n  }\r\n}\r\n\r\nexport default FreeDrawing;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Add icon module\r\n */\r\nimport snippet from 'tui-code-snippet';\r\nimport fabric from 'fabric';\r\nimport Component from '@/interface/component';\r\nimport { Promise } from '@/util';\r\nimport { eventNames as events, rejectMessages, componentNames, fObjectOptions } from '@/consts';\r\n\r\nconst pathMap = {\r\n  arrow: 'M 0 90 H 105 V 120 L 160 60 L 105 0 V 30 H 0 Z',\r\n  cancel:\r\n    'M 0 30 L 30 60 L 0 90 L 30 120 L 60 90 L 90 120 L 120 90 ' +\r\n    'L 90 60 L 120 30 L 90 0 L 60 30 L 30 0 Z',\r\n};\r\n\r\n/**\r\n * Icon\r\n * @class Icon\r\n * @param {Graphics} graphics - Graphics instance\r\n * @extends {Component}\r\n * @ignore\r\n */\r\nclass Icon extends Component {\r\n  constructor(graphics) {\r\n    super(componentNames.ICON, graphics);\r\n\r\n    /**\r\n     * Default icon color\r\n     * @type {string}\r\n     */\r\n    this._oColor = '#000000';\r\n\r\n    /**\r\n     * Path value of each icon type\r\n     * @type {Object}\r\n     */\r\n    this._pathMap = pathMap;\r\n\r\n    /**\r\n     * Type of the drawing icon\r\n     * @type {string}\r\n     * @private\r\n     */\r\n    this._type = null;\r\n\r\n    /**\r\n     * Color of the drawing icon\r\n     * @type {string}\r\n     * @private\r\n     */\r\n    this._iconColor = null;\r\n\r\n    /**\r\n     * Event handler list\r\n     * @type {Object}\r\n     * @private\r\n     */\r\n    this._handlers = {\r\n      mousedown: this._onFabricMouseDown.bind(this),\r\n      mousemove: this._onFabricMouseMove.bind(this),\r\n      mouseup: this._onFabricMouseUp.bind(this),\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Set states of the current drawing shape\r\n   * @ignore\r\n   * @param {string} type - Icon type ('arrow', 'cancel', custom icon name)\r\n   * @param {string} iconColor - Icon foreground color\r\n   */\r\n  setStates(type, iconColor) {\r\n    this._type = type;\r\n    this._iconColor = iconColor;\r\n  }\r\n\r\n  /**\r\n   * Start to draw the icon on canvas\r\n   * @ignore\r\n   */\r\n  start() {\r\n    const canvas = this.getCanvas();\r\n    canvas.selection = false;\r\n    canvas.on('mouse:down', this._handlers.mousedown);\r\n  }\r\n\r\n  /**\r\n   * End to draw the icon on canvas\r\n   * @ignore\r\n   */\r\n  end() {\r\n    const canvas = this.getCanvas();\r\n\r\n    canvas.selection = true;\r\n    canvas.off({\r\n      'mouse:down': this._handlers.mousedown,\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Add icon\r\n   * @param {string} type - Icon type\r\n   * @param {Object} options - Icon options\r\n   *      @param {string} [options.fill] - Icon foreground color\r\n   *      @param {string} [options.left] - Icon x position\r\n   *      @param {string} [options.top] - Icon y position\r\n   * @returns {Promise}\r\n   */\r\n  add(type, options) {\r\n    return new Promise((resolve, reject) => {\r\n      const canvas = this.getCanvas();\r\n      const path = this._pathMap[type];\r\n      const selectionStyle = fObjectOptions.SELECTION_STYLE;\r\n      const icon = path ? this._createIcon(path) : null;\r\n      this._icon = icon;\r\n\r\n      if (!icon) {\r\n        reject(rejectMessages.invalidParameters);\r\n      }\r\n\r\n      icon.set(\r\n        snippet.extend(\r\n          {\r\n            type: 'icon',\r\n            fill: this._oColor,\r\n          },\r\n          selectionStyle,\r\n          options,\r\n          this.graphics.controlStyle\r\n        )\r\n      );\r\n\r\n      canvas.add(icon).setActiveObject(icon);\r\n\r\n      resolve(this.graphics.createObjectProperties(icon));\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Register icon paths\r\n   * @param {{key: string, value: string}} pathInfos - Path infos\r\n   */\r\n  registerPaths(pathInfos) {\r\n    snippet.forEach(\r\n      pathInfos,\r\n      (path, type) => {\r\n        this._pathMap[type] = path;\r\n      },\r\n      this\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Set icon object color\r\n   * @param {string} color - Color to set\r\n   * @param {fabric.Path}[obj] - Current activated path object\r\n   */\r\n  setColor(color, obj) {\r\n    this._oColor = color;\r\n\r\n    if (obj && obj.get('type') === 'icon') {\r\n      obj.set({ fill: this._oColor });\r\n      this.getCanvas().renderAll();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get icon color\r\n   * @param {fabric.Path}[obj] - Current activated path object\r\n   * @returns {string} color\r\n   */\r\n  getColor(obj) {\r\n    return obj.fill;\r\n  }\r\n\r\n  /**\r\n   * Create icon object\r\n   * @param {string} path - Path value to create icon\r\n   * @returns {fabric.Path} Path object\r\n   */\r\n  _createIcon(path) {\r\n    return new fabric.Path(path);\r\n  }\r\n\r\n  /**\r\n   * MouseDown event handler on canvas\r\n   * @param {{target: fabric.Object, e: MouseEvent}} fEvent - Fabric event object\r\n   * @private\r\n   */\r\n  _onFabricMouseDown(fEvent) {\r\n    const canvas = this.getCanvas();\r\n\r\n    this._startPoint = canvas.getPointer(fEvent.e);\r\n    const { x: left, y: top } = this._startPoint;\r\n\r\n    this.add(this._type, {\r\n      left,\r\n      top,\r\n      fill: this._iconColor,\r\n    }).then(() => {\r\n      this.fire(events.ADD_OBJECT, this.graphics.createObjectProperties(this._icon));\r\n      canvas.on('mouse:move', this._handlers.mousemove);\r\n      canvas.on('mouse:up', this._handlers.mouseup);\r\n    });\r\n  }\r\n\r\n  /**\r\n   * MouseMove event handler on canvas\r\n   * @param {{target: fabric.Object, e: MouseEvent}} fEvent - Fabric event object\r\n   * @private\r\n   */\r\n  _onFabricMouseMove(fEvent) {\r\n    const canvas = this.getCanvas();\r\n\r\n    if (!this._icon) {\r\n      return;\r\n    }\r\n    const moveOriginPointer = canvas.getPointer(fEvent.e);\r\n\r\n    const scaleX = (moveOriginPointer.x - this._startPoint.x) / this._icon.width;\r\n    const scaleY = (moveOriginPointer.y - this._startPoint.y) / this._icon.height;\r\n\r\n    this._icon.set({\r\n      scaleX: Math.abs(scaleX * 2),\r\n      scaleY: Math.abs(scaleY * 2),\r\n    });\r\n\r\n    this._icon.setCoords();\r\n    canvas.renderAll();\r\n  }\r\n\r\n  /**\r\n   * MouseUp event handler on canvas\r\n   * @private\r\n   */\r\n  _onFabricMouseUp() {\r\n    const canvas = this.getCanvas();\r\n\r\n    this.fire(events.OBJECT_ADDED, this.graphics.createObjectProperties(this._icon));\r\n\r\n    this._icon = null;\r\n\r\n    canvas.off('mouse:down', this._handlers.mousedown);\r\n    canvas.off('mouse:move', this._handlers.mousemove);\r\n    canvas.off('mouse:up', this._handlers.mouseup);\r\n  }\r\n}\r\n\r\nexport default Icon;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Image loader\r\n */\r\nimport Component from '@/interface/component';\r\nimport { Promise } from '@/util';\r\nimport { componentNames, rejectMessages } from '@/consts';\r\n\r\nconst imageOption = {\r\n  padding: 0,\r\n  crossOrigin: 'Anonymous',\r\n};\r\n\r\n/**\r\n * ImageLoader components\r\n * @extends {Component}\r\n * @class ImageLoader\r\n * @param {Graphics} graphics - Graphics instance\r\n * @ignore\r\n */\r\nclass ImageLoader extends Component {\r\n  constructor(graphics) {\r\n    super(componentNames.IMAGE_LOADER, graphics);\r\n  }\r\n\r\n  /**\r\n   * Load image from url\r\n   * @param {?string} imageName - File name\r\n   * @param {?(fabric.Image|string)} img - fabric.Image instance or URL of an image\r\n   * @returns {Promise}\r\n   */\r\n  load(imageName, img) {\r\n    let promise;\r\n\r\n    if (!imageName && !img) {\r\n      // Back to the initial state, not error.\r\n      const canvas = this.getCanvas();\r\n\r\n      canvas.backgroundImage = null;\r\n      canvas.renderAll();\r\n\r\n      promise = new Promise((resolve) => {\r\n        this.setCanvasImage('', null);\r\n        resolve();\r\n      });\r\n    } else {\r\n      promise = this._setBackgroundImage(img).then((oImage) => {\r\n        this.setCanvasImage(imageName, oImage);\r\n        this.adjustCanvasDimension();\r\n\r\n        return oImage;\r\n      });\r\n    }\r\n\r\n    return promise;\r\n  }\r\n\r\n  /**\r\n   * Set background image\r\n   * @param {?(fabric.Image|String)} img fabric.Image instance or URL of an image to set background to\r\n   * @returns {Promise}\r\n   * @private\r\n   */\r\n  _setBackgroundImage(img) {\r\n    if (!img) {\r\n      return Promise.reject(rejectMessages.loadImage);\r\n    }\r\n\r\n    return new Promise((resolve, reject) => {\r\n      const canvas = this.getCanvas();\r\n\r\n      canvas.setBackgroundImage(\r\n        img,\r\n        () => {\r\n          const oImage = canvas.backgroundImage;\r\n\r\n          if (oImage && oImage.getElement()) {\r\n            resolve(oImage);\r\n          } else {\r\n            reject(rejectMessages.loadingImageFailed);\r\n          }\r\n        },\r\n        imageOption\r\n      );\r\n    });\r\n  }\r\n}\r\n\r\nexport default ImageLoader;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview JSON loader\r\n */\r\nimport Component from '@/interface/component';\r\nimport { Promise } from '@/util';\r\nimport { componentNames, rejectMessages } from '@/consts';\r\n\r\n/**\r\n * JsonLoader components\r\n * @extends {Component}\r\n * @class JsonLoader\r\n * @param {Graphics} graphics - Graphics instance\r\n * @ignore\r\n */\r\nclass JsonLoader extends Component {\r\n  constructor(graphics) {\r\n    super(componentNames.JSON_LOADER, graphics);\r\n  }\r\n\r\n  load(json) {\r\n    let promise;\r\n\r\n    if (!json) {\r\n      // Back to the initial state, not error.\r\n      const canvas = this.getCanvas();\r\n\r\n      canvas.renderAll();\r\n\r\n      promise = new Promise((resolve) => {\r\n        resolve();\r\n      });\r\n    } else {\r\n      promise = this._loadJson(json).then((objs) => {\r\n        return objs;\r\n      });\r\n    }\r\n\r\n    return promise;\r\n  }\r\n\r\n  _loadJson(json) {\r\n    if (!json) {\r\n      return Promise.reject(rejectMessages.loadJson);\r\n    }\r\n\r\n    return new Promise((resolve, reject) => {\r\n      const canvas = this.getCanvas();\r\n\r\n      canvas.loadFromJSON(json, () => {\r\n        const objs = canvas.getObjects();\r\n        if (objs) {\r\n          resolve(objs);\r\n        } else {\r\n          reject(rejectMessages.loadingJsonFailed);\r\n        }\r\n      });\r\n    });\r\n  }\r\n}\r\n\r\nexport default JsonLoader;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Free drawing module, Set brush\r\n */\r\nimport snippet from 'tui-code-snippet';\r\nimport fabric from 'fabric';\r\nimport Component from '@/interface/component';\r\nimport ArrowLine from '@/extension/arrowLine';\r\nimport { eventNames, componentNames, fObjectOptions } from '@/consts';\r\n\r\n/**\r\n * Line\r\n * @class Line\r\n * @param {Graphics} graphics - Graphics instance\r\n * @extends {Component}\r\n * @ignore\r\n */\r\nclass Line extends Component {\r\n  constructor(graphics) {\r\n    super(componentNames.LINE, graphics);\r\n\r\n    /**\r\n     * Brush width\r\n     * @type {number}\r\n     * @private\r\n     */\r\n    this._width = 12;\r\n\r\n    /**\r\n     * fabric.Color instance for brush color\r\n     * @type {fabric.Color}\r\n     * @private\r\n     */\r\n    this._oColor = new fabric.Color('rgba(0, 0, 0, 0.5)');\r\n\r\n    /**\r\n     * Listeners\r\n     * @type {object.<string, function>}\r\n     * @private\r\n     */\r\n    this._listeners = {\r\n      mousedown: this._onFabricMouseDown.bind(this),\r\n      mousemove: this._onFabricMouseMove.bind(this),\r\n      mouseup: this._onFabricMouseUp.bind(this),\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Start drawing line mode\r\n   * @param {{width: ?number, color: ?string}} [setting] - Brush width & color\r\n   */\r\n  setHeadOption(setting) {\r\n    const {\r\n      arrowType = {\r\n        head: null,\r\n        tail: null,\r\n      },\r\n    } = setting;\r\n\r\n    this._arrowType = arrowType;\r\n  }\r\n\r\n  /**\r\n   * Start drawing line mode\r\n   * @param {{width: ?number, color: ?string}} [setting] - Brush width & color\r\n   */\r\n  start(setting = {}) {\r\n    const canvas = this.getCanvas();\r\n\r\n    canvas.defaultCursor = 'crosshair';\r\n    canvas.selection = false;\r\n\r\n    this.setHeadOption(setting);\r\n    this.setBrush(setting);\r\n\r\n    canvas.forEachObject((obj) => {\r\n      obj.set({\r\n        evented: false,\r\n      });\r\n    });\r\n\r\n    canvas.on({\r\n      'mouse:down': this._listeners.mousedown,\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Set brush\r\n   * @param {{width: ?number, color: ?string}} [setting] - Brush width & color\r\n   */\r\n  setBrush(setting) {\r\n    const brush = this.getCanvas().freeDrawingBrush;\r\n\r\n    setting = setting || {};\r\n    this._width = setting.width || this._width;\r\n\r\n    if (setting.color) {\r\n      this._oColor = new fabric.Color(setting.color);\r\n    }\r\n    brush.width = this._width;\r\n    brush.color = this._oColor.toRgba();\r\n  }\r\n\r\n  /**\r\n   * End drawing line mode\r\n   */\r\n  end() {\r\n    const canvas = this.getCanvas();\r\n\r\n    canvas.defaultCursor = 'default';\r\n    canvas.selection = true;\r\n\r\n    canvas.forEachObject((obj) => {\r\n      obj.set({\r\n        evented: true,\r\n      });\r\n    });\r\n\r\n    canvas.off('mouse:down', this._listeners.mousedown);\r\n  }\r\n\r\n  /**\r\n   * Mousedown event handler in fabric canvas\r\n   * @param {{target: fabric.Object, e: MouseEvent}} fEvent - Fabric event object\r\n   * @private\r\n   */\r\n  _onFabricMouseDown(fEvent) {\r\n    const canvas = this.getCanvas();\r\n    const { x, y } = canvas.getPointer(fEvent.e);\r\n    const points = [x, y, x, y];\r\n\r\n    this._line = new ArrowLine(points, {\r\n      stroke: this._oColor.toRgba(),\r\n      strokeWidth: this._width,\r\n      arrowType: this._arrowType,\r\n      evented: false,\r\n    });\r\n\r\n    this._line.set(fObjectOptions.SELECTION_STYLE);\r\n\r\n    canvas.add(this._line);\r\n\r\n    canvas.on({\r\n      'mouse:move': this._listeners.mousemove,\r\n      'mouse:up': this._listeners.mouseup,\r\n    });\r\n\r\n    this.fire(eventNames.ADD_OBJECT, this._createLineEventObjectProperties());\r\n  }\r\n\r\n  /**\r\n   * Mousemove event handler in fabric canvas\r\n   * @param {{target: fabric.Object, e: MouseEvent}} fEvent - Fabric event object\r\n   * @private\r\n   */\r\n  _onFabricMouseMove(fEvent) {\r\n    const canvas = this.getCanvas();\r\n    const pointer = canvas.getPointer(fEvent.e);\r\n\r\n    this._line.set({\r\n      x2: pointer.x,\r\n      y2: pointer.y,\r\n    });\r\n\r\n    this._line.setCoords();\r\n\r\n    canvas.renderAll();\r\n  }\r\n\r\n  /**\r\n   * Mouseup event handler in fabric canvas\r\n   * @private\r\n   */\r\n  _onFabricMouseUp() {\r\n    const canvas = this.getCanvas();\r\n\r\n    this.fire(eventNames.OBJECT_ADDED, this._createLineEventObjectProperties());\r\n\r\n    this._line = null;\r\n\r\n    canvas.off({\r\n      'mouse:move': this._listeners.mousemove,\r\n      'mouse:up': this._listeners.mouseup,\r\n    });\r\n  }\r\n\r\n  /**\r\n   * create line event object properties\r\n   * @returns {Object} properties line object\r\n   * @private\r\n   */\r\n  _createLineEventObjectProperties() {\r\n    const params = this.graphics.createObjectProperties(this._line);\r\n    const { x1, x2, y1, y2 } = this._line;\r\n\r\n    return snippet.extend({}, params, {\r\n      startPosition: {\r\n        x: x1,\r\n        y: y1,\r\n      },\r\n      endPosition: {\r\n        x: x2,\r\n        y: y2,\r\n      },\r\n    });\r\n  }\r\n}\r\n\r\nexport default Line;\r\n","import { Promise } from '@/util';\r\nimport Component from '@/interface/component';\r\nimport { componentNames } from '@/consts';\r\n\r\n/**\r\n * Resize components\r\n * @param {Graphics} graphics - Graphics instance\r\n * @extends {Component}\r\n * @class Resize\r\n * @ignore\r\n */\r\nclass Resize extends Component {\r\n  constructor(graphics) {\r\n    super(componentNames.RESIZE, graphics);\r\n\r\n    /**\r\n     * Current dimensions\r\n     * @type {Object}\r\n     * @private\r\n     */\r\n    this._dimensions = null;\r\n\r\n    /**\r\n     * Original dimensions\r\n     * @type {Object}\r\n     * @private\r\n     */\r\n    this._originalDimensions = null;\r\n  }\r\n\r\n  /**\r\n   * Get current dimensions\r\n   * @returns {object}\r\n   */\r\n  getCurrentDimensions() {\r\n    const canvasImage = this.getCanvasImage();\r\n    if (!this._dimensions && canvasImage) {\r\n      const { width, height } = canvasImage;\r\n      this._dimensions = { width, height };\r\n    }\r\n\r\n    return this._dimensions;\r\n  }\r\n\r\n  /**\r\n   * Get original dimensions\r\n   * @returns {object}\r\n   */\r\n  getOriginalDimensions() {\r\n    return this._originalDimensions;\r\n  }\r\n\r\n  /**\r\n   * Set original dimensions\r\n   * @param {object} dimensions - Dimensions\r\n   */\r\n  setOriginalDimensions(dimensions) {\r\n    this._originalDimensions = dimensions;\r\n  }\r\n\r\n  /**\r\n   * Resize Image\r\n   * @param {Object} dimensions - Resize dimensions\r\n   * @returns {Promise}\r\n   */\r\n  resize(dimensions) {\r\n    const canvasImage = this.getCanvasImage();\r\n    const { width, height, scaleX, scaleY } = canvasImage;\r\n    const { width: dimensionsWidth, height: dimensionsHeight } = dimensions;\r\n\r\n    const scaleValues = {\r\n      scaleX: dimensionsWidth ? dimensionsWidth / width : scaleX,\r\n      scaleY: dimensionsHeight ? dimensionsHeight / height : scaleY,\r\n    };\r\n\r\n    if (scaleX !== scaleValues.scaleX || scaleY !== scaleValues.scaleY) {\r\n      canvasImage.set(scaleValues).setCoords();\r\n\r\n      this._dimensions = {\r\n        width: canvasImage.width * canvasImage.scaleX,\r\n        height: canvasImage.height * canvasImage.scaleY,\r\n      };\r\n    }\r\n\r\n    this.adjustCanvasDimensionBase();\r\n\r\n    return Promise.resolve();\r\n  }\r\n\r\n  /**\r\n   * Start resizing\r\n   */\r\n  start() {\r\n    const dimensions = this.getCurrentDimensions();\r\n    this.setOriginalDimensions(dimensions);\r\n  }\r\n\r\n  /**\r\n   * End resizing\r\n   */\r\n  end() {}\r\n}\r\n\r\nexport default Resize;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Image rotation module\r\n */\r\nimport fabric from 'fabric';\r\nimport Component from '@/interface/component';\r\nimport { Promise } from '@/util';\r\nimport { componentNames } from '@/consts';\r\n\r\n/**\r\n * Image Rotation component\r\n * @class Rotation\r\n * @extends {Component}\r\n * @param {Graphics} graphics - Graphics instance\r\n * @ignore\r\n */\r\nclass Rotation extends Component {\r\n  constructor(graphics) {\r\n    super(componentNames.ROTATION, graphics);\r\n  }\r\n\r\n  /**\r\n   * Get current angle\r\n   * @returns {Number}\r\n   */\r\n  getCurrentAngle() {\r\n    return this.getCanvasImage().angle;\r\n  }\r\n\r\n  /**\r\n   * Set angle of the image\r\n   *\r\n   *  Do not call \"this.setImageProperties\" for setting angle directly.\r\n   *  Before setting angle, The originX,Y of image should be set to center.\r\n   *      See \"http://fabricjs.com/docs/fabric.Object.html#setAngle\"\r\n   *\r\n   * @param {number} angle - Angle value\r\n   * @returns {Promise}\r\n   */\r\n  setAngle(angle) {\r\n    const oldAngle = this.getCurrentAngle() % 360; // The angle is lower than 2*PI(===360 degrees)\r\n\r\n    angle %= 360;\r\n\r\n    const canvasImage = this.getCanvasImage();\r\n    const oldImageCenter = canvasImage.getCenterPoint();\r\n    canvasImage.set({ angle }).setCoords();\r\n    this.adjustCanvasDimension();\r\n    const newImageCenter = canvasImage.getCenterPoint();\r\n    this._rotateForEachObject(oldImageCenter, newImageCenter, angle - oldAngle);\r\n\r\n    return Promise.resolve(angle);\r\n  }\r\n\r\n  /**\r\n   * Rotate for each object\r\n   * @param {fabric.Point} oldImageCenter - Image center point before rotation\r\n   * @param {fabric.Point} newImageCenter - Image center point after rotation\r\n   * @param {number} angleDiff - Image angle difference after rotation\r\n   * @private\r\n   */\r\n  _rotateForEachObject(oldImageCenter, newImageCenter, angleDiff) {\r\n    const canvas = this.getCanvas();\r\n    const centerDiff = {\r\n      x: oldImageCenter.x - newImageCenter.x,\r\n      y: oldImageCenter.y - newImageCenter.y,\r\n    };\r\n\r\n    canvas.forEachObject((obj) => {\r\n      const objCenter = obj.getCenterPoint();\r\n      const radian = fabric.util.degreesToRadians(angleDiff);\r\n      const newObjCenter = fabric.util.rotatePoint(objCenter, oldImageCenter, radian);\r\n\r\n      obj.set({\r\n        left: newObjCenter.x - centerDiff.x,\r\n        top: newObjCenter.y - centerDiff.y,\r\n        angle: (obj.angle + angleDiff) % 360,\r\n      });\r\n      obj.setCoords();\r\n    });\r\n    canvas.renderAll();\r\n  }\r\n\r\n  /**\r\n   * Rotate the image\r\n   * @param {number} additionalAngle - Additional angle\r\n   * @returns {Promise}\r\n   */\r\n  rotate(additionalAngle) {\r\n    const current = this.getCurrentAngle();\r\n\r\n    return this.setAngle(current + additionalAngle);\r\n  }\r\n}\r\n\r\nexport default Rotation;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Shape component\r\n */\r\nimport { extend } from 'tui-code-snippet';\r\nimport fabric from 'fabric';\r\nimport Component from '@/interface/component';\r\nimport resizeHelper from '@/helper/shapeResizeHelper';\r\nimport {\r\n  getFillImageFromShape,\r\n  rePositionFilterTypeFillImage,\r\n  reMakePatternImageSource,\r\n  makeFillPatternForFilter,\r\n  makeFilterOptionFromFabricImage,\r\n  resetFillPatternCanvas,\r\n} from '@/helper/shapeFilterFillHelper';\r\nimport {\r\n  Promise,\r\n  changeOrigin,\r\n  getCustomProperty,\r\n  getFillTypeFromOption,\r\n  getFillTypeFromObject,\r\n  isShape,\r\n} from '@/util';\r\nimport {\r\n  rejectMessages,\r\n  eventNames,\r\n  keyCodes as KEY_CODES,\r\n  componentNames,\r\n  fObjectOptions,\r\n  SHAPE_DEFAULT_OPTIONS,\r\n  SHAPE_FILL_TYPE,\r\n} from '@/consts';\r\n\r\nconst SHAPE_INIT_OPTIONS = extend(\r\n  {\r\n    strokeWidth: 1,\r\n    stroke: '#000000',\r\n    fill: '#ffffff',\r\n    width: 1,\r\n    height: 1,\r\n    rx: 0,\r\n    ry: 0,\r\n  },\r\n  SHAPE_DEFAULT_OPTIONS\r\n);\r\nconst DEFAULT_TYPE = 'rect';\r\nconst DEFAULT_WIDTH = 20;\r\nconst DEFAULT_HEIGHT = 20;\r\n\r\n/**\r\n * Make fill option\r\n * @param {Object} options - Options to create the shape\r\n * @param {Object.Image} canvasImage - canvas background image\r\n * @param {Function} createStaticCanvas - static canvas creater\r\n * @returns {Object} - shape option\r\n * @private\r\n */\r\nfunction makeFabricFillOption(options, canvasImage, createStaticCanvas) {\r\n  const fillOption = options.fill;\r\n  const fillType = getFillTypeFromOption(options.fill);\r\n  let fill = fillOption;\r\n\r\n  if (fillOption.color) {\r\n    fill = fillOption.color;\r\n  }\r\n\r\n  let extOption = null;\r\n  if (fillType === 'filter') {\r\n    const newStaticCanvas = createStaticCanvas();\r\n    extOption = makeFillPatternForFilter(canvasImage, fillOption.filter, newStaticCanvas);\r\n  } else {\r\n    extOption = { fill };\r\n  }\r\n\r\n  return extend({}, options, extOption);\r\n}\r\n\r\n/**\r\n * Shape\r\n * @class Shape\r\n * @param {Graphics} graphics - Graphics instance\r\n * @extends {Component}\r\n * @ignore\r\n */\r\nexport default class Shape extends Component {\r\n  constructor(graphics) {\r\n    super(componentNames.SHAPE, graphics);\r\n\r\n    /**\r\n     * Object of The drawing shape\r\n     * @type {fabric.Object}\r\n     * @private\r\n     */\r\n    this._shapeObj = null;\r\n\r\n    /**\r\n     * Type of the drawing shape\r\n     * @type {string}\r\n     * @private\r\n     */\r\n    this._type = DEFAULT_TYPE;\r\n\r\n    /**\r\n     * Options to draw the shape\r\n     * @type {Object}\r\n     * @private\r\n     */\r\n    this._options = extend({}, SHAPE_INIT_OPTIONS);\r\n\r\n    /**\r\n     * Whether the shape object is selected or not\r\n     * @type {boolean}\r\n     * @private\r\n     */\r\n    this._isSelected = false;\r\n\r\n    /**\r\n     * Pointer for drawing shape (x, y)\r\n     * @type {Object}\r\n     * @private\r\n     */\r\n    this._startPoint = {};\r\n\r\n    /**\r\n     * Using shortcut on drawing shape\r\n     * @type {boolean}\r\n     * @private\r\n     */\r\n    this._withShiftKey = false;\r\n\r\n    /**\r\n     * Event handler list\r\n     * @type {Object}\r\n     * @private\r\n     */\r\n    this._handlers = {\r\n      mousedown: this._onFabricMouseDown.bind(this),\r\n      mousemove: this._onFabricMouseMove.bind(this),\r\n      mouseup: this._onFabricMouseUp.bind(this),\r\n      keydown: this._onKeyDown.bind(this),\r\n      keyup: this._onKeyUp.bind(this),\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Start to draw the shape on canvas\r\n   * @ignore\r\n   */\r\n  start() {\r\n    const canvas = this.getCanvas();\r\n\r\n    this._isSelected = false;\r\n\r\n    canvas.defaultCursor = 'crosshair';\r\n    canvas.selection = false;\r\n    canvas.uniformScaling = true;\r\n    canvas.on({\r\n      'mouse:down': this._handlers.mousedown,\r\n    });\r\n\r\n    fabric.util.addListener(document, 'keydown', this._handlers.keydown);\r\n    fabric.util.addListener(document, 'keyup', this._handlers.keyup);\r\n  }\r\n\r\n  /**\r\n   * End to draw the shape on canvas\r\n   * @ignore\r\n   */\r\n  end() {\r\n    const canvas = this.getCanvas();\r\n\r\n    this._isSelected = false;\r\n\r\n    canvas.defaultCursor = 'default';\r\n\r\n    canvas.selection = true;\r\n    canvas.uniformScaling = false;\r\n    canvas.off({\r\n      'mouse:down': this._handlers.mousedown,\r\n    });\r\n\r\n    fabric.util.removeListener(document, 'keydown', this._handlers.keydown);\r\n    fabric.util.removeListener(document, 'keyup', this._handlers.keyup);\r\n  }\r\n\r\n  /**\r\n   * Set states of the current drawing shape\r\n   * @ignore\r\n   * @param {string} type - Shape type (ex: 'rect', 'circle')\r\n   * @param {Object} [options] - Shape options\r\n   *      @param {(ShapeFillOption | string)} [options.fill] - {@link ShapeFillOption} or\r\n   *        Shape foreground color (ex: '#fff', 'transparent')\r\n   *      @param {string} [options.stoke] - Shape outline color\r\n   *      @param {number} [options.strokeWidth] - Shape outline width\r\n   *      @param {number} [options.width] - Width value (When type option is 'rect', this options can use)\r\n   *      @param {number} [options.height] - Height value (When type option is 'rect', this options can use)\r\n   *      @param {number} [options.rx] - Radius x value (When type option is 'circle', this options can use)\r\n   *      @param {number} [options.ry] - Radius y value (When type option is 'circle', this options can use)\r\n   */\r\n  setStates(type, options) {\r\n    this._type = type;\r\n\r\n    if (options) {\r\n      this._options = extend(this._options, options);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Add the shape\r\n   * @ignore\r\n   * @param {string} type - Shape type (ex: 'rect', 'circle')\r\n   * @param {Object} options - Shape options\r\n   *      @param {(ShapeFillOption | string)} [options.fill] - ShapeFillOption or Shape foreground color (ex: '#fff', 'transparent') or ShapeFillOption object\r\n   *      @param {string} [options.stroke] - Shape outline color\r\n   *      @param {number} [options.strokeWidth] - Shape outline width\r\n   *      @param {number} [options.width] - Width value (When type option is 'rect', this options can use)\r\n   *      @param {number} [options.height] - Height value (When type option is 'rect', this options can use)\r\n   *      @param {number} [options.rx] - Radius x value (When type option is 'circle', this options can use)\r\n   *      @param {number} [options.ry] - Radius y value (When type option is 'circle', this options can use)\r\n   *      @param {number} [options.isRegular] - Whether scaling shape has 1:1 ratio or not\r\n   * @returns {Promise}\r\n   */\r\n  add(type, options) {\r\n    return new Promise((resolve) => {\r\n      const canvas = this.getCanvas();\r\n      const extendOption = this._extendOptions(options);\r\n\r\n      const shapeObj = this._createInstance(type, extendOption);\r\n      const objectProperties = this.graphics.createObjectProperties(shapeObj);\r\n\r\n      this._bindEventOnShape(shapeObj);\r\n\r\n      canvas.add(shapeObj).setActiveObject(shapeObj);\r\n\r\n      this._resetPositionFillFilter(shapeObj);\r\n\r\n      resolve(objectProperties);\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Change the shape\r\n   * @ignore\r\n   * @param {fabric.Object} shapeObj - Selected shape object on canvas\r\n   * @param {Object} options - Shape options\r\n   *      @param {(ShapeFillOption | string)} [options.fill] - {@link ShapeFillOption} or\r\n   *        Shape foreground color (ex: '#fff', 'transparent')\r\n   *      @param {string} [options.stroke] - Shape outline color\r\n   *      @param {number} [options.strokeWidth] - Shape outline width\r\n   *      @param {number} [options.width] - Width value (When type option is 'rect', this options can use)\r\n   *      @param {number} [options.height] - Height value (When type option is 'rect', this options can use)\r\n   *      @param {number} [options.rx] - Radius x value (When type option is 'circle', this options can use)\r\n   *      @param {number} [options.ry] - Radius y value (When type option is 'circle', this options can use)\r\n   *      @param {number} [options.isRegular] - Whether scaling shape has 1:1 ratio or not\r\n   * @returns {Promise}\r\n   */\r\n  change(shapeObj, options) {\r\n    return new Promise((resolve, reject) => {\r\n      if (!isShape(shapeObj)) {\r\n        reject(rejectMessages.unsupportedType);\r\n      }\r\n      const hasFillOption = getFillTypeFromOption(options.fill) === 'filter';\r\n      const { canvasImage, createStaticCanvas } = this.graphics;\r\n\r\n      shapeObj.set(\r\n        hasFillOption ? makeFabricFillOption(options, canvasImage, createStaticCanvas) : options\r\n      );\r\n\r\n      if (hasFillOption) {\r\n        this._resetPositionFillFilter(shapeObj);\r\n      }\r\n\r\n      this.getCanvas().renderAll();\r\n      resolve();\r\n    });\r\n  }\r\n\r\n  /**\r\n   * make fill property for user event\r\n   * @param {fabric.Object} shapeObj - fabric object\r\n   * @returns {Object}\r\n   */\r\n  makeFillPropertyForUserEvent(shapeObj) {\r\n    const fillType = getFillTypeFromObject(shapeObj);\r\n    const fillProp = {};\r\n\r\n    if (fillType === SHAPE_FILL_TYPE.FILTER) {\r\n      const fillImage = getFillImageFromShape(shapeObj);\r\n      const filterOption = makeFilterOptionFromFabricImage(fillImage);\r\n\r\n      fillProp.type = fillType;\r\n      fillProp.filter = filterOption;\r\n    } else {\r\n      fillProp.type = SHAPE_FILL_TYPE.COLOR;\r\n      fillProp.color = shapeObj.fill || 'transparent';\r\n    }\r\n\r\n    return fillProp;\r\n  }\r\n\r\n  /**\r\n   * Copy object handling.\r\n   * @param {fabric.Object} shapeObj - Shape object\r\n   * @param {fabric.Object} originalShapeObj - Shape object\r\n   */\r\n  processForCopiedObject(shapeObj, originalShapeObj) {\r\n    this._bindEventOnShape(shapeObj);\r\n\r\n    if (getFillTypeFromObject(shapeObj) === 'filter') {\r\n      const fillImage = getFillImageFromShape(originalShapeObj);\r\n      const filterOption = makeFilterOptionFromFabricImage(fillImage);\r\n      const newStaticCanvas = this.graphics.createStaticCanvas();\r\n\r\n      shapeObj.set(\r\n        makeFillPatternForFilter(this.graphics.canvasImage, filterOption, newStaticCanvas)\r\n      );\r\n      this._resetPositionFillFilter(shapeObj);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Create the instance of shape\r\n   * @param {string} type - Shape type\r\n   * @param {Object} options - Options to creat the shape\r\n   * @returns {fabric.Object} Shape instance\r\n   * @private\r\n   */\r\n  _createInstance(type, options) {\r\n    let instance;\r\n\r\n    switch (type) {\r\n      case 'rect':\r\n        instance = new fabric.Rect(options);\r\n        break;\r\n      case 'circle':\r\n        instance = new fabric.Ellipse(\r\n          extend(\r\n            {\r\n              type: 'circle',\r\n            },\r\n            options\r\n          )\r\n        );\r\n        break;\r\n      case 'triangle':\r\n        instance = new fabric.Triangle(options);\r\n        break;\r\n      default:\r\n        instance = {};\r\n    }\r\n\r\n    return instance;\r\n  }\r\n\r\n  /**\r\n   * Get the options to create the shape\r\n   * @param {Object} options - Options to creat the shape\r\n   * @returns {Object} Shape options\r\n   * @private\r\n   */\r\n  _extendOptions(options) {\r\n    const selectionStyles = fObjectOptions.SELECTION_STYLE;\r\n    const { canvasImage, createStaticCanvas } = this.graphics;\r\n\r\n    options = extend({}, SHAPE_INIT_OPTIONS, this._options, selectionStyles, options);\r\n\r\n    return makeFabricFillOption(options, canvasImage, createStaticCanvas);\r\n  }\r\n\r\n  /**\r\n   * Bind fabric events on the creating shape object\r\n   * @param {fabric.Object} shapeObj - Shape object\r\n   * @private\r\n   */\r\n  _bindEventOnShape(shapeObj) {\r\n    const self = this;\r\n    const canvas = this.getCanvas();\r\n\r\n    shapeObj.on({\r\n      added() {\r\n        self._shapeObj = this;\r\n        resizeHelper.setOrigins(self._shapeObj);\r\n      },\r\n      selected() {\r\n        self._isSelected = true;\r\n        self._shapeObj = this;\r\n        canvas.uniformScaling = true;\r\n        canvas.defaultCursor = 'default';\r\n        resizeHelper.setOrigins(self._shapeObj);\r\n      },\r\n      deselected() {\r\n        self._isSelected = false;\r\n        self._shapeObj = null;\r\n        canvas.defaultCursor = 'crosshair';\r\n        canvas.uniformScaling = false;\r\n      },\r\n      modified() {\r\n        const currentObj = self._shapeObj;\r\n\r\n        resizeHelper.adjustOriginToCenter(currentObj);\r\n        resizeHelper.setOrigins(currentObj);\r\n      },\r\n      modifiedInGroup(activeSelection) {\r\n        self._fillFilterRePositionInGroupSelection(shapeObj, activeSelection);\r\n      },\r\n      moving() {\r\n        self._resetPositionFillFilter(this);\r\n      },\r\n      rotating() {\r\n        self._resetPositionFillFilter(this);\r\n      },\r\n      scaling(fEvent) {\r\n        const pointer = canvas.getPointer(fEvent.e);\r\n        const currentObj = self._shapeObj;\r\n\r\n        canvas.setCursor('crosshair');\r\n        resizeHelper.resize(currentObj, pointer, true);\r\n\r\n        self._resetPositionFillFilter(this);\r\n      },\r\n    });\r\n  }\r\n\r\n  /**\r\n   * MouseDown event handler on canvas\r\n   * @param {{target: fabric.Object, e: MouseEvent}} fEvent - Fabric event object\r\n   * @private\r\n   */\r\n  _onFabricMouseDown(fEvent) {\r\n    if (!fEvent.target) {\r\n      this._isSelected = false;\r\n      this._shapeObj = false;\r\n    }\r\n\r\n    if (!this._isSelected && !this._shapeObj) {\r\n      const canvas = this.getCanvas();\r\n      this._startPoint = canvas.getPointer(fEvent.e);\r\n\r\n      canvas.on({\r\n        'mouse:move': this._handlers.mousemove,\r\n        'mouse:up': this._handlers.mouseup,\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * MouseDown event handler on canvas\r\n   * @param {{target: fabric.Object, e: MouseEvent}} fEvent - Fabric event object\r\n   * @private\r\n   */\r\n  _onFabricMouseMove(fEvent) {\r\n    const canvas = this.getCanvas();\r\n    const pointer = canvas.getPointer(fEvent.e);\r\n    const startPointX = this._startPoint.x;\r\n    const startPointY = this._startPoint.y;\r\n    const width = startPointX - pointer.x;\r\n    const height = startPointY - pointer.y;\r\n    const shape = this._shapeObj;\r\n\r\n    if (!shape) {\r\n      this.add(this._type, {\r\n        left: startPointX,\r\n        top: startPointY,\r\n        width,\r\n        height,\r\n      }).then((objectProps) => {\r\n        this.fire(eventNames.ADD_OBJECT, objectProps);\r\n      });\r\n    } else {\r\n      this._shapeObj.set({\r\n        isRegular: this._withShiftKey,\r\n      });\r\n\r\n      resizeHelper.resize(shape, pointer);\r\n      canvas.renderAll();\r\n\r\n      this._resetPositionFillFilter(shape);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * MouseUp event handler on canvas\r\n   * @private\r\n   */\r\n  _onFabricMouseUp() {\r\n    const canvas = this.getCanvas();\r\n    const startPointX = this._startPoint.x;\r\n    const startPointY = this._startPoint.y;\r\n    const shape = this._shapeObj;\r\n\r\n    if (!shape) {\r\n      this.add(this._type, {\r\n        left: startPointX,\r\n        top: startPointY,\r\n        width: DEFAULT_WIDTH,\r\n        height: DEFAULT_HEIGHT,\r\n      }).then((objectProps) => {\r\n        this.fire(eventNames.ADD_OBJECT, objectProps);\r\n      });\r\n    } else if (shape) {\r\n      resizeHelper.adjustOriginToCenter(shape);\r\n      this.fire(eventNames.OBJECT_ADDED, this.graphics.createObjectProperties(shape));\r\n    }\r\n\r\n    canvas.off({\r\n      'mouse:move': this._handlers.mousemove,\r\n      'mouse:up': this._handlers.mouseup,\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Keydown event handler on document\r\n   * @param {KeyboardEvent} e - Event object\r\n   * @private\r\n   */\r\n  _onKeyDown(e) {\r\n    if (e.keyCode === KEY_CODES.SHIFT) {\r\n      this._withShiftKey = true;\r\n\r\n      if (this._shapeObj) {\r\n        this._shapeObj.isRegular = true;\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Keyup event handler on document\r\n   * @param {KeyboardEvent} e - Event object\r\n   * @private\r\n   */\r\n  _onKeyUp(e) {\r\n    if (e.keyCode === KEY_CODES.SHIFT) {\r\n      this._withShiftKey = false;\r\n\r\n      if (this._shapeObj) {\r\n        this._shapeObj.isRegular = false;\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Reset shape position and internal proportions in the filter type fill area.\r\n   * @param {fabric.Object} shapeObj - Shape object\r\n   * @private\r\n   */\r\n  _resetPositionFillFilter(shapeObj) {\r\n    if (getFillTypeFromObject(shapeObj) !== 'filter') {\r\n      return;\r\n    }\r\n\r\n    const { patternSourceCanvas } = getCustomProperty(shapeObj, 'patternSourceCanvas');\r\n\r\n    const fillImage = getFillImageFromShape(shapeObj);\r\n    const { originalAngle } = getCustomProperty(fillImage, 'originalAngle');\r\n\r\n    if (this.graphics.canvasImage.angle !== originalAngle) {\r\n      reMakePatternImageSource(shapeObj, this.graphics.canvasImage);\r\n    }\r\n    const { originX, originY } = shapeObj;\r\n\r\n    resizeHelper.adjustOriginToCenter(shapeObj);\r\n\r\n    shapeObj.width *= shapeObj.scaleX;\r\n    shapeObj.height *= shapeObj.scaleY;\r\n    shapeObj.rx *= shapeObj.scaleX;\r\n    shapeObj.ry *= shapeObj.scaleY;\r\n    shapeObj.scaleX = 1;\r\n    shapeObj.scaleY = 1;\r\n\r\n    rePositionFilterTypeFillImage(shapeObj);\r\n\r\n    changeOrigin(shapeObj, {\r\n      originX,\r\n      originY,\r\n    });\r\n\r\n    resetFillPatternCanvas(patternSourceCanvas);\r\n  }\r\n\r\n  /**\r\n   * Reset filter area position within group selection.\r\n   * @param {fabric.Object} shapeObj - Shape object\r\n   * @param {fabric.ActiveSelection} activeSelection - Shape object\r\n   * @private\r\n   */\r\n  _fillFilterRePositionInGroupSelection(shapeObj, activeSelection) {\r\n    if (activeSelection.scaleX !== 1 || activeSelection.scaleY !== 1) {\r\n      // This is necessary because the group's scale transition state affects the relative size of the fill area.\r\n      // The only way to reset the object transformation scale state to neutral.\r\n      // {@link https://github.com/fabricjs/fabric.js/issues/5372}\r\n      activeSelection.addWithUpdate();\r\n    }\r\n\r\n    const { angle, left, top } = shapeObj;\r\n\r\n    fabric.util.addTransformToObject(shapeObj, activeSelection.calcTransformMatrix());\r\n    this._resetPositionFillFilter(shapeObj);\r\n\r\n    shapeObj.set({\r\n      angle,\r\n      left,\r\n      top,\r\n    });\r\n  }\r\n}\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Text module\r\n */\r\nimport snippet from 'tui-code-snippet';\r\nimport fabric from 'fabric';\r\nimport Component from '@/interface/component';\r\nimport { Promise } from '@/util';\r\nimport { componentNames, eventNames as events, fObjectOptions } from '@/consts';\r\n\r\nconst defaultStyles = {\r\n  fill: '#000000',\r\n  left: 0,\r\n  top: 0,\r\n};\r\nconst resetStyles = {\r\n  fill: '#000000',\r\n  fontStyle: 'normal',\r\n  fontWeight: 'normal',\r\n  textAlign: 'tie-text-align-left',\r\n  underline: false,\r\n};\r\nconst DBCLICK_TIME = 500;\r\n\r\n/**\r\n * Text\r\n * @class Text\r\n * @param {Graphics} graphics - Graphics instance\r\n * @extends {Component}\r\n * @ignore\r\n */\r\nclass Text extends Component {\r\n  constructor(graphics) {\r\n    super(componentNames.TEXT, graphics);\r\n\r\n    /**\r\n     * Default text style\r\n     * @type {Object}\r\n     */\r\n    this._defaultStyles = defaultStyles;\r\n\r\n    /**\r\n     * Selected state\r\n     * @type {boolean}\r\n     */\r\n    this._isSelected = false;\r\n\r\n    /**\r\n     * Selected text object\r\n     * @type {Object}\r\n     */\r\n    this._selectedObj = {};\r\n\r\n    /**\r\n     * Editing text object\r\n     * @type {Object}\r\n     */\r\n    this._editingObj = {};\r\n\r\n    /**\r\n     * Listeners for fabric event\r\n     * @type {Object}\r\n     */\r\n    this._listeners = {\r\n      mousedown: this._onFabricMouseDown.bind(this),\r\n      select: this._onFabricSelect.bind(this),\r\n      selectClear: this._onFabricSelectClear.bind(this),\r\n      scaling: this._onFabricScaling.bind(this),\r\n      textChanged: this._onFabricTextChanged.bind(this),\r\n    };\r\n\r\n    /**\r\n     * Textarea element for editing\r\n     * @type {HTMLElement}\r\n     */\r\n    this._textarea = null;\r\n\r\n    /**\r\n     * Ratio of current canvas\r\n     * @type {number}\r\n     */\r\n    this._ratio = 1;\r\n\r\n    /**\r\n     * Last click time\r\n     * @type {Date}\r\n     */\r\n    this._lastClickTime = new Date().getTime();\r\n\r\n    /**\r\n     * Text object infos before editing\r\n     * @type {Object}\r\n     */\r\n    this._editingObjInfos = {};\r\n\r\n    /**\r\n     * Previous state of editing\r\n     * @type {boolean}\r\n     */\r\n    this.isPrevEditing = false;\r\n  }\r\n\r\n  /**\r\n   * Start input text mode\r\n   */\r\n  start() {\r\n    const canvas = this.getCanvas();\r\n\r\n    canvas.selection = false;\r\n    canvas.defaultCursor = 'text';\r\n    canvas.on({\r\n      'mouse:down': this._listeners.mousedown,\r\n      'selection:created': this._listeners.select,\r\n      'selection:updated': this._listeners.select,\r\n      'before:selection:cleared': this._listeners.selectClear,\r\n      'object:scaling': this._listeners.scaling,\r\n      'text:changed': this._listeners.textChanged,\r\n    });\r\n\r\n    canvas.forEachObject((obj) => {\r\n      if (obj.type === 'i-text') {\r\n        this.adjustOriginPosition(obj, 'start');\r\n      }\r\n    });\r\n\r\n    this.setCanvasRatio();\r\n  }\r\n\r\n  /**\r\n   * End input text mode\r\n   */\r\n  end() {\r\n    const canvas = this.getCanvas();\r\n\r\n    canvas.selection = true;\r\n    canvas.defaultCursor = 'default';\r\n\r\n    canvas.forEachObject((obj) => {\r\n      if (obj.type === 'i-text') {\r\n        if (obj.text === '') {\r\n          canvas.remove(obj);\r\n        } else {\r\n          this.adjustOriginPosition(obj, 'end');\r\n        }\r\n      }\r\n    });\r\n\r\n    canvas.off({\r\n      'mouse:down': this._listeners.mousedown,\r\n      'selection:created': this._listeners.select,\r\n      'selection:updated': this._listeners.select,\r\n      'before:selection:cleared': this._listeners.selectClear,\r\n      'object:selected': this._listeners.select,\r\n      'object:scaling': this._listeners.scaling,\r\n      'text:changed': this._listeners.textChanged,\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Adjust the origin position\r\n   * @param {fabric.Object} text - text object\r\n   * @param {string} editStatus - 'start' or 'end'\r\n   */\r\n  adjustOriginPosition(text, editStatus) {\r\n    let [originX, originY] = ['center', 'center'];\r\n    if (editStatus === 'start') {\r\n      [originX, originY] = ['left', 'top'];\r\n    }\r\n\r\n    const { x: left, y: top } = text.getPointByOrigin(originX, originY);\r\n    text.set({\r\n      left,\r\n      top,\r\n      originX,\r\n      originY,\r\n    });\r\n    text.setCoords();\r\n  }\r\n\r\n  /**\r\n   * Add new text on canvas image\r\n   * @param {string} text - Initial input text\r\n   * @param {Object} options - Options for generating text\r\n   *     @param {Object} [options.styles] Initial styles\r\n   *         @param {string} [options.styles.fill] Color\r\n   *         @param {string} [options.styles.fontFamily] Font type for text\r\n   *         @param {number} [options.styles.fontSize] Size\r\n   *         @param {string} [options.styles.fontStyle] Type of inclination (normal / italic)\r\n   *         @param {string} [options.styles.fontWeight] Type of thicker or thinner looking (normal / bold)\r\n   *         @param {string} [options.styles.textAlign] Type of text align (left / center / right)\r\n   *         @param {string} [options.styles.textDecoration] Type of line (underline / line-through / overline)\r\n   *     @param {{x: number, y: number}} [options.position] - Initial position\r\n   * @returns {Promise}\r\n   */\r\n  add(text, options) {\r\n    return new Promise((resolve) => {\r\n      const canvas = this.getCanvas();\r\n      let newText = null;\r\n      let styles = this._defaultStyles;\r\n\r\n      this._setInitPos(options.position);\r\n\r\n      if (options.styles) {\r\n        styles = snippet.extend(styles, options.styles);\r\n      }\r\n\r\n      if (!snippet.isExisty(options.autofocus)) {\r\n        options.autofocus = true;\r\n      }\r\n\r\n      newText = new fabric.IText(text, styles);\r\n      let selectionStyle = fObjectOptions.SELECTION_STYLE;\r\n      selectionStyle = snippet.extend({}, selectionStyle, {\r\n        originX: 'left',\r\n        originY: 'top',\r\n      });\r\n\r\n      newText.set(selectionStyle);\r\n      this.initialize(newText);\r\n\r\n      canvas.add(newText);\r\n\r\n      if (options.autofocus) {\r\n        newText.enterEditing();\r\n        newText.selectAll();\r\n      }\r\n\r\n      if (!canvas.getActiveObject()) {\r\n        canvas.setActiveObject(newText);\r\n      }\r\n\r\n      this.isPrevEditing = true;\r\n      resolve(this.graphics.createObjectProperties(newText));\r\n    });\r\n  }\r\n\r\n  initialize(text) {\r\n    text.on({\r\n      mouseup: this._onFabricMouseUp.bind(this),\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Change text of activate object on canvas image\r\n   * @param {Object} activeObj - Current selected text object\r\n   * @param {string} text - Changed text\r\n   * @returns {Promise}\r\n   */\r\n  change(activeObj, text) {\r\n    return new Promise((resolve) => {\r\n      activeObj.set('text', text);\r\n\r\n      this.getCanvas().renderAll();\r\n      resolve();\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Set style\r\n   * @param {Object} activeObj - Current selected text object\r\n   * @param {Object} styleObj - Initial styles\r\n   *     @param {string} [styleObj.fill] Color\r\n   *     @param {string} [styleObj.fontFamily] Font type for text\r\n   *     @param {number} [styleObj.fontSize] Size\r\n   *     @param {string} [styleObj.fontStyle] Type of inclination (normal / italic)\r\n   *     @param {string} [styleObj.fontWeight] Type of thicker or thinner looking (normal / bold)\r\n   *     @param {string} [styleObj.textAlign] Type of text align (left / center / right)\r\n   *     @param {string} [styleObj.textDecoration] Type of line (underline / line-through / overline)\r\n   * @returns {Promise}\r\n   */\r\n  setStyle(activeObj, styleObj) {\r\n    return new Promise((resolve) => {\r\n      snippet.forEach(\r\n        styleObj,\r\n        (val, key) => {\r\n          if (activeObj[key] === val && key !== 'fontSize') {\r\n            styleObj[key] = resetStyles[key] || '';\r\n          }\r\n        },\r\n        this\r\n      );\r\n\r\n      if ('textDecoration' in styleObj) {\r\n        snippet.extend(styleObj, this._getTextDecorationAdaptObject(styleObj.textDecoration));\r\n      }\r\n\r\n      activeObj.set(styleObj);\r\n\r\n      this.getCanvas().renderAll();\r\n      resolve();\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Get the text\r\n   * @param {Object} activeObj - Current selected text object\r\n   * @returns {String} text\r\n   */\r\n  getText(activeObj) {\r\n    return activeObj.text;\r\n  }\r\n\r\n  /**\r\n   * Set infos of the current selected object\r\n   * @param {fabric.Text} obj - Current selected text object\r\n   * @param {boolean} state - State of selecting\r\n   */\r\n  setSelectedInfo(obj, state) {\r\n    this._selectedObj = obj;\r\n    this._isSelected = state;\r\n  }\r\n\r\n  /**\r\n   * Whether object is selected or not\r\n   * @returns {boolean} State of selecting\r\n   */\r\n  isSelected() {\r\n    return this._isSelected;\r\n  }\r\n\r\n  /**\r\n   * Get current selected text object\r\n   * @returns {fabric.Text} Current selected text object\r\n   */\r\n  getSelectedObj() {\r\n    return this._selectedObj;\r\n  }\r\n\r\n  /**\r\n   * Set ratio value of canvas\r\n   */\r\n  setCanvasRatio() {\r\n    const canvasElement = this.getCanvasElement();\r\n    const cssWidth = parseInt(canvasElement.style.maxWidth, 10);\r\n    const originWidth = canvasElement.width;\r\n\r\n    this._ratio = originWidth / cssWidth;\r\n  }\r\n\r\n  /**\r\n   * Get ratio value of canvas\r\n   * @returns {number} Ratio value\r\n   */\r\n  getCanvasRatio() {\r\n    return this._ratio;\r\n  }\r\n\r\n  /**\r\n   * Get text decoration adapt object\r\n   * @param {string} textDecoration - text decoration option string\r\n   * @returns {object} adapt object for override\r\n   */\r\n  _getTextDecorationAdaptObject(textDecoration) {\r\n    return {\r\n      underline: textDecoration === 'underline',\r\n      linethrough: textDecoration === 'line-through',\r\n      overline: textDecoration === 'overline',\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Set initial position on canvas image\r\n   * @param {{x: number, y: number}} [position] - Selected position\r\n   * @private\r\n   */\r\n  _setInitPos(position) {\r\n    position = position || this.getCanvasImage().getCenterPoint();\r\n\r\n    this._defaultStyles.left = position.x;\r\n    this._defaultStyles.top = position.y;\r\n  }\r\n\r\n  /**\r\n   * Input event handler\r\n   * @private\r\n   */\r\n  _onInput() {\r\n    const ratio = this.getCanvasRatio();\r\n    const obj = this._editingObj;\r\n    const textareaStyle = this._textarea.style;\r\n\r\n    textareaStyle.width = `${Math.ceil(obj.width / ratio)}px`;\r\n    textareaStyle.height = `${Math.ceil(obj.height / ratio)}px`;\r\n  }\r\n\r\n  /**\r\n   * Keydown event handler\r\n   * @private\r\n   */\r\n  _onKeyDown() {\r\n    const ratio = this.getCanvasRatio();\r\n    const obj = this._editingObj;\r\n    const textareaStyle = this._textarea.style;\r\n\r\n    setTimeout(() => {\r\n      obj.text(this._textarea.value);\r\n\r\n      textareaStyle.width = `${Math.ceil(obj.width / ratio)}px`;\r\n      textareaStyle.height = `${Math.ceil(obj.height / ratio)}px`;\r\n    }, 0);\r\n  }\r\n\r\n  /**\r\n   * Blur event handler\r\n   * @private\r\n   */\r\n  _onBlur() {\r\n    const ratio = this.getCanvasRatio();\r\n    const editingObj = this._editingObj;\r\n    const editingObjInfos = this._editingObjInfos;\r\n    const textContent = this._textarea.value;\r\n    let transWidth = editingObj.width / ratio - editingObjInfos.width / ratio;\r\n    let transHeight = editingObj.height / ratio - editingObjInfos.height / ratio;\r\n\r\n    if (ratio === 1) {\r\n      transWidth /= 2;\r\n      transHeight /= 2;\r\n    }\r\n\r\n    this._textarea.style.display = 'none';\r\n\r\n    editingObj.set({\r\n      left: editingObjInfos.left + transWidth,\r\n      top: editingObjInfos.top + transHeight,\r\n    });\r\n\r\n    if (textContent.length) {\r\n      this.getCanvas().add(editingObj);\r\n\r\n      const params = {\r\n        objId: snippet.stamp(editingObj),\r\n        type: editingObj.type,\r\n        text: textContent,\r\n      };\r\n\r\n      this.fire(events.TEXT_CHANGED, params);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Scroll event handler\r\n   * @private\r\n   */\r\n  _onScroll() {\r\n    this._textarea.scrollLeft = 0;\r\n    this._textarea.scrollTop = 0;\r\n  }\r\n\r\n  /**\r\n   * Fabric scaling event handler\r\n   * @param {fabric.Event} fEvent - Current scaling event on selected object\r\n   * @private\r\n   */\r\n  _onFabricScaling(fEvent) {\r\n    const obj = fEvent.target;\r\n\r\n    obj.fontSize = obj.fontSize * obj.scaleY;\r\n    obj.scaleX = 1;\r\n    obj.scaleY = 1;\r\n  }\r\n\r\n  /**\r\n   * textChanged event handler\r\n   * @param {{target: fabric.Object}} props - changed text object\r\n   * @private\r\n   */\r\n  _onFabricTextChanged(props) {\r\n    this.fire(events.TEXT_CHANGED, props.target);\r\n  }\r\n\r\n  /**\r\n   * onSelectClear handler in fabric canvas\r\n   * @param {{target: fabric.Object, e: MouseEvent}} fEvent - Fabric event\r\n   * @private\r\n   */\r\n  _onFabricSelectClear(fEvent) {\r\n    const obj = this.getSelectedObj();\r\n\r\n    this.isPrevEditing = true;\r\n\r\n    this.setSelectedInfo(fEvent.target, false);\r\n\r\n    if (obj) {\r\n      // obj is empty object at initial time, will be set fabric object\r\n      if (obj.text === '') {\r\n        this.getCanvas().remove(obj);\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * onSelect handler in fabric canvas\r\n   * @param {{target: fabric.Object, e: MouseEvent}} fEvent - Fabric event\r\n   * @private\r\n   */\r\n  _onFabricSelect(fEvent) {\r\n    this.isPrevEditing = true;\r\n\r\n    this.setSelectedInfo(fEvent.target, true);\r\n  }\r\n\r\n  /**\r\n   * Fabric 'mousedown' event handler\r\n   * @param {fabric.Event} fEvent - Current mousedown event on selected object\r\n   * @private\r\n   */\r\n  _onFabricMouseDown(fEvent) {\r\n    const obj = fEvent.target;\r\n\r\n    if (obj && !obj.isType('text')) {\r\n      return;\r\n    }\r\n\r\n    if (this.isPrevEditing) {\r\n      this.isPrevEditing = false;\r\n\r\n      return;\r\n    }\r\n\r\n    this._fireAddText(fEvent);\r\n  }\r\n\r\n  /**\r\n   * Fire 'addText' event if object is not selected.\r\n   * @param {fabric.Event} fEvent - Current mousedown event on selected object\r\n   * @private\r\n   */\r\n  _fireAddText(fEvent) {\r\n    const obj = fEvent.target;\r\n    const e = fEvent.e || {};\r\n    const originPointer = this.getCanvas().getPointer(e);\r\n\r\n    if (!obj) {\r\n      this.fire(events.ADD_TEXT, {\r\n        originPosition: {\r\n          x: originPointer.x,\r\n          y: originPointer.y,\r\n        },\r\n        clientPosition: {\r\n          x: e.clientX || 0,\r\n          y: e.clientY || 0,\r\n        },\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Fabric mouseup event handler\r\n   * @param {fabric.Event} fEvent - Current mousedown event on selected object\r\n   * @private\r\n   */\r\n  _onFabricMouseUp(fEvent) {\r\n    const { target } = fEvent;\r\n    const newClickTime = new Date().getTime();\r\n\r\n    if (this._isDoubleClick(newClickTime) && !target.isEditing) {\r\n      target.enterEditing();\r\n    }\r\n\r\n    if (target.isEditing) {\r\n      this.fire(events.TEXT_EDITING); // fire editing text event\r\n    }\r\n\r\n    this._lastClickTime = newClickTime;\r\n  }\r\n\r\n  /**\r\n   * Get state of firing double click event\r\n   * @param {Date} newClickTime - Current clicked time\r\n   * @returns {boolean} Whether double clicked or not\r\n   * @private\r\n   */\r\n  _isDoubleClick(newClickTime) {\r\n    return newClickTime - this._lastClickTime < DBCLICK_TIME;\r\n  }\r\n}\r\n\r\nexport default Text;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Image zoom module (start zoom, end zoom)\r\n */\r\nimport fabric from 'fabric';\r\nimport Component from '@/interface/component';\r\nimport { clamp } from '@/util';\r\nimport { componentNames, eventNames, keyCodes, zoomModes } from '@/consts';\r\n\r\nconst MOUSE_MOVE_THRESHOLD = 10;\r\nconst DEFAULT_SCROLL_OPTION = {\r\n  left: 0,\r\n  top: 0,\r\n  width: 0,\r\n  height: 0,\r\n  stroke: '#000000',\r\n  strokeWidth: 0,\r\n  fill: '#000000',\r\n  opacity: 0.4,\r\n  evented: false,\r\n  selectable: false,\r\n  hoverCursor: 'auto',\r\n};\r\nconst DEFAULT_VERTICAL_SCROLL_RATIO = {\r\n  SIZE: 0.0045,\r\n  MARGIN: 0.003,\r\n  BORDER_RADIUS: 0.003,\r\n};\r\nconst DEFAULT_HORIZONTAL_SCROLL_RATIO = {\r\n  SIZE: 0.0066,\r\n  MARGIN: 0.0044,\r\n  BORDER_RADIUS: 0.003,\r\n};\r\nconst DEFAULT_ZOOM_LEVEL = 1.0;\r\nconst {\r\n  ZOOM_CHANGED,\r\n  ADD_TEXT,\r\n  TEXT_EDITING,\r\n  OBJECT_MODIFIED,\r\n  KEY_DOWN,\r\n  KEY_UP,\r\n  HAND_STARTED,\r\n  HAND_STOPPED,\r\n} = eventNames;\r\n\r\n/**\r\n * Zoom components\r\n * @param {Graphics} graphics - Graphics instance\r\n * @extends {Component}\r\n * @class Zoom\r\n * @ignore\r\n */\r\nclass Zoom extends Component {\r\n  constructor(graphics) {\r\n    super(componentNames.ZOOM, graphics);\r\n\r\n    /**\r\n     * zoomArea\r\n     * @type {?fabric.Rect}\r\n     * @private\r\n     */\r\n    this.zoomArea = null;\r\n\r\n    /**\r\n     * Start point of zoom area\r\n     * @type {?{x: number, y: number}}\r\n     */\r\n    this._startPoint = null;\r\n\r\n    /**\r\n     * Center point of every zoom\r\n     * @type {Array.<{prevZoomLevel: number, zoomLevel: number, x: number, y: number}>}\r\n     */\r\n    this._centerPoints = [];\r\n\r\n    /**\r\n     * Zoom level (default: 100%(1.0), max: 400%(4.0))\r\n     * @type {number}\r\n     */\r\n    this.zoomLevel = DEFAULT_ZOOM_LEVEL;\r\n\r\n    /**\r\n     * Zoom mode ('normal', 'zoom', 'hand')\r\n     * @type {string}\r\n     */\r\n    this.zoomMode = zoomModes.DEFAULT;\r\n\r\n    /**\r\n     * Listeners\r\n     * @type {Object.<string, Function>}\r\n     * @private\r\n     */\r\n    this._listeners = {\r\n      startZoom: this._onMouseDownWithZoomMode.bind(this),\r\n      moveZoom: this._onMouseMoveWithZoomMode.bind(this),\r\n      stopZoom: this._onMouseUpWithZoomMode.bind(this),\r\n      startHand: this._onMouseDownWithHandMode.bind(this),\r\n      moveHand: this._onMouseMoveWithHandMode.bind(this),\r\n      stopHand: this._onMouseUpWithHandMode.bind(this),\r\n      zoomChanged: this._changeScrollState.bind(this),\r\n      keydown: this._startHandModeWithSpaceBar.bind(this),\r\n      keyup: this._endHandModeWithSpaceBar.bind(this),\r\n    };\r\n\r\n    const canvas = this.getCanvas();\r\n\r\n    /**\r\n     * Width:Height ratio (ex. width=1.5, height=1 -> aspectRatio=1.5)\r\n     * @private\r\n     */\r\n    this.aspectRatio = canvas.width / canvas.height;\r\n\r\n    /**\r\n     * vertical scroll bar\r\n     * @type {fabric.Rect}\r\n     * @private\r\n     */\r\n    this._verticalScroll = new fabric.Rect(DEFAULT_SCROLL_OPTION);\r\n\r\n    /**\r\n     * horizontal scroll bar\r\n     * @type {fabric.Rect}\r\n     * @private\r\n     */\r\n    this._horizontalScroll = new fabric.Rect(DEFAULT_SCROLL_OPTION);\r\n\r\n    canvas.on(ZOOM_CHANGED, this._listeners.zoomChanged);\r\n\r\n    this.graphics.on(ADD_TEXT, this._startTextEditingHandler.bind(this));\r\n    this.graphics.on(TEXT_EDITING, this._startTextEditingHandler.bind(this));\r\n    this.graphics.on(OBJECT_MODIFIED, this._stopTextEditingHandler.bind(this));\r\n  }\r\n\r\n  /**\r\n   * Attach zoom keyboard events\r\n   */\r\n  attachKeyboardZoomEvents() {\r\n    fabric.util.addListener(document, KEY_DOWN, this._listeners.keydown);\r\n    fabric.util.addListener(document, KEY_UP, this._listeners.keyup);\r\n  }\r\n\r\n  /**\r\n   * Detach zoom keyboard events\r\n   */\r\n  detachKeyboardZoomEvents() {\r\n    fabric.util.removeListener(document, KEY_DOWN, this._listeners.keydown);\r\n    fabric.util.removeListener(document, KEY_UP, this._listeners.keyup);\r\n  }\r\n\r\n  /**\r\n   * Handler when you started editing text\r\n   * @private\r\n   */\r\n  _startTextEditingHandler() {\r\n    this.isTextEditing = true;\r\n  }\r\n\r\n  /**\r\n   * Handler when you stopped editing text\r\n   * @private\r\n   */\r\n  _stopTextEditingHandler() {\r\n    this.isTextEditing = false;\r\n  }\r\n\r\n  /**\r\n   * Handler who turns on hand mode when the space bar is down\r\n   * @param {KeyboardEvent} e - Event object\r\n   * @private\r\n   */\r\n  _startHandModeWithSpaceBar(e) {\r\n    if (this.withSpace || this.isTextEditing) {\r\n      return;\r\n    }\r\n\r\n    if (e.keyCode === keyCodes.SPACE) {\r\n      this.withSpace = true;\r\n      this.startHandMode();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Handler who turns off hand mode when space bar is up\r\n   * @param {KeyboardEvent} e - Event object\r\n   * @private\r\n   */\r\n  _endHandModeWithSpaceBar(e) {\r\n    if (e.keyCode === keyCodes.SPACE) {\r\n      this.withSpace = false;\r\n      this.endHandMode();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Start zoom-in mode\r\n   */\r\n  startZoomInMode() {\r\n    if (this.zoomArea) {\r\n      return;\r\n    }\r\n    this.endHandMode();\r\n    this.zoomMode = zoomModes.ZOOM;\r\n\r\n    const canvas = this.getCanvas();\r\n\r\n    this._changeObjectsEventedState(false);\r\n\r\n    this.zoomArea = new fabric.Rect({\r\n      left: 0,\r\n      top: 0,\r\n      width: 0.5,\r\n      height: 0.5,\r\n      stroke: 'black',\r\n      strokeWidth: 1,\r\n      fill: 'transparent',\r\n      hoverCursor: 'zoom-in',\r\n    });\r\n\r\n    canvas.discardActiveObject();\r\n    canvas.add(this.zoomArea);\r\n    canvas.on('mouse:down', this._listeners.startZoom);\r\n    canvas.selection = false;\r\n    canvas.defaultCursor = 'zoom-in';\r\n  }\r\n\r\n  /**\r\n   * End zoom-in mode\r\n   */\r\n  endZoomInMode() {\r\n    this.zoomMode = zoomModes.DEFAULT;\r\n\r\n    const canvas = this.getCanvas();\r\n    const { startZoom, moveZoom, stopZoom } = this._listeners;\r\n\r\n    canvas.selection = true;\r\n    canvas.defaultCursor = 'auto';\r\n    canvas.off({\r\n      'mouse:down': startZoom,\r\n      'mouse:move': moveZoom,\r\n      'mouse:up': stopZoom,\r\n    });\r\n\r\n    this._changeObjectsEventedState(true);\r\n\r\n    canvas.remove(this.zoomArea);\r\n    this.zoomArea = null;\r\n  }\r\n\r\n  /**\r\n   * Start zoom drawing mode\r\n   */\r\n  start() {\r\n    this.zoomArea = null;\r\n    this._startPoint = null;\r\n    this._startHandPoint = null;\r\n  }\r\n\r\n  /**\r\n   * Stop zoom drawing mode\r\n   */\r\n  end() {\r\n    this.endZoomInMode();\r\n    this.endHandMode();\r\n  }\r\n\r\n  /**\r\n   * Start hand mode\r\n   */\r\n  startHandMode() {\r\n    this.endZoomInMode();\r\n    this.zoomMode = zoomModes.HAND;\r\n\r\n    const canvas = this.getCanvas();\r\n\r\n    this._changeObjectsEventedState(false);\r\n\r\n    canvas.discardActiveObject();\r\n    canvas.off('mouse:down', this._listeners.startHand);\r\n    canvas.on('mouse:down', this._listeners.startHand);\r\n    canvas.selection = false;\r\n    canvas.defaultCursor = 'grab';\r\n\r\n    canvas.fire(HAND_STARTED);\r\n  }\r\n\r\n  /**\r\n   * Stop hand mode\r\n   */\r\n  endHandMode() {\r\n    this.zoomMode = zoomModes.DEFAULT;\r\n    const canvas = this.getCanvas();\r\n\r\n    this._changeObjectsEventedState(true);\r\n\r\n    canvas.off('mouse:down', this._listeners.startHand);\r\n    canvas.selection = true;\r\n    canvas.defaultCursor = 'auto';\r\n\r\n    this._startHandPoint = null;\r\n\r\n    canvas.fire(HAND_STOPPED);\r\n  }\r\n\r\n  /**\r\n   * onMousedown handler in fabric canvas\r\n   * @param {{target: fabric.Object, e: MouseEvent}} fEvent - Fabric event\r\n   * @private\r\n   */\r\n  _onMouseDownWithZoomMode({ target, e }) {\r\n    if (target) {\r\n      return;\r\n    }\r\n\r\n    const canvas = this.getCanvas();\r\n\r\n    canvas.selection = false;\r\n\r\n    this._startPoint = canvas.getPointer(e);\r\n    this.zoomArea.set({ width: 0, height: 0 });\r\n\r\n    const { moveZoom, stopZoom } = this._listeners;\r\n    canvas.on({\r\n      'mouse:move': moveZoom,\r\n      'mouse:up': stopZoom,\r\n    });\r\n  }\r\n\r\n  /**\r\n   * onMousemove handler in fabric canvas\r\n   * @param {{e: MouseEvent}} fEvent - Fabric event\r\n   * @private\r\n   */\r\n  _onMouseMoveWithZoomMode({ e }) {\r\n    const canvas = this.getCanvas();\r\n    const pointer = canvas.getPointer(e);\r\n    const { x, y } = pointer;\r\n    const { zoomArea, _startPoint } = this;\r\n    const deltaX = Math.abs(x - _startPoint.x);\r\n    const deltaY = Math.abs(y - _startPoint.y);\r\n\r\n    if (deltaX + deltaY > MOUSE_MOVE_THRESHOLD) {\r\n      canvas.remove(zoomArea);\r\n      zoomArea.set(this._calcRectDimensionFromPoint(x, y));\r\n      canvas.add(zoomArea);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get rect dimension setting from Canvas-Mouse-Position(x, y)\r\n   * @param {number} x - Canvas-Mouse-Position x\r\n   * @param {number} y - Canvas-Mouse-Position Y\r\n   * @returns {{left: number, top: number, width: number, height: number}}\r\n   * @private\r\n   */\r\n  _calcRectDimensionFromPoint(x, y) {\r\n    const canvas = this.getCanvas();\r\n    const canvasWidth = canvas.getWidth();\r\n    const canvasHeight = canvas.getHeight();\r\n    const { x: startX, y: startY } = this._startPoint;\r\n    const { min } = Math;\r\n\r\n    const left = min(startX, x);\r\n    const top = min(startY, y);\r\n    const width = clamp(x, startX, canvasWidth) - left; // (startX <= x(mouse) <= canvasWidth) - left\r\n    const height = clamp(y, startY, canvasHeight) - top; // (startY <= y(mouse) <= canvasHeight) - top\r\n\r\n    return { left, top, width, height };\r\n  }\r\n\r\n  /**\r\n   * onMouseup handler in fabric canvas\r\n   * @private\r\n   */\r\n  _onMouseUpWithZoomMode() {\r\n    let { zoomLevel } = this;\r\n    const { zoomArea } = this;\r\n    const { moveZoom, stopZoom } = this._listeners;\r\n    const canvas = this.getCanvas();\r\n    const center = this._getCenterPoint();\r\n    const { x, y } = center;\r\n\r\n    if (!this._isMaxZoomLevel()) {\r\n      this._centerPoints.push({\r\n        x,\r\n        y,\r\n        prevZoomLevel: zoomLevel,\r\n        zoomLevel: zoomLevel + 1,\r\n      });\r\n      zoomLevel += 1;\r\n      canvas.zoomToPoint({ x, y }, zoomLevel);\r\n\r\n      this._fireZoomChanged(canvas, zoomLevel);\r\n\r\n      this.zoomLevel = zoomLevel;\r\n    }\r\n\r\n    canvas.off({\r\n      'mouse:move': moveZoom,\r\n      'mouse:up': stopZoom,\r\n    });\r\n\r\n    canvas.remove(zoomArea);\r\n    this._startPoint = null;\r\n  }\r\n\r\n  /**\r\n   * Get center point\r\n   * @returns {{x: number, y: number}}\r\n   * @private\r\n   */\r\n  _getCenterPoint() {\r\n    const { left, top, width, height } = this.zoomArea;\r\n    const { x, y } = this._startPoint;\r\n    const { aspectRatio } = this;\r\n\r\n    if (width < MOUSE_MOVE_THRESHOLD && height < MOUSE_MOVE_THRESHOLD) {\r\n      return { x, y };\r\n    }\r\n\r\n    return width > height\r\n      ? { x: left + (aspectRatio * height) / 2, y: top + height / 2 }\r\n      : { x: left + width / 2, y: top + width / aspectRatio / 2 };\r\n  }\r\n\r\n  /**\r\n   * Zoom the canvas\r\n   * @param {{x: number, y: number}} center - center of zoom\r\n   * @param {?number} zoomLevel - zoom level\r\n   */\r\n  zoom({ x, y }, zoomLevel = this.zoomLevel) {\r\n    const canvas = this.getCanvas();\r\n    const centerPoints = this._centerPoints;\r\n\r\n    for (let i = centerPoints.length - 1; i >= 0; i -= 1) {\r\n      if (centerPoints[i].zoomLevel < zoomLevel) {\r\n        break;\r\n      }\r\n\r\n      const { x: prevX, y: prevY, prevZoomLevel } = centerPoints.pop();\r\n\r\n      canvas.zoomToPoint({ x: prevX, y: prevY }, prevZoomLevel);\r\n      this.zoomLevel = prevZoomLevel;\r\n    }\r\n\r\n    canvas.zoomToPoint({ x, y }, zoomLevel);\r\n    if (!this._isDefaultZoomLevel(zoomLevel)) {\r\n      this._centerPoints.push({\r\n        x,\r\n        y,\r\n        zoomLevel,\r\n        prevZoomLevel: this.zoomLevel,\r\n      });\r\n    }\r\n    this.zoomLevel = zoomLevel;\r\n\r\n    this._fireZoomChanged(canvas, zoomLevel);\r\n  }\r\n\r\n  /**\r\n   * Zoom out one step\r\n   */\r\n  zoomOut() {\r\n    const centerPoints = this._centerPoints;\r\n\r\n    if (!centerPoints.length) {\r\n      return;\r\n    }\r\n\r\n    const canvas = this.getCanvas();\r\n    const point = centerPoints.pop();\r\n    const { x, y, prevZoomLevel } = point;\r\n\r\n    if (this._isDefaultZoomLevel(prevZoomLevel)) {\r\n      canvas.setViewportTransform([1, 0, 0, 1, 0, 0]);\r\n    } else {\r\n      canvas.zoomToPoint({ x, y }, prevZoomLevel);\r\n    }\r\n\r\n    this.zoomLevel = prevZoomLevel;\r\n\r\n    this._fireZoomChanged(canvas, this.zoomLevel);\r\n  }\r\n\r\n  /**\r\n   * Zoom reset\r\n   */\r\n  resetZoom() {\r\n    const canvas = this.getCanvas();\r\n\r\n    canvas.setViewportTransform([1, 0, 0, 1, 0, 0]);\r\n\r\n    this.zoomLevel = DEFAULT_ZOOM_LEVEL;\r\n    this._centerPoints = [];\r\n\r\n    this._fireZoomChanged(canvas, this.zoomLevel);\r\n  }\r\n\r\n  /**\r\n   * Whether zoom level is max (5.0)\r\n   * @returns {boolean}\r\n   * @private\r\n   */\r\n  _isMaxZoomLevel() {\r\n    return this.zoomLevel >= 5.0;\r\n  }\r\n\r\n  /**\r\n   * Move point of zoom\r\n   * @param {{x: number, y: number}} delta - move amount\r\n   * @private\r\n   */\r\n  _movePointOfZoom({ x: deltaX, y: deltaY }) {\r\n    const centerPoints = this._centerPoints;\r\n\r\n    if (!centerPoints.length) {\r\n      return;\r\n    }\r\n\r\n    const canvas = this.getCanvas();\r\n    const { zoomLevel } = this;\r\n\r\n    const point = centerPoints.pop();\r\n    const { x: originX, y: originY, prevZoomLevel } = point;\r\n    const x = originX - deltaX;\r\n    const y = originY - deltaY;\r\n\r\n    canvas.zoomToPoint({ x: originX, y: originY }, prevZoomLevel);\r\n    canvas.zoomToPoint({ x, y }, zoomLevel);\r\n    centerPoints.push({ x, y, prevZoomLevel, zoomLevel });\r\n\r\n    this._fireZoomChanged(canvas, zoomLevel);\r\n  }\r\n\r\n  /**\r\n   * onMouseDown handler in fabric canvas\r\n   * @param {{target: fabric.Object, e: MouseEvent}} fEvent - Fabric event\r\n   * @private\r\n   */\r\n  _onMouseDownWithHandMode({ target, e }) {\r\n    if (target) {\r\n      return;\r\n    }\r\n\r\n    const canvas = this.getCanvas();\r\n\r\n    if (this.zoomLevel <= DEFAULT_ZOOM_LEVEL) {\r\n      return;\r\n    }\r\n\r\n    canvas.selection = false;\r\n\r\n    this._startHandPoint = canvas.getPointer(e);\r\n\r\n    const { moveHand, stopHand } = this._listeners;\r\n    canvas.on({\r\n      'mouse:move': moveHand,\r\n      'mouse:up': stopHand,\r\n    });\r\n  }\r\n\r\n  /**\r\n   * onMouseMove handler in fabric canvas\r\n   * @param {{e: MouseEvent}} fEvent - Fabric event\r\n   * @private\r\n   */\r\n  _onMouseMoveWithHandMode({ e }) {\r\n    const canvas = this.getCanvas();\r\n    const { x, y } = canvas.getPointer(e);\r\n    const deltaX = x - this._startHandPoint.x;\r\n    const deltaY = y - this._startHandPoint.y;\r\n\r\n    this._movePointOfZoom({ x: deltaX, y: deltaY });\r\n  }\r\n\r\n  /**\r\n   * onMouseUp handler in fabric canvas\r\n   * @private\r\n   */\r\n  _onMouseUpWithHandMode() {\r\n    const canvas = this.getCanvas();\r\n    const { moveHand, stopHand } = this._listeners;\r\n\r\n    canvas.off({\r\n      'mouse:move': moveHand,\r\n      'mouse:up': stopHand,\r\n    });\r\n\r\n    this._startHandPoint = null;\r\n  }\r\n\r\n  /**\r\n   * onChangeZoom handler in fabric canvas\r\n   * @private\r\n   */\r\n  _changeScrollState({ viewport, zoomLevel }) {\r\n    const canvas = this.getCanvas();\r\n\r\n    canvas.remove(this._verticalScroll);\r\n    canvas.remove(this._horizontalScroll);\r\n\r\n    if (this._isDefaultZoomLevel(zoomLevel)) {\r\n      return;\r\n    }\r\n\r\n    const canvasWidth = canvas.width;\r\n    const canvasHeight = canvas.height;\r\n\r\n    const { tl, tr, bl } = viewport;\r\n    const viewportWidth = tr.x - tl.x;\r\n    const viewportHeight = bl.y - tl.y;\r\n\r\n    const horizontalScrollWidth = (viewportWidth * viewportWidth) / canvasWidth;\r\n    const horizontalScrollHeight = viewportHeight * DEFAULT_HORIZONTAL_SCROLL_RATIO.SIZE;\r\n    const horizontalScrollLeft = clamp(\r\n      tl.x + (tl.x / canvasWidth) * viewportWidth,\r\n      tl.x,\r\n      tr.x - horizontalScrollWidth\r\n    );\r\n    const horizontalScrollMargin = viewportHeight * DEFAULT_HORIZONTAL_SCROLL_RATIO.MARGIN;\r\n    const horizontalScrollBorderRadius =\r\n      viewportHeight * DEFAULT_HORIZONTAL_SCROLL_RATIO.BORDER_RADIUS;\r\n\r\n    this._horizontalScroll.set({\r\n      left: horizontalScrollLeft,\r\n      top: bl.y - horizontalScrollHeight - horizontalScrollMargin,\r\n      width: horizontalScrollWidth,\r\n      height: horizontalScrollHeight,\r\n      rx: horizontalScrollBorderRadius,\r\n      ry: horizontalScrollBorderRadius,\r\n    });\r\n\r\n    const verticalScrollWidth = viewportWidth * DEFAULT_VERTICAL_SCROLL_RATIO.SIZE;\r\n    const verticalScrollHeight = (viewportHeight * viewportHeight) / canvasHeight;\r\n    const verticalScrollTop = clamp(\r\n      tl.y + (tl.y / canvasHeight) * viewportHeight,\r\n      tr.y,\r\n      bl.y - verticalScrollHeight\r\n    );\r\n    const verticalScrollMargin = viewportWidth * DEFAULT_VERTICAL_SCROLL_RATIO.MARGIN;\r\n    const verticalScrollBorderRadius = viewportWidth * DEFAULT_VERTICAL_SCROLL_RATIO.BORDER_RADIUS;\r\n\r\n    this._verticalScroll.set({\r\n      left: tr.x - verticalScrollWidth - verticalScrollMargin,\r\n      top: verticalScrollTop,\r\n      width: verticalScrollWidth,\r\n      height: verticalScrollHeight,\r\n      rx: verticalScrollBorderRadius,\r\n      ry: verticalScrollBorderRadius,\r\n    });\r\n\r\n    this._addScrollBar();\r\n  }\r\n\r\n  /**\r\n   * Change objects 'evented' state\r\n   * @param {boolean} [evented=true] - objects 'evented' state\r\n   */\r\n  _changeObjectsEventedState(evented = true) {\r\n    const canvas = this.getCanvas();\r\n\r\n    canvas.forEachObject((obj) => {\r\n      // {@link http://fabricjs.com/docs/fabric.Object.html#evented}\r\n      obj.evented = evented;\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Add scroll bar and set remove timer\r\n   */\r\n  _addScrollBar() {\r\n    const canvas = this.getCanvas();\r\n\r\n    canvas.add(this._horizontalScroll);\r\n    canvas.add(this._verticalScroll);\r\n\r\n    if (this.scrollBarTid) {\r\n      clearTimeout(this.scrollBarTid);\r\n    }\r\n\r\n    this.scrollBarTid = setTimeout(() => {\r\n      canvas.remove(this._horizontalScroll);\r\n      canvas.remove(this._verticalScroll);\r\n    }, 3000);\r\n  }\r\n\r\n  /**\r\n   * Check zoom level is default zoom level (1.0)\r\n   * @param {number} zoomLevel - zoom level\r\n   * @returns {boolean} - whether zoom level is 1.0\r\n   */\r\n  _isDefaultZoomLevel(zoomLevel) {\r\n    return zoomLevel === DEFAULT_ZOOM_LEVEL;\r\n  }\r\n\r\n  /**\r\n   * Fire 'zoomChanged' event\r\n   * @param {fabric.Canvas} canvas - fabric canvas\r\n   * @param {number} zoomLevel - 'zoomChanged' event params\r\n   */\r\n  _fireZoomChanged(canvas, zoomLevel) {\r\n    canvas.fire(ZOOM_CHANGED, { viewport: canvas.calcViewportBoundaries(), zoomLevel });\r\n  }\r\n\r\n  /**\r\n   * Get zoom mode\r\n   */\r\n  get mode() {\r\n    return this.zoomMode;\r\n  }\r\n}\r\n\r\nexport default Zoom;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Constants\r\n */\r\nimport { keyMirror } from '@/util';\r\n\r\n/**\r\n * Help features for zoom\r\n * @type {Array.<string>}\r\n */\r\nexport const ZOOM_HELP_MENUS = ['zoomIn', 'zoomOut', 'hand'];\r\n\r\n/**\r\n * Help features for command\r\n * @type {Array.<string>}\r\n */\r\nexport const COMMAND_HELP_MENUS = ['history', 'undo', 'redo', 'reset'];\r\n\r\n/**\r\n * Help features for delete\r\n * @type {Array.<string>}\r\n */\r\nexport const DELETE_HELP_MENUS = ['delete', 'deleteAll'];\r\n\r\n/**\r\n * Editor help features\r\n * @type {Array.<string>}\r\n */\r\nexport const HELP_MENUS = [...ZOOM_HELP_MENUS, ...COMMAND_HELP_MENUS, ...DELETE_HELP_MENUS];\r\n\r\n/**\r\n * Fill type for shape\r\n * @type {Object.<string, string>}\r\n */\r\nexport const SHAPE_FILL_TYPE = {\r\n  FILTER: 'filter',\r\n  COLOR: 'color',\r\n};\r\n\r\n/**\r\n * Shape type list\r\n * @type {Array.<string>}\r\n */\r\nexport const SHAPE_TYPE = ['rect', 'circle', 'triangle'];\r\n\r\n/**\r\n * Object type\r\n * @type {Object.<string, string>}\r\n */\r\nexport const OBJ_TYPE = {\r\n  CROPZONE: 'cropzone',\r\n};\r\n\r\n/**\r\n * Filter type map\r\n * @type {Object.<string, string>}\r\n */\r\nexport const filterType = {\r\n  VINTAGE: 'vintage',\r\n  SEPIA2: 'sepia2',\r\n  REMOVE_COLOR: 'removeColor',\r\n  COLOR_FILTER: 'colorFilter',\r\n  REMOVE_WHITE: 'removeWhite',\r\n  BLEND_COLOR: 'blendColor',\r\n  BLEND: 'blend',\r\n};\r\n\r\n/**\r\n * Component names\r\n * @type {Object.<string, string>}\r\n */\r\nexport const componentNames = keyMirror(\r\n  'IMAGE_LOADER',\r\n  'JSON_LOADER',\r\n  'CROPPER',\r\n  'FLIP',\r\n  'ROTATION',\r\n  'FREE_DRAWING',\r\n  'LINE',\r\n  'TEXT',\r\n  'ICON',\r\n  'FILTER',\r\n  'SHAPE',\r\n  'ZOOM',\r\n  'RESIZE'\r\n);\r\n\r\n/**\r\n * Shape default option\r\n * @type {Object}\r\n */\r\nexport const SHAPE_DEFAULT_OPTIONS = {\r\n  lockSkewingX: true,\r\n  lockSkewingY: true,\r\n  bringForward: true,\r\n  isRegular: false,\r\n};\r\n\r\n/**\r\n * Cropzone default option\r\n * @type {Object}\r\n */\r\nexport const CROPZONE_DEFAULT_OPTIONS = {\r\n  hasRotatingPoint: false,\r\n  hasBorders: false,\r\n  lockScalingFlip: true,\r\n  lockRotation: true,\r\n  lockSkewingX: true,\r\n  lockSkewingY: true,\r\n};\r\n\r\n/**\r\n * Command names\r\n * @type {Object.<string, string>}\r\n */\r\nexport const commandNames = {\r\n  CLEAR_OBJECTS: 'clearObjects',\r\n  LOAD_IMAGE: 'loadImage',\r\n  LOAD_JSON: 'loadJson',\r\n  FLIP_IMAGE: 'flip',\r\n  ROTATE_IMAGE: 'rotate',\r\n  ADD_OBJECT: 'addObject',\r\n  REMOVE_OBJECT: 'removeObject',\r\n  APPLY_FILTER: 'applyFilter',\r\n  REMOVE_FILTER: 'removeFilter',\r\n  ADD_ICON: 'addIcon',\r\n  CHANGE_ICON_COLOR: 'changeIconColor',\r\n  ADD_SHAPE: 'addShape',\r\n  CHANGE_SHAPE: 'changeShape',\r\n  ADD_TEXT: 'addText',\r\n  CHANGE_TEXT: 'changeText',\r\n  CHANGE_TEXT_STYLE: 'changeTextStyle',\r\n  ADD_IMAGE_OBJECT: 'addImageObject',\r\n  RESIZE_CANVAS_DIMENSION: 'resizeCanvasDimension',\r\n  SET_OBJECT_PROPERTIES: 'setObjectProperties',\r\n  SET_OBJECT_POSITION: 'setObjectPosition',\r\n  CHANGE_SELECTION: 'changeSelection',\r\n  RESIZE_IMAGE: 'resize',\r\n};\r\n\r\n/**\r\n * Event names\r\n * @type {Object.<string, string>}\r\n */\r\nexport const eventNames = {\r\n  OBJECT_ACTIVATED: 'objectActivated',\r\n  OBJECT_MOVED: 'objectMoved',\r\n  OBJECT_SCALED: 'objectScaled',\r\n  OBJECT_CREATED: 'objectCreated',\r\n  OBJECT_ROTATED: 'objectRotated',\r\n  OBJECT_ADDED: 'objectAdded',\r\n  OBJECT_MODIFIED: 'objectModified',\r\n  TEXT_EDITING: 'textEditing',\r\n  TEXT_CHANGED: 'textChanged',\r\n  ICON_CREATE_RESIZE: 'iconCreateResize',\r\n  ICON_CREATE_END: 'iconCreateEnd',\r\n  ADD_TEXT: 'addText',\r\n  ADD_OBJECT: 'addObject',\r\n  ADD_OBJECT_AFTER: 'addObjectAfter',\r\n  MOUSE_DOWN: 'mousedown',\r\n  MOUSE_UP: 'mouseup',\r\n  MOUSE_MOVE: 'mousemove',\r\n  MOUSE_WHEEL: 'mousewheel',\r\n  // UNDO/REDO Events\r\n  REDO_STACK_CHANGED: 'redoStackChanged',\r\n  UNDO_STACK_CHANGED: 'undoStackChanged',\r\n  SELECTION_CLEARED: 'selectionCleared',\r\n  SELECTION_CREATED: 'selectionCreated',\r\n  EXECUTE_COMMAND: 'executeCommand',\r\n  AFTER_UNDO: 'afterUndo',\r\n  AFTER_REDO: 'afterRedo',\r\n  ZOOM_CHANGED: 'zoomChanged',\r\n  HAND_STARTED: 'handStarted',\r\n  HAND_STOPPED: 'handStopped',\r\n  KEY_DOWN: 'keydown',\r\n  KEY_UP: 'keyup',\r\n  INPUT_BOX_EDITING_STARTED: 'inputBoxEditingStarted',\r\n  INPUT_BOX_EDITING_STOPPED: 'inputBoxEditingStopped',\r\n  FOCUS: 'focus',\r\n  BLUR: 'blur',\r\n  IMAGE_RESIZED: 'imageResized',\r\n};\r\n\r\n/**\r\n * Selector names\r\n * @type {Object.<string, string>}\r\n */\r\nexport const selectorNames = {\r\n  COLOR_PICKER_INPUT_BOX: '.tui-colorpicker-palette-hex',\r\n};\r\n\r\n/**\r\n * History names\r\n * @type {Object.<string, string>}\r\n */\r\nexport const historyNames = {\r\n  LOAD_IMAGE: 'Load',\r\n  LOAD_JSON: 'Load Json',\r\n  LOAD_MASK_IMAGE: 'Mask',\r\n  ADD_MASK_IMAGE: 'Mask',\r\n  ADD_IMAGE_OBJECT: 'Mask',\r\n  CROP: 'Crop',\r\n  RESIZE: 'Resize',\r\n  APPLY_FILTER: 'Filter',\r\n  REMOVE_FILTER: 'Filter',\r\n  CHANGE_SHAPE: 'Shape',\r\n  CHANGE_ICON_COLOR: 'Icon',\r\n  ADD_TEXT: 'Text',\r\n  CHANGE_TEXT_STYLE: 'Text',\r\n  REMOVE_OBJECT: 'Delete',\r\n  CLEAR_OBJECTS: 'Delete',\r\n};\r\n\r\n/**\r\n * Editor states\r\n * @type {Object.<string, string>}\r\n */\r\nexport const drawingModes = keyMirror(\r\n  'NORMAL',\r\n  'CROPPER',\r\n  'FREE_DRAWING',\r\n  'LINE_DRAWING',\r\n  'TEXT',\r\n  'SHAPE',\r\n  'ICON',\r\n  'ZOOM',\r\n  'RESIZE'\r\n);\r\n\r\n/**\r\n * Menu names with drawing mode\r\n * @type {Object.<string, string>}\r\n */\r\nexport const drawingMenuNames = {\r\n  TEXT: 'text',\r\n  CROP: 'crop',\r\n  RESIZE: 'resize',\r\n  SHAPE: 'shape',\r\n  ZOOM: 'zoom',\r\n};\r\n\r\n/**\r\n * Zoom modes\r\n * @type {Object.<string, string>}\r\n */\r\nexport const zoomModes = {\r\n  DEFAULT: 'normal',\r\n  ZOOM: 'zoom',\r\n  HAND: 'hand',\r\n};\r\n\r\n/**\r\n * Shortcut key values\r\n * @type {Object.<string, number>}\r\n */\r\nexport const keyCodes = {\r\n  Z: 90,\r\n  Y: 89,\r\n  C: 67,\r\n  V: 86,\r\n  SHIFT: 16,\r\n  BACKSPACE: 8,\r\n  DEL: 46,\r\n  ARROW_DOWN: 40,\r\n  ARROW_UP: 38,\r\n  SPACE: 32,\r\n};\r\n\r\n/**\r\n * Fabric object options\r\n * @type {Object.<string, Object>}\r\n */\r\nexport const fObjectOptions = {\r\n  SELECTION_STYLE: {\r\n    borderColor: 'red',\r\n    cornerColor: 'green',\r\n    cornerSize: 10,\r\n    originX: 'center',\r\n    originY: 'center',\r\n    transparentCorners: false,\r\n  },\r\n};\r\n\r\n/**\r\n * Promise reject messages\r\n * @type {Object.<string, string>}\r\n */\r\nexport const rejectMessages = {\r\n  addedObject: 'The object is already added.',\r\n  flip: 'The flipX and flipY setting values are not changed.',\r\n  invalidDrawingMode: 'This operation is not supported in the drawing mode.',\r\n  invalidParameters: 'Invalid parameters.',\r\n  isLock: 'The executing command state is locked.',\r\n  loadImage: 'The background image is empty.',\r\n  loadJson: 'The JSON is invalid',\r\n  loadingImageFailed: 'Invalid image loaded.',\r\n  noActiveObject: 'There is no active object.',\r\n  noObject: 'The object is not in canvas.',\r\n  redo: 'The promise of redo command is reject.',\r\n  rotation: 'The current angle is same the old angle.',\r\n  undo: 'The promise of undo command is reject.',\r\n  unsupportedOperation: 'Unsupported operation.',\r\n  unsupportedType: 'Unsupported object type.',\r\n};\r\n\r\n/**\r\n * Default icon menu svg path\r\n * @type {Object.<string, string>}\r\n */\r\nexport const defaultIconPath = {\r\n  'icon-arrow': 'M40 12V0l24 24-24 24V36H0V12h40z',\r\n  'icon-arrow-2': 'M49,32 H3 V22 h46 l-18,-18 h12 l23,23 L43,50 h-12 l18,-18  z ',\r\n  'icon-arrow-3':\r\n    'M43.349998,27 L17.354,53 H1.949999 l25.996,-26 L1.949999,1 h15.404 L43.349998,27  z ',\r\n  'icon-star':\r\n    'M35,54.557999 l-19.912001,10.468 l3.804,-22.172001 l-16.108,-15.7 l22.26,-3.236 L35,3.746 l9.956,20.172001 l22.26,3.236 l-16.108,15.7 l3.804,22.172001  z ',\r\n  'icon-star-2':\r\n    'M17,31.212 l-7.194,4.08 l-4.728,-6.83 l-8.234,0.524 l-1.328,-8.226 l-7.644,-3.14 l2.338,-7.992 l-5.54,-6.18 l5.54,-6.176 l-2.338,-7.994 l7.644,-3.138 l1.328,-8.226 l8.234,0.522 l4.728,-6.83 L17,-24.312 l7.194,-4.08 l4.728,6.83 l8.234,-0.522 l1.328,8.226 l7.644,3.14 l-2.338,7.992 l5.54,6.178 l-5.54,6.178 l2.338,7.992 l-7.644,3.14 l-1.328,8.226 l-8.234,-0.524 l-4.728,6.83  z ',\r\n  'icon-polygon': 'M3,31 L19,3 h32 l16,28 l-16,28 H19  z ',\r\n  'icon-location':\r\n    'M24 62C8 45.503 0 32.837 0 24 0 10.745 10.745 0 24 0s24 10.745 24 24c0 8.837-8 21.503-24 38zm0-28c5.523 0 10-4.477 10-10s-4.477-10-10-10-10 4.477-10 10 4.477 10 10 10z',\r\n  'icon-heart':\r\n    'M49.994999,91.349998 l-6.96,-6.333 C18.324001,62.606995 2.01,47.829002 2.01,29.690998 C2.01,14.912998 13.619999,3.299999 28.401001,3.299999 c8.349,0 16.362,5.859 21.594,12 c5.229,-6.141 13.242001,-12 21.591,-12 c14.778,0 26.390999,11.61 26.390999,26.390999 c0,18.138 -16.314001,32.916 -41.025002,55.374001 l-6.96,6.285  z ',\r\n  'icon-bubble':\r\n    'M44 48L34 58V48H12C5.373 48 0 42.627 0 36V12C0 5.373 5.373 0 12 0h40c6.627 0 12 5.373 12 12v24c0 6.627-5.373 12-12 12h-8z',\r\n};\r\n\r\nexport const defaultRotateRangeValues = {\r\n  realTimeEvent: true,\r\n  min: -360,\r\n  max: 360,\r\n  value: 0,\r\n};\r\n\r\nexport const defaultDrawRangeValues = {\r\n  min: 5,\r\n  max: 30,\r\n  value: 12,\r\n};\r\n\r\nexport const defaultShapeStrokeValues = {\r\n  realTimeEvent: true,\r\n  min: 2,\r\n  max: 300,\r\n  value: 3,\r\n};\r\n\r\nexport const defaultTextRangeValues = {\r\n  realTimeEvent: true,\r\n  min: 10,\r\n  max: 100,\r\n  value: 50,\r\n};\r\n\r\nexport const defaultFilterRangeValues = {\r\n  tintOpacityRange: {\r\n    realTimeEvent: true,\r\n    min: 0,\r\n    max: 1,\r\n    value: 0.7,\r\n    useDecimal: true,\r\n  },\r\n  removewhiteDistanceRange: {\r\n    realTimeEvent: true,\r\n    min: 0,\r\n    max: 1,\r\n    value: 0.2,\r\n    useDecimal: true,\r\n  },\r\n  brightnessRange: {\r\n    realTimeEvent: true,\r\n    min: -1,\r\n    max: 1,\r\n    value: 0,\r\n    useDecimal: true,\r\n  },\r\n  noiseRange: {\r\n    realTimeEvent: true,\r\n    min: 0,\r\n    max: 1000,\r\n    value: 100,\r\n  },\r\n  pixelateRange: {\r\n    realTimeEvent: true,\r\n    min: 2,\r\n    max: 20,\r\n    value: 4,\r\n  },\r\n  colorfilterThresholdRange: {\r\n    realTimeEvent: true,\r\n    min: 0,\r\n    max: 1,\r\n    value: 0.2,\r\n    useDecimal: true,\r\n  },\r\n  blurFilterRange: {\r\n    value: 0.1,\r\n  },\r\n};\r\n\r\nexport const emptyCropRectValues = {\r\n  LEFT: 0,\r\n  TOP: 0,\r\n  WIDTH: 0.5,\r\n  HEIGHT: 0.5,\r\n};\r\n\r\nexport const defaultResizePixelValues = {\r\n  realTimeEvent: true,\r\n  min: 32,\r\n  max: 4088,\r\n  value: 800,\r\n};\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview CropperDrawingMode class\r\n */\r\nimport DrawingMode from '@/interface/drawingMode';\r\nimport { drawingModes, componentNames as components } from '@/consts';\r\n\r\n/**\r\n * CropperDrawingMode class\r\n * @class\r\n * @ignore\r\n */\r\nclass CropperDrawingMode extends DrawingMode {\r\n  constructor() {\r\n    super(drawingModes.CROPPER);\r\n  }\r\n\r\n  /**\r\n   * start this drawing mode\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @override\r\n   */\r\n  start(graphics) {\r\n    const cropper = graphics.getComponent(components.CROPPER);\r\n    cropper.start();\r\n  }\r\n\r\n  /**\r\n   * stop this drawing mode\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @override\r\n   */\r\n  end(graphics) {\r\n    const cropper = graphics.getComponent(components.CROPPER);\r\n    cropper.end();\r\n  }\r\n}\r\n\r\nexport default CropperDrawingMode;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview FreeDrawingMode class\r\n */\r\nimport DrawingMode from '@/interface/drawingMode';\r\nimport { drawingModes, componentNames as components } from '@/consts';\r\n\r\n/**\r\n * FreeDrawingMode class\r\n * @class\r\n * @ignore\r\n */\r\nclass FreeDrawingMode extends DrawingMode {\r\n  constructor() {\r\n    super(drawingModes.FREE_DRAWING);\r\n  }\r\n\r\n  /**\r\n   * start this drawing mode\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @param {{width: ?number, color: ?string}} [options] - Brush width & color\r\n   * @override\r\n   */\r\n  start(graphics, options) {\r\n    const freeDrawing = graphics.getComponent(components.FREE_DRAWING);\r\n    freeDrawing.start(options);\r\n  }\r\n\r\n  /**\r\n   * stop this drawing mode\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @override\r\n   */\r\n  end(graphics) {\r\n    const freeDrawing = graphics.getComponent(components.FREE_DRAWING);\r\n    freeDrawing.end();\r\n  }\r\n}\r\n\r\nexport default FreeDrawingMode;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview IconDrawingMode class\r\n */\r\nimport DrawingMode from '@/interface/drawingMode';\r\nimport { drawingModes, componentNames as components } from '@/consts';\r\n\r\n/**\r\n * IconDrawingMode class\r\n * @class\r\n * @ignore\r\n */\r\nclass IconDrawingMode extends DrawingMode {\r\n  constructor() {\r\n    super(drawingModes.ICON);\r\n  }\r\n\r\n  /**\r\n   * start this drawing mode\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @override\r\n   */\r\n  start(graphics) {\r\n    const icon = graphics.getComponent(components.ICON);\r\n    icon.start();\r\n  }\r\n\r\n  /**\r\n   * stop this drawing mode\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @override\r\n   */\r\n  end(graphics) {\r\n    const icon = graphics.getComponent(components.ICON);\r\n    icon.end();\r\n  }\r\n}\r\n\r\nexport default IconDrawingMode;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview LineDrawingMode class\r\n */\r\nimport DrawingMode from '@/interface/drawingMode';\r\nimport { drawingModes, componentNames as components } from '@/consts';\r\n\r\n/**\r\n * LineDrawingMode class\r\n * @class\r\n * @ignore\r\n */\r\nclass LineDrawingMode extends DrawingMode {\r\n  constructor() {\r\n    super(drawingModes.LINE_DRAWING);\r\n  }\r\n\r\n  /**\r\n   * start this drawing mode\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @param {{width: ?number, color: ?string}} [options] - Brush width & color\r\n   * @override\r\n   */\r\n  start(graphics, options) {\r\n    const lineDrawing = graphics.getComponent(components.LINE);\r\n    lineDrawing.start(options);\r\n  }\r\n\r\n  /**\r\n   * stop this drawing mode\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @override\r\n   */\r\n  end(graphics) {\r\n    const lineDrawing = graphics.getComponent(components.LINE);\r\n    lineDrawing.end();\r\n  }\r\n}\r\n\r\nexport default LineDrawingMode;\r\n","import DrawingMode from '@/interface/drawingMode';\r\nimport { drawingModes, componentNames as components } from '@/consts';\r\n\r\n/**\r\n * ResizeDrawingMode class\r\n * @class\r\n * @ignore\r\n */\r\nclass ResizeDrawingMode extends DrawingMode {\r\n  constructor() {\r\n    super(drawingModes.RESIZE);\r\n  }\r\n\r\n  /**\r\n   * start this drawing mode\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @override\r\n   */\r\n  start(graphics) {\r\n    const resize = graphics.getComponent(components.RESIZE);\r\n    resize.start();\r\n  }\r\n\r\n  /**\r\n   * stop this drawing mode\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @override\r\n   */\r\n  end(graphics) {\r\n    const resize = graphics.getComponent(components.RESIZE);\r\n    resize.end();\r\n  }\r\n}\r\n\r\nexport default ResizeDrawingMode;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview ShapeDrawingMode class\r\n */\r\nimport DrawingMode from '@/interface/drawingMode';\r\nimport { drawingModes, componentNames as components } from '@/consts';\r\n\r\n/**\r\n * ShapeDrawingMode class\r\n * @class\r\n * @ignore\r\n */\r\nclass ShapeDrawingMode extends DrawingMode {\r\n  constructor() {\r\n    super(drawingModes.SHAPE);\r\n  }\r\n\r\n  /**\r\n   * start this drawing mode\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @override\r\n   */\r\n  start(graphics) {\r\n    const shape = graphics.getComponent(components.SHAPE);\r\n    shape.start();\r\n  }\r\n\r\n  /**\r\n   * stop this drawing mode\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @override\r\n   */\r\n  end(graphics) {\r\n    const shape = graphics.getComponent(components.SHAPE);\r\n    shape.end();\r\n  }\r\n}\r\n\r\nexport default ShapeDrawingMode;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview TextDrawingMode class\r\n */\r\nimport DrawingMode from '@/interface/drawingMode';\r\nimport { drawingModes, componentNames as components } from '@/consts';\r\n\r\n/**\r\n * TextDrawingMode class\r\n * @class\r\n * @ignore\r\n */\r\nclass TextDrawingMode extends DrawingMode {\r\n  constructor() {\r\n    super(drawingModes.TEXT);\r\n  }\r\n\r\n  /**\r\n   * start this drawing mode\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @override\r\n   */\r\n  start(graphics) {\r\n    const text = graphics.getComponent(components.TEXT);\r\n    text.start();\r\n  }\r\n\r\n  /**\r\n   * stop this drawing mode\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @override\r\n   */\r\n  end(graphics) {\r\n    const text = graphics.getComponent(components.TEXT);\r\n    text.end();\r\n  }\r\n}\r\n\r\nexport default TextDrawingMode;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview ZoomDrawingMode class\r\n */\r\nimport DrawingMode from '@/interface/drawingMode';\r\nimport { drawingModes, componentNames as components } from '@/consts';\r\n\r\n/**\r\n * ZoomDrawingMode class\r\n * @class\r\n * @ignore\r\n */\r\nclass ZoomDrawingMode extends DrawingMode {\r\n  constructor() {\r\n    super(drawingModes.ZOOM);\r\n  }\r\n\r\n  /**\r\n   * start this drawing mode\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @override\r\n   */\r\n  start(graphics) {\r\n    const zoom = graphics.getComponent(components.ZOOM);\r\n\r\n    zoom.start();\r\n  }\r\n\r\n  /**\r\n   * stop this drawing mode\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @override\r\n   */\r\n  end(graphics) {\r\n    const zoom = graphics.getComponent(components.ZOOM);\r\n\r\n    zoom.end();\r\n  }\r\n}\r\n\r\nexport default ZoomDrawingMode;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Blur extending fabric.Image.filters.Convolute\r\n */\r\nimport fabric from 'fabric';\r\n\r\nconst ARROW_ANGLE = 30;\r\nconst CHEVRON_SIZE_RATIO = 2.7;\r\nconst TRIANGLE_SIZE_RATIO = 1.7;\r\nconst RADIAN_CONVERSION_VALUE = 180;\r\n\r\nconst ArrowLine = fabric.util.createClass(\r\n  fabric.Line,\r\n  /** @lends Convolute.prototype */ {\r\n    /**\r\n     * Line type\r\n     * @param {String} type\r\n     * @default\r\n     */\r\n    type: 'line',\r\n\r\n    /**\r\n     * Constructor\r\n     * @param {Array} [points] Array of points\r\n     * @param {Object} [options] Options object\r\n     * @override\r\n     */\r\n    initialize(points, options = {}) {\r\n      this.callSuper('initialize', points, options);\r\n\r\n      this.arrowType = options.arrowType;\r\n    },\r\n\r\n    /**\r\n     * Render ArrowLine\r\n     * @private\r\n     * @override\r\n     */\r\n    _render(ctx) {\r\n      const { x1: fromX, y1: fromY, x2: toX, y2: toY } = this.calcLinePoints();\r\n      const linePosition = {\r\n        fromX,\r\n        fromY,\r\n        toX,\r\n        toY,\r\n      };\r\n      this.ctx = ctx;\r\n      ctx.lineWidth = this.strokeWidth;\r\n\r\n      this._renderBasicLinePath(linePosition);\r\n      this._drawDecoratorPath(linePosition);\r\n\r\n      this._renderStroke(ctx);\r\n    },\r\n\r\n    /**\r\n     * Render Basic line path\r\n     * @param {Object} linePosition - line position\r\n     *  @param {number} option.fromX - line start position x\r\n     *  @param {number} option.fromY - line start position y\r\n     *  @param {number} option.toX - line end position x\r\n     *  @param {number} option.toY - line end position y\r\n     * @private\r\n     */\r\n    _renderBasicLinePath({ fromX, fromY, toX, toY }) {\r\n      this.ctx.beginPath();\r\n      this.ctx.moveTo(fromX, fromY);\r\n      this.ctx.lineTo(toX, toY);\r\n    },\r\n\r\n    /**\r\n     * Render Arrow Head\r\n     * @param {Object} linePosition - line position\r\n     *  @param {number} option.fromX - line start position x\r\n     *  @param {number} option.fromY - line start position y\r\n     *  @param {number} option.toX - line end position x\r\n     *  @param {number} option.toY - line end position y\r\n     * @private\r\n     */\r\n    _drawDecoratorPath(linePosition) {\r\n      this._drawDecoratorPathType('head', linePosition);\r\n      this._drawDecoratorPathType('tail', linePosition);\r\n    },\r\n\r\n    /**\r\n     * Render Arrow Head\r\n     * @param {string} type - 'head' or 'tail'\r\n     * @param {Object} linePosition - line position\r\n     *  @param {number} option.fromX - line start position x\r\n     *  @param {number} option.fromY - line start position y\r\n     *  @param {number} option.toX - line end position x\r\n     *  @param {number} option.toY - line end position y\r\n     * @private\r\n     */\r\n    _drawDecoratorPathType(type, linePosition) {\r\n      switch (this.arrowType[type]) {\r\n        case 'triangle':\r\n          this._drawTrianglePath(type, linePosition);\r\n          break;\r\n        case 'chevron':\r\n          this._drawChevronPath(type, linePosition);\r\n          break;\r\n        default:\r\n          break;\r\n      }\r\n    },\r\n\r\n    /**\r\n     * Render Triangle Head\r\n     * @param {string} type - 'head' or 'tail'\r\n     * @param {Object} linePosition - line position\r\n     *  @param {number} option.fromX - line start position x\r\n     *  @param {number} option.fromY - line start position y\r\n     *  @param {number} option.toX - line end position x\r\n     *  @param {number} option.toY - line end position y\r\n     * @private\r\n     */\r\n    _drawTrianglePath(type, linePosition) {\r\n      const decorateSize = this.ctx.lineWidth * TRIANGLE_SIZE_RATIO;\r\n\r\n      this._drawChevronPath(type, linePosition, decorateSize);\r\n      this.ctx.closePath();\r\n    },\r\n\r\n    /**\r\n     * Render Chevron Head\r\n     * @param {string} type - 'head' or 'tail'\r\n     * @param {Object} linePosition - line position\r\n     *  @param {number} option.fromX - line start position x\r\n     *  @param {number} option.fromY - line start position y\r\n     *  @param {number} option.toX - line end position x\r\n     *  @param {number} option.toY - line end position y\r\n     * @param {number} decorateSize - decorate size\r\n     * @private\r\n     */\r\n    _drawChevronPath(type, { fromX, fromY, toX, toY }, decorateSize) {\r\n      const { ctx } = this;\r\n      if (!decorateSize) {\r\n        decorateSize = this.ctx.lineWidth * CHEVRON_SIZE_RATIO;\r\n      }\r\n\r\n      const [standardX, standardY] = type === 'head' ? [fromX, fromY] : [toX, toY];\r\n      const [compareX, compareY] = type === 'head' ? [toX, toY] : [fromX, fromY];\r\n\r\n      const angle =\r\n        (Math.atan2(compareY - standardY, compareX - standardX) * RADIAN_CONVERSION_VALUE) /\r\n        Math.PI;\r\n      const rotatedPosition = (changeAngle) =>\r\n        this.getRotatePosition(decorateSize, changeAngle, {\r\n          x: standardX,\r\n          y: standardY,\r\n        });\r\n\r\n      ctx.moveTo(...rotatedPosition(angle + ARROW_ANGLE));\r\n      ctx.lineTo(standardX, standardY);\r\n      ctx.lineTo(...rotatedPosition(angle - ARROW_ANGLE));\r\n    },\r\n\r\n    /**\r\n     * return position from change angle.\r\n     * @param {number} distance - change distance\r\n     * @param {number} angle - change angle\r\n     * @param {Object} referencePosition - reference position\r\n     * @returns {Array}\r\n     * @private\r\n     */\r\n    getRotatePosition(distance, angle, referencePosition) {\r\n      const radian = (angle * Math.PI) / RADIAN_CONVERSION_VALUE;\r\n      const { x, y } = referencePosition;\r\n\r\n      return [distance * Math.cos(radian) + x, distance * Math.sin(radian) + y];\r\n    },\r\n  }\r\n);\r\n\r\nexport default ArrowLine;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview ColorFilter extending fabric.Image.filters.BaseFilter\r\n */\r\nimport fabric from 'fabric';\r\n\r\n/**\r\n * ColorFilter object\r\n * @class ColorFilter\r\n * @extends {fabric.Image.filters.BaseFilter}\r\n * @ignore\r\n */\r\nconst ColorFilter = fabric.util.createClass(\r\n  fabric.Image.filters.BaseFilter,\r\n  /** @lends BaseFilter.prototype */ {\r\n    /**\r\n     * Filter type\r\n     * @param {String} type\r\n     * @default\r\n     */\r\n    type: 'ColorFilter',\r\n\r\n    /**\r\n     * Constructor\r\n     * @member fabric.Image.filters.ColorFilter.prototype\r\n     * @param {Object} [options] Options object\r\n     * @param {Number} [options.color='#FFFFFF'] Value of color (0...255)\r\n     * @param {Number} [options.threshold=45] Value of threshold (0...255)\r\n     * @override\r\n     */\r\n    initialize(options) {\r\n      if (!options) {\r\n        options = {};\r\n      }\r\n      this.color = options.color || '#FFFFFF';\r\n      this.threshold = options.threshold || 45;\r\n      this.x = options.x || null;\r\n      this.y = options.y || null;\r\n    },\r\n\r\n    /**\r\n     * Applies filter to canvas element\r\n     * @param {Object} canvas Canvas object passed by fabric\r\n     */\r\n    // eslint-disable-next-line complexity\r\n    applyTo(canvas) {\r\n      const { canvasEl } = canvas;\r\n      const context = canvasEl.getContext('2d');\r\n      const imageData = context.getImageData(0, 0, canvasEl.width, canvasEl.height);\r\n      const { data } = imageData;\r\n      const { threshold } = this;\r\n      let filterColor = fabric.Color.sourceFromHex(this.color);\r\n      let i, len;\r\n\r\n      if (this.x && this.y) {\r\n        filterColor = this._getColor(imageData, this.x, this.y);\r\n      }\r\n\r\n      for (i = 0, len = data.length; i < len; i += 4) {\r\n        if (\r\n          this._isOutsideThreshold(data[i], filterColor[0], threshold) ||\r\n          this._isOutsideThreshold(data[i + 1], filterColor[1], threshold) ||\r\n          this._isOutsideThreshold(data[i + 2], filterColor[2], threshold)\r\n        ) {\r\n          continue;\r\n        }\r\n        data[i] = data[i + 1] = data[i + 2] = data[i + 3] = 0;\r\n      }\r\n      context.putImageData(imageData, 0, 0);\r\n    },\r\n\r\n    /**\r\n     * Check color if it is within threshold\r\n     * @param {Number} color1 source color\r\n     * @param {Number} color2 filtering color\r\n     * @param {Number} threshold threshold\r\n     * @returns {boolean} true if within threshold or false\r\n     */\r\n    _isOutsideThreshold(color1, color2, threshold) {\r\n      const diff = color1 - color2;\r\n\r\n      return Math.abs(diff) > threshold;\r\n    },\r\n\r\n    /**\r\n     * Get color at (x, y)\r\n     * @param {Object} imageData of canvas\r\n     * @param {Number} x left position\r\n     * @param {Number} y top position\r\n     * @returns {Array} color array\r\n     */\r\n    _getColor(imageData, x, y) {\r\n      const color = [0, 0, 0, 0];\r\n      const { data, width } = imageData;\r\n      const bytes = 4;\r\n      const position = (width * y + x) * bytes;\r\n\r\n      color[0] = data[position];\r\n      color[1] = data[position + 1];\r\n      color[2] = data[position + 2];\r\n      color[3] = data[position + 3];\r\n\r\n      return color;\r\n    },\r\n  }\r\n);\r\n\r\nexport default ColorFilter;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Cropzone extending fabric.Rect\r\n */\r\nimport snippet from 'tui-code-snippet';\r\nimport fabric from 'fabric';\r\nimport { clamp } from '@/util';\r\nimport { eventNames as events, keyCodes } from '@/consts';\r\n\r\nconst CORNER_TYPE_TOP_LEFT = 'tl';\r\nconst CORNER_TYPE_TOP_RIGHT = 'tr';\r\nconst CORNER_TYPE_MIDDLE_TOP = 'mt';\r\nconst CORNER_TYPE_MIDDLE_LEFT = 'ml';\r\nconst CORNER_TYPE_MIDDLE_RIGHT = 'mr';\r\nconst CORNER_TYPE_MIDDLE_BOTTOM = 'mb';\r\nconst CORNER_TYPE_BOTTOM_LEFT = 'bl';\r\nconst CORNER_TYPE_BOTTOM_RIGHT = 'br';\r\nconst CORNER_TYPE_LIST = [\r\n  CORNER_TYPE_TOP_LEFT,\r\n  CORNER_TYPE_TOP_RIGHT,\r\n  CORNER_TYPE_MIDDLE_TOP,\r\n  CORNER_TYPE_MIDDLE_LEFT,\r\n  CORNER_TYPE_MIDDLE_RIGHT,\r\n  CORNER_TYPE_MIDDLE_BOTTOM,\r\n  CORNER_TYPE_BOTTOM_LEFT,\r\n  CORNER_TYPE_BOTTOM_RIGHT,\r\n];\r\nconst NOOP_FUNCTION = () => {};\r\n\r\n/**\r\n * Align with cropzone ratio\r\n * @param {string} selectedCorner - selected corner type\r\n * @returns {{width: number, height: number}}\r\n * @private\r\n */\r\nfunction cornerTypeValid(selectedCorner) {\r\n  return CORNER_TYPE_LIST.indexOf(selectedCorner) >= 0;\r\n}\r\n\r\n/**\r\n * return scale basis type\r\n * @param {number} diffX - X distance of the cursor and corner.\r\n * @param {number} diffY - Y distance of the cursor and corner.\r\n * @returns {string}\r\n * @private\r\n */\r\nfunction getScaleBasis(diffX, diffY) {\r\n  return diffX > diffY ? 'width' : 'height';\r\n}\r\n\r\n/**\r\n * Cropzone object\r\n * Issue: IE7, 8(with excanvas)\r\n *  - Cropzone is a black zone without transparency.\r\n * @class Cropzone\r\n * @extends {fabric.Rect}\r\n * @ignore\r\n */\r\nconst Cropzone = fabric.util.createClass(\r\n  fabric.Rect,\r\n  /** @lends Cropzone.prototype */ {\r\n    /**\r\n     * Constructor\r\n     * @param {Object} canvas canvas\r\n     * @param {Object} options Options object\r\n     * @param {Object} extendsOptions object for extends \"options\"\r\n     * @override\r\n     */\r\n    initialize(canvas, options, extendsOptions) {\r\n      options = snippet.extend(options, extendsOptions);\r\n      options.type = 'cropzone';\r\n\r\n      this.callSuper('initialize', options);\r\n      this._addEventHandler();\r\n\r\n      this.canvas = canvas;\r\n      this.options = options;\r\n    },\r\n    canvasEventDelegation(eventName) {\r\n      let delegationState = 'unregistered';\r\n      const isRegistered = this.canvasEventTrigger[eventName] !== NOOP_FUNCTION;\r\n      if (isRegistered) {\r\n        delegationState = 'registered';\r\n      } else if ([events.OBJECT_MOVED, events.OBJECT_SCALED].indexOf(eventName) < 0) {\r\n        delegationState = 'none';\r\n      }\r\n\r\n      return delegationState;\r\n    },\r\n    canvasEventRegister(eventName, eventTrigger) {\r\n      this.canvasEventTrigger[eventName] = eventTrigger;\r\n    },\r\n    _addEventHandler() {\r\n      this.canvasEventTrigger = {\r\n        [events.OBJECT_MOVED]: NOOP_FUNCTION,\r\n        [events.OBJECT_SCALED]: NOOP_FUNCTION,\r\n      };\r\n      this.on({\r\n        moving: this._onMoving.bind(this),\r\n        scaling: this._onScaling.bind(this),\r\n      });\r\n      fabric.util.addListener(document, 'keydown', this._onKeyDown.bind(this));\r\n      fabric.util.addListener(document, 'keyup', this._onKeyUp.bind(this));\r\n    },\r\n    _renderCropzone(ctx) {\r\n      const cropzoneDashLineWidth = 7;\r\n      const cropzoneDashLineOffset = 7;\r\n\r\n      // Calc original scale\r\n      const originalFlipX = this.flipX ? -1 : 1;\r\n      const originalFlipY = this.flipY ? -1 : 1;\r\n      const originalScaleX = originalFlipX / this.scaleX;\r\n      const originalScaleY = originalFlipY / this.scaleY;\r\n\r\n      // Set original scale\r\n      ctx.scale(originalScaleX, originalScaleY);\r\n\r\n      // Render outer rect\r\n      this._fillOuterRect(ctx, 'rgba(0, 0, 0, 0.5)');\r\n\r\n      if (this.options.lineWidth) {\r\n        this._fillInnerRect(ctx);\r\n        this._strokeBorder(ctx, 'rgb(255, 255, 255)', {\r\n          lineWidth: this.options.lineWidth,\r\n        });\r\n      } else {\r\n        // Black dash line\r\n        this._strokeBorder(ctx, 'rgb(0, 0, 0)', {\r\n          lineDashWidth: cropzoneDashLineWidth,\r\n        });\r\n\r\n        // White dash line\r\n        this._strokeBorder(ctx, 'rgb(255, 255, 255)', {\r\n          lineDashWidth: cropzoneDashLineWidth,\r\n          lineDashOffset: cropzoneDashLineOffset,\r\n        });\r\n      }\r\n\r\n      // Reset scale\r\n      ctx.scale(1 / originalScaleX, 1 / originalScaleY);\r\n    },\r\n\r\n    /**\r\n     * Render Crop-zone\r\n     * @private\r\n     * @override\r\n     */\r\n    _render(ctx) {\r\n      this.callSuper('_render', ctx);\r\n\r\n      this._renderCropzone(ctx);\r\n    },\r\n\r\n    /**\r\n     * Cropzone-coordinates with outer rectangle\r\n     *\r\n     *     x0     x1         x2      x3\r\n     *  y0 +--------------------------+\r\n     *     |///////|//////////|///////|    // <--- \"Outer-rectangle\"\r\n     *     |///////|//////////|///////|\r\n     *  y1 +-------+----------+-------+\r\n     *     |///////| Cropzone |///////|    Cropzone is the \"Inner-rectangle\"\r\n     *     |///////|  (0, 0)  |///////|    Center point (0, 0)\r\n     *  y2 +-------+----------+-------+\r\n     *     |///////|//////////|///////|\r\n     *     |///////|//////////|///////|\r\n     *  y3 +--------------------------+\r\n     *\r\n     * @typedef {{x: Array<number>, y: Array<number>}} cropzoneCoordinates\r\n     * @ignore\r\n     */\r\n\r\n    /**\r\n     * Fill outer rectangle\r\n     * @param {CanvasRenderingContext2D} ctx - Context\r\n     * @param {string|CanvasGradient|CanvasPattern} fillStyle - Fill-style\r\n     * @private\r\n     */\r\n    _fillOuterRect(ctx, fillStyle) {\r\n      const { x, y } = this._getCoordinates();\r\n\r\n      ctx.save();\r\n      ctx.fillStyle = fillStyle;\r\n      ctx.beginPath();\r\n\r\n      // Outer rectangle\r\n      // Numbers are +/-1 so that overlay edges don't get blurry.\r\n      ctx.moveTo(x[0] - 1, y[0] - 1);\r\n      ctx.lineTo(x[3] + 1, y[0] - 1);\r\n      ctx.lineTo(x[3] + 1, y[3] + 1);\r\n      ctx.lineTo(x[0] - 1, y[3] + 1);\r\n      ctx.lineTo(x[0] - 1, y[0] - 1);\r\n      ctx.closePath();\r\n\r\n      // Inner rectangle\r\n      ctx.moveTo(x[1], y[1]);\r\n      ctx.lineTo(x[1], y[2]);\r\n      ctx.lineTo(x[2], y[2]);\r\n      ctx.lineTo(x[2], y[1]);\r\n      ctx.lineTo(x[1], y[1]);\r\n      ctx.closePath();\r\n\r\n      ctx.fill();\r\n      ctx.restore();\r\n    },\r\n\r\n    /**\r\n     * Draw Inner grid line\r\n     * @param {CanvasRenderingContext2D} ctx - Context\r\n     * @private\r\n     */\r\n    _fillInnerRect(ctx) {\r\n      const { x: outerX, y: outerY } = this._getCoordinates();\r\n      const x = this._caculateInnerPosition(outerX, (outerX[2] - outerX[1]) / 3);\r\n      const y = this._caculateInnerPosition(outerY, (outerY[2] - outerY[1]) / 3);\r\n\r\n      ctx.save();\r\n      ctx.strokeStyle = 'rgba(255, 255, 255, 0.7)';\r\n      ctx.lineWidth = this.options.lineWidth;\r\n      ctx.beginPath();\r\n\r\n      ctx.moveTo(x[0], y[1]);\r\n      ctx.lineTo(x[3], y[1]);\r\n\r\n      ctx.moveTo(x[0], y[2]);\r\n      ctx.lineTo(x[3], y[2]);\r\n\r\n      ctx.moveTo(x[1], y[0]);\r\n      ctx.lineTo(x[1], y[3]);\r\n\r\n      ctx.moveTo(x[2], y[0]);\r\n      ctx.lineTo(x[2], y[3]);\r\n      ctx.stroke();\r\n      ctx.closePath();\r\n\r\n      ctx.restore();\r\n    },\r\n\r\n    /**\r\n     * Calculate Inner Position\r\n     * @param {Array} outer - outer position\r\n     * @param {number} size - interval for calculate\r\n     * @returns {Array} - inner position\r\n     * @private\r\n     */\r\n    _caculateInnerPosition(outer, size) {\r\n      const position = [];\r\n      position[0] = outer[1];\r\n      position[1] = outer[1] + size;\r\n      position[2] = outer[1] + size * 2;\r\n      position[3] = outer[2];\r\n\r\n      return position;\r\n    },\r\n\r\n    /**\r\n     * Get coordinates\r\n     * @returns {cropzoneCoordinates} - {@link cropzoneCoordinates}\r\n     * @private\r\n     */\r\n    _getCoordinates() {\r\n      const { canvas, width, height, left, top } = this;\r\n      const halfWidth = width / 2;\r\n      const halfHeight = height / 2;\r\n      const canvasHeight = canvas.getHeight(); // fabric object\r\n      const canvasWidth = canvas.getWidth(); // fabric object\r\n\r\n      return {\r\n        x: snippet.map(\r\n          [\r\n            -(halfWidth + left), // x0\r\n            -halfWidth, // x1\r\n            halfWidth, // x2\r\n            halfWidth + (canvasWidth - left - width), // x3\r\n          ],\r\n          Math.ceil\r\n        ),\r\n        y: snippet.map(\r\n          [\r\n            -(halfHeight + top), // y0\r\n            -halfHeight, // y1\r\n            halfHeight, // y2\r\n            halfHeight + (canvasHeight - top - height), // y3\r\n          ],\r\n          Math.ceil\r\n        ),\r\n      };\r\n    },\r\n\r\n    /**\r\n     * Stroke border\r\n     * @param {CanvasRenderingContext2D} ctx - Context\r\n     * @param {string|CanvasGradient|CanvasPattern} strokeStyle - Stroke-style\r\n     * @param {number} lineDashWidth - Dash width\r\n     * @param {number} [lineDashOffset] - Dash offset\r\n     * @param {number} [lineWidth] - line width\r\n     * @private\r\n     */\r\n    _strokeBorder(ctx, strokeStyle, { lineDashWidth, lineDashOffset, lineWidth }) {\r\n      const halfWidth = this.width / 2;\r\n      const halfHeight = this.height / 2;\r\n\r\n      ctx.save();\r\n      ctx.strokeStyle = strokeStyle;\r\n\r\n      if (ctx.setLineDash) {\r\n        ctx.setLineDash([lineDashWidth, lineDashWidth]);\r\n      }\r\n      if (lineDashOffset) {\r\n        ctx.lineDashOffset = lineDashOffset;\r\n      }\r\n      if (lineWidth) {\r\n        ctx.lineWidth = lineWidth;\r\n      }\r\n\r\n      ctx.beginPath();\r\n      ctx.moveTo(-halfWidth, -halfHeight);\r\n      ctx.lineTo(halfWidth, -halfHeight);\r\n      ctx.lineTo(halfWidth, halfHeight);\r\n      ctx.lineTo(-halfWidth, halfHeight);\r\n      ctx.lineTo(-halfWidth, -halfHeight);\r\n      ctx.stroke();\r\n\r\n      ctx.restore();\r\n    },\r\n\r\n    /**\r\n     * onMoving event listener\r\n     * @private\r\n     */\r\n    _onMoving() {\r\n      const { height, width, left, top } = this;\r\n      const maxLeft = this.canvas.getWidth() - width;\r\n      const maxTop = this.canvas.getHeight() - height;\r\n\r\n      this.left = clamp(left, 0, maxLeft);\r\n      this.top = clamp(top, 0, maxTop);\r\n\r\n      this.canvasEventTrigger[events.OBJECT_MOVED](this);\r\n    },\r\n\r\n    /**\r\n     * onScaling event listener\r\n     * @param {{e: MouseEvent}} fEvent - Fabric event\r\n     * @private\r\n     */\r\n    _onScaling(fEvent) {\r\n      const selectedCorner = fEvent.transform.corner;\r\n      const pointer = this.canvas.getPointer(fEvent.e);\r\n      const settings = this._calcScalingSizeFromPointer(pointer, selectedCorner);\r\n\r\n      // On scaling cropzone,\r\n      // change real width and height and fix scaleFactor to 1\r\n      this.scale(1).set(settings);\r\n\r\n      this.canvasEventTrigger[events.OBJECT_SCALED](this);\r\n    },\r\n\r\n    /**\r\n     * Calc scaled size from mouse pointer with selected corner\r\n     * @param {{x: number, y: number}} pointer - Mouse position\r\n     * @param {string} selectedCorner - selected corner type\r\n     * @returns {Object} Having left or(and) top or(and) width or(and) height.\r\n     * @private\r\n     */\r\n    _calcScalingSizeFromPointer(pointer, selectedCorner) {\r\n      const isCornerTypeValid = cornerTypeValid(selectedCorner);\r\n\r\n      return isCornerTypeValid && this._resizeCropZone(pointer, selectedCorner);\r\n    },\r\n\r\n    /**\r\n     * Align with cropzone ratio\r\n     * @param {number} width - cropzone width\r\n     * @param {number} height - cropzone height\r\n     * @param {number} maxWidth - limit max width\r\n     * @param {number} maxHeight - limit max height\r\n     * @param {number} scaleTo - cropzone ratio\r\n     * @returns {{width: number, height: number}}\r\n     * @private\r\n     */\r\n    adjustRatioCropzoneSize({ width, height, leftMaker, topMaker, maxWidth, maxHeight, scaleTo }) {\r\n      width = maxWidth ? clamp(width, 1, maxWidth) : width;\r\n      height = maxHeight ? clamp(height, 1, maxHeight) : height;\r\n\r\n      if (!this.presetRatio) {\r\n        if (this._withShiftKey) {\r\n          // make fixed ratio cropzone\r\n          if (width > height) {\r\n            height = width;\r\n          } else if (height > width) {\r\n            width = height;\r\n          }\r\n        }\r\n\r\n        return {\r\n          width,\r\n          height,\r\n          left: leftMaker(width),\r\n          top: topMaker(height),\r\n        };\r\n      }\r\n\r\n      if (scaleTo === 'width') {\r\n        height = width / this.presetRatio;\r\n      } else {\r\n        width = height * this.presetRatio;\r\n      }\r\n\r\n      const maxScaleFactor = Math.min(maxWidth / width, maxHeight / height);\r\n      if (maxScaleFactor <= 1) {\r\n        [width, height] = [width, height].map((v) => v * maxScaleFactor);\r\n      }\r\n\r\n      return {\r\n        width,\r\n        height,\r\n        left: leftMaker(width),\r\n        top: topMaker(height),\r\n      };\r\n    },\r\n\r\n    /**\r\n     * Get dimension last state cropzone\r\n     * @returns {{rectTop: number, rectLeft: number, rectWidth: number, rectHeight: number}}\r\n     * @private\r\n     */\r\n    _getCropzoneRectInfo() {\r\n      const { width: canvasWidth, height: canvasHeight } = this.canvas;\r\n      const {\r\n        top: rectTop,\r\n        left: rectLeft,\r\n        width: rectWidth,\r\n        height: rectHeight,\r\n      } = this.getBoundingRect(false, true);\r\n\r\n      return {\r\n        rectTop,\r\n        rectLeft,\r\n        rectWidth,\r\n        rectHeight,\r\n        rectRight: rectLeft + rectWidth,\r\n        rectBottom: rectTop + rectHeight,\r\n        canvasWidth,\r\n        canvasHeight,\r\n      };\r\n    },\r\n\r\n    /**\r\n     * Calc scaling dimension\r\n     * @param {Object} position - Mouse position\r\n     * @param {string} corner - corner type\r\n     * @returns {{left: number, top: number, width: number, height: number}}\r\n     * @private\r\n     */\r\n    _resizeCropZone({ x, y }, corner) {\r\n      const {\r\n        rectWidth,\r\n        rectHeight,\r\n        rectTop,\r\n        rectLeft,\r\n        rectBottom,\r\n        rectRight,\r\n        canvasWidth,\r\n        canvasHeight,\r\n      } = this._getCropzoneRectInfo();\r\n\r\n      const resizeInfoMap = {\r\n        tl: {\r\n          width: rectRight - x,\r\n          height: rectBottom - y,\r\n          leftMaker: (newWidth) => rectRight - newWidth,\r\n          topMaker: (newHeight) => rectBottom - newHeight,\r\n          maxWidth: rectRight,\r\n          maxHeight: rectBottom,\r\n          scaleTo: getScaleBasis(rectLeft - x, rectTop - y),\r\n        },\r\n        tr: {\r\n          width: x - rectLeft,\r\n          height: rectBottom - y,\r\n          leftMaker: () => rectLeft,\r\n          topMaker: (newHeight) => rectBottom - newHeight,\r\n          maxWidth: canvasWidth - rectLeft,\r\n          maxHeight: rectBottom,\r\n          scaleTo: getScaleBasis(x - rectRight, rectTop - y),\r\n        },\r\n        mt: {\r\n          width: rectWidth,\r\n          height: rectBottom - y,\r\n          leftMaker: () => rectLeft,\r\n          topMaker: (newHeight) => rectBottom - newHeight,\r\n          maxWidth: canvasWidth - rectLeft,\r\n          maxHeight: rectBottom,\r\n          scaleTo: 'height',\r\n        },\r\n        ml: {\r\n          width: rectRight - x,\r\n          height: rectHeight,\r\n          leftMaker: (newWidth) => rectRight - newWidth,\r\n          topMaker: () => rectTop,\r\n          maxWidth: rectRight,\r\n          maxHeight: canvasHeight - rectTop,\r\n          scaleTo: 'width',\r\n        },\r\n        mr: {\r\n          width: x - rectLeft,\r\n          height: rectHeight,\r\n          leftMaker: () => rectLeft,\r\n          topMaker: () => rectTop,\r\n          maxWidth: canvasWidth - rectLeft,\r\n          maxHeight: canvasHeight - rectTop,\r\n          scaleTo: 'width',\r\n        },\r\n        mb: {\r\n          width: rectWidth,\r\n          height: y - rectTop,\r\n          leftMaker: () => rectLeft,\r\n          topMaker: () => rectTop,\r\n          maxWidth: canvasWidth - rectLeft,\r\n          maxHeight: canvasHeight - rectTop,\r\n          scaleTo: 'height',\r\n        },\r\n        bl: {\r\n          width: rectRight - x,\r\n          height: y - rectTop,\r\n          leftMaker: (newWidth) => rectRight - newWidth,\r\n          topMaker: () => rectTop,\r\n          maxWidth: rectRight,\r\n          maxHeight: canvasHeight - rectTop,\r\n          scaleTo: getScaleBasis(rectLeft - x, y - rectBottom),\r\n        },\r\n        br: {\r\n          width: x - rectLeft,\r\n          height: y - rectTop,\r\n          leftMaker: () => rectLeft,\r\n          topMaker: () => rectTop,\r\n          maxWidth: canvasWidth - rectLeft,\r\n          maxHeight: canvasHeight - rectTop,\r\n          scaleTo: getScaleBasis(x - rectRight, y - rectBottom),\r\n        },\r\n      };\r\n\r\n      return this.adjustRatioCropzoneSize(resizeInfoMap[corner]);\r\n    },\r\n\r\n    /**\r\n     * Return the whether this cropzone is valid\r\n     * @returns {boolean}\r\n     */\r\n    isValid() {\r\n      return this.left >= 0 && this.top >= 0 && this.width > 0 && this.height > 0;\r\n    },\r\n\r\n    /**\r\n     * Keydown event handler\r\n     * @param {{number}} keyCode - Event keyCode\r\n     * @private\r\n     */\r\n    _onKeyDown({ keyCode }) {\r\n      if (keyCode === keyCodes.SHIFT) {\r\n        this._withShiftKey = true;\r\n      }\r\n    },\r\n\r\n    /**\r\n     * Keyup event handler\r\n     * @param {{number}} keyCode - Event keyCode\r\n     * @private\r\n     */\r\n    _onKeyUp({ keyCode }) {\r\n      if (keyCode === keyCodes.SHIFT) {\r\n        this._withShiftKey = false;\r\n      }\r\n    },\r\n  }\r\n);\r\n\r\nexport default Cropzone;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Emboss extending fabric.Image.filters.Convolute\r\n */\r\nimport fabric from 'fabric';\r\n\r\n/**\r\n * Emboss object\r\n * @class Emboss\r\n * @extends {fabric.Image.filters.Convolute}\r\n * @ignore\r\n */\r\nconst Emboss = fabric.util.createClass(\r\n  fabric.Image.filters.Convolute,\r\n  /** @lends Convolute.prototype */ {\r\n    /**\r\n     * Filter type\r\n     * @param {String} type\r\n     * @default\r\n     */\r\n    type: 'Emboss',\r\n\r\n    /**\r\n     * constructor\r\n     * @override\r\n     */\r\n    initialize() {\r\n      this.matrix = [1, 1, 1, 1, 0.7, -1, -1, -1, -1];\r\n    },\r\n  }\r\n);\r\n\r\nexport default Emboss;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Mask extending fabric.Image.filters.Mask\r\n */\r\nimport fabric from 'fabric';\r\n\r\n/**\r\n * Mask object\r\n * @class Mask\r\n * @extends {fabric.Image.filters.BlendImage}\r\n * @ignore\r\n */\r\nconst Mask = fabric.util.createClass(\r\n  fabric.Image.filters.BlendImage,\r\n  /** @lends Mask.prototype */ {\r\n    /**\r\n     * Apply filter to canvas element\r\n     * @param {Object} pipelineState - Canvas element to apply filter\r\n     * @override\r\n     */\r\n    applyTo(pipelineState) {\r\n      if (!this.mask) {\r\n        return;\r\n      }\r\n\r\n      const canvas = pipelineState.canvasEl;\r\n      const { width, height } = canvas;\r\n      const maskCanvasEl = this._createCanvasOfMask(width, height);\r\n      const ctx = canvas.getContext('2d');\r\n      const maskCtx = maskCanvasEl.getContext('2d');\r\n      const imageData = ctx.getImageData(0, 0, width, height);\r\n\r\n      this._drawMask(maskCtx, canvas, ctx);\r\n      this._mapData(maskCtx, imageData, width, height);\r\n\r\n      pipelineState.imageData = imageData;\r\n    },\r\n\r\n    /**\r\n     * Create canvas of mask image\r\n     * @param {number} width - Width of main canvas\r\n     * @param {number} height - Height of main canvas\r\n     * @returns {HTMLElement} Canvas element\r\n     * @private\r\n     */\r\n    _createCanvasOfMask(width, height) {\r\n      const maskCanvasEl = fabric.util.createCanvasElement();\r\n\r\n      maskCanvasEl.width = width;\r\n      maskCanvasEl.height = height;\r\n\r\n      return maskCanvasEl;\r\n    },\r\n\r\n    /**\r\n     * Draw mask image on canvas element\r\n     * @param {Object} maskCtx - Context of mask canvas\r\n     * @private\r\n     */\r\n    _drawMask(maskCtx) {\r\n      const { mask } = this;\r\n      const maskImg = mask.getElement();\r\n      const { angle, left, scaleX, scaleY, top } = mask;\r\n\r\n      maskCtx.save();\r\n      maskCtx.translate(left, top);\r\n      maskCtx.rotate((angle * Math.PI) / 180);\r\n      maskCtx.scale(scaleX, scaleY);\r\n      maskCtx.drawImage(maskImg, -maskImg.width / 2, -maskImg.height / 2);\r\n      maskCtx.restore();\r\n    },\r\n\r\n    /**\r\n     * Map mask image data to source image data\r\n     * @param {Object} maskCtx - Context of mask canvas\r\n     * @param {Object} imageData - Data of source image\r\n     * @param {number} width - Width of main canvas\r\n     * @param {number} height - Height of main canvas\r\n     * @private\r\n     */\r\n    _mapData(maskCtx, imageData, width, height) {\r\n      const { data, height: imgHeight, width: imgWidth } = imageData;\r\n      const sourceData = data;\r\n      const len = imgWidth * imgHeight * 4;\r\n      const maskData = maskCtx.getImageData(0, 0, width, height).data;\r\n\r\n      for (let i = 0; i < len; i += 4) {\r\n        sourceData[i + 3] = maskData[i]; // adjust value of alpha data\r\n      }\r\n    },\r\n  }\r\n);\r\n\r\nexport default Mask;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Sharpen extending fabric.Image.filters.Convolute\r\n */\r\nimport fabric from 'fabric';\r\n\r\n/**\r\n * Sharpen object\r\n * @class Sharpen\r\n * @extends {fabric.Image.filters.Convolute}\r\n * @ignore\r\n */\r\nconst Sharpen = fabric.util.createClass(\r\n  fabric.Image.filters.Convolute,\r\n  /** @lends Convolute.prototype */ {\r\n    /**\r\n     * Filter type\r\n     * @param {String} type\r\n     * @default\r\n     */\r\n    type: 'Sharpen',\r\n\r\n    /**\r\n     * constructor\r\n     * @override\r\n     */\r\n    initialize() {\r\n      this.matrix = [0, -1, 0, -1, 5, -1, 0, -1, 0];\r\n    },\r\n  }\r\n);\r\n\r\nexport default Sharpen;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Command factory\r\n */\r\nimport Command from '@/interface/command';\r\n\r\nconst commands = {};\r\n\r\n/**\r\n * Create a command\r\n * @param {string} name - Command name\r\n * @param {...*} args - Arguments for creating command\r\n * @returns {Command}\r\n * @ignore\r\n */\r\nfunction create(name, ...args) {\r\n  const actions = commands[name];\r\n  if (actions) {\r\n    return new Command(actions, args);\r\n  }\r\n\r\n  return null;\r\n}\r\n\r\n/**\r\n * Register a command with name as a key\r\n * @param {Object} command - {name:{string}, execute: {function}, undo: {function}}\r\n * @param {string} command.name - command name\r\n * @param {function} command.execute - executable function\r\n * @param {function} command.undo - undo function\r\n * @ignore\r\n */\r\nfunction register(command) {\r\n  commands[command.name] = command;\r\n}\r\n\r\nexport default {\r\n  create,\r\n  register,\r\n};\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Error-message factory\r\n */\r\nimport snippet from 'tui-code-snippet';\r\nimport { keyMirror } from '@/util';\r\n\r\nconst types = keyMirror('UN_IMPLEMENTATION', 'NO_COMPONENT_NAME');\r\nconst messages = {\r\n  UN_IMPLEMENTATION: 'Should implement a method: ',\r\n  NO_COMPONENT_NAME: 'Should set a component name',\r\n};\r\nconst map = {\r\n  UN_IMPLEMENTATION(methodName) {\r\n    return messages.UN_IMPLEMENTATION + methodName;\r\n  },\r\n  NO_COMPONENT_NAME() {\r\n    return messages.NO_COMPONENT_NAME;\r\n  },\r\n};\r\n\r\nexport default {\r\n  types: snippet.extend({}, types),\r\n\r\n  create(type, ...args) {\r\n    type = type.toLowerCase();\r\n    const func = map[type];\r\n\r\n    return func(...args);\r\n  },\r\n};\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Graphics module\r\n */\r\nimport snippet from 'tui-code-snippet';\r\nimport fabric from 'fabric';\r\nimport ImageLoader from '@/component/imageLoader';\r\nimport Cropper from '@/component/cropper';\r\nimport Flip from '@/component/flip';\r\nimport Rotation from '@/component/rotation';\r\nimport FreeDrawing from '@/component/freeDrawing';\r\nimport Line from '@/component/line';\r\nimport Text from '@/component/text';\r\nimport Icon from '@/component/icon';\r\nimport Filter from '@/component/filter';\r\nimport Shape from '@/component/shape';\r\nimport Zoom from '@/component/zoom';\r\nimport CropperDrawingMode from '@/drawingMode/cropper';\r\nimport FreeDrawingMode from '@/drawingMode/freeDrawing';\r\nimport LineDrawingMode from '@/drawingMode/lineDrawing';\r\nimport ShapeDrawingMode from '@/drawingMode/shape';\r\nimport TextDrawingMode from '@/drawingMode/text';\r\nimport IconDrawingMode from '@/drawingMode/icon';\r\nimport ZoomDrawingMode from '@/drawingMode/zoom';\r\nimport {\r\n  makeSelectionUndoData,\r\n  makeSelectionUndoDatum,\r\n  setCachedUndoDataForDimension,\r\n} from '@/helper/selectionModifyHelper';\r\nimport { getProperties, includes, isShape, Promise } from '@/util';\r\nimport {\r\n  componentNames as components,\r\n  eventNames as events,\r\n  drawingModes,\r\n  fObjectOptions,\r\n} from '@/consts';\r\nimport Resize from '@/component/resize';\r\nimport ResizeDrawingMode from '@/drawingMode/resize';\r\nimport JsonLoader from '@/component/jsonLoader';\r\n\r\nconst { extend, stamp, isArray, isString, forEachArray, forEachOwnProperties, CustomEvents } =\r\n  snippet;\r\nconst DEFAULT_CSS_MAX_WIDTH = 1000;\r\nconst DEFAULT_CSS_MAX_HEIGHT = 800;\r\nconst EXTRA_PX_FOR_PASTE = 10;\r\n\r\nconst cssOnly = {\r\n  cssOnly: true,\r\n};\r\nconst backstoreOnly = {\r\n  backstoreOnly: true,\r\n};\r\n\r\n/**\r\n * Graphics class\r\n * @class\r\n * @param {string|HTMLElement} wrapper - Wrapper's element or selector\r\n * @param {Object} [option] - Canvas max width & height of css\r\n *  @param {number} option.cssMaxWidth - Canvas css-max-width\r\n *  @param {number} option.cssMaxHeight - Canvas css-max-height\r\n *  @param {String} option.backgroundColor - Canvas background color hex code\r\n * @ignore\r\n */\r\nclass Graphics {\r\n  constructor(\r\n    element,\r\n    { cssMaxWidth, cssMaxHeight, preserveObjectStacking, backgroundColor } = {}\r\n  ) {\r\n    /**\r\n     * Fabric image instance\r\n     * @type {fabric.Image}\r\n     */\r\n    this.canvasImage = null;\r\n\r\n    /**\r\n     * Max width of canvas elements\r\n     * @type {number}\r\n     */\r\n    this.cssMaxWidth = cssMaxWidth || DEFAULT_CSS_MAX_WIDTH;\r\n\r\n    /**\r\n     * Max height of canvas elements\r\n     * @type {number}\r\n     */\r\n    this.cssMaxHeight = cssMaxHeight || DEFAULT_CSS_MAX_HEIGHT;\r\n\r\n    /**\r\n     * cropper Selection Style\r\n     * @type {Object}\r\n     */\r\n    this.cropSelectionStyle = {};\r\n\r\n    /**\r\n     * target fabric object for copy paste feature\r\n     * @type {fabric.Object}\r\n     * @private\r\n     */\r\n    this.targetObjectForCopyPaste = null;\r\n\r\n    /**\r\n     * Image name\r\n     * @type {string}\r\n     */\r\n    this.imageName = '';\r\n\r\n    /**\r\n     * Object Map\r\n     * @type {Object}\r\n     * @private\r\n     */\r\n    this._objects = {};\r\n\r\n    /**\r\n     * Fabric-Canvas instance\r\n     * @type {fabric.Canvas}\r\n     * @private\r\n     */\r\n    this._canvas = null;\r\n\r\n    /**\r\n     * Drawing mode\r\n     * @type {string}\r\n     * @private\r\n     */\r\n    this._drawingMode = drawingModes.NORMAL;\r\n\r\n    /**\r\n     * DrawingMode map\r\n     * @type {Object.<string, DrawingMode>}\r\n     * @private\r\n     */\r\n    this._drawingModeMap = {};\r\n\r\n    /**\r\n     * Component map\r\n     * @type {Object.<string, Component>}\r\n     * @private\r\n     */\r\n    this._componentMap = {};\r\n\r\n    /**\r\n     * fabric event handlers\r\n     * @type {Object.<string, function>}\r\n     * @private\r\n     */\r\n    this._handler = {\r\n      onMouseDown: this._onMouseDown.bind(this),\r\n      onMouseUp: this._onMouseUp.bind(this),\r\n      onMouseMove: this._onMouseMove.bind(this),\r\n      onMouseWheel: this._onMouseWheel.bind(this),\r\n      onObjectAdded: this._onObjectAdded.bind(this),\r\n      onObjectRemoved: this._onObjectRemoved.bind(this),\r\n      onObjectMoved: this._onObjectMoved.bind(this),\r\n      onObjectScaled: this._onObjectScaled.bind(this),\r\n      onObjectModified: this._onObjectModified.bind(this),\r\n      onObjectRotated: this._onObjectRotated.bind(this),\r\n      onObjectSelected: this._onObjectSelected.bind(this),\r\n      onPathCreated: this._onPathCreated.bind(this),\r\n      onSelectionCleared: this._onSelectionCleared.bind(this),\r\n      onSelectionCreated: this._onSelectionCreated.bind(this),\r\n    };\r\n\r\n    this._setObjectCachingToFalse();\r\n    this._setCanvasElement(element, preserveObjectStacking, backgroundColor);\r\n    this._createDrawingModeInstances();\r\n    this._createComponents();\r\n    this._attachCanvasEvents();\r\n    this._attachZoomEvents();\r\n  }\r\n\r\n  /**\r\n   * Destroy canvas element\r\n   */\r\n  destroy() {\r\n    const { wrapperEl } = this._canvas;\r\n\r\n    this._canvas.clear();\r\n\r\n    wrapperEl.parentNode.removeChild(wrapperEl);\r\n\r\n    this._detachZoomEvents();\r\n  }\r\n\r\n  /**\r\n   * Attach zoom events\r\n   */\r\n  _attachZoomEvents() {\r\n    const zoom = this.getComponent(components.ZOOM);\r\n\r\n    zoom.attachKeyboardZoomEvents();\r\n  }\r\n\r\n  /**\r\n   * Detach zoom events\r\n   */\r\n  _detachZoomEvents() {\r\n    const zoom = this.getComponent(components.ZOOM);\r\n\r\n    zoom.detachKeyboardZoomEvents();\r\n  }\r\n\r\n  /**\r\n   * Deactivates all objects on canvas\r\n   * @returns {Graphics} this\r\n   */\r\n  deactivateAll() {\r\n    this._canvas.discardActiveObject();\r\n\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Renders all objects on canvas\r\n   * @returns {Graphics} this\r\n   */\r\n  renderAll() {\r\n    this._canvas.renderAll();\r\n\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Adds objects on canvas\r\n   * @param {Object|Array} objects - objects\r\n   */\r\n  add(objects) {\r\n    let theArgs = [];\r\n    if (isArray(objects)) {\r\n      theArgs = objects;\r\n    } else {\r\n      theArgs.push(objects);\r\n    }\r\n\r\n    this._canvas.add(...theArgs);\r\n  }\r\n\r\n  /**\r\n   * Removes the object or group\r\n   * @param {Object} target - graphics object or group\r\n   * @returns {boolean} true if contains or false\r\n   */\r\n  contains(target) {\r\n    return this._canvas.contains(target);\r\n  }\r\n\r\n  /**\r\n   * Gets all objects or group\r\n   * @returns {Array} all objects, shallow copy\r\n   */\r\n  getObjects() {\r\n    return this._canvas.getObjects().slice();\r\n  }\r\n\r\n  /**\r\n   * Get an object by id\r\n   * @param {number} objId -  object id\r\n   * @returns {fabric.Object} object corresponding id\r\n   */\r\n  getObject(objId) {\r\n    return this._objects[objId];\r\n  }\r\n\r\n  /**\r\n   * Removes the object or group\r\n   * @param {Object} target - graphics object or group\r\n   */\r\n  remove(target) {\r\n    this._canvas.remove(target);\r\n  }\r\n\r\n  /**\r\n   * Removes all object or group\r\n   * @param {boolean} includesBackground - remove the background image or not\r\n   * @returns {Array} all objects array which is removed\r\n   */\r\n  removeAll(includesBackground) {\r\n    const canvas = this._canvas;\r\n    const objects = canvas.getObjects().slice();\r\n    canvas.remove(...this._canvas.getObjects());\r\n\r\n    if (includesBackground) {\r\n      canvas.clear();\r\n    }\r\n\r\n    return objects;\r\n  }\r\n\r\n  /**\r\n   * Removes an object or group by id\r\n   * @param {number} objId -  object id\r\n   * @returns {Array} removed objects\r\n   */\r\n  removeObjectById(objId) {\r\n    const objects = [];\r\n    const canvas = this._canvas;\r\n    const target = this.getObject(objId);\r\n    const isValidGroup = target && target.isType('group') && !target.isEmpty();\r\n\r\n    if (isValidGroup) {\r\n      canvas.discardActiveObject(); // restore states for each objects\r\n      target.forEachObject((obj) => {\r\n        objects.push(obj);\r\n        canvas.remove(obj);\r\n      });\r\n    } else if (canvas.contains(target)) {\r\n      objects.push(target);\r\n      canvas.remove(target);\r\n    }\r\n\r\n    return objects;\r\n  }\r\n\r\n  /**\r\n   * Get an id by object instance\r\n   * @param {fabric.Object} object object\r\n   * @returns {number} object id if it exists or null\r\n   */\r\n  getObjectId(object) {\r\n    let key = null;\r\n    for (key in this._objects) {\r\n      if (this._objects.hasOwnProperty(key)) {\r\n        if (object === this._objects[key]) {\r\n          return key;\r\n        }\r\n      }\r\n    }\r\n\r\n    return null;\r\n  }\r\n\r\n  /**\r\n   * Gets an active object or group\r\n   * @returns {Object} active object or group instance\r\n   */\r\n  getActiveObject() {\r\n    return this._canvas._activeObject;\r\n  }\r\n\r\n  /**\r\n   * Returns the object ID to delete the object.\r\n   * @returns {number} object id for remove\r\n   */\r\n  getActiveObjectIdForRemove() {\r\n    const activeObject = this.getActiveObject();\r\n    const { type, left, top } = activeObject;\r\n    const isSelection = type === 'activeSelection';\r\n\r\n    if (isSelection) {\r\n      const group = new fabric.Group([...activeObject.getObjects()], {\r\n        left,\r\n        top,\r\n      });\r\n\r\n      return this._addFabricObject(group);\r\n    }\r\n\r\n    return this.getObjectId(activeObject);\r\n  }\r\n\r\n  /**\r\n   * Verify that you are ready to erase the object.\r\n   * @returns {boolean} ready for object remove\r\n   */\r\n  isReadyRemoveObject() {\r\n    const activeObject = this.getActiveObject();\r\n\r\n    return activeObject && !activeObject.isEditing;\r\n  }\r\n\r\n  /**\r\n   * Gets an active group object\r\n   * @returns {Object} active group object instance\r\n   */\r\n  getActiveObjects() {\r\n    const activeObject = this._canvas._activeObject;\r\n\r\n    return activeObject && activeObject.type === 'activeSelection' ? activeObject : null;\r\n  }\r\n\r\n  /**\r\n   * Get Active object Selection from object ids\r\n   * @param {Array.<Object>} objects - fabric objects\r\n   * @returns {Object} target - target object group\r\n   */\r\n  getActiveSelectionFromObjects(objects) {\r\n    const canvas = this.getCanvas();\r\n\r\n    return new fabric.ActiveSelection(objects, { canvas });\r\n  }\r\n\r\n  /**\r\n   * Activates an object or group\r\n   * @param {Object} target - target object or group\r\n   */\r\n  setActiveObject(target) {\r\n    this._canvas.setActiveObject(target);\r\n  }\r\n\r\n  /**\r\n   * Set Crop selection style\r\n   * @param {Object} style - Selection styles\r\n   */\r\n  setCropSelectionStyle(style) {\r\n    this.cropSelectionStyle = style;\r\n  }\r\n\r\n  /**\r\n   * Get component\r\n   * @param {string} name - Component name\r\n   * @returns {Component}\r\n   */\r\n  getComponent(name) {\r\n    return this._componentMap[name];\r\n  }\r\n\r\n  /**\r\n   * Get current drawing mode\r\n   * @returns {string}\r\n   */\r\n  getDrawingMode() {\r\n    return this._drawingMode;\r\n  }\r\n\r\n  /**\r\n   * Start a drawing mode. If the current mode is not 'NORMAL', 'stopDrawingMode()' will be called first.\r\n   * @param {String} mode Can be one of <I>'CROPPER', 'FREE_DRAWING', 'LINE', 'TEXT', 'SHAPE'</I>\r\n   * @param {Object} [option] parameters of drawing mode, it's available with 'FREE_DRAWING', 'LINE_DRAWING'\r\n   *  @param {Number} [option.width] brush width\r\n   *  @param {String} [option.color] brush color\r\n   * @returns {boolean} true if success or false\r\n   */\r\n  startDrawingMode(mode, option) {\r\n    if (this._isSameDrawingMode(mode)) {\r\n      return true;\r\n    }\r\n\r\n    // If the current mode is not 'NORMAL', 'stopDrawingMode()' will be called first.\r\n    this.stopDrawingMode();\r\n\r\n    const drawingModeInstance = this._getDrawingModeInstance(mode);\r\n    if (drawingModeInstance && drawingModeInstance.start) {\r\n      drawingModeInstance.start(this, option);\r\n\r\n      this._drawingMode = mode;\r\n    }\r\n\r\n    return !!drawingModeInstance;\r\n  }\r\n\r\n  /**\r\n   * Stop the current drawing mode and back to the 'NORMAL' mode\r\n   */\r\n  stopDrawingMode() {\r\n    if (this._isSameDrawingMode(drawingModes.NORMAL)) {\r\n      return;\r\n    }\r\n\r\n    const drawingModeInstance = this._getDrawingModeInstance(this.getDrawingMode());\r\n    if (drawingModeInstance && drawingModeInstance.end) {\r\n      drawingModeInstance.end(this);\r\n    }\r\n    this._drawingMode = drawingModes.NORMAL;\r\n  }\r\n\r\n  canvasZoom({ x, y }, zoomLevel) {\r\n    const canvas = this.getCanvas();\r\n    canvas.zoomToPoint({ x, y }, zoomLevel);\r\n  }\r\n\r\n  getCanvasZoom() {\r\n    return this.getCanvas().getZoom();\r\n  }\r\n\r\n  /**\r\n   * Change zoom of canvas\r\n   * @param {{x: number, y: number}} center - center of zoom\r\n   * @param {number} zoomLevel - zoom level\r\n   */\r\n  zoom({ x, y }, zoomLevel) {\r\n    const zoom = this.getComponent(components.ZOOM);\r\n\r\n    zoom.zoom({ x, y }, zoomLevel);\r\n  }\r\n\r\n  /**\r\n   * Get zoom mode\r\n   * @returns {string}\r\n   */\r\n  getZoomMode() {\r\n    const zoom = this.getComponent(components.ZOOM);\r\n\r\n    return zoom.mode;\r\n  }\r\n\r\n  /**\r\n   * Start zoom-in mode\r\n   */\r\n  startZoomInMode() {\r\n    const zoom = this.getComponent(components.ZOOM);\r\n\r\n    zoom.startZoomInMode();\r\n  }\r\n\r\n  /**\r\n   * Stop zoom-in mode\r\n   */\r\n  endZoomInMode() {\r\n    const zoom = this.getComponent(components.ZOOM);\r\n\r\n    zoom.endZoomInMode();\r\n  }\r\n\r\n  /**\r\n   * Zoom out one step\r\n   */\r\n  zoomOut() {\r\n    const zoom = this.getComponent(components.ZOOM);\r\n\r\n    zoom.zoomOut();\r\n  }\r\n\r\n  /**\r\n   * Start hand mode\r\n   */\r\n  startHandMode() {\r\n    const zoom = this.getComponent(components.ZOOM);\r\n\r\n    zoom.startHandMode();\r\n  }\r\n\r\n  /**\r\n   * Stop hand mode\r\n   */\r\n  endHandMode() {\r\n    const zoom = this.getComponent(components.ZOOM);\r\n\r\n    zoom.endHandMode();\r\n  }\r\n\r\n  /**\r\n   * Zoom reset\r\n   */\r\n  resetZoom() {\r\n    const zoom = this.getComponent(components.ZOOM);\r\n\r\n    zoom.resetZoom();\r\n  }\r\n\r\n  /**\r\n   * To data url from canvas\r\n   * @param {Object} options - options for toDataURL\r\n   *   @param {String} [options.format=png] The format of the output image. Either \"jpeg\" or \"png\"\r\n   *   @param {Number} [options.quality=1] Quality level (0..1). Only used for jpeg.\r\n   *   @param {Number} [options.multiplier=1] Multiplier to scale by\r\n   *   @param {Number} [options.left] Cropping left offset. Introduced in fabric v1.2.14\r\n   *   @param {Number} [options.top] Cropping top offset. Introduced in fabric v1.2.14\r\n   *   @param {Number} [options.width] Cropping width. Introduced in fabric v1.2.14\r\n   *   @param {Number} [options.height] Cropping height. Introduced in fabric v1.2.14\r\n   * @returns {string} A DOMString containing the requested data URI.\r\n   */\r\n  toDataURL(options) {\r\n    const cropper = this.getComponent(components.CROPPER);\r\n    cropper.changeVisibility(false);\r\n\r\n    const dataUrl = this._canvas && this._canvas.toDataURL(options);\r\n    cropper.changeVisibility(true);\r\n\r\n    return dataUrl;\r\n  }\r\n\r\n  /**\r\n   * Save image(background) of canvas\r\n   * @param {string} name - Name of image\r\n   * @param {?fabric.Image} canvasImage - Fabric image instance\r\n   */\r\n  setCanvasImage(name, canvasImage) {\r\n    if (canvasImage) {\r\n      stamp(canvasImage);\r\n    }\r\n    this.imageName = name;\r\n    this.canvasImage = canvasImage;\r\n  }\r\n\r\n  /**\r\n   * Set css max dimension\r\n   * @param {{width: number, height: number}} maxDimension - Max width & Max height\r\n   */\r\n  setCssMaxDimension(maxDimension) {\r\n    this.cssMaxWidth = maxDimension.width || this.cssMaxWidth;\r\n    this.cssMaxHeight = maxDimension.height || this.cssMaxHeight;\r\n  }\r\n\r\n  /**\r\n   * Adjust canvas dimension with scaling image\r\n   */\r\n  adjustCanvasDimension() {\r\n    this.adjustCanvasDimensionBase(this.canvasImage.scale(1));\r\n  }\r\n\r\n  adjustCanvasDimensionBase(canvasImage = null) {\r\n    if (!canvasImage) {\r\n      canvasImage = this.canvasImage;\r\n    }\r\n\r\n    const { width, height } = canvasImage.getBoundingRect();\r\n    const maxDimension = this._calcMaxDimension(width, height);\r\n\r\n    this.setCanvasCssDimension({\r\n      width: '100%',\r\n      height: '100%', // Set height '' for IE9\r\n      'max-width': `${maxDimension.width}px`,\r\n      'max-height': `${maxDimension.height}px`,\r\n    });\r\n\r\n    this.setCanvasBackstoreDimension({\r\n      width,\r\n      height,\r\n    });\r\n    this._canvas.centerObject(canvasImage);\r\n  }\r\n\r\n  /**\r\n   * Set canvas dimension - css only\r\n   *  {@link http://fabricjs.com/docs/fabric.Canvas.html#setDimensions}\r\n   * @param {Object} dimension - Canvas css dimension\r\n   */\r\n  setCanvasCssDimension(dimension) {\r\n    this._canvas.setDimensions(dimension, cssOnly);\r\n  }\r\n\r\n  /**\r\n   * Set canvas dimension - backstore only\r\n   *  {@link http://fabricjs.com/docs/fabric.Canvas.html#setDimensions}\r\n   * @param {Object} dimension - Canvas backstore dimension\r\n   */\r\n  setCanvasBackstoreDimension(dimension) {\r\n    this._canvas.setDimensions(dimension, backstoreOnly);\r\n  }\r\n\r\n  /**\r\n   * Set image properties\r\n   * {@link http://fabricjs.com/docs/fabric.Image.html#set}\r\n   * @param {Object} setting - Image properties\r\n   * @param {boolean} [withRendering] - If true, The changed image will be reflected in the canvas\r\n   */\r\n  setImageProperties(setting, withRendering) {\r\n    const { canvasImage } = this;\r\n\r\n    if (!canvasImage) {\r\n      return;\r\n    }\r\n\r\n    canvasImage.set(setting).setCoords();\r\n    if (withRendering) {\r\n      this._canvas.renderAll();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Returns canvas element of fabric.Canvas[[lower-canvas]]\r\n   * @returns {HTMLCanvasElement}\r\n   */\r\n  getCanvasElement() {\r\n    return this._canvas.getElement();\r\n  }\r\n\r\n  /**\r\n   * Get fabric.Canvas instance\r\n   * @returns {fabric.Canvas}\r\n   */\r\n  getCanvas() {\r\n    return this._canvas;\r\n  }\r\n\r\n  /**\r\n   * Get canvasImage (fabric.Image instance)\r\n   * @returns {fabric.Image}\r\n   */\r\n  getCanvasImage() {\r\n    return this.canvasImage;\r\n  }\r\n\r\n  /**\r\n   * Get image name\r\n   * @returns {string}\r\n   */\r\n  getImageName() {\r\n    return this.imageName;\r\n  }\r\n\r\n  /**\r\n   * Add image object on canvas\r\n   * @param {string} imgUrl - Image url to make object\r\n   * @returns {Promise}\r\n   */\r\n  addImageObject(imgUrl) {\r\n    const callback = this._callbackAfterLoadingImageObject.bind(this);\r\n\r\n    return new Promise((resolve) => {\r\n      fabric.Image.fromURL(\r\n        imgUrl,\r\n        (image) => {\r\n          callback(image);\r\n          resolve(this.createObjectProperties(image));\r\n        },\r\n        {\r\n          crossOrigin: 'Anonymous',\r\n        }\r\n      );\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Get center position of canvas\r\n   * @returns {Object} {left, top}\r\n   */\r\n  getCenter() {\r\n    return this._canvas.getCenter();\r\n  }\r\n\r\n  /**\r\n   * Get cropped rect\r\n   * @returns {Object} rect\r\n   */\r\n  getCropzoneRect() {\r\n    return this.getComponent(components.CROPPER).getCropzoneRect();\r\n  }\r\n\r\n  /**\r\n   * Get cropped rect\r\n   * @param {number} [mode] cropzone rect mode\r\n   */\r\n  setCropzoneRect(mode) {\r\n    this.getComponent(components.CROPPER).setCropzoneRect(mode);\r\n  }\r\n\r\n  /**\r\n   * Get cropped image data\r\n   * @param {Object} cropRect cropzone rect\r\n   *  @param {Number} cropRect.left left position\r\n   *  @param {Number} cropRect.top top position\r\n   *  @param {Number} cropRect.width width\r\n   *  @param {Number} cropRect.height height\r\n   * @returns {?{imageName: string, url: string}} cropped Image data\r\n   */\r\n  getCroppedImageData(cropRect) {\r\n    return this.getComponent(components.CROPPER).getCroppedImageData(cropRect);\r\n  }\r\n\r\n  /**\r\n   * Set brush option\r\n   * @param {Object} option brush option\r\n   *  @param {Number} option.width width\r\n   *  @param {String} option.color color like 'FFFFFF', 'rgba(0, 0, 0, 0.5)'\r\n   */\r\n  setBrush(option) {\r\n    const drawingMode = this._drawingMode;\r\n    let compName = components.FREE_DRAWING;\r\n\r\n    if (drawingMode === drawingModes.LINE_DRAWING) {\r\n      compName = components.LINE;\r\n    }\r\n\r\n    this.getComponent(compName).setBrush(option);\r\n  }\r\n\r\n  /**\r\n   * Set states of current drawing shape\r\n   * @param {string} type - Shape type (ex: 'rect', 'circle', 'triangle')\r\n   * @param {Object} [options] - Shape options\r\n   *      @param {(ShapeFillOption | string)} [options.fill] - {@link ShapeFillOption} or\r\n   *        Shape foreground color (ex: '#fff', 'transparent')\r\n   *      @param {string} [options.stoke] - Shape outline color\r\n   *      @param {number} [options.strokeWidth] - Shape outline width\r\n   *      @param {number} [options.width] - Width value (When type option is 'rect', this options can use)\r\n   *      @param {number} [options.height] - Height value (When type option is 'rect', this options can use)\r\n   *      @param {number} [options.rx] - Radius x value (When type option is 'circle', this options can use)\r\n   *      @param {number} [options.ry] - Radius y value (When type option is 'circle', this options can use)\r\n   *      @param {number} [options.isRegular] - Whether resizing shape has 1:1 ratio or not\r\n   */\r\n  setDrawingShape(type, options) {\r\n    this.getComponent(components.SHAPE).setStates(type, options);\r\n  }\r\n\r\n  /**\r\n   * Set style of current drawing icon\r\n   * @param {string} type - icon type (ex: 'icon-arrow', 'icon-star')\r\n   * @param {Object} [iconColor] - Icon color\r\n   */\r\n  setIconStyle(type, iconColor) {\r\n    this.getComponent(components.ICON).setStates(type, iconColor);\r\n  }\r\n\r\n  /**\r\n   * Register icon paths\r\n   * @param {Object} pathInfos - Path infos\r\n   *  @param {string} pathInfos.key - key\r\n   *  @param {string} pathInfos.value - value\r\n   */\r\n  registerPaths(pathInfos) {\r\n    this.getComponent(components.ICON).registerPaths(pathInfos);\r\n  }\r\n\r\n  /**\r\n   * Change cursor style\r\n   * @param {string} cursorType - cursor type\r\n   */\r\n  changeCursor(cursorType) {\r\n    const canvas = this.getCanvas();\r\n    canvas.defaultCursor = cursorType;\r\n    canvas.renderAll();\r\n  }\r\n\r\n  /**\r\n   * Whether it has the filter or not\r\n   * @param {string} type - Filter type\r\n   * @returns {boolean} true if it has the filter\r\n   */\r\n  hasFilter(type) {\r\n    return this.getComponent(components.FILTER).hasFilter(type);\r\n  }\r\n\r\n  /**\r\n   * Set selection style of fabric object by init option\r\n   * @param {Object} styles - Selection styles\r\n   */\r\n  setSelectionStyle(styles) {\r\n    extend(fObjectOptions.SELECTION_STYLE, styles);\r\n  }\r\n\r\n  /**\r\n   * Set object properties\r\n   * @param {number} objId -  object id\r\n   * @param {Object} props - props\r\n   *     @param {string} [props.fill] Color\r\n   *     @param {string} [props.fontFamily] Font type for text\r\n   *     @param {number} [props.fontSize] Size\r\n   *     @param {string} [props.fontStyle] Type of inclination (normal / italic)\r\n   *     @param {string} [props.fontWeight] Type of thicker or thinner looking (normal / bold)\r\n   *     @param {string} [props.textAlign] Type of text align (left / center / right)\r\n   *     @param {string} [props.textDecoration] Type of line (underline / line-through / overline)\r\n   * @returns {Object} applied properties\r\n   */\r\n  setObjectProperties(objId, props) {\r\n    const object = this.getObject(objId);\r\n    const clone = extend({}, props);\r\n\r\n    object.set(clone);\r\n\r\n    object.setCoords();\r\n\r\n    this.getCanvas().renderAll();\r\n\r\n    return clone;\r\n  }\r\n\r\n  /**\r\n   * Get object properties corresponding key\r\n   * @param {number} objId -  object id\r\n   * @param {Array<string>|ObjectProps|string} keys - property's key\r\n   * @returns {Object} properties\r\n   */\r\n  getObjectProperties(objId, keys) {\r\n    const object = this.getObject(objId);\r\n    const props = {};\r\n\r\n    if (isString(keys)) {\r\n      props[keys] = object[keys];\r\n    } else if (isArray(keys)) {\r\n      forEachArray(keys, (value) => {\r\n        props[value] = object[value];\r\n      });\r\n    } else {\r\n      forEachOwnProperties(keys, (value, key) => {\r\n        props[key] = object[key];\r\n      });\r\n    }\r\n\r\n    return props;\r\n  }\r\n\r\n  /**\r\n   * Get object position by originX, originY\r\n   * @param {number} objId -  object id\r\n   * @param {string} originX - can be 'left', 'center', 'right'\r\n   * @param {string} originY - can be 'top', 'center', 'bottom'\r\n   * @returns {Object} {{x:number, y: number}} position by origin if id is valobjId, or null\r\n   */\r\n  getObjectPosition(objId, originX, originY) {\r\n    const targetObj = this.getObject(objId);\r\n    if (!targetObj) {\r\n      return null;\r\n    }\r\n\r\n    return targetObj.getPointByOrigin(originX, originY);\r\n  }\r\n\r\n  /**\r\n   * Set object position  by originX, originY\r\n   * @param {number} objId -  object id\r\n   * @param {Object} posInfo - position object\r\n   *  @param {number} posInfo.x - x position\r\n   *  @param {number} posInfo.y - y position\r\n   *  @param {string} posInfo.originX - can be 'left', 'center', 'right'\r\n   *  @param {string} posInfo.originY - can be 'top', 'center', 'bottom'\r\n   * @returns {boolean} true if target id is valid or false\r\n   */\r\n  setObjectPosition(objId, posInfo) {\r\n    const targetObj = this.getObject(objId);\r\n    const { x, y, originX, originY } = posInfo;\r\n    if (!targetObj) {\r\n      return false;\r\n    }\r\n\r\n    const targetOrigin = targetObj.getPointByOrigin(originX, originY);\r\n    const centerOrigin = targetObj.getPointByOrigin('center', 'center');\r\n    const diffX = centerOrigin.x - targetOrigin.x;\r\n    const diffY = centerOrigin.y - targetOrigin.y;\r\n\r\n    targetObj.set({\r\n      left: x + diffX,\r\n      top: y + diffY,\r\n    });\r\n\r\n    targetObj.setCoords();\r\n\r\n    return true;\r\n  }\r\n\r\n  /**\r\n   * Get the canvas size\r\n   * @returns {Object} {{width: number, height: number}} image size\r\n   */\r\n  getCanvasSize() {\r\n    const image = this.getCanvasImage();\r\n\r\n    return {\r\n      width: image ? image.width : 0,\r\n      height: image ? image.height : 0,\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Create fabric static canvas\r\n   * @returns {Object} {{width: number, height: number}} image size\r\n   */\r\n  createStaticCanvas() {\r\n    const staticCanvas = new fabric.StaticCanvas();\r\n\r\n    staticCanvas.set({\r\n      enableRetinaScaling: false,\r\n    });\r\n\r\n    return staticCanvas;\r\n  }\r\n\r\n  /**\r\n   * Get a DrawingMode instance\r\n   * @param {string} modeName - DrawingMode Class Name\r\n   * @returns {DrawingMode} DrawingMode instance\r\n   * @private\r\n   */\r\n  _getDrawingModeInstance(modeName) {\r\n    return this._drawingModeMap[modeName];\r\n  }\r\n\r\n  /**\r\n   * Set object caching to false. This brought many bugs when draw Shape & cropzone\r\n   * @see http://fabricjs.com/fabric-object-caching\r\n   * @private\r\n   */\r\n  _setObjectCachingToFalse() {\r\n    fabric.Object.prototype.objectCaching = false;\r\n  }\r\n\r\n  /**\r\n   * Set canvas element to fabric.Canvas\r\n   * @param {Element|string} element - Wrapper or canvas element or selector\r\n   * @param {Boolean} preserveObjectStacking - preserve object stacking or not\r\n   * @param {String} backgroundColor - hex code for canvas background color\r\n   * @private\r\n   */\r\n  _setCanvasElement(element, preserveObjectStacking, backgroundColor) {\r\n    let selectedElement;\r\n    let canvasElement;\r\n\r\n    if (element.nodeType) {\r\n      selectedElement = element;\r\n    } else {\r\n      selectedElement = document.querySelector(element);\r\n    }\r\n\r\n    if (selectedElement.nodeName.toUpperCase() !== 'CANVAS') {\r\n      canvasElement = document.createElement('canvas');\r\n      selectedElement.appendChild(canvasElement);\r\n    }\r\n\r\n    this._canvas = new fabric.Canvas(canvasElement, {\r\n      backgroundColor,\r\n      containerClass: 'tui-image-editor-canvas-container',\r\n      enableRetinaScaling: false,\r\n      preserveObjectStacking,\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Creates DrawingMode instances\r\n   * @private\r\n   */\r\n  _createDrawingModeInstances() {\r\n    this._register(this._drawingModeMap, new CropperDrawingMode());\r\n    this._register(this._drawingModeMap, new FreeDrawingMode());\r\n    this._register(this._drawingModeMap, new LineDrawingMode());\r\n    this._register(this._drawingModeMap, new ShapeDrawingMode());\r\n    this._register(this._drawingModeMap, new TextDrawingMode());\r\n    this._register(this._drawingModeMap, new IconDrawingMode());\r\n    this._register(this._drawingModeMap, new ZoomDrawingMode());\r\n    this._register(this._drawingModeMap, new ResizeDrawingMode());\r\n  }\r\n\r\n  /**\r\n   * Create components\r\n   * @private\r\n   */\r\n  _createComponents() {\r\n    this._register(this._componentMap, new ImageLoader(this));\r\n    this._register(this._componentMap, new JsonLoader(this));\r\n    this._register(this._componentMap, new Cropper(this));\r\n    this._register(this._componentMap, new Flip(this));\r\n    this._register(this._componentMap, new Rotation(this));\r\n    this._register(this._componentMap, new FreeDrawing(this));\r\n    this._register(this._componentMap, new Line(this));\r\n    this._register(this._componentMap, new Text(this));\r\n    this._register(this._componentMap, new Icon(this));\r\n    this._register(this._componentMap, new Filter(this));\r\n    this._register(this._componentMap, new Shape(this));\r\n    this._register(this._componentMap, new Zoom(this));\r\n    this._register(this._componentMap, new Resize(this));\r\n  }\r\n\r\n  /**\r\n   * Register component\r\n   * @param {Object} map - map object\r\n   * @param {Object} module - module which has getName method\r\n   * @private\r\n   */\r\n  _register(map, module) {\r\n    map[module.getName()] = module;\r\n  }\r\n\r\n  /**\r\n   * Get the current drawing mode is same with given mode\r\n   * @param {string} mode drawing mode\r\n   * @returns {boolean} true if same or false\r\n   */\r\n  _isSameDrawingMode(mode) {\r\n    return this.getDrawingMode() === mode;\r\n  }\r\n\r\n  /**\r\n   * Calculate max dimension of canvas\r\n   * The css-max dimension is dynamically decided with maintaining image ratio\r\n   * The css-max dimension is lower than canvas dimension (attribute of canvas, not css)\r\n   * @param {number} width - Canvas width\r\n   * @param {number} height - Canvas height\r\n   * @returns {{width: number, height: number}} - Max width & Max height\r\n   * @private\r\n   */\r\n  _calcMaxDimension(width, height) {\r\n    const wScaleFactor = this.cssMaxWidth / width;\r\n    const hScaleFactor = this.cssMaxHeight / height;\r\n    let cssMaxWidth = Math.min(width, this.cssMaxWidth);\r\n    let cssMaxHeight = Math.min(height, this.cssMaxHeight);\r\n\r\n    if (wScaleFactor < 1 && wScaleFactor < hScaleFactor) {\r\n      cssMaxWidth = width * wScaleFactor;\r\n      cssMaxHeight = height * wScaleFactor;\r\n    } else if (hScaleFactor < 1 && hScaleFactor < wScaleFactor) {\r\n      cssMaxWidth = width * hScaleFactor;\r\n      cssMaxHeight = height * hScaleFactor;\r\n    }\r\n\r\n    return {\r\n      width: Math.floor(cssMaxWidth),\r\n      height: Math.floor(cssMaxHeight),\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Callback function after loading image\r\n   * @param {fabric.Image} obj - Fabric image object\r\n   * @private\r\n   */\r\n  _callbackAfterLoadingImageObject(obj) {\r\n    const centerPos = this.getCanvasImage().getCenterPoint();\r\n\r\n    obj.set(fObjectOptions.SELECTION_STYLE);\r\n    obj.set({\r\n      left: centerPos.x,\r\n      top: centerPos.y,\r\n      crossOrigin: 'Anonymous',\r\n    });\r\n\r\n    this.getCanvas().add(obj).setActiveObject(obj);\r\n  }\r\n\r\n  /**\r\n   * Attach canvas's events\r\n   */\r\n  _attachCanvasEvents() {\r\n    const canvas = this._canvas;\r\n    const handler = this._handler;\r\n    canvas.on({\r\n      'mouse:down': handler.onMouseDown,\r\n      'mouse:up': handler.onMouseUp,\r\n      'mouse:move': handler.onMouseMove,\r\n      'mouse:wheel': handler.onMouseWheel,\r\n      'object:added': handler.onObjectAdded,\r\n      'object:removed': handler.onObjectRemoved,\r\n      'object:moving': handler.onObjectMoved,\r\n      'object:scaling': handler.onObjectScaled,\r\n      'object:modified': handler.onObjectModified,\r\n      'object:rotating': handler.onObjectRotated,\r\n      'path:created': handler.onPathCreated,\r\n      'selection:cleared': handler.onSelectionCleared,\r\n      'selection:created': handler.onSelectionCreated,\r\n      'selection:updated': handler.onObjectSelected,\r\n    });\r\n  }\r\n\r\n  /**\r\n   * \"mouse:down\" canvas event handler\r\n   * @param {{target: fabric.Object, e: MouseEvent}} fEvent - Fabric event\r\n   * @private\r\n   */\r\n  _onMouseDown(fEvent) {\r\n    const { e: event, target } = fEvent;\r\n    const originPointer = this._canvas.getPointer(event);\r\n\r\n    if (target) {\r\n      const { type } = target;\r\n      const undoData = makeSelectionUndoData(target, (item) =>\r\n        makeSelectionUndoDatum(this.getObjectId(item), item, type === 'activeSelection')\r\n      );\r\n\r\n      setCachedUndoDataForDimension(undoData);\r\n    }\r\n\r\n    this.fire(events.MOUSE_DOWN, event, originPointer);\r\n  }\r\n\r\n  _onMouseUp(fEvent) {\r\n    const { e: event } = fEvent;\r\n    const originPointer = this._canvas.getPointer(event);\r\n\r\n    this.fire(events.MOUSE_UP, event, originPointer);\r\n  }\r\n\r\n  _onMouseMove(fEvent) {\r\n    const { e: event } = fEvent;\r\n    const originPointer = this._canvas.getPointer(event);\r\n\r\n    this.fire(events.MOUSE_MOVE, event, originPointer);\r\n  }\r\n\r\n  _onMouseWheel(fEvent) {\r\n    const { e: event } = fEvent;\r\n    const originPointer = this._canvas.getPointer(event);\r\n\r\n    this.fire(events.MOUSE_WHEEL, event, originPointer);\r\n  }\r\n\r\n  /**\r\n   * \"object:added\" canvas event handler\r\n   * @param {{target: fabric.Object, e: MouseEvent}} fEvent - Fabric event\r\n   * @private\r\n   */\r\n  _onObjectAdded(fEvent) {\r\n    const obj = fEvent.target;\r\n    if (obj.isType('cropzone')) {\r\n      return;\r\n    }\r\n\r\n    this._addFabricObject(obj);\r\n  }\r\n\r\n  /**\r\n   * \"object:removed\" canvas event handler\r\n   * @param {{target: fabric.Object, e: MouseEvent}} fEvent - Fabric event\r\n   * @private\r\n   */\r\n  _onObjectRemoved(fEvent) {\r\n    const obj = fEvent.target;\r\n\r\n    this._removeFabricObject(stamp(obj));\r\n  }\r\n\r\n  /**\r\n   * \"object:moving\" canvas event handler\r\n   * @param {{target: fabric.Object, e: MouseEvent}} fEvent - Fabric event\r\n   * @private\r\n   */\r\n  _onObjectMoved(fEvent) {\r\n    this._lazyFire(\r\n      events.OBJECT_MOVED,\r\n      (object) => this.createObjectProperties(object),\r\n      fEvent.target\r\n    );\r\n  }\r\n\r\n  /**\r\n   * \"object:scaling\" canvas event handler\r\n   * @param {{target: fabric.Object, e: MouseEvent}} fEvent - Fabric event\r\n   * @private\r\n   */\r\n  _onObjectScaled(fEvent) {\r\n    this._lazyFire(\r\n      events.OBJECT_SCALED,\r\n      (object) => this.createObjectProperties(object),\r\n      fEvent.target\r\n    );\r\n  }\r\n\r\n  /**\r\n   * \"object:modified\" canvas event handler\r\n   * @param {{target: fabric.Object, e: MouseEvent}} fEvent - Fabric event\r\n   * @private\r\n   */\r\n  _onObjectModified(fEvent) {\r\n    const { target } = fEvent;\r\n    if (target.type === 'activeSelection') {\r\n      const items = target.getObjects();\r\n\r\n      items.forEach((item) => item.fire('modifiedInGroup', target));\r\n    }\r\n\r\n    this.fire(events.OBJECT_MODIFIED, target, this.getObjectId(target));\r\n  }\r\n\r\n  /**\r\n   * \"object:rotating\" canvas event handler\r\n   * @param {{target: fabric.Object, e: MouseEvent}} fEvent - Fabric event\r\n   * @private\r\n   */\r\n  _onObjectRotated(fEvent) {\r\n    this._lazyFire(\r\n      events.OBJECT_ROTATED,\r\n      (object) => this.createObjectProperties(object),\r\n      fEvent.target\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Lazy event emitter\r\n   * @param {string} eventName - event name\r\n   * @param {Function} paramsMaker - make param function\r\n   * @param {Object} [target] - Object of the event owner.\r\n   * @private\r\n   */\r\n  _lazyFire(eventName, paramsMaker, target) {\r\n    const existEventDelegation = target && target.canvasEventDelegation;\r\n    const delegationState = existEventDelegation ? target.canvasEventDelegation(eventName) : 'none';\r\n\r\n    if (delegationState === 'unregistered') {\r\n      target.canvasEventRegister(eventName, (object) => {\r\n        this.fire(eventName, paramsMaker(object));\r\n      });\r\n    }\r\n\r\n    if (delegationState === 'none') {\r\n      this.fire(eventName, paramsMaker(target));\r\n    }\r\n  }\r\n\r\n  /**\r\n   * \"object:selected\" canvas event handler\r\n   * @param {{target: fabric.Object, e: MouseEvent}} fEvent - Fabric event\r\n   * @private\r\n   */\r\n  _onObjectSelected(fEvent) {\r\n    const { target } = fEvent;\r\n    const params = this.createObjectProperties(target);\r\n\r\n    this.fire(events.OBJECT_ACTIVATED, params);\r\n  }\r\n\r\n  /**\r\n   * \"path:created\" canvas event handler\r\n   * @param {{path: fabric.Path}} obj - Path object\r\n   * @private\r\n   */\r\n  _onPathCreated(obj) {\r\n    const { x: left, y: top } = obj.path.getCenterPoint();\r\n    obj.path.set(\r\n      extend(\r\n        {\r\n          left,\r\n          top,\r\n        },\r\n        fObjectOptions.SELECTION_STYLE\r\n      )\r\n    );\r\n\r\n    const params = this.createObjectProperties(obj.path);\r\n\r\n    this.fire(events.ADD_OBJECT, params);\r\n  }\r\n\r\n  /**\r\n   * \"selction:cleared\" canvas event handler\r\n   * @private\r\n   */\r\n  _onSelectionCleared() {\r\n    this.fire(events.SELECTION_CLEARED);\r\n  }\r\n\r\n  /**\r\n   * \"selction:created\" canvas event handler\r\n   * @param {{target: fabric.Object, e: MouseEvent}} fEvent - Fabric event\r\n   * @private\r\n   */\r\n  _onSelectionCreated(fEvent) {\r\n    const { target } = fEvent;\r\n    const params = this.createObjectProperties(target);\r\n\r\n    this.fire(events.OBJECT_ACTIVATED, params);\r\n    this.fire(events.SELECTION_CREATED, fEvent.target);\r\n  }\r\n\r\n  /**\r\n   * Canvas discard selection all\r\n   */\r\n  discardSelection() {\r\n    this._canvas.discardActiveObject();\r\n    this._canvas.renderAll();\r\n  }\r\n\r\n  /**\r\n   * Canvas Selectable status change\r\n   * @param {boolean} selectable - expect status\r\n   */\r\n  changeSelectableAll(selectable) {\r\n    this._canvas.forEachObject((obj) => {\r\n      obj.selectable = selectable;\r\n      obj.hoverCursor = selectable ? 'move' : 'crosshair';\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Return object's properties\r\n   * @param {fabric.Object} obj - fabric object\r\n   * @returns {Object} properties object\r\n   */\r\n  createObjectProperties(obj) {\r\n    const predefinedKeys = [\r\n      'left',\r\n      'top',\r\n      'width',\r\n      'height',\r\n      'fill',\r\n      'stroke',\r\n      'strokeWidth',\r\n      'opacity',\r\n      'angle',\r\n    ];\r\n    const props = {\r\n      objId: stamp(obj),\r\n      type: obj.type,\r\n    };\r\n\r\n    extend(props, getProperties(obj, predefinedKeys));\r\n\r\n    if (includes(['i-text', 'text'], obj.type)) {\r\n      extend(props, this._createTextProperties(obj, props));\r\n    } else if (includes(['rect', 'triangle', 'circle'], obj.type)) {\r\n      const shapeComp = this.getComponent(components.SHAPE);\r\n      extend(props, {\r\n        fill: shapeComp.makeFillPropertyForUserEvent(obj),\r\n      });\r\n    }\r\n\r\n    return props;\r\n  }\r\n\r\n  /**\r\n   * Get text object's properties\r\n   * @param {fabric.Object} obj - fabric text object\r\n   * @param {Object} props - properties\r\n   * @returns {Object} properties object\r\n   */\r\n  _createTextProperties(obj) {\r\n    const predefinedKeys = [\r\n      'text',\r\n      'fontFamily',\r\n      'fontSize',\r\n      'fontStyle',\r\n      'textAlign',\r\n      'textDecoration',\r\n      'fontWeight',\r\n    ];\r\n    const props = {};\r\n    extend(props, getProperties(obj, predefinedKeys));\r\n\r\n    return props;\r\n  }\r\n\r\n  /**\r\n   * Add object array by id\r\n   * @param {fabric.Object} obj - fabric object\r\n   * @returns {number} object id\r\n   */\r\n  _addFabricObject(obj) {\r\n    const objId = stamp(obj);\r\n    this._objects[objId] = obj;\r\n\r\n    return objId;\r\n  }\r\n\r\n  /**\r\n   * Remove an object in array yb id\r\n   * @param {number} objId -  object id\r\n   */\r\n  _removeFabricObject(objId) {\r\n    delete this._objects[objId];\r\n  }\r\n\r\n  /**\r\n   * Reset targetObjectForCopyPaste value from activeObject\r\n   */\r\n  resetTargetObjectForCopyPaste() {\r\n    const activeObject = this.getActiveObject();\r\n\r\n    if (activeObject) {\r\n      this.targetObjectForCopyPaste = activeObject;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Paste fabric object\r\n   * @returns {Promise}\r\n   */\r\n  pasteObject() {\r\n    if (!this.targetObjectForCopyPaste) {\r\n      return Promise.resolve([]);\r\n    }\r\n\r\n    const targetObject = this.targetObjectForCopyPaste;\r\n    const isGroupSelect = targetObject.type === 'activeSelection';\r\n    const targetObjects = isGroupSelect ? targetObject.getObjects() : [targetObject];\r\n    let newTargetObject = null;\r\n\r\n    this.discardSelection();\r\n\r\n    return this._cloneObject(targetObjects).then((addedObjects) => {\r\n      if (addedObjects.length > 1) {\r\n        newTargetObject = this.getActiveSelectionFromObjects(addedObjects);\r\n      } else {\r\n        [newTargetObject] = addedObjects;\r\n      }\r\n      this.targetObjectForCopyPaste = newTargetObject;\r\n      this.setActiveObject(newTargetObject);\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Clone object\r\n   * @param {fabric.Object} targetObjects - fabric object\r\n   * @returns {Promise}\r\n   * @private\r\n   */\r\n  _cloneObject(targetObjects) {\r\n    const addedObjects = snippet.map(targetObjects, (targetObject) =>\r\n      this._cloneObjectItem(targetObject)\r\n    );\r\n\r\n    return Promise.all(addedObjects);\r\n  }\r\n\r\n  /**\r\n   * Clone object one item\r\n   * @param {fabric.Object} targetObject - fabric object\r\n   * @returns {Promise}\r\n   * @private\r\n   */\r\n  _cloneObjectItem(targetObject) {\r\n    return this._copyFabricObjectForPaste(targetObject).then((clonedObject) => {\r\n      const objectProperties = this.createObjectProperties(clonedObject);\r\n      this.add(clonedObject);\r\n\r\n      this.fire(events.ADD_OBJECT, objectProperties);\r\n\r\n      return clonedObject;\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Copy fabric object with Changed position for copy and paste\r\n   * @param {fabric.Object} targetObject - fabric object\r\n   * @returns {Promise}\r\n   * @private\r\n   */\r\n  _copyFabricObjectForPaste(targetObject) {\r\n    const addExtraPx = (value, isReverse) =>\r\n      isReverse ? value - EXTRA_PX_FOR_PASTE : value + EXTRA_PX_FOR_PASTE;\r\n\r\n    return this._copyFabricObject(targetObject).then((clonedObject) => {\r\n      const { left, top, width, height } = clonedObject;\r\n      const { width: canvasWidth, height: canvasHeight } = this.getCanvasSize();\r\n      const rightEdge = left + width / 2;\r\n      const bottomEdge = top + height / 2;\r\n\r\n      clonedObject.set(\r\n        snippet.extend(\r\n          {\r\n            left: addExtraPx(left, rightEdge + EXTRA_PX_FOR_PASTE > canvasWidth),\r\n            top: addExtraPx(top, bottomEdge + EXTRA_PX_FOR_PASTE > canvasHeight),\r\n          },\r\n          fObjectOptions.SELECTION_STYLE\r\n        )\r\n      );\r\n\r\n      return clonedObject;\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Copy fabric object\r\n   * @param {fabric.Object} targetObject - fabric object\r\n   * @returns {Promise}\r\n   * @private\r\n   */\r\n  _copyFabricObject(targetObject) {\r\n    return new Promise((resolve) => {\r\n      targetObject.clone((cloned) => {\r\n        const shapeComp = this.getComponent(components.SHAPE);\r\n        if (isShape(cloned)) {\r\n          shapeComp.processForCopiedObject(cloned, targetObject);\r\n        }\r\n\r\n        resolve(cloned);\r\n      });\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Get current dimensions\r\n   * @returns {object}\r\n   */\r\n  getCurrentDimensions() {\r\n    const resize = this.getComponent(components.RESIZE);\r\n\r\n    return resize.getCurrentDimensions();\r\n  }\r\n\r\n  /**\r\n   * Get original dimensions\r\n   * @returns {object}\r\n   */\r\n  getOriginalDimensions() {\r\n    const resize = this.getComponent(components.RESIZE);\r\n\r\n    return resize.getOriginalDimensions();\r\n  }\r\n\r\n  /**\r\n   * Set original dimensions\r\n   * @param {object} dimensions - Dimensions\r\n   */\r\n  setOriginalDimensions(dimensions) {\r\n    const resize = this.getComponent(components.RESIZE);\r\n    resize.setOriginalDimensions(dimensions);\r\n  }\r\n\r\n  /**\r\n   * Resize Image\r\n   * @param {Object} dimensions - Resize dimensions\r\n   * @returns {Promise}\r\n   */\r\n  resize(dimensions) {\r\n    const resize = this.getComponent(components.RESIZE);\r\n\r\n    return resize.resize(dimensions);\r\n  }\r\n\r\n  /**\r\n   * @param {Array} [propertiesToInclude] Any properties that you might want to additionally include in the output\r\n   * @returns {Object} Object representation of an instance\r\n   */\r\n  toJSON(propertiesToInclude) {\r\n    return this._canvas.toJSON(propertiesToInclude);\r\n  }\r\n\r\n  loadFromJSON(json) {\r\n    return new Promise((resolve) => {\r\n      this._canvas.loadFromJSON(json, () => {\r\n        this._canvas.renderAll();\r\n        resolve();\r\n      });\r\n    });\r\n  }\r\n\r\n  setBackgroundColor(color) {\r\n    return new Promise((resolve) => {\r\n      this._canvas.setBackgroundColor(color, () => {\r\n        this._canvas.renderAll();\r\n        resolve();\r\n      });\r\n    });\r\n  }\r\n}\r\n\r\nCustomEvents.mixin(Graphics);\r\n\r\nexport default Graphics;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Selection modification helper\r\n */\r\n\r\nimport { extend } from 'tui-code-snippet';\r\nimport fabric from 'fabric';\r\n\r\n/**\r\n * Cached selection's info\r\n * @type {Array}\r\n * @private\r\n */\r\nlet cachedUndoDataForChangeDimension = null;\r\n\r\n/**\r\n * Set cached undo data\r\n * @param {Array} undoData - selection object\r\n * @private\r\n */\r\nexport function setCachedUndoDataForDimension(undoData) {\r\n  cachedUndoDataForChangeDimension = undoData;\r\n}\r\n\r\n/**\r\n * Get cached undo data\r\n * @returns {Object} cached undo data\r\n * @private\r\n */\r\nexport function getCachedUndoDataForDimension() {\r\n  return cachedUndoDataForChangeDimension;\r\n}\r\n\r\n/**\r\n * Make undo data\r\n * @param {fabric.Object} obj - selection object\r\n * @param {Function} undoDatumMaker - make undo datum\r\n * @returns {Array} undoData\r\n * @private\r\n */\r\nexport function makeSelectionUndoData(obj, undoDatumMaker) {\r\n  let undoData;\r\n\r\n  if (obj.type === 'activeSelection') {\r\n    undoData = obj.getObjects().map((item) => {\r\n      const { angle, left, top, scaleX, scaleY, width, height } = item;\r\n\r\n      fabric.util.addTransformToObject(item, obj.calcTransformMatrix());\r\n      const result = undoDatumMaker(item);\r\n\r\n      item.set({\r\n        angle,\r\n        left,\r\n        top,\r\n        width,\r\n        height,\r\n        scaleX,\r\n        scaleY,\r\n      });\r\n\r\n      return result;\r\n    });\r\n  } else {\r\n    undoData = [undoDatumMaker(obj)];\r\n  }\r\n\r\n  return undoData;\r\n}\r\n\r\n/**\r\n * Make undo datum\r\n * @param {number} objId - object id\r\n * @param {fabric.Object} obj - selection object\r\n * @param {boolean} isSelection - whether or not object is selection\r\n * @returns {Object} undo datum\r\n * @private\r\n */\r\nexport function makeSelectionUndoDatum(objId, obj, isSelection) {\r\n  return isSelection\r\n    ? {\r\n        objId,\r\n        width: obj.width,\r\n        height: obj.height,\r\n        top: obj.top,\r\n        left: obj.left,\r\n        angle: obj.angle,\r\n        scaleX: obj.scaleX,\r\n        scaleY: obj.scaleY,\r\n      }\r\n    : extend({ objId }, obj);\r\n}\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Shape resize helper\r\n */\r\nimport { forEach, map, extend } from 'tui-code-snippet';\r\nimport resizeHelper from '@/helper/shapeResizeHelper';\r\nimport { capitalizeString, flipObject, setCustomProperty, getCustomProperty } from '@/util';\r\n\r\nconst FILTER_OPTION_MAP = {\r\n  pixelate: 'blocksize',\r\n  blur: 'blur',\r\n};\r\nconst POSITION_DIMENSION_MAP = {\r\n  x: 'width',\r\n  y: 'height',\r\n};\r\n\r\nconst FILTER_NAME_VALUE_MAP = flipObject(FILTER_OPTION_MAP);\r\n\r\n/**\r\n * Cached canvas image element for fill image\r\n * @type {boolean}\r\n * @private\r\n */\r\nlet cachedCanvasImageElement = null;\r\n\r\n/**\r\n * Get background image of fill\r\n * @param {fabric.Object} shapeObj - Shape object\r\n * @returns {fabric.Image}\r\n * @private\r\n */\r\nexport function getFillImageFromShape(shapeObj) {\r\n  const { patternSourceCanvas } = getCustomProperty(shapeObj, 'patternSourceCanvas');\r\n  const [fillImage] = patternSourceCanvas.getObjects();\r\n\r\n  return fillImage;\r\n}\r\n\r\n/**\r\n * Reset the image position in the filter type fill area.\r\n * @param {fabric.Object} shapeObj - Shape object\r\n * @private\r\n */\r\nexport function rePositionFilterTypeFillImage(shapeObj) {\r\n  const { angle, flipX, flipY } = shapeObj;\r\n  const fillImage = getFillImageFromShape(shapeObj);\r\n  const rotatedShapeCornerDimension = getRotatedDimension(shapeObj);\r\n  const { right, bottom } = rotatedShapeCornerDimension;\r\n  let { width, height } = rotatedShapeCornerDimension;\r\n  const diffLeft = (width - shapeObj.width) / 2;\r\n  const diffTop = (height - shapeObj.height) / 2;\r\n  const cropX = shapeObj.left - shapeObj.width / 2 - diffLeft;\r\n  const cropY = shapeObj.top - shapeObj.height / 2 - diffTop;\r\n  let left = width / 2 - diffLeft;\r\n  let top = height / 2 - diffTop;\r\n  const fillImageMaxSize = Math.max(width, height) + Math.max(diffLeft, diffTop);\r\n\r\n  [left, top, width, height] = calculateFillImageDimensionOutsideCanvas({\r\n    shapeObj,\r\n    left,\r\n    top,\r\n    width,\r\n    height,\r\n    cropX,\r\n    cropY,\r\n    flipX,\r\n    flipY,\r\n    right,\r\n    bottom,\r\n  });\r\n\r\n  fillImage.set({\r\n    angle: flipX === flipY ? -angle : angle,\r\n    left,\r\n    top,\r\n    width,\r\n    height,\r\n    cropX,\r\n    cropY,\r\n    flipX,\r\n    flipY,\r\n  });\r\n\r\n  setCustomProperty(fillImage, { fillImageMaxSize });\r\n}\r\n\r\n/**\r\n * Make filter option from fabric image\r\n * @param {fabric.Image} imageObject - fabric image object\r\n * @returns {object}\r\n */\r\nexport function makeFilterOptionFromFabricImage(imageObject) {\r\n  return map(imageObject.filters, (filter) => {\r\n    const [key] = Object.keys(filter);\r\n\r\n    return {\r\n      [FILTER_NAME_VALUE_MAP[key]]: filter[key],\r\n    };\r\n  });\r\n}\r\n\r\n/**\r\n * Calculate fill image position and size for out of Canvas\r\n * @param {Object} options - options for position dimension calculate\r\n *   @param {fabric.Object} shapeObj - shape object\r\n *   @param {number} left - original left position\r\n *   @param {number} top - original top position\r\n *   @param {number} width - image width\r\n *   @param {number} height - image height\r\n *   @param {number} cropX - image cropX\r\n *   @param {number} cropY - image cropY\r\n *   @param {boolean} flipX - shape flipX\r\n *   @param {boolean} flipY - shape flipY\r\n * @returns {Object}\r\n */\r\nfunction calculateFillImageDimensionOutsideCanvas({\r\n  shapeObj,\r\n  left,\r\n  top,\r\n  width,\r\n  height,\r\n  cropX,\r\n  cropY,\r\n  flipX,\r\n  flipY,\r\n  right,\r\n  bottom,\r\n}) {\r\n  const overflowAreaPositionFixer = (type, outDistance, imageLeft, imageTop) =>\r\n    calculateDistanceOverflowPart({\r\n      type,\r\n      outDistance,\r\n      shapeObj,\r\n      flipX,\r\n      flipY,\r\n      left: imageLeft,\r\n      top: imageTop,\r\n    });\r\n  const [originalWidth, originalHeight] = [width, height];\r\n\r\n  [left, top, width, height] = calculateDimensionLeftTopEdge(overflowAreaPositionFixer, {\r\n    left,\r\n    top,\r\n    width,\r\n    height,\r\n    cropX,\r\n    cropY,\r\n  });\r\n\r\n  [left, top, width, height] = calculateDimensionRightBottomEdge(overflowAreaPositionFixer, {\r\n    left,\r\n    top,\r\n    insideCanvasRealImageWidth: width,\r\n    insideCanvasRealImageHeight: height,\r\n    right,\r\n    bottom,\r\n    cropX,\r\n    cropY,\r\n    originalWidth,\r\n    originalHeight,\r\n  });\r\n\r\n  return [left, top, width, height];\r\n}\r\n\r\n/**\r\n * Calculate fill image position and size for for right bottom edge\r\n * @param {Function} overflowAreaPositionFixer - position fixer\r\n * @param {Object} options - options for position dimension calculate\r\n *   @param {fabric.Object} shapeObj - shape object\r\n *   @param {number} left - original left position\r\n *   @param {number} top - original top position\r\n *   @param {number} width - image width\r\n *   @param {number} height - image height\r\n *   @param {number} right - image right\r\n *   @param {number} bottom - image bottom\r\n *   @param {number} cropX - image cropX\r\n *   @param {number} cropY - image cropY\r\n *   @param {boolean} originalWidth - image original width\r\n *   @param {boolean} originalHeight - image original height\r\n * @returns {Object}\r\n */\r\nfunction calculateDimensionRightBottomEdge(\r\n  overflowAreaPositionFixer,\r\n  {\r\n    left,\r\n    top,\r\n    insideCanvasRealImageWidth,\r\n    insideCanvasRealImageHeight,\r\n    right,\r\n    bottom,\r\n    cropX,\r\n    cropY,\r\n    originalWidth,\r\n    originalHeight,\r\n  }\r\n) {\r\n  let [width, height] = [insideCanvasRealImageWidth, insideCanvasRealImageHeight];\r\n  const { width: canvasWidth, height: canvasHeight } = cachedCanvasImageElement;\r\n\r\n  if (right > canvasWidth && cropX > 0) {\r\n    width = originalWidth - Math.abs(right - canvasWidth);\r\n  }\r\n  if (bottom > canvasHeight && cropY > 0) {\r\n    height = originalHeight - Math.abs(bottom - canvasHeight);\r\n  }\r\n\r\n  const diff = {\r\n    x: (insideCanvasRealImageWidth - width) / 2,\r\n    y: (insideCanvasRealImageHeight - height) / 2,\r\n  };\r\n\r\n  forEach(['x', 'y'], (type) => {\r\n    const cropDistance2 = diff[type];\r\n    if (cropDistance2 > 0) {\r\n      [left, top] = overflowAreaPositionFixer(type, cropDistance2, left, top);\r\n    }\r\n  });\r\n\r\n  return [left, top, width, height];\r\n}\r\n\r\n/**\r\n * Calculate fill image position and size for for left top\r\n * @param {Function} overflowAreaPositionFixer - position fixer\r\n * @param {Object} options - options for position dimension calculate\r\n *   @param {fabric.Object} shapeObj - shape object\r\n *   @param {number} left - original left position\r\n *   @param {number} top - original top position\r\n *   @param {number} width - image width\r\n *   @param {number} height - image height\r\n *   @param {number} cropX - image cropX\r\n *   @param {number} cropY - image cropY\r\n * @returns {Object}\r\n */\r\nfunction calculateDimensionLeftTopEdge(\r\n  overflowAreaPositionFixer,\r\n  { left, top, width, height, cropX, cropY }\r\n) {\r\n  const dimension = {\r\n    width,\r\n    height,\r\n  };\r\n\r\n  forEach(['x', 'y'], (type) => {\r\n    const cropDistance = type === 'x' ? cropX : cropY;\r\n    const compareSize = dimension[POSITION_DIMENSION_MAP[type]];\r\n    const standardSize = cachedCanvasImageElement[POSITION_DIMENSION_MAP[type]];\r\n\r\n    if (compareSize > standardSize) {\r\n      const outDistance = (compareSize - standardSize) / 2;\r\n\r\n      dimension[POSITION_DIMENSION_MAP[type]] = standardSize;\r\n      [left, top] = overflowAreaPositionFixer(type, outDistance, left, top);\r\n    }\r\n    if (cropDistance < 0) {\r\n      [left, top] = overflowAreaPositionFixer(type, cropDistance, left, top);\r\n    }\r\n  });\r\n\r\n  return [left, top, dimension.width, dimension.height];\r\n}\r\n\r\n/**\r\n * Make fill property of dynamic pattern type\r\n * @param {fabric.Image} canvasImage - canvas background image\r\n * @param {Array} filterOption - filter option\r\n * @param {fabric.StaticCanvas} patternSourceCanvas - fabric static canvas\r\n * @returns {Object}\r\n */\r\nexport function makeFillPatternForFilter(canvasImage, filterOption, patternSourceCanvas) {\r\n  const copiedCanvasElement = getCachedCanvasImageElement(canvasImage);\r\n  const fillImage = makeFillImage(copiedCanvasElement, canvasImage.angle, filterOption);\r\n  patternSourceCanvas.add(fillImage);\r\n\r\n  const fabricProperty = {\r\n    fill: new fabric.Pattern({\r\n      source: patternSourceCanvas.getElement(),\r\n      repeat: 'no-repeat',\r\n    }),\r\n  };\r\n\r\n  setCustomProperty(fabricProperty, { patternSourceCanvas });\r\n\r\n  return fabricProperty;\r\n}\r\n\r\n/**\r\n * Reset fill pattern canvas\r\n * @param {fabric.StaticCanvas} patternSourceCanvas - fabric static canvas\r\n */\r\nexport function resetFillPatternCanvas(patternSourceCanvas) {\r\n  const [innerImage] = patternSourceCanvas.getObjects();\r\n  let { fillImageMaxSize } = getCustomProperty(innerImage, 'fillImageMaxSize');\r\n  fillImageMaxSize = Math.max(1, fillImageMaxSize);\r\n\r\n  patternSourceCanvas.setDimensions({\r\n    width: fillImageMaxSize,\r\n    height: fillImageMaxSize,\r\n  });\r\n  patternSourceCanvas.renderAll();\r\n}\r\n\r\n/**\r\n * Remake filter pattern image source\r\n * @param {fabric.Object} shapeObj - Shape object\r\n * @param {fabric.Image} canvasImage - canvas background image\r\n */\r\nexport function reMakePatternImageSource(shapeObj, canvasImage) {\r\n  const { patternSourceCanvas } = getCustomProperty(shapeObj, 'patternSourceCanvas');\r\n  const [fillImage] = patternSourceCanvas.getObjects();\r\n  const filterOption = makeFilterOptionFromFabricImage(fillImage);\r\n\r\n  patternSourceCanvas.remove(fillImage);\r\n\r\n  const copiedCanvasElement = getCachedCanvasImageElement(canvasImage, true);\r\n  const newFillImage = makeFillImage(copiedCanvasElement, canvasImage.angle, filterOption);\r\n\r\n  patternSourceCanvas.add(newFillImage);\r\n}\r\n\r\n/**\r\n * Calculate a point line outside the canvas.\r\n * @param {fabric.Image} canvasImage - canvas background image\r\n * @param {boolean} reset - default is false\r\n * @returns {HTMLImageElement}\r\n */\r\nexport function getCachedCanvasImageElement(canvasImage, reset = false) {\r\n  if (!cachedCanvasImageElement || reset) {\r\n    cachedCanvasImageElement = canvasImage.toCanvasElement();\r\n  }\r\n\r\n  return cachedCanvasImageElement;\r\n}\r\n\r\n/**\r\n * Calculate fill image position for out of Canvas\r\n * @param {string} type - 'x' or 'y'\r\n * @param {fabric.Object} shapeObj - shape object\r\n * @param {number} outDistance - distance away\r\n * @param {number} left - original left position\r\n * @param {number} top - original top position\r\n * @returns {Array}\r\n */\r\nfunction calculateDistanceOverflowPart({ type, shapeObj, outDistance, left, top, flipX, flipY }) {\r\n  const shapePointNavigation = getShapeEdgePoint(shapeObj);\r\n  const shapeNeighborPointNavigation = [\r\n    [1, 2],\r\n    [0, 3],\r\n    [0, 3],\r\n    [1, 2],\r\n  ];\r\n  const linePointsOutsideCanvas = calculateLinePointsOutsideCanvas(\r\n    type,\r\n    shapePointNavigation,\r\n    shapeNeighborPointNavigation\r\n  );\r\n  const reatAngles = calculateLineAngleOfOutsideCanvas(\r\n    type,\r\n    shapePointNavigation,\r\n    linePointsOutsideCanvas\r\n  );\r\n  const { startPointIndex } = linePointsOutsideCanvas;\r\n  const diffPosition = getReversePositionForFlip({\r\n    outDistance,\r\n    startPointIndex,\r\n    flipX,\r\n    flipY,\r\n    reatAngles,\r\n  });\r\n\r\n  return [left + diffPosition.left, top + diffPosition.top];\r\n}\r\n\r\n/**\r\n * Calculate fill image position for out of Canvas\r\n * @param {number} outDistance - distance away\r\n * @param {boolean} flipX - flip x statux\r\n * @param {boolean} flipY - flip y statux\r\n * @param {Array} reatAngles - Line angle of the rectangle vertex.\r\n * @returns {Object} diffPosition\r\n */\r\nfunction getReversePositionForFlip({ outDistance, startPointIndex, flipX, flipY, reatAngles }) {\r\n  const rotationChangePoint1 = outDistance * Math.cos((reatAngles[0] * Math.PI) / 180);\r\n  const rotationChangePoint2 = outDistance * Math.cos((reatAngles[1] * Math.PI) / 180);\r\n  const isForward = startPointIndex === 2 || startPointIndex === 3;\r\n  const diffPosition = {\r\n    top: isForward ? rotationChangePoint1 : rotationChangePoint2,\r\n    left: isForward ? rotationChangePoint2 : rotationChangePoint1,\r\n  };\r\n\r\n  if (isReverseLeftPositionForFlip(startPointIndex, flipX, flipY)) {\r\n    diffPosition.left = diffPosition.left * -1;\r\n  }\r\n  if (isReverseTopPositionForFlip(startPointIndex, flipX, flipY)) {\r\n    diffPosition.top = diffPosition.top * -1;\r\n  }\r\n\r\n  return diffPosition;\r\n}\r\n\r\n/**\r\n * Calculate a point line outside the canvas.\r\n * @param {string} type - 'x' or 'y'\r\n * @param {Array} shapePointNavigation - shape edge positions\r\n *   @param {Object} shapePointNavigation.lefttop - left top position\r\n *   @param {Object} shapePointNavigation.righttop - right top position\r\n *   @param {Object} shapePointNavigation.leftbottom - lefttop position\r\n *   @param {Object} shapePointNavigation.rightbottom - rightbottom position\r\n * @param {Array} shapeNeighborPointNavigation - Array to find adjacent edges.\r\n * @returns {Object}\r\n */\r\nfunction calculateLinePointsOutsideCanvas(\r\n  type,\r\n  shapePointNavigation,\r\n  shapeNeighborPointNavigation\r\n) {\r\n  let minimumPoint = 0;\r\n  let minimumPointIndex = 0;\r\n  forEach(shapePointNavigation, (point, index) => {\r\n    if (point[type] < minimumPoint) {\r\n      minimumPoint = point[type];\r\n      minimumPointIndex = index;\r\n    }\r\n  });\r\n\r\n  const [endPointIndex1, endPointIndex2] = shapeNeighborPointNavigation[minimumPointIndex];\r\n\r\n  return {\r\n    startPointIndex: minimumPointIndex,\r\n    endPointIndex1,\r\n    endPointIndex2,\r\n  };\r\n}\r\n\r\n/**\r\n * Calculate a point line outside the canvas.\r\n * @param {string} type - 'x' or 'y'\r\n * @param {Array} shapePointNavigation - shape edge positions\r\n *   @param {object} shapePointNavigation.lefttop - left top position\r\n *   @param {object} shapePointNavigation.righttop - right top position\r\n *   @param {object} shapePointNavigation.leftbottom - lefttop position\r\n *   @param {object} shapePointNavigation.rightbottom - rightbottom position\r\n * @param {Object} linePointsOfOneVertexIndex - Line point of one vertex\r\n *   @param {Object} linePointsOfOneVertexIndex.startPoint - start point index\r\n *   @param {Object} linePointsOfOneVertexIndex.endPointIndex1 - end point index\r\n *   @param {Object} linePointsOfOneVertexIndex.endPointIndex2 - end point index\r\n * @returns {Object}\r\n */\r\nfunction calculateLineAngleOfOutsideCanvas(type, shapePointNavigation, linePointsOfOneVertexIndex) {\r\n  const { startPointIndex, endPointIndex1, endPointIndex2 } = linePointsOfOneVertexIndex;\r\n  const horizontalVerticalAngle = type === 'x' ? 180 : 270;\r\n\r\n  return map([endPointIndex1, endPointIndex2], (pointIndex) => {\r\n    const startPoint = shapePointNavigation[startPointIndex];\r\n    const endPoint = shapePointNavigation[pointIndex];\r\n    const diffY = startPoint.y - endPoint.y;\r\n    const diffX = startPoint.x - endPoint.x;\r\n\r\n    return (Math.atan2(diffY, diffX) * 180) / Math.PI - horizontalVerticalAngle;\r\n  });\r\n}\r\n\r\n/* eslint-disable complexity */\r\n/**\r\n * Calculate a point line outside the canvas for horizontal.\r\n * @param {number} startPointIndex - start point index\r\n * @param {boolean} flipX - flip x statux\r\n * @param {boolean} flipY - flip y statux\r\n * @returns {boolean} flipY - flip y statux\r\n */\r\nfunction isReverseLeftPositionForFlip(startPointIndex, flipX, flipY) {\r\n  return (\r\n    (((!flipX && flipY) || (!flipX && !flipY)) && startPointIndex === 0) ||\r\n    (((flipX && flipY) || (flipX && !flipY)) && startPointIndex === 1) ||\r\n    (((!flipX && !flipY) || (!flipX && flipY)) && startPointIndex === 2) ||\r\n    (((flipX && !flipY) || (flipX && flipY)) && startPointIndex === 3)\r\n  );\r\n}\r\n/* eslint-enable complexity */\r\n\r\n/* eslint-disable complexity */\r\n/**\r\n * Calculate a point line outside the canvas for vertical.\r\n * @param {number} startPointIndex - start point index\r\n * @param {boolean} flipX - flip x statux\r\n * @param {boolean} flipY - flip y statux\r\n * @returns {boolean} flipY - flip y statux\r\n */\r\nfunction isReverseTopPositionForFlip(startPointIndex, flipX, flipY) {\r\n  return (\r\n    (((flipX && !flipY) || (!flipX && !flipY)) && startPointIndex === 0) ||\r\n    (((!flipX && !flipY) || (flipX && !flipY)) && startPointIndex === 1) ||\r\n    (((flipX && flipY) || (!flipX && flipY)) && startPointIndex === 2) ||\r\n    (((!flipX && flipY) || (flipX && flipY)) && startPointIndex === 3)\r\n  );\r\n}\r\n/* eslint-enable complexity */\r\n\r\n/**\r\n * Shape edge points\r\n * @param {fabric.Object} shapeObj - Selected shape object on canvas\r\n * @returns {Array} shapeEdgePoint - shape edge positions\r\n */\r\nfunction getShapeEdgePoint(shapeObj) {\r\n  return [\r\n    shapeObj.getPointByOrigin('left', 'top'),\r\n    shapeObj.getPointByOrigin('right', 'top'),\r\n    shapeObj.getPointByOrigin('left', 'bottom'),\r\n    shapeObj.getPointByOrigin('right', 'bottom'),\r\n  ];\r\n}\r\n\r\n/**\r\n * Rotated shape dimension\r\n * @param {fabric.Object} shapeObj - Shape object\r\n * @returns {Object} Rotated shape dimension\r\n */\r\nfunction getRotatedDimension(shapeObj) {\r\n  const [{ x: ax, y: ay }, { x: bx, y: by }, { x: cx, y: cy }, { x: dx, y: dy }] =\r\n    getShapeEdgePoint(shapeObj);\r\n\r\n  const left = Math.min(ax, bx, cx, dx);\r\n  const top = Math.min(ay, by, cy, dy);\r\n  const right = Math.max(ax, bx, cx, dx);\r\n  const bottom = Math.max(ay, by, cy, dy);\r\n\r\n  return {\r\n    left,\r\n    top,\r\n    right,\r\n    bottom,\r\n    width: right - left,\r\n    height: bottom - top,\r\n  };\r\n}\r\n\r\n/**\r\n * Make fill image\r\n * @param {HTMLImageElement} copiedCanvasElement - html image element\r\n * @param {number} currentCanvasImageAngle - current canvas angle\r\n * @param {Array} filterOption - filter option\r\n * @returns {fabric.Image}\r\n * @private\r\n */\r\nfunction makeFillImage(copiedCanvasElement, currentCanvasImageAngle, filterOption) {\r\n  const fillImage = new fabric.Image(copiedCanvasElement);\r\n\r\n  forEach(extend({}, ...filterOption), (value, key) => {\r\n    const fabricFilterClassName = capitalizeString(key);\r\n    const filter = new fabric.Image.filters[fabricFilterClassName]({\r\n      [FILTER_OPTION_MAP[key]]: value,\r\n    });\r\n    fillImage.filters.push(filter);\r\n  });\r\n  fillImage.applyFilters();\r\n\r\n  setCustomProperty(fillImage, {\r\n    originalAngle: currentCanvasImageAngle,\r\n    fillImageMaxSize: Math.max(fillImage.width, fillImage.height),\r\n  });\r\n  resizeHelper.adjustOriginToCenter(fillImage);\r\n\r\n  return fillImage;\r\n}\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Shape resize helper\r\n */\r\nconst DIVISOR = {\r\n  rect: 1,\r\n  circle: 2,\r\n  triangle: 1,\r\n};\r\nconst DIMENSION_KEYS = {\r\n  rect: {\r\n    w: 'width',\r\n    h: 'height',\r\n  },\r\n  circle: {\r\n    w: 'rx',\r\n    h: 'ry',\r\n  },\r\n  triangle: {\r\n    w: 'width',\r\n    h: 'height',\r\n  },\r\n};\r\n\r\n/**\r\n * Set the start point value to the shape object\r\n * @param {fabric.Object} shape - Shape object\r\n * @ignore\r\n */\r\nfunction setStartPoint(shape) {\r\n  const { originX, originY } = shape;\r\n  const originKey = originX.substring(0, 1) + originY.substring(0, 1);\r\n\r\n  shape.startPoint = shape.origins[originKey];\r\n}\r\n\r\n/**\r\n * Get the positions of ratated origin by the pointer value\r\n * @param {{x: number, y: number}} origin - Origin value\r\n * @param {{x: number, y: number}} pointer - Pointer value\r\n * @param {number} angle - Rotating angle\r\n * @returns {Object} Postions of origin\r\n * @ignore\r\n */\r\nfunction getPositionsOfRotatedOrigin(origin, pointer, angle) {\r\n  const sx = origin.x;\r\n  const sy = origin.y;\r\n  const px = pointer.x;\r\n  const py = pointer.y;\r\n  const r = (angle * Math.PI) / 180;\r\n  const rx = (px - sx) * Math.cos(r) - (py - sy) * Math.sin(r) + sx;\r\n  const ry = (px - sx) * Math.sin(r) + (py - sy) * Math.cos(r) + sy;\r\n\r\n  return {\r\n    originX: sx > rx ? 'right' : 'left',\r\n    originY: sy > ry ? 'bottom' : 'top',\r\n  };\r\n}\r\n\r\n/**\r\n * Whether the shape has the center origin or not\r\n * @param {fabric.Object} shape - Shape object\r\n * @returns {boolean} State\r\n * @ignore\r\n */\r\nfunction hasCenterOrigin(shape) {\r\n  return shape.originX === 'center' && shape.originY === 'center';\r\n}\r\n\r\n/**\r\n * Adjust the origin of shape by the start point\r\n * @param {{x: number, y: number}} pointer - Pointer value\r\n * @param {fabric.Object} shape - Shape object\r\n * @ignore\r\n */\r\nfunction adjustOriginByStartPoint(pointer, shape) {\r\n  const centerPoint = shape.getPointByOrigin('center', 'center');\r\n  const angle = -shape.angle;\r\n  const originPositions = getPositionsOfRotatedOrigin(centerPoint, pointer, angle);\r\n  const { originX, originY } = originPositions;\r\n  const origin = shape.getPointByOrigin(originX, originY);\r\n  const left = shape.left - (centerPoint.x - origin.x);\r\n  const top = shape.top - (centerPoint.y - origin.y);\r\n\r\n  shape.set({\r\n    originX,\r\n    originY,\r\n    left,\r\n    top,\r\n  });\r\n\r\n  shape.setCoords();\r\n}\r\n\r\n/**\r\n * Adjust the origin of shape by the moving pointer value\r\n * @param {{x: number, y: number}} pointer - Pointer value\r\n * @param {fabric.Object} shape - Shape object\r\n * @ignore\r\n */\r\nfunction adjustOriginByMovingPointer(pointer, shape) {\r\n  const origin = shape.startPoint;\r\n  const angle = -shape.angle;\r\n  const originPositions = getPositionsOfRotatedOrigin(origin, pointer, angle);\r\n  const { originX, originY } = originPositions;\r\n\r\n  shape.setPositionByOrigin(origin, originX, originY);\r\n  shape.setCoords();\r\n}\r\n\r\n/**\r\n * Adjust the dimension of shape on firing scaling event\r\n * @param {fabric.Object} shape - Shape object\r\n * @ignore\r\n */\r\nfunction adjustDimensionOnScaling(shape) {\r\n  const { type, scaleX, scaleY } = shape;\r\n  const dimensionKeys = DIMENSION_KEYS[type];\r\n  let width = shape[dimensionKeys.w] * scaleX;\r\n  let height = shape[dimensionKeys.h] * scaleY;\r\n\r\n  if (shape.isRegular) {\r\n    const maxScale = Math.max(scaleX, scaleY);\r\n\r\n    width = shape[dimensionKeys.w] * maxScale;\r\n    height = shape[dimensionKeys.h] * maxScale;\r\n  }\r\n\r\n  const options = {\r\n    hasControls: false,\r\n    hasBorders: false,\r\n    scaleX: 1,\r\n    scaleY: 1,\r\n  };\r\n\r\n  options[dimensionKeys.w] = width;\r\n  options[dimensionKeys.h] = height;\r\n\r\n  shape.set(options);\r\n}\r\n\r\n/**\r\n * Adjust the dimension of shape on firing mouse move event\r\n * @param {{x: number, y: number}} pointer - Pointer value\r\n * @param {fabric.Object} shape - Shape object\r\n * @ignore\r\n */\r\nfunction adjustDimensionOnMouseMove(pointer, shape) {\r\n  const { type, strokeWidth, startPoint: origin } = shape;\r\n  const divisor = DIVISOR[type];\r\n  const dimensionKeys = DIMENSION_KEYS[type];\r\n  const isTriangle = !!(shape.type === 'triangle');\r\n  const options = {};\r\n  let width = Math.abs(origin.x - pointer.x) / divisor;\r\n  let height = Math.abs(origin.y - pointer.y) / divisor;\r\n\r\n  if (width > strokeWidth) {\r\n    width -= strokeWidth / divisor;\r\n  }\r\n\r\n  if (height > strokeWidth) {\r\n    height -= strokeWidth / divisor;\r\n  }\r\n\r\n  if (shape.isRegular) {\r\n    width = height = Math.max(width, height);\r\n\r\n    if (isTriangle) {\r\n      height = (Math.sqrt(3) / 2) * width;\r\n    }\r\n  }\r\n\r\n  options[dimensionKeys.w] = width;\r\n  options[dimensionKeys.h] = height;\r\n\r\n  shape.set(options);\r\n}\r\n\r\nmodule.exports = {\r\n  /**\r\n   * Set each origin value to shape\r\n   * @param {fabric.Object} shape - Shape object\r\n   */\r\n  setOrigins(shape) {\r\n    const leftTopPoint = shape.getPointByOrigin('left', 'top');\r\n    const rightTopPoint = shape.getPointByOrigin('right', 'top');\r\n    const rightBottomPoint = shape.getPointByOrigin('right', 'bottom');\r\n    const leftBottomPoint = shape.getPointByOrigin('left', 'bottom');\r\n\r\n    shape.origins = {\r\n      lt: leftTopPoint,\r\n      rt: rightTopPoint,\r\n      rb: rightBottomPoint,\r\n      lb: leftBottomPoint,\r\n    };\r\n  },\r\n\r\n  /**\r\n   * Resize the shape\r\n   * @param {fabric.Object} shape - Shape object\r\n   * @param {{x: number, y: number}} pointer - Mouse pointer values on canvas\r\n   * @param {boolean} isScaling - Whether the resizing action is scaling or not\r\n   */\r\n  resize(shape, pointer, isScaling) {\r\n    if (hasCenterOrigin(shape)) {\r\n      adjustOriginByStartPoint(pointer, shape);\r\n      setStartPoint(shape);\r\n    }\r\n\r\n    if (isScaling) {\r\n      adjustDimensionOnScaling(shape, pointer);\r\n    } else {\r\n      adjustDimensionOnMouseMove(pointer, shape);\r\n    }\r\n\r\n    adjustOriginByMovingPointer(pointer, shape);\r\n  },\r\n\r\n  /**\r\n   * Adjust the origin position of shape to center\r\n   * @param {fabric.Object} shape - Shape object\r\n   */\r\n  adjustOriginToCenter(shape) {\r\n    const centerPoint = shape.getPointByOrigin('center', 'center');\r\n    const { originX, originY } = shape;\r\n    const origin = shape.getPointByOrigin(originX, originY);\r\n    const left = shape.left + (centerPoint.x - origin.x);\r\n    const top = shape.top + (centerPoint.y - origin.y);\r\n\r\n    shape.set({\r\n      hasControls: true,\r\n      hasBorders: true,\r\n      originX: 'center',\r\n      originY: 'center',\r\n      left,\r\n      top,\r\n    });\r\n\r\n    shape.setCoords(); // For left, top properties\r\n  },\r\n};\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Image-editor application class\r\n */\r\nimport snippet from 'tui-code-snippet';\r\nimport Invoker from '@/invoker';\r\nimport commandFactory from '@/factory/command';\r\nimport Graphics from '@/graphics';\r\nimport { makeSelectionUndoData, makeSelectionUndoDatum } from '@/helper/selectionModifyHelper';\r\nimport { sendHostName, Promise, getObjectType } from '@/util';\r\nimport {\r\n  eventNames as events,\r\n  commandNames as commands,\r\n  keyCodes,\r\n  rejectMessages,\r\n  OBJ_TYPE,\r\n} from '@/consts';\r\n\r\nconst { isUndefined, forEach, CustomEvents } = snippet;\r\n\r\nconst {\r\n  MOUSE_DOWN,\r\n  MOUSE_UP,\r\n  MOUSE_MOVE,\r\n  MOUSE_WHEEL,\r\n  OBJECT_MOVED,\r\n  OBJECT_SCALED,\r\n  OBJECT_ACTIVATED,\r\n  OBJECT_ROTATED,\r\n  OBJECT_ADDED,\r\n  OBJECT_MODIFIED,\r\n  ADD_TEXT,\r\n  ADD_OBJECT,\r\n  TEXT_EDITING,\r\n  TEXT_CHANGED,\r\n  ICON_CREATE_RESIZE,\r\n  ICON_CREATE_END,\r\n  SELECTION_CLEARED,\r\n  SELECTION_CREATED,\r\n  ADD_OBJECT_AFTER,\r\n} = events;\r\n\r\n/**\r\n * Image filter result\r\n * @typedef {object} FilterResult\r\n * @property {string} type - filter type like 'mask', 'Grayscale' and so on\r\n * @property {string} action - action type like 'add', 'remove'\r\n */\r\n\r\n/**\r\n * Flip status\r\n * @typedef {object} FlipStatus\r\n * @property {boolean} flipX - x axis\r\n * @property {boolean} flipY - y axis\r\n * @property {Number} angle - angle\r\n */\r\n/**\r\n * Rotation status\r\n * @typedef {Number} RotateStatus\r\n * @property {Number} angle - angle\r\n */\r\n\r\n/**\r\n * Old and new Size\r\n * @typedef {object} SizeChange\r\n * @property {Number} oldWidth - old width\r\n * @property {Number} oldHeight - old height\r\n * @property {Number} newWidth - new width\r\n * @property {Number} newHeight - new height\r\n */\r\n\r\n/**\r\n * @typedef {string} ErrorMsg - {string} error message\r\n */\r\n\r\n/**\r\n * @typedef {object} ObjectProps - graphics object properties\r\n * @property {number} objId -  object id\r\n * @property {string} type - object type\r\n * @property {string} text - text content\r\n * @property {(string | number)} left - Left\r\n * @property {(string | number)} top - Top\r\n * @property {(string | number)} width - Width\r\n * @property {(string | number)} height - Height\r\n * @property {string} fill - Color\r\n * @property {string} stroke - Stroke\r\n * @property {(string | number)} strokeWidth - StrokeWidth\r\n * @property {string} fontFamily - Font type for text\r\n * @property {number} fontSize - Font Size\r\n * @property {string} fontStyle - Type of inclination (normal / italic)\r\n * @property {string} fontWeight - Type of thicker or thinner looking (normal / bold)\r\n * @property {string} textAlign - Type of text align (left / center / right)\r\n * @property {string} textDecoration - Type of line (underline / line-through / overline)\r\n */\r\n\r\n/**\r\n * Shape filter option\r\n * @typedef {object.<string, number>} ShapeFilterOption\r\n */\r\n\r\n/**\r\n * Shape filter option\r\n * @typedef {object} ShapeFillOption - fill option of shape\r\n * @property {string} type - fill type ('color' or 'filter')\r\n * @property {Array.<ShapeFillFilterOption>} [filter] - {@link ShapeFilterOption} List.\r\n *  only applies to filter types\r\n *  (ex: \\[\\{pixelate: 20\\}, \\{blur: 0.3\\}\\])\r\n * @property {string} [color] - Shape foreground color (ex: '#fff', 'transparent')\r\n */\r\n\r\n/**\r\n * Image editor\r\n * @class\r\n * @param {string|HTMLElement} wrapper - Wrapper's element or selector\r\n * @param {Object} [options] - Canvas max width & height of css\r\n *  @param {number} [options.includeUI] - Use the provided UI\r\n *    @param {Object} [options.includeUI.loadImage] - Basic editing image\r\n *      @param {string} options.includeUI.loadImage.path - image path\r\n *      @param {string} options.includeUI.loadImage.name - image name\r\n *    @param {Object} [options.includeUI.theme] - Theme object\r\n *    @param {Array} [options.includeUI.menu] - It can be selected when only specific menu is used, Default values are \\['crop', 'flip', 'rotate', 'draw', 'shape', 'icon', 'text', 'mask', 'filter'\\].\r\n *    @param {string} [options.includeUI.initMenu] - The first menu to be selected and started.\r\n *    @param {Object} [options.includeUI.uiSize] - ui size of editor\r\n *      @param {string} options.includeUI.uiSize.width - width of ui\r\n *      @param {string} options.includeUI.uiSize.height - height of ui\r\n *    @param {string} [options.includeUI.menuBarPosition=bottom] - Menu bar position('top', 'bottom', 'left', 'right')\r\n *  @param {number} options.cssMaxWidth - Canvas css-max-width\r\n *  @param {number} options.cssMaxHeight - Canvas css-max-height\r\n *  @param {Object} [options.selectionStyle] - selection style\r\n *  @param {string} [options.selectionStyle.cornerStyle] - selection corner style\r\n *  @param {number} [options.selectionStyle.cornerSize] - selection corner size\r\n *  @param {string} [options.selectionStyle.cornerColor] - selection corner color\r\n *  @param {string} [options.selectionStyle.cornerStrokeColor] = selection corner stroke color\r\n *  @param {boolean} [options.selectionStyle.transparentCorners] - selection corner transparent\r\n *  @param {number} [options.selectionStyle.lineWidth] - selection line width\r\n *  @param {string} [options.selectionStyle.borderColor] - selection border color\r\n *  @param {number} [options.selectionStyle.rotatingPointOffset] - selection rotating point length\r\n *  @param {Boolean} [options.usageStatistics=true] - Let us know the hostname. If you don't want to send the hostname, please set to false.\r\n * @example\r\n * var ImageEditor = require('tui-image-editor');\r\n * var blackTheme = require('./js/theme/black-theme.js');\r\n * var instance = new ImageEditor(document.querySelector('#tui-image-editor'), {\r\n *   includeUI: {\r\n *     loadImage: {\r\n *       path: 'img/sampleImage.jpg',\r\n *       name: 'SampleImage'\r\n *     },\r\n *     theme: blackTheme, // or whiteTheme\r\n *     menu: ['shape', 'filter'],\r\n *     initMenu: 'filter',\r\n *     uiSize: {\r\n *         width: '1000px',\r\n *         height: '700px'\r\n *     },\r\n *     menuBarPosition: 'bottom'\r\n *   },\r\n *   cssMaxWidth: 700,\r\n *   cssMaxHeight: 500,\r\n *   selectionStyle: {\r\n *     cornerSize: 20,\r\n *     rotatingPointOffset: 70\r\n *   }\r\n * });\r\n */\r\nclass ImageEditor {\r\n  constructor(wrapper, options) {\r\n    options = snippet.extend(\r\n      {\r\n        includeUI: false,\r\n        usageStatistics: true,\r\n      },\r\n      options\r\n    );\r\n\r\n    this.mode = null;\r\n\r\n    this.activeObjectId = null;\r\n\r\n    /**\r\n     * Invoker\r\n     * @type {Invoker}\r\n     * @private\r\n     */\r\n    this._invoker = new Invoker();\r\n\r\n    /**\r\n     * Graphics instance\r\n     * @type {Graphics}\r\n     * @private\r\n     */\r\n    this._graphics = new Graphics(wrapper, {\r\n      backgroundColor: options.backgroundColor ? options.backgroundColor : 'transparent',\r\n      cssMaxWidth: options.cssMaxWidth,\r\n      cssMaxHeight: options.cssMaxHeight,\r\n      preserveObjectStacking: options.preserveObjectStacking\r\n        ? options.preserveObjectStacking\r\n        : false,\r\n    });\r\n\r\n    /**\r\n     * Event handler list\r\n     * @type {Object}\r\n     * @private\r\n     */\r\n    this._handlers = {\r\n      keydown: this._onKeyDown.bind(this),\r\n      mousedown: this._onMouseDown.bind(this),\r\n      mouseup: this._onMouseUp.bind(this),\r\n      mousemove: this._onMouseMove.bind(this),\r\n      mousewheel: this._onMouseWheel.bind(this),\r\n      objectActivated: this._onObjectActivated.bind(this),\r\n      objectMoved: this._onObjectMoved.bind(this),\r\n      objectScaled: this._onObjectScaled.bind(this),\r\n      objectRotated: this._onObjectRotated.bind(this),\r\n      objectAdded: this._onObjectAdded.bind(this),\r\n      objectModified: this._onObjectModified.bind(this),\r\n      createdPath: this._onCreatedPath,\r\n      addText: this._onAddText.bind(this),\r\n      addObject: this._onAddObject.bind(this),\r\n      textEditing: this._onTextEditing.bind(this),\r\n      textChanged: this._onTextChanged.bind(this),\r\n      iconCreateResize: this._onIconCreateResize.bind(this),\r\n      iconCreateEnd: this._onIconCreateEnd.bind(this),\r\n      selectionCleared: this._selectionCleared.bind(this),\r\n      selectionCreated: this._selectionCreated.bind(this),\r\n    };\r\n\r\n    this._attachInvokerEvents();\r\n    this._attachGraphicsEvents();\r\n    this._attachDomEvents();\r\n    this._setSelectionStyle(options.selectionStyle, {\r\n      applyCropSelectionStyle: options.applyCropSelectionStyle,\r\n      applyGroupSelectionStyle: options.applyGroupSelectionStyle,\r\n    });\r\n\r\n    if (options.usageStatistics) {\r\n      sendHostName();\r\n    }\r\n    fabric.enableGLFiltering = false;\r\n  }\r\n\r\n  /**\r\n   * Set selection style by init option\r\n   * @param {Object} selectionStyle - Selection styles\r\n   * @param {Object} applyTargets - Selection apply targets\r\n   *   @param {boolean} applyCropSelectionStyle - whether apply with crop selection style or not\r\n   *   @param {boolean} applyGroupSelectionStyle - whether apply with group selection style or not\r\n   * @private\r\n   */\r\n  _setSelectionStyle(selectionStyle, { applyCropSelectionStyle, applyGroupSelectionStyle }) {\r\n    if (selectionStyle) {\r\n      this._graphics.setSelectionStyle(selectionStyle);\r\n    }\r\n\r\n    if (applyCropSelectionStyle) {\r\n      this._graphics.setCropSelectionStyle(selectionStyle);\r\n    }\r\n\r\n    if (applyGroupSelectionStyle) {\r\n      this.on('selectionCreated', (eventTarget) => {\r\n        if (eventTarget.type === 'activeSelection') {\r\n          eventTarget.set(selectionStyle);\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Attach invoker events\r\n   * @private\r\n   */\r\n  _attachInvokerEvents() {\r\n    const { UNDO_STACK_CHANGED, REDO_STACK_CHANGED } = events;\r\n\r\n    /**\r\n     * Undo stack changed event\r\n     * @event ImageEditor#undoStackChanged\r\n     * @param {Number} length - undo stack length\r\n     * @example\r\n     * imageEditor.on('undoStackChanged', function(length) {\r\n     *     console.log(length);\r\n     * });\r\n     */\r\n    this._invoker.on(UNDO_STACK_CHANGED, this.fire.bind(this, UNDO_STACK_CHANGED));\r\n    /**\r\n     * Redo stack changed event\r\n     * @event ImageEditor#redoStackChanged\r\n     * @param {Number} length - redo stack length\r\n     * @example\r\n     * imageEditor.on('redoStackChanged', function(length) {\r\n     *     console.log(length);\r\n     * });\r\n     */\r\n    this._invoker.on(REDO_STACK_CHANGED, this.fire.bind(this, REDO_STACK_CHANGED));\r\n  }\r\n\r\n  /**\r\n   * Attach canvas events\r\n   * @private\r\n   */\r\n  _attachGraphicsEvents() {\r\n    this._graphics.on({\r\n      [MOUSE_DOWN]: this._handlers.mousedown,\r\n      [MOUSE_UP]: this._handlers.mouseup,\r\n      [MOUSE_MOVE]: this._handlers.mousemove,\r\n      [MOUSE_WHEEL]: this._handlers.mousewheel,\r\n      [OBJECT_MOVED]: this._handlers.objectMoved,\r\n      [OBJECT_SCALED]: this._handlers.objectScaled,\r\n      [OBJECT_ROTATED]: this._handlers.objectRotated,\r\n      [OBJECT_ACTIVATED]: this._handlers.objectActivated,\r\n      [OBJECT_ADDED]: this._handlers.objectAdded,\r\n      [OBJECT_MODIFIED]: this._handlers.objectModified,\r\n      [ADD_TEXT]: this._handlers.addText,\r\n      [ADD_OBJECT]: this._handlers.addObject,\r\n      [TEXT_EDITING]: this._handlers.textEditing,\r\n      [TEXT_CHANGED]: this._handlers.textChanged,\r\n      [ICON_CREATE_RESIZE]: this._handlers.iconCreateResize,\r\n      [ICON_CREATE_END]: this._handlers.iconCreateEnd,\r\n      [SELECTION_CLEARED]: this._handlers.selectionCleared,\r\n      [SELECTION_CREATED]: this._handlers.selectionCreated,\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Attach dom events\r\n   * @private\r\n   */\r\n  _attachDomEvents() {\r\n    // ImageEditor supports IE 9 higher\r\n    document.addEventListener('keydown', this._handlers.keydown);\r\n  }\r\n\r\n  /**\r\n   * Detach dom events\r\n   * @private\r\n   */\r\n  _detachDomEvents() {\r\n    // ImageEditor supports IE 9 higher\r\n    document.removeEventListener('keydown', this._handlers.keydown);\r\n  }\r\n\r\n  /**\r\n   * Keydown event handler\r\n   * @param {KeyboardEvent} e - Event object\r\n   * @private\r\n   */\r\n  /* eslint-disable complexity */\r\n  _onKeyDown(e) {\r\n    const { ctrlKey, keyCode, metaKey } = e;\r\n    const isModifierKey = ctrlKey || metaKey;\r\n\r\n    if (isModifierKey) {\r\n      if (keyCode === keyCodes.C) {\r\n        this._graphics.resetTargetObjectForCopyPaste();\r\n      } else if (keyCode === keyCodes.V) {\r\n        this._graphics.pasteObject();\r\n        this.clearRedoStack();\r\n      } else if (keyCode === keyCodes.Z) {\r\n        // There is no error message on shortcut when it's empty\r\n        this.undo()['catch'](() => {});\r\n      } else if (keyCode === keyCodes.Y) {\r\n        // There is no error message on shortcut when it's empty\r\n        this.redo()['catch'](() => {});\r\n      }\r\n    }\r\n\r\n    const isDeleteKey = keyCode === keyCodes.BACKSPACE || keyCode === keyCodes.DEL;\r\n    const isRemoveReady = this._graphics.isReadyRemoveObject();\r\n\r\n    if (!this.isColorPickerInputBoxEditing && isRemoveReady && isDeleteKey) {\r\n      e.preventDefault();\r\n      this.removeActiveObject();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Remove Active Object\r\n   */\r\n  removeActiveObject() {\r\n    const activeObjectId = this._graphics.getActiveObjectIdForRemove();\r\n\r\n    this.removeObject(activeObjectId);\r\n  }\r\n\r\n  /**\r\n   * mouse down event handler\r\n   * @param {Event} event - mouse down event\r\n   * @param {Object} originPointer - origin pointer\r\n   *  @param {Number} originPointer.x x position\r\n   *  @param {Number} originPointer.y y position\r\n   * @private\r\n   */\r\n  _onMouseDown(event, originPointer) {\r\n    /**\r\n     * The mouse down event with position x, y on canvas\r\n     * @event ImageEditor#mousedown\r\n     * @param {Object} event - browser mouse event object\r\n     * @param {Object} originPointer origin pointer\r\n     *  @param {Number} originPointer.x x position\r\n     *  @param {Number} originPointer.y y position\r\n     * @example\r\n     * imageEditor.on('mousedown', function(event, originPointer) {\r\n     *     console.log(event);\r\n     *     console.log(originPointer);\r\n     *     if (imageEditor.hasFilter('colorFilter')) {\r\n     *         imageEditor.applyFilter('colorFilter', {\r\n     *             x: parseInt(originPointer.x, 10),\r\n     *             y: parseInt(originPointer.y, 10)\r\n     *         });\r\n     *     }\r\n     * });\r\n     */\r\n\r\n    this.fire(events.MOUSE_DOWN, event, originPointer);\r\n  }\r\n\r\n  _onMouseUp(event, originPointer) {\r\n    this.fire(events.MOUSE_UP, event, originPointer);\r\n  }\r\n\r\n  _onMouseMove(event, originPointer) {\r\n    this.fire(events.MOUSE_MOVE, event, originPointer);\r\n  }\r\n\r\n  _onMouseWheel(event, originPointer) {\r\n    this.fire(events.MOUSE_WHEEL, event, originPointer);\r\n  }\r\n\r\n  /**\r\n   * Add a 'addObject' command\r\n   * @param {Object} obj - Fabric object\r\n   * @private\r\n   */\r\n  _pushAddObjectCommand(obj) {\r\n    const command = commandFactory.create(commands.ADD_OBJECT, this._graphics, obj);\r\n    this._invoker.pushUndoStack(command);\r\n  }\r\n\r\n  /**\r\n   * Add a 'changeSelection' command\r\n   * @param {fabric.Object} obj - selection object\r\n   * @private\r\n   */\r\n  _pushModifyObjectCommand(obj) {\r\n    const { type } = obj;\r\n    const props = makeSelectionUndoData(obj, (item) =>\r\n      makeSelectionUndoDatum(this._graphics.getObjectId(item), item, type === 'activeSelection')\r\n    );\r\n    const command = commandFactory.create(commands.CHANGE_SELECTION, this._graphics, props);\r\n    command.execute(this._graphics, props);\r\n\r\n    this._invoker.pushUndoStack(command);\r\n  }\r\n\r\n  /**\r\n   * 'objectActivated' event handler\r\n   * @param {ObjectProps} props - object properties\r\n   * @private\r\n   */\r\n  _onObjectActivated(props) {\r\n    /**\r\n     * The event when object is selected(aka activated).\r\n     * @event ImageEditor#objectActivated\r\n     * @param {ObjectProps} objectProps - object properties\r\n     * @example\r\n     * imageEditor.on('objectActivated', function(props) {\r\n     *     console.log(props);\r\n     *     console.log(props.type);\r\n     *     console.log(props.objId);\r\n     * });\r\n     */\r\n    this.fire(events.OBJECT_ACTIVATED, props);\r\n  }\r\n\r\n  /**\r\n   * 'objectMoved' event handler\r\n   * @param {ObjectProps} props - object properties\r\n   * @private\r\n   */\r\n  _onObjectMoved(props) {\r\n    /**\r\n     * The event when object is moved\r\n     * @event ImageEditor#objectMoved\r\n     * @param {ObjectProps} props - object properties\r\n     * @example\r\n     * imageEditor.on('objectMoved', function(props) {\r\n     *     console.log(props);\r\n     *     console.log(props.type);\r\n     * });\r\n     */\r\n    this.fire(events.OBJECT_MOVED, props);\r\n  }\r\n\r\n  /**\r\n   * 'objectScaled' event handler\r\n   * @param {ObjectProps} props - object properties\r\n   * @private\r\n   */\r\n  _onObjectScaled(props) {\r\n    /**\r\n     * The event when scale factor is changed\r\n     * @event ImageEditor#objectScaled\r\n     * @param {ObjectProps} props - object properties\r\n     * @example\r\n     * imageEditor.on('objectScaled', function(props) {\r\n     *     console.log(props);\r\n     *     console.log(props.type);\r\n     * });\r\n     */\r\n    this.fire(events.OBJECT_SCALED, props);\r\n  }\r\n\r\n  /**\r\n   * 'objectRotated' event handler\r\n   * @param {ObjectProps} props - object properties\r\n   * @private\r\n   */\r\n  _onObjectRotated(props) {\r\n    /**\r\n     * The event when object angle is changed\r\n     * @event ImageEditor#objectRotated\r\n     * @param {ObjectProps} props - object properties\r\n     * @example\r\n     * imageEditor.on('objectRotated', function(props) {\r\n     *     console.log(props);\r\n     *     console.log(props.type);\r\n     * });\r\n     */\r\n    this.fire(events.OBJECT_ROTATED, props);\r\n  }\r\n\r\n  /**\r\n   * Get current drawing mode\r\n   * @returns {string}\r\n   * @example\r\n   * // Image editor drawing mode\r\n   * //\r\n   * //    NORMAL: 'NORMAL'\r\n   * //    CROPPER: 'CROPPER'\r\n   * //    FREE_DRAWING: 'FREE_DRAWING'\r\n   * //    LINE_DRAWING: 'LINE_DRAWING'\r\n   * //    TEXT: 'TEXT'\r\n   * //\r\n   * if (imageEditor.getDrawingMode() === 'FREE_DRAWING') {\r\n   *     imageEditor.stopDrawingMode();\r\n   * }\r\n   */\r\n  getDrawingMode() {\r\n    return this._graphics.getDrawingMode();\r\n  }\r\n\r\n  /**\r\n   * Clear all objects\r\n   * @returns {Promise}\r\n   * @example\r\n   * imageEditor.clearObjects();\r\n   */\r\n  clearObjects() {\r\n    return this.execute(commands.CLEAR_OBJECTS);\r\n  }\r\n\r\n  /**\r\n   * Deactivate all objects\r\n   * @example\r\n   * imageEditor.deactivateAll();\r\n   */\r\n  deactivateAll() {\r\n    this._graphics.deactivateAll();\r\n    this._graphics.renderAll();\r\n  }\r\n\r\n  /**\r\n   * discard selction\r\n   * @example\r\n   * imageEditor.discardSelection();\r\n   */\r\n  discardSelection() {\r\n    this._graphics.discardSelection();\r\n  }\r\n\r\n  /**\r\n   * selectable status change\r\n   * @param {boolean} selectable - selectable status\r\n   * @example\r\n   * imageEditor.changeSelectableAll(false); // or true\r\n   */\r\n  changeSelectableAll(selectable) {\r\n    this._graphics.changeSelectableAll(selectable);\r\n  }\r\n\r\n  /**\r\n   * Clear history\r\n   */\r\n  clearHistory() {\r\n    this._invoker.clearUndoStack();\r\n    this._invoker.clearRedoStack();\r\n  }\r\n\r\n  /**\r\n   * Invoke command\r\n   * @param {String} commandName - Command name\r\n   * @param {...*} args - Arguments for creating command\r\n   * @returns {Promise}\r\n   * @private\r\n   */\r\n  execute(commandName, ...args) {\r\n    // Inject an Graphics instance as first parameter\r\n    const theArgs = [this._graphics].concat(args);\r\n\r\n    return this._invoker.execute(commandName, ...theArgs);\r\n  }\r\n\r\n  /**\r\n   * Invoke command\r\n   * @param {String} commandName - Command name\r\n   * @param {...*} args - Arguments for creating command\r\n   * @returns {Promise}\r\n   * @private\r\n   */\r\n  executeSilent(commandName, ...args) {\r\n    // Inject an Graphics instance as first parameter\r\n    const theArgs = [this._graphics].concat(args);\r\n\r\n    return this._invoker.executeSilent(commandName, ...theArgs);\r\n  }\r\n\r\n  /**\r\n   * Undo\r\n   * @param {number} [iterationCount=1] - Iteration count of undo\r\n   * @returns {Promise}\r\n   * @example\r\n   * imageEditor.undo();\r\n   */\r\n  undo(iterationCount = 1) {\r\n    let promise = Promise.resolve();\r\n\r\n    for (let i = 0; i < iterationCount; i += 1) {\r\n      promise = promise.then(() => this._invoker.undo());\r\n    }\r\n\r\n    return promise;\r\n  }\r\n\r\n  /**\r\n   * Redo\r\n   * @param {number} [iterationCount=1] - Iteration count of redo\r\n   * @returns {Promise}\r\n   * @example\r\n   * imageEditor.redo();\r\n   */\r\n  redo(iterationCount = 1) {\r\n    let promise = Promise.resolve();\r\n\r\n    for (let i = 0; i < iterationCount; i += 1) {\r\n      promise = promise.then(() => this._invoker.redo());\r\n    }\r\n\r\n    return promise;\r\n  }\r\n\r\n  /**\r\n   * Zoom\r\n   * @param {number} x - x axis of center point for zoom\r\n   * @param {number} y - y axis of center point for zoom\r\n   * @param {number} zoomLevel - level of zoom(1.0 ~ 5.0)\r\n   */\r\n  zoom({ x, y, zoomLevel }) {\r\n    this._graphics.zoom({ x, y }, zoomLevel);\r\n  }\r\n\r\n  /**\r\n   * Reset zoom. Change zoom level to 1.0\r\n   */\r\n  resetZoom() {\r\n    this._graphics.resetZoom();\r\n  }\r\n\r\n  canvasZoom({ x, y, zoomLevel }) {\r\n    this._graphics.canvasZoom({ x, y, zoomLevel });\r\n  }\r\n\r\n  getCanvasZoom() {\r\n    return this._graphics.getCanvasZoom();\r\n  }\r\n\r\n  resetCanvasZoom() {\r\n    return this._graphics.canvasZoom(1.0);\r\n  }\r\n\r\n  /**\r\n   * Load image from file\r\n   * @param {File} imgFile - Image file\r\n   * @param {string} [imageName] - imageName\r\n   * @returns {Promise<SizeChange, ErrorMsg>}\r\n   * @example\r\n   * imageEditor.loadImageFromFile(file).then(result => {\r\n   *      console.log('old : ' + result.oldWidth + ', ' + result.oldHeight);\r\n   *      console.log('new : ' + result.newWidth + ', ' + result.newHeight);\r\n   * });\r\n   */\r\n  loadImageFromFile(imgFile, imageName) {\r\n    if (!imgFile) {\r\n      return Promise.reject(rejectMessages.invalidParameters);\r\n    }\r\n\r\n    const imgUrl = URL.createObjectURL(imgFile);\r\n    imageName = imageName || imgFile.name;\r\n\r\n    return this.loadImageFromURL(imgUrl, imageName).then((value) => {\r\n      URL.revokeObjectURL(imgFile);\r\n\r\n      return value;\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Load image from url\r\n   * @param {string} url - File url\r\n   * @param {string} imageName - imageName\r\n   * @returns {Promise<SizeChange, ErrorMsg>}\r\n   * @example\r\n   * imageEditor.loadImageFromURL('http://url/testImage.png', 'lena').then(result => {\r\n   *      console.log('old : ' + result.oldWidth + ', ' + result.oldHeight);\r\n   *      console.log('new : ' + result.newWidth + ', ' + result.newHeight);\r\n   * });\r\n   */\r\n  loadImageFromURL(url, imageName) {\r\n    if (!imageName || !url) {\r\n      return Promise.reject(rejectMessages.invalidParameters);\r\n    }\r\n\r\n    return this.execute(commands.LOAD_IMAGE, imageName, url);\r\n  }\r\n\r\n  /**\r\n   * Add image object on canvas\r\n   * @param {string} imgUrl - Image url to make object\r\n   * @returns {Promise<ObjectProps, ErrorMsg>}\r\n   * @example\r\n   * imageEditor.addImageObject('path/fileName.jpg').then(objectProps => {\r\n   *     console.log(ojectProps.objId);\r\n   * });\r\n   */\r\n  addImageObject(imgUrl) {\r\n    if (!imgUrl) {\r\n      return Promise.reject(rejectMessages.invalidParameters);\r\n    }\r\n\r\n    return this.execute(commands.ADD_IMAGE_OBJECT, imgUrl);\r\n  }\r\n\r\n  /**\r\n   * Start a drawing mode. If the current mode is not 'NORMAL', 'stopDrawingMode()' will be called first.\r\n   * @param {String} mode Can be one of <I>'CROPPER', 'FREE_DRAWING', 'LINE_DRAWING', 'TEXT', 'SHAPE'</I>\r\n   * @param {Object} [option] parameters of drawing mode, it's available with 'FREE_DRAWING', 'LINE_DRAWING'\r\n   *  @param {Number} [option.width] brush width\r\n   *  @param {String} [option.color] brush color\r\n   *  @param {Object} [option.arrowType] arrow decorate\r\n   *    @param {string} [option.arrowType.tail] arrow decorate for tail. 'chevron' or 'triangle'\r\n   *    @param {string} [option.arrowType.head] arrow decorate for head. 'chevron' or 'triangle'\r\n   * @returns {boolean} true if success or false\r\n   * @example\r\n   * imageEditor.startDrawingMode('FREE_DRAWING', {\r\n   *      width: 10,\r\n   *      color: 'rgba(255,0,0,0.5)'\r\n   * });\r\n   * imageEditor.startDrawingMode('LINE_DRAWING', {\r\n   *      width: 10,\r\n   *      color: 'rgba(255,0,0,0.5)',\r\n   *      arrowType: {\r\n   *          tail: 'chevron' // triangle\r\n   *      }\r\n   * });\r\n   *\r\n   */\r\n  startDrawingMode(mode, option) {\r\n    return this._graphics.startDrawingMode(mode, option);\r\n  }\r\n\r\n  /**\r\n   * Stop the current drawing mode and back to the 'NORMAL' mode\r\n   * @example\r\n   * imageEditor.stopDrawingMode();\r\n   */\r\n  stopDrawingMode() {\r\n    this._graphics.stopDrawingMode();\r\n  }\r\n\r\n  /**\r\n   * Crop this image with rect\r\n   * @param {Object} rect crop rect\r\n   *  @param {Number} rect.left left position\r\n   *  @param {Number} rect.top top position\r\n   *  @param {Number} rect.width width\r\n   *  @param {Number} rect.height height\r\n   * @returns {Promise}\r\n   * @example\r\n   * imageEditor.crop(imageEditor.getCropzoneRect());\r\n   */\r\n  crop(rect) {\r\n    const data = this._graphics.getCroppedImageData(rect);\r\n    if (!data) {\r\n      return Promise.reject(rejectMessages.invalidParameters);\r\n    }\r\n\r\n    return this.loadImageFromURL(data.url, data.imageName);\r\n  }\r\n\r\n  /**\r\n   * Get the cropping rect\r\n   * @returns {Object}  {{left: number, top: number, width: number, height: number}} rect\r\n   */\r\n  getCropzoneRect() {\r\n    return this._graphics.getCropzoneRect();\r\n  }\r\n\r\n  /**\r\n   * Set the cropping rect\r\n   * @param {number} [mode] crop rect mode [1, 1.5, 1.3333333333333333, 1.25, 1.7777777777777777]\r\n   */\r\n  setCropzoneRect(mode) {\r\n    this._graphics.setCropzoneRect(mode);\r\n  }\r\n\r\n  /**\r\n   * Flip\r\n   * @returns {Promise}\r\n   * @param {string} type - 'flipX' or 'flipY' or 'reset'\r\n   * @returns {Promise<FlipStatus, ErrorMsg>}\r\n   * @private\r\n   */\r\n  _flip(type) {\r\n    return this.execute(commands.FLIP_IMAGE, type);\r\n  }\r\n\r\n  /**\r\n   * Flip x\r\n   * @returns {Promise<FlipStatus, ErrorMsg>}\r\n   * @example\r\n   * imageEditor.flipX().then((status => {\r\n   *     console.log('flipX: ', status.flipX);\r\n   *     console.log('flipY: ', status.flipY);\r\n   *     console.log('angle: ', status.angle);\r\n   * }).catch(message => {\r\n   *     console.log('error: ', message);\r\n   * });\r\n   */\r\n  flipX() {\r\n    return this._flip('flipX');\r\n  }\r\n\r\n  /**\r\n   * Flip y\r\n   * @returns {Promise<FlipStatus, ErrorMsg>}\r\n   * @example\r\n   * imageEditor.flipY().then(status => {\r\n   *     console.log('flipX: ', status.flipX);\r\n   *     console.log('flipY: ', status.flipY);\r\n   *     console.log('angle: ', status.angle);\r\n   * }).catch(message => {\r\n   *     console.log('error: ', message);\r\n   * });\r\n   */\r\n  flipY() {\r\n    return this._flip('flipY');\r\n  }\r\n\r\n  /**\r\n   * Reset flip\r\n   * @returns {Promise<FlipStatus, ErrorMsg>}\r\n   * @example\r\n   * imageEditor.resetFlip().then(status => {\r\n   *     console.log('flipX: ', status.flipX);\r\n   *     console.log('flipY: ', status.flipY);\r\n   *     console.log('angle: ', status.angle);\r\n   * }).catch(message => {\r\n   *     console.log('error: ', message);\r\n   * });;\r\n   */\r\n  resetFlip() {\r\n    return this._flip('reset');\r\n  }\r\n\r\n  /**\r\n   * @param {string} type - 'rotate' or 'setAngle'\r\n   * @param {number} angle - angle value (degree)\r\n   * @param {boolean} isSilent - is silent execution or not\r\n   * @returns {Promise<RotateStatus, ErrorMsg>}\r\n   * @private\r\n   */\r\n  _rotate(type, angle, isSilent) {\r\n    let result = null;\r\n\r\n    if (isSilent) {\r\n      result = this.executeSilent(commands.ROTATE_IMAGE, type, angle);\r\n    } else {\r\n      result = this.execute(commands.ROTATE_IMAGE, type, angle);\r\n    }\r\n\r\n    return result;\r\n  }\r\n\r\n  /**\r\n   * Rotate image\r\n   * @returns {Promise}\r\n   * @param {number} angle - Additional angle to rotate image\r\n   * @param {boolean} isSilent - is silent execution or not\r\n   * @returns {Promise<RotateStatus, ErrorMsg>}\r\n   * @example\r\n   * imageEditor.rotate(10); // angle = 10\r\n   * imageEditor.rotate(10); // angle = 20\r\n   * imageEditor.rotate(5); // angle = 5\r\n   * imageEditor.rotate(-95); // angle = -90\r\n   * imageEditor.rotate(10).then(status => {\r\n   *     console.log('angle: ', status.angle);\r\n   * })).catch(message => {\r\n   *     console.log('error: ', message);\r\n   * });\r\n   */\r\n  rotate(angle, isSilent) {\r\n    return this._rotate('rotate', angle, isSilent);\r\n  }\r\n\r\n  /**\r\n   * Set angle\r\n   * @param {number} angle - Angle of image\r\n   * @param {boolean} isSilent - is silent execution or not\r\n   * @returns {Promise<RotateStatus, ErrorMsg>}\r\n   * @example\r\n   * imageEditor.setAngle(10); // angle = 10\r\n   * imageEditor.rotate(10); // angle = 20\r\n   * imageEditor.setAngle(5); // angle = 5\r\n   * imageEditor.rotate(50); // angle = 55\r\n   * imageEditor.setAngle(-40); // angle = -40\r\n   * imageEditor.setAngle(10).then(status => {\r\n   *     console.log('angle: ', status.angle);\r\n   * })).catch(message => {\r\n   *     console.log('error: ', message);\r\n   * });\r\n   */\r\n  setAngle(angle, isSilent) {\r\n    return this._rotate('setAngle', angle, isSilent);\r\n  }\r\n\r\n  /**\r\n   * Set drawing brush\r\n   * @param {Object} option brush option\r\n   *  @param {Number} option.width width\r\n   *  @param {String} option.color color like 'FFFFFF', 'rgba(0, 0, 0, 0.5)'\r\n   * @example\r\n   * imageEditor.startDrawingMode('FREE_DRAWING');\r\n   * imageEditor.setBrush({\r\n   *     width: 12,\r\n   *     color: 'rgba(0, 0, 0, 0.5)'\r\n   * });\r\n   * imageEditor.setBrush({\r\n   *     width: 8,\r\n   *     color: 'FFFFFF'\r\n   * });\r\n   */\r\n  setBrush(option) {\r\n    this._graphics.setBrush(option);\r\n  }\r\n\r\n  /**\r\n   * Set states of current drawing shape\r\n   * @param {string} type - Shape type (ex: 'rect', 'circle', 'triangle')\r\n   * @param {Object} [options] - Shape options\r\n   *      @param {(ShapeFillOption | string)} [options.fill] - {@link ShapeFillOption} or\r\n   *        Shape foreground color (ex: '#fff', 'transparent')\r\n   *      @param {string} [options.stoke] - Shape outline color\r\n   *      @param {number} [options.strokeWidth] - Shape outline width\r\n   *      @param {number} [options.width] - Width value (When type option is 'rect', this options can use)\r\n   *      @param {number} [options.height] - Height value (When type option is 'rect', this options can use)\r\n   *      @param {number} [options.rx] - Radius x value (When type option is 'circle', this options can use)\r\n   *      @param {number} [options.ry] - Radius y value (When type option is 'circle', this options can use)\r\n   *      @param {number} [options.isRegular] - Whether resizing shape has 1:1 ratio or not\r\n   * @example\r\n   * imageEditor.setDrawingShape('rect', {\r\n   *     fill: 'red',\r\n   *     width: 100,\r\n   *     height: 200\r\n   * });\r\n   * @example\r\n   * imageEditor.setDrawingShape('rect', {\r\n   *     fill: {\r\n   *         type: 'filter',\r\n   *         filter: [{blur: 0.3}, {pixelate: 20}]\r\n   *     },\r\n   *     width: 100,\r\n   *     height: 200\r\n   * });\r\n   * @example\r\n   * imageEditor.setDrawingShape('circle', {\r\n   *     fill: 'transparent',\r\n   *     stroke: 'blue',\r\n   *     strokeWidth: 3,\r\n   *     rx: 10,\r\n   *     ry: 100\r\n   * });\r\n   * @example\r\n   * imageEditor.setDrawingShape('triangle', { // When resizing, the shape keep the 1:1 ratio\r\n   *     width: 1,\r\n   *     height: 1,\r\n   *     isRegular: true\r\n   * });\r\n   * @example\r\n   * imageEditor.setDrawingShape('circle', { // When resizing, the shape keep the 1:1 ratio\r\n   *     rx: 10,\r\n   *     ry: 10,\r\n   *     isRegular: true\r\n   * });\r\n   */\r\n  setDrawingShape(type, options) {\r\n    this._graphics.setDrawingShape(type, options);\r\n  }\r\n\r\n  setDrawingIcon(type, iconColor) {\r\n    this._graphics.setIconStyle(type, iconColor);\r\n  }\r\n\r\n  /**\r\n   * Add shape\r\n   * @param {string} type - Shape type (ex: 'rect', 'circle', 'triangle')\r\n   * @param {Object} options - Shape options\r\n   *      @param {(ShapeFillOption | string)} [options.fill] - {@link ShapeFillOption} or\r\n   *        Shape foreground color (ex: '#fff', 'transparent')\r\n   *      @param {string} [options.stroke] - Shape outline color\r\n   *      @param {number} [options.strokeWidth] - Shape outline width\r\n   *      @param {number} [options.width] - Width value (When type option is 'rect', this options can use)\r\n   *      @param {number} [options.height] - Height value (When type option is 'rect', this options can use)\r\n   *      @param {number} [options.rx] - Radius x value (When type option is 'circle', this options can use)\r\n   *      @param {number} [options.ry] - Radius y value (When type option is 'circle', this options can use)\r\n   *      @param {number} [options.left] - Shape x position\r\n   *      @param {number} [options.top] - Shape y position\r\n   *      @param {boolean} [options.isRegular] - Whether resizing shape has 1:1 ratio or not\r\n   * @returns {Promise<ObjectProps, ErrorMsg>}\r\n   * @example\r\n   * imageEditor.addShape('rect', {\r\n   *     fill: 'red',\r\n   *     stroke: 'blue',\r\n   *     strokeWidth: 3,\r\n   *     width: 100,\r\n   *     height: 200,\r\n   *     left: 10,\r\n   *     top: 10,\r\n   *     isRegular: true\r\n   * });\r\n   * @example\r\n   * imageEditor.addShape('circle', {\r\n   *     fill: 'red',\r\n   *     stroke: 'blue',\r\n   *     strokeWidth: 3,\r\n   *     rx: 10,\r\n   *     ry: 100,\r\n   *     isRegular: false\r\n   * }).then(objectProps => {\r\n   *     console.log(objectProps.objId);\r\n   * });\r\n   * @example\r\n   * imageEditor.addShape('rect', {\r\n   *     fill: {\r\n   *         type: 'filter',\r\n   *         filter: [{blur: 0.3}, {pixelate: 20}]\r\n   *     },\r\n   *     stroke: 'blue',\r\n   *     strokeWidth: 3,\r\n   *     rx: 10,\r\n   *     ry: 100,\r\n   *     isRegular: false\r\n   * }).then(objectProps => {\r\n   *     console.log(objectProps.objId);\r\n   * });\r\n   */\r\n  addShape(type, options) {\r\n    options = options || {};\r\n\r\n    this._setPositions(options);\r\n\r\n    return this.execute(commands.ADD_SHAPE, type, options);\r\n  }\r\n\r\n  /**\r\n   * Change shape\r\n   * @param {number} objId -  object id\r\n   * @param {Object} options - Shape options\r\n   *      @param {(ShapeFillOption | string)} [options.fill] - {@link ShapeFillOption} or\r\n   *        Shape foreground color (ex: '#fff', 'transparent')\r\n   *      @param {string} [options.stroke] - Shape outline color\r\n   *      @param {number} [options.strokeWidth] - Shape outline width\r\n   *      @param {number} [options.width] - Width value (When type option is 'rect', this options can use)\r\n   *      @param {number} [options.height] - Height value (When type option is 'rect', this options can use)\r\n   *      @param {number} [options.rx] - Radius x value (When type option is 'circle', this options can use)\r\n   *      @param {number} [options.ry] - Radius y value (When type option is 'circle', this options can use)\r\n   *      @param {boolean} [options.isRegular] - Whether resizing shape has 1:1 ratio or not\r\n   * @param {boolean} isSilent - is silent execution or not\r\n   * @returns {Promise}\r\n   * @example\r\n   * // call after selecting shape object on canvas\r\n   * imageEditor.changeShape(objId, { // change rectagle or triangle\r\n   *     fill: 'red',\r\n   *     stroke: 'blue',\r\n   *     strokeWidth: 3,\r\n   *     width: 100,\r\n   *     height: 200\r\n   * });\r\n   * @example\r\n   * // call after selecting shape object on canvas\r\n   * imageEditor.changeShape(objId, { // change circle\r\n   *     fill: 'red',\r\n   *     stroke: 'blue',\r\n   *     strokeWidth: 3,\r\n   *     rx: 10,\r\n   *     ry: 100\r\n   * });\r\n   */\r\n  changeShape(objId, options, isSilent) {\r\n    const executeMethodName = isSilent ? 'executeSilent' : 'execute';\r\n\r\n    return this[executeMethodName](commands.CHANGE_SHAPE, objId, options);\r\n  }\r\n\r\n  /**\r\n   * Add text on image\r\n   * @param {string} text - Initial input text\r\n   * @param {Object} [options] Options for generating text\r\n   *     @param {Object} [options.styles] Initial styles\r\n   *         @param {string} [options.styles.fill] Color\r\n   *         @param {string} [options.styles.fontFamily] Font type for text\r\n   *         @param {number} [options.styles.fontSize] Size\r\n   *         @param {string} [options.styles.fontStyle] Type of inclination (normal / italic)\r\n   *         @param {string} [options.styles.fontWeight] Type of thicker or thinner looking (normal / bold)\r\n   *         @param {string} [options.styles.textAlign] Type of text align (left / center / right)\r\n   *         @param {string} [options.styles.textDecoration] Type of line (underline / line-through / overline)\r\n   *     @param {{x: number, y: number}} [options.position] - Initial position\r\n   *     @param {boolean} [options.autofocus] - text autofocus, default is true\r\n   * @returns {Promise}\r\n   * @example\r\n   * imageEditor.addText('init text');\r\n   * @example\r\n   * imageEditor.addText('init text', {\r\n   *     styles: {\r\n   *         fill: '#000',\r\n   *         fontSize: 20,\r\n   *         fontWeight: 'bold'\r\n   *     },\r\n   *     position: {\r\n   *         x: 10,\r\n   *         y: 10\r\n   *     }\r\n   * }).then(objectProps => {\r\n   *     console.log(objectProps.objId);\r\n   * });\r\n   */\r\n  addText(text, options) {\r\n    text = text || '';\r\n    options = options || {};\r\n\r\n    return this.execute(commands.ADD_TEXT, text, options);\r\n  }\r\n\r\n  /**\r\n   * Change contents of selected text object on image\r\n   * @param {number} objId -  object id\r\n   * @param {string} text - Changing text\r\n   * @returns {Promise<ObjectProps, ErrorMsg>}\r\n   * @example\r\n   * imageEditor.changeText(objId, 'change text');\r\n   */\r\n  changeText(objId, text) {\r\n    text = text || '';\r\n\r\n    return this.execute(commands.CHANGE_TEXT, objId, text);\r\n  }\r\n\r\n  /**\r\n   * Set style\r\n   * @param {number} objId -  object id\r\n   * @param {Object} styleObj - text styles\r\n   *     @param {string} [styleObj.fill] Color\r\n   *     @param {string} [styleObj.fontFamily] Font type for text\r\n   *     @param {number} [styleObj.fontSize] Size\r\n   *     @param {string} [styleObj.fontStyle] Type of inclination (normal / italic)\r\n   *     @param {string} [styleObj.fontWeight] Type of thicker or thinner looking (normal / bold)\r\n   *     @param {string} [styleObj.textAlign] Type of text align (left / center / right)\r\n   *     @param {string} [styleObj.textDecoration] Type of line (underline / line-through / overline)\r\n   * @param {boolean} isSilent - is silent execution or not\r\n   * @returns {Promise}\r\n   * @example\r\n   * imageEditor.changeTextStyle(objId, {\r\n   *     fontStyle: 'italic'\r\n   * });\r\n   */\r\n  changeTextStyle(objId, styleObj, isSilent) {\r\n    const executeMethodName = isSilent ? 'executeSilent' : 'execute';\r\n\r\n    return this[executeMethodName](commands.CHANGE_TEXT_STYLE, objId, styleObj);\r\n  }\r\n\r\n  /**\r\n   * change text mode\r\n   * @param {string} type - change type\r\n   * @private\r\n   */\r\n  _changeActivateMode(type) {\r\n    if (type !== 'ICON' && this.getDrawingMode() !== type) {\r\n      this.startDrawingMode(type);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 'textChanged' event handler\r\n   * @param {Object} target - changed text object\r\n   * @private\r\n   */\r\n  _onTextChanged(target) {\r\n    this.fire(events.TEXT_CHANGED, target);\r\n  }\r\n\r\n  /**\r\n   * 'iconCreateResize' event handler\r\n   * @param {Object} originPointer origin pointer\r\n   *  @param {Number} originPointer.x x position\r\n   *  @param {Number} originPointer.y y position\r\n   * @private\r\n   */\r\n  _onIconCreateResize(originPointer) {\r\n    this.fire(events.ICON_CREATE_RESIZE, originPointer);\r\n  }\r\n\r\n  /**\r\n   * 'iconCreateEnd' event handler\r\n   * @param {Object} originPointer origin pointer\r\n   *  @param {Number} originPointer.x x position\r\n   *  @param {Number} originPointer.y y position\r\n   * @private\r\n   */\r\n  _onIconCreateEnd(originPointer) {\r\n    this.fire(events.ICON_CREATE_END, originPointer);\r\n  }\r\n\r\n  /**\r\n   * 'textEditing' event handler\r\n   * @private\r\n   */\r\n  _onTextEditing() {\r\n    /**\r\n     * The event which starts to edit text object\r\n     * @event ImageEditor#textEditing\r\n     * @example\r\n     * imageEditor.on('textEditing', function() {\r\n     *     console.log('text editing');\r\n     * });\r\n     */\r\n\r\n    this.fire(events.TEXT_EDITING);\r\n  }\r\n\r\n  /**\r\n   * Mousedown event handler in case of 'TEXT' drawing mode\r\n   * @param {fabric.Event} event - Current mousedown event object\r\n   * @private\r\n   */\r\n  _onAddText(event) {\r\n    /**\r\n     * The event when 'TEXT' drawing mode is enabled and click non-object area.\r\n     * @event ImageEditor#addText\r\n     * @param {Object} pos\r\n     *  @param {Object} pos.originPosition - Current position on origin canvas\r\n     *      @param {Number} pos.originPosition.x - x\r\n     *      @param {Number} pos.originPosition.y - y\r\n     *  @param {Object} pos.clientPosition - Current position on client area\r\n     *      @param {Number} pos.clientPosition.x - x\r\n     *      @param {Number} pos.clientPosition.y - y\r\n     * @example\r\n     * imageEditor.on('addText', function(pos) {\r\n     *     console.log('text position on canvas: ' + pos.originPosition);\r\n     *     console.log('text position on brwoser: ' + pos.clientPosition);\r\n     * });\r\n     */\r\n\r\n    this.fire(events.ADD_TEXT, {\r\n      originPosition: event.originPosition,\r\n      clientPosition: event.clientPosition,\r\n    });\r\n  }\r\n\r\n  /**\r\n   * 'addObject' event handler\r\n   * @param {Object} objectProps added object properties\r\n   * @private\r\n   */\r\n  _onAddObject(objectProps) {\r\n    const obj = this._graphics.getObject(objectProps.objId);\r\n    this._invoker.fire(events.EXECUTE_COMMAND, getObjectType(obj.type));\r\n    this._pushAddObjectCommand(obj);\r\n  }\r\n\r\n  /**\r\n   * 'objectAdded' event handler\r\n   * @param {Object} objectProps added object properties\r\n   * @private\r\n   */\r\n  _onObjectAdded(objectProps) {\r\n    /**\r\n     * The event when object added\r\n     * @event ImageEditor#objectAdded\r\n     * @param {ObjectProps} props - object properties\r\n     * @example\r\n     * imageEditor.on('objectAdded', function(props) {\r\n     *     console.log(props);\r\n     * });\r\n     */\r\n    this.fire(OBJECT_ADDED, objectProps);\r\n\r\n    /**\r\n     * The event when object added (deprecated)\r\n     * @event ImageEditor#addObjectAfter\r\n     * @param {ObjectProps} props - object properties\r\n     * @deprecated\r\n     */\r\n    this.fire(ADD_OBJECT_AFTER, objectProps);\r\n  }\r\n\r\n  /**\r\n   * 'objectModified' event handler\r\n   * @param {fabric.Object} obj - selection object\r\n   * @private\r\n   */\r\n  _onObjectModified(obj) {\r\n    if (obj.type !== OBJ_TYPE.CROPZONE) {\r\n      this._invoker.fire(events.EXECUTE_COMMAND, getObjectType(obj.type));\r\n      this._pushModifyObjectCommand(obj);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 'selectionCleared' event handler\r\n   * @private\r\n   */\r\n  _selectionCleared() {\r\n    this.fire(SELECTION_CLEARED);\r\n  }\r\n\r\n  /**\r\n   * 'selectionCreated' event handler\r\n   * @param {Object} eventTarget - Fabric object\r\n   * @private\r\n   */\r\n  _selectionCreated(eventTarget) {\r\n    this.fire(SELECTION_CREATED, eventTarget);\r\n  }\r\n\r\n  /**\r\n   * Register custom icons\r\n   * @param {{iconType: string, pathValue: string}} infos - Infos to register icons\r\n   * @example\r\n   * imageEditor.registerIcons({\r\n   *     customIcon: 'M 0 0 L 20 20 L 10 10 Z',\r\n   *     customArrow: 'M 60 0 L 120 60 H 90 L 75 45 V 180 H 45 V 45 L 30 60 H 0 Z'\r\n   * });\r\n   */\r\n  registerIcons(infos) {\r\n    this._graphics.registerPaths(infos);\r\n  }\r\n\r\n  /**\r\n   * Change canvas cursor type\r\n   * @param {string} cursorType - cursor type\r\n   * @example\r\n   * imageEditor.changeCursor('crosshair');\r\n   */\r\n  changeCursor(cursorType) {\r\n    this._graphics.changeCursor(cursorType);\r\n  }\r\n\r\n  /**\r\n   * Add icon on canvas\r\n   * @param {string} type - Icon type ('arrow', 'cancel', custom icon name)\r\n   * @param {Object} options - Icon options\r\n   *      @param {string} [options.fill] - Icon foreground color\r\n   *      @param {number} [options.left] - Icon x position\r\n   *      @param {number} [options.top] - Icon y position\r\n   * @returns {Promise<ObjectProps, ErrorMsg>}\r\n   * @example\r\n   * imageEditor.addIcon('arrow'); // The position is center on canvas\r\n   * @example\r\n   * imageEditor.addIcon('arrow', {\r\n   *     left: 100,\r\n   *     top: 100\r\n   * }).then(objectProps => {\r\n   *     console.log(objectProps.objId);\r\n   * });\r\n   */\r\n  addIcon(type, options) {\r\n    options = options || {};\r\n\r\n    this._setPositions(options);\r\n\r\n    return this.execute(commands.ADD_ICON, type, options);\r\n  }\r\n\r\n  /**\r\n   * Change icon color\r\n   * @param {number} objId -  object id\r\n   * @param {string} color - Color for icon\r\n   * @returns {Promise}\r\n   * @example\r\n   * imageEditor.changeIconColor(objId, '#000000');\r\n   */\r\n  changeIconColor(objId, color) {\r\n    return this.execute(commands.CHANGE_ICON_COLOR, objId, color);\r\n  }\r\n\r\n  /**\r\n   * Remove an object or group by id\r\n   * @param {number} objId -  object id\r\n   * @returns {Promise}\r\n   * @example\r\n   * imageEditor.removeObject(objId);\r\n   */\r\n  removeObject(objId) {\r\n    const { type } = this._graphics.getObject(objId);\r\n\r\n    return this.execute(commands.REMOVE_OBJECT, objId, getObjectType(type));\r\n  }\r\n\r\n  /**\r\n   * Whether it has the filter or not\r\n   * @param {string} type - Filter type\r\n   * @returns {boolean} true if it has the filter\r\n   */\r\n  hasFilter(type) {\r\n    return this._graphics.hasFilter(type);\r\n  }\r\n\r\n  /**\r\n   * Remove filter on canvas image\r\n   * @param {string} type - Filter type\r\n   * @returns {Promise<FilterResult, ErrorMsg>}\r\n   * @example\r\n   * imageEditor.removeFilter('Grayscale').then(obj => {\r\n   *     console.log('filterType: ', obj.type);\r\n   *     console.log('actType: ', obj.action);\r\n   * }).catch(message => {\r\n   *     console.log('error: ', message);\r\n   * });\r\n   */\r\n  removeFilter(type) {\r\n    return this.execute(commands.REMOVE_FILTER, type);\r\n  }\r\n\r\n  /**\r\n   * Apply filter on canvas image\r\n   * @param {string} type - Filter type\r\n   * @param {object} options - Options to apply filter\r\n   * @param {boolean} isSilent - is silent execution or not\r\n   * @returns {Promise<FilterResult, ErrorMsg>}\r\n   * @example\r\n   * imageEditor.applyFilter('Grayscale');\r\n   * @example\r\n   * imageEditor.applyFilter('mask', {maskObjId: id}).then(obj => {\r\n   *     console.log('filterType: ', obj.type);\r\n   *     console.log('actType: ', obj.action);\r\n   * }).catch(message => {\r\n   *     console.log('error: ', message);\r\n   * });;\r\n   */\r\n  applyFilter(type, options, isSilent) {\r\n    const executeMethodName = isSilent ? 'executeSilent' : 'execute';\r\n\r\n    return this[executeMethodName](commands.APPLY_FILTER, type, options);\r\n  }\r\n\r\n  /**\r\n   * Get data url\r\n   * @param {Object} options - options for toDataURL\r\n   *   @param {String} [options.format=png] The format of the output image. Either \"jpeg\" or \"png\"\r\n   *   @param {Number} [options.quality=1] Quality level (0..1). Only used for jpeg.\r\n   *   @param {Number} [options.multiplier=1] Multiplier to scale by\r\n   *   @param {Number} [options.left] Cropping left offset. Introduced in fabric v1.2.14\r\n   *   @param {Number} [options.top] Cropping top offset. Introduced in fabric v1.2.14\r\n   *   @param {Number} [options.width] Cropping width. Introduced in fabric v1.2.14\r\n   *   @param {Number} [options.height] Cropping height. Introduced in fabric v1.2.14\r\n   * @returns {string} A DOMString containing the requested data URI\r\n   * @example\r\n   * imgEl.src = imageEditor.toDataURL();\r\n   *\r\n   * imageEditor.loadImageFromURL(imageEditor.toDataURL(), 'FilterImage').then(() => {\r\n   *      imageEditor.addImageObject(imgUrl);\r\n   * });\r\n   */\r\n  toDataURL(options) {\r\n    return this._graphics.toDataURL(options);\r\n  }\r\n\r\n  /**\r\n   * Get image name\r\n   * @returns {string} image name\r\n   * @example\r\n   * console.log(imageEditor.getImageName());\r\n   */\r\n  getImageName() {\r\n    return this._graphics.getImageName();\r\n  }\r\n\r\n  /**\r\n   * Clear undoStack\r\n   * @example\r\n   * imageEditor.clearUndoStack();\r\n   */\r\n  clearUndoStack() {\r\n    this._invoker.clearUndoStack();\r\n  }\r\n\r\n  /**\r\n   * Clear redoStack\r\n   * @example\r\n   * imageEditor.clearRedoStack();\r\n   */\r\n  clearRedoStack() {\r\n    this._invoker.clearRedoStack();\r\n  }\r\n\r\n  /**\r\n   * Whehter the undo stack is empty or not\r\n   * @returns {boolean}\r\n   * imageEditor.isEmptyUndoStack();\r\n   */\r\n  isEmptyUndoStack() {\r\n    return this._invoker.isEmptyUndoStack();\r\n  }\r\n\r\n  /**\r\n   * Whehter the redo stack is empty or not\r\n   * @returns {boolean}\r\n   * imageEditor.isEmptyRedoStack();\r\n   */\r\n  isEmptyRedoStack() {\r\n    return this._invoker.isEmptyRedoStack();\r\n  }\r\n\r\n  /**\r\n   * Resize canvas dimension\r\n   * @param {{width: number, height: number}} dimension - Max width & height\r\n   * @returns {Promise}\r\n   */\r\n  resizeCanvasDimension(dimension) {\r\n    if (!dimension) {\r\n      return Promise.reject(rejectMessages.invalidParameters);\r\n    }\r\n\r\n    return this.execute(commands.RESIZE_CANVAS_DIMENSION, dimension);\r\n  }\r\n\r\n  /**\r\n   * Destroy\r\n   */\r\n  destroy() {\r\n    this.stopDrawingMode();\r\n    this._detachDomEvents();\r\n    this._graphics.destroy();\r\n    this._graphics = null;\r\n\r\n    forEach(\r\n      this,\r\n      (value, key) => {\r\n        this[key] = null;\r\n      },\r\n      this\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Set position\r\n   * @param {Object} options - Position options (left or top)\r\n   * @private\r\n   */\r\n  _setPositions(options) {\r\n    const centerPosition = this._graphics.getCenter();\r\n\r\n    if (isUndefined(options.left)) {\r\n      options.left = centerPosition.left;\r\n    }\r\n\r\n    if (isUndefined(options.top)) {\r\n      options.top = centerPosition.top;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Set properties of active object\r\n   * @param {number} objId -  object id\r\n   * @param {Object} keyValue - key & value\r\n   * @returns {Promise}\r\n   * @example\r\n   * imageEditor.setObjectProperties(objId, {\r\n   *     left:100,\r\n   *     top:100,\r\n   *     width: 200,\r\n   *     height: 200,\r\n   *     opacity: 0.5\r\n   * });\r\n   */\r\n  setObjectProperties(objId, keyValue) {\r\n    return this.execute(commands.SET_OBJECT_PROPERTIES, objId, keyValue);\r\n  }\r\n\r\n  /**\r\n   * Set properties of active object, Do not leave an invoke history.\r\n   * @param {number} objId -  object id\r\n   * @param {Object} keyValue - key & value\r\n   * @example\r\n   * imageEditor.setObjectPropertiesQuietly(objId, {\r\n   *     left:100,\r\n   *     top:100,\r\n   *     width: 200,\r\n   *     height: 200,\r\n   *     opacity: 0.5\r\n   * });\r\n   */\r\n  setObjectPropertiesQuietly(objId, keyValue) {\r\n    this._graphics.setObjectProperties(objId, keyValue);\r\n  }\r\n\r\n  /**\r\n   * Get properties of active object corresponding key\r\n   * @param {number} objId -  object id\r\n   * @param {Array<string>|ObjectProps|string} keys - property's key\r\n   * @returns {ObjectProps} properties if id is valid or null\r\n   * @example\r\n   * var props = imageEditor.getObjectProperties(objId, 'left');\r\n   * console.log(props);\r\n   * @example\r\n   * var props = imageEditor.getObjectProperties(objId, ['left', 'top', 'width', 'height']);\r\n   * console.log(props);\r\n   * @example\r\n   * var props = imageEditor.getObjectProperties(objId, {\r\n   *     left: null,\r\n   *     top: null,\r\n   *     width: null,\r\n   *     height: null,\r\n   *     opacity: null\r\n   * });\r\n   * console.log(props);\r\n   */\r\n  getObjectProperties(objId, keys) {\r\n    const object = this._graphics.getObject(objId);\r\n    if (!object) {\r\n      return null;\r\n    }\r\n\r\n    return this._graphics.getObjectProperties(objId, keys);\r\n  }\r\n\r\n  /**\r\n   * Get the canvas size\r\n   * @returns {Object} {{width: number, height: number}} canvas size\r\n   * @example\r\n   * var canvasSize = imageEditor.getCanvasSize();\r\n   * console.log(canvasSize.width);\r\n   * console.height(canvasSize.height);\r\n   */\r\n  getCanvasSize() {\r\n    return this._graphics.getCanvasSize();\r\n  }\r\n\r\n  /**\r\n   * Get object position by originX, originY\r\n   * @param {number} objId -  object id\r\n   * @param {string} originX - can be 'left', 'center', 'right'\r\n   * @param {string} originY - can be 'top', 'center', 'bottom'\r\n   * @returns {Object} {{x:number, y: number}} position by origin if id is valid, or null\r\n   * @example\r\n   * var position = imageEditor.getObjectPosition(objId, 'left', 'top');\r\n   * console.log(position);\r\n   */\r\n  getObjectPosition(objId, originX, originY) {\r\n    return this._graphics.getObjectPosition(objId, originX, originY);\r\n  }\r\n\r\n  /**\r\n   * Set object position  by originX, originY\r\n   * @param {number} objId -  object id\r\n   * @param {Object} posInfo - position object\r\n   *  @param {number} posInfo.x - x position\r\n   *  @param {number} posInfo.y - y position\r\n   *  @param {string} posInfo.originX - can be 'left', 'center', 'right'\r\n   *  @param {string} posInfo.originY - can be 'top', 'center', 'bottom'\r\n   * @returns {Promise}\r\n   * @example\r\n   * // align the object to 'left', 'top'\r\n   * imageEditor.setObjectPosition(objId, {\r\n   *     x: 0,\r\n   *     y: 0,\r\n   *     originX: 'left',\r\n   *     originY: 'top'\r\n   * });\r\n   * @example\r\n   * // align the object to 'right', 'top'\r\n   * var canvasSize = imageEditor.getCanvasSize();\r\n   * imageEditor.setObjectPosition(objId, {\r\n   *     x: canvasSize.width,\r\n   *     y: 0,\r\n   *     originX: 'right',\r\n   *     originY: 'top'\r\n   * });\r\n   * @example\r\n   * // align the object to 'left', 'bottom'\r\n   * var canvasSize = imageEditor.getCanvasSize();\r\n   * imageEditor.setObjectPosition(objId, {\r\n   *     x: 0,\r\n   *     y: canvasSize.height,\r\n   *     originX: 'left',\r\n   *     originY: 'bottom'\r\n   * });\r\n   * @example\r\n   * // align the object to 'right', 'bottom'\r\n   * var canvasSize = imageEditor.getCanvasSize();\r\n   * imageEditor.setObjectPosition(objId, {\r\n   *     x: canvasSize.width,\r\n   *     y: canvasSize.height,\r\n   *     originX: 'right',\r\n   *     originY: 'bottom'\r\n   * });\r\n   */\r\n  setObjectPosition(objId, posInfo) {\r\n    return this.execute(commands.SET_OBJECT_POSITION, objId, posInfo);\r\n  }\r\n\r\n  /**\r\n   * @param {object} dimensions - Image Dimensions\r\n   * @returns {Promise<ErrorMsg>}\r\n   */\r\n  resize(dimensions) {\r\n    return this.execute(commands.RESIZE_IMAGE, dimensions);\r\n  }\r\n\r\n  /**\r\n   * @param {Array} [propertiesToInclude] Any properties that you might want to additionally include in the output\r\n   * @returns {Object} Object representation of an instance\r\n   */\r\n  toJSON(propertiesToInclude) {\r\n    return this._graphics.toJSON(propertiesToInclude);\r\n  }\r\n\r\n  loadFromJSON(json) {\r\n    if (!json) {\r\n      return Promise.reject(rejectMessages.invalidParameters);\r\n    }\r\n\r\n    return this.execute(commands.LOAD_JSON, json);\r\n  }\r\n\r\n  setBackgroundColor(color) {\r\n    return this._graphics.setBackgroundColor(color);\r\n  }\r\n}\r\n\r\nCustomEvents.mixin(ImageEditor);\r\n\r\nexport default ImageEditor;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Command interface\r\n */\r\nimport snippet from 'tui-code-snippet';\r\nimport errorMessage from '@/factory/errorMessage';\r\n\r\nconst createMessage = errorMessage.create;\r\nconst errorTypes = errorMessage.types;\r\n\r\n/**\r\n * Command class\r\n * @class\r\n * @param {{name:function, execute: function, undo: function,\r\n *          executeCallback: function, undoCallback: function}} actions - Command actions\r\n * @param {Array} args - passing arguments on execute, undo\r\n * @ignore\r\n */\r\nclass Command {\r\n  constructor(actions, args) {\r\n    /**\r\n     * command name\r\n     * @type {string}\r\n     */\r\n    this.name = actions.name;\r\n\r\n    /**\r\n     * arguments\r\n     * @type {Array}\r\n     */\r\n    this.args = args;\r\n\r\n    /**\r\n     * Execute function\r\n     * @type {function}\r\n     */\r\n    this.execute = actions.execute;\r\n\r\n    /**\r\n     * Undo function\r\n     * @type {function}\r\n     */\r\n    this.undo = actions.undo;\r\n\r\n    /**\r\n     * executeCallback\r\n     * @type {function}\r\n     */\r\n    this.executeCallback = actions.executeCallback || null;\r\n\r\n    /**\r\n     * undoCallback\r\n     * @type {function}\r\n     */\r\n    this.undoCallback = actions.undoCallback || null;\r\n\r\n    /**\r\n     * data for undo\r\n     * @type {Object}\r\n     */\r\n    this.undoData = {};\r\n  }\r\n\r\n  /**\r\n   * Execute action\r\n   * @param {Object.<string, Component>} compMap - Components injection\r\n   * @abstract\r\n   */\r\n  execute() {\r\n    throw new Error(createMessage(errorTypes.UN_IMPLEMENTATION, 'execute'));\r\n  }\r\n\r\n  /**\r\n   * Undo action\r\n   * @param {Object.<string, Component>} compMap - Components injection\r\n   * @abstract\r\n   */\r\n  undo() {\r\n    throw new Error(createMessage(errorTypes.UN_IMPLEMENTATION, 'undo'));\r\n  }\r\n\r\n  /**\r\n   * command for redo if undoData exists\r\n   * @returns {boolean} isRedo\r\n   */\r\n  get isRedo() {\r\n    return Object.keys(this.undoData).length > 0;\r\n  }\r\n\r\n  /**\r\n   * Set undoData action\r\n   * @param {Object} undoData - maked undo data\r\n   * @param {Object} cachedUndoDataForSilent - cached undo data\r\n   * @param {boolean} isSilent - is silent execution or not\r\n   * @returns {Object} cachedUndoDataForSilent\r\n   */\r\n  setUndoData(undoData, cachedUndoDataForSilent, isSilent) {\r\n    if (cachedUndoDataForSilent) {\r\n      undoData = cachedUndoDataForSilent;\r\n    }\r\n\r\n    if (!isSilent) {\r\n      snippet.extend(this.undoData, undoData);\r\n      cachedUndoDataForSilent = null;\r\n    } else if (!cachedUndoDataForSilent) {\r\n      cachedUndoDataForSilent = undoData;\r\n    }\r\n\r\n    return cachedUndoDataForSilent;\r\n  }\r\n\r\n  /**\r\n   * Attach execute callabck\r\n   * @param {function} callback - Callback after execution\r\n   * @returns {Command} this\r\n   */\r\n  setExecuteCallback(callback) {\r\n    this.executeCallback = callback;\r\n\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Attach undo callback\r\n   * @param {function} callback - Callback after undo\r\n   * @returns {Command} this\r\n   */\r\n  setUndoCallback(callback) {\r\n    this.undoCallback = callback;\r\n\r\n    return this;\r\n  }\r\n}\r\n\r\nexport default Command;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Component interface\r\n */\r\n\r\n/**\r\n * Component interface\r\n * @class\r\n * @param {string} name - component name\r\n * @param {Graphics} graphics - Graphics instance\r\n * @ignore\r\n */\r\nclass Component {\r\n  constructor(name, graphics) {\r\n    /**\r\n     * Component name\r\n     * @type {string}\r\n     */\r\n    this.name = name;\r\n\r\n    /**\r\n     * Graphics instance\r\n     * @type {Graphics}\r\n     */\r\n    this.graphics = graphics;\r\n  }\r\n\r\n  /**\r\n   * Fire Graphics event\r\n   * @returns {Object} return value\r\n   */\r\n  fire(...args) {\r\n    const context = this.graphics;\r\n\r\n    return this.graphics.fire.apply(context, args);\r\n  }\r\n\r\n  /**\r\n   * Save image(background) of canvas\r\n   * @param {string} name - Name of image\r\n   * @param {fabric.Image} oImage - Fabric image instance\r\n   */\r\n  setCanvasImage(name, oImage) {\r\n    this.graphics.setCanvasImage(name, oImage);\r\n  }\r\n\r\n  /**\r\n   * Returns canvas element of fabric.Canvas[[lower-canvas]]\r\n   * @returns {HTMLCanvasElement}\r\n   */\r\n  getCanvasElement() {\r\n    return this.graphics.getCanvasElement();\r\n  }\r\n\r\n  /**\r\n   * Get fabric.Canvas instance\r\n   * @returns {fabric.Canvas}\r\n   */\r\n  getCanvas() {\r\n    return this.graphics.getCanvas();\r\n  }\r\n\r\n  /**\r\n   * Get canvasImage (fabric.Image instance)\r\n   * @returns {fabric.Image}\r\n   */\r\n  getCanvasImage() {\r\n    return this.graphics.getCanvasImage();\r\n  }\r\n\r\n  /**\r\n   * Get image name\r\n   * @returns {string}\r\n   */\r\n  getImageName() {\r\n    return this.graphics.getImageName();\r\n  }\r\n\r\n  /**\r\n   * Get image editor\r\n   * @returns {ImageEditor}\r\n   */\r\n  getEditor() {\r\n    return this.graphics.getEditor();\r\n  }\r\n\r\n  /**\r\n   * Return component name\r\n   * @returns {string}\r\n   */\r\n  getName() {\r\n    return this.name;\r\n  }\r\n\r\n  /**\r\n   * Set image properties\r\n   * @param {Object} setting - Image properties\r\n   * @param {boolean} [withRendering] - If true, The changed image will be reflected in the canvas\r\n   */\r\n  setImageProperties(setting, withRendering) {\r\n    this.graphics.setImageProperties(setting, withRendering);\r\n  }\r\n\r\n  /**\r\n   * Set canvas dimension - css only\r\n   * @param {Object} dimension - Canvas css dimension\r\n   */\r\n  setCanvasCssDimension(dimension) {\r\n    this.graphics.setCanvasCssDimension(dimension);\r\n  }\r\n\r\n  /**\r\n   * Set canvas dimension - css only\r\n   * @param {Object} dimension - Canvas backstore dimension\r\n   */\r\n  setCanvasBackstoreDimension(dimension) {\r\n    this.graphics.setCanvasBackstoreDimension(dimension);\r\n  }\r\n\r\n  /**\r\n   * Adjust canvas dimension with scaling image\r\n   */\r\n  adjustCanvasDimension() {\r\n    this.graphics.adjustCanvasDimension();\r\n  }\r\n\r\n  adjustCanvasDimensionBase() {\r\n    this.graphics.adjustCanvasDimensionBase();\r\n  }\r\n}\r\n\r\nexport default Component;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview DrawingMode interface\r\n */\r\nimport errorMessage from '@/factory/errorMessage';\r\n\r\nconst createMessage = errorMessage.create;\r\nconst errorTypes = errorMessage.types;\r\n\r\n/**\r\n * DrawingMode interface\r\n * @class\r\n * @param {string} name - drawing mode name\r\n * @ignore\r\n */\r\nclass DrawingMode {\r\n  constructor(name) {\r\n    /**\r\n     * the name of drawing mode\r\n     * @type {string}\r\n     */\r\n    this.name = name;\r\n  }\r\n\r\n  /**\r\n   * Get this drawing mode name;\r\n   * @returns {string} drawing mode name\r\n   */\r\n  getName() {\r\n    return this.name;\r\n  }\r\n\r\n  /**\r\n   * start this drawing mode\r\n   * @param {Object} options - drawing mode options\r\n   * @abstract\r\n   */\r\n  start() {\r\n    throw new Error(createMessage(errorTypes.UN_IMPLEMENTATION, 'start'));\r\n  }\r\n\r\n  /**\r\n   * stop this drawing mode\r\n   * @abstract\r\n   */\r\n  end() {\r\n    throw new Error(createMessage(errorTypes.UN_IMPLEMENTATION, 'stop'));\r\n  }\r\n}\r\n\r\nexport default DrawingMode;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Invoker - invoke commands\r\n */\r\nimport snippet from 'tui-code-snippet';\r\nimport commandFactory from '@/factory/command';\r\nimport { Promise } from '@/util';\r\nimport { eventNames, rejectMessages } from '@/consts';\r\n\r\nconst { isFunction, isString, CustomEvents } = snippet;\r\n\r\n/**\r\n * Invoker\r\n * @class\r\n * @ignore\r\n */\r\nclass Invoker {\r\n  constructor() {\r\n    /**\r\n     * Undo stack\r\n     * @type {Array.<Command>}\r\n     * @private\r\n     */\r\n    this._undoStack = [];\r\n\r\n    /**\r\n     * Redo stack\r\n     * @type {Array.<Command>}\r\n     * @private\r\n     */\r\n    this._redoStack = [];\r\n\r\n    /**\r\n     * Lock-flag for executing command\r\n     * @type {boolean}\r\n     * @private\r\n     */\r\n    this._isLocked = false;\r\n\r\n    this._isSilent = false;\r\n  }\r\n\r\n  /**\r\n   * Invoke command execution\r\n   * @param {Command} command - Command\r\n   * @param {boolean} [isRedo=false] - check if command is redo\r\n   * @returns {Promise}\r\n   * @private\r\n   */\r\n  _invokeExecution(command, isRedo = false) {\r\n    this.lock();\r\n\r\n    let { args } = command;\r\n    if (!args) {\r\n      args = [];\r\n    }\r\n\r\n    return command\r\n      .execute(...args)\r\n      .then((value) => {\r\n        if (!this._isSilent) {\r\n          this.pushUndoStack(command);\r\n\r\n          this.fire(isRedo ? eventNames.AFTER_REDO : eventNames.EXECUTE_COMMAND, command);\r\n        }\r\n        this.unlock();\r\n        if (isFunction(command.executeCallback)) {\r\n          command.executeCallback(value);\r\n        }\r\n\r\n        return value;\r\n      })\r\n      ['catch']((message) => {\r\n        this.unlock();\r\n\r\n        return Promise.reject(message);\r\n      });\r\n  }\r\n\r\n  /**\r\n   * Invoke command undo\r\n   * @param {Command} command - Command\r\n   * @returns {Promise}\r\n   * @private\r\n   */\r\n  _invokeUndo(command) {\r\n    this.lock();\r\n\r\n    let { args } = command;\r\n    if (!args) {\r\n      args = [];\r\n    }\r\n\r\n    return command\r\n      .undo(...args)\r\n      .then((value) => {\r\n        this.pushRedoStack(command);\r\n        this.fire(eventNames.AFTER_UNDO, command);\r\n        this.unlock();\r\n        if (isFunction(command.undoCallback)) {\r\n          command.undoCallback(value);\r\n        }\r\n\r\n        return value;\r\n      })\r\n      ['catch']((message) => {\r\n        this.unlock();\r\n\r\n        return Promise.reject(message);\r\n      });\r\n  }\r\n\r\n  /**\r\n   * fire REDO_STACK_CHANGED event\r\n   * @private\r\n   */\r\n  _fireRedoStackChanged() {\r\n    this.fire(eventNames.REDO_STACK_CHANGED, this._redoStack.length);\r\n  }\r\n\r\n  /**\r\n   * fire UNDO_STACK_CHANGED event\r\n   * @private\r\n   */\r\n  _fireUndoStackChanged() {\r\n    this.fire(eventNames.UNDO_STACK_CHANGED, this._undoStack.length);\r\n  }\r\n\r\n  /**\r\n   * Lock this invoker\r\n   */\r\n  lock() {\r\n    this._isLocked = true;\r\n  }\r\n\r\n  /**\r\n   * Unlock this invoker\r\n   */\r\n  unlock() {\r\n    this._isLocked = false;\r\n  }\r\n\r\n  executeSilent(...args) {\r\n    this._isSilent = true;\r\n\r\n    return this.execute(...args, this._isSilent).then(() => {\r\n      this._isSilent = false;\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Invoke command\r\n   * Store the command to the undoStack\r\n   * Clear the redoStack\r\n   * @param {String} commandName - Command name\r\n   * @param {...*} args - Arguments for creating command\r\n   * @returns {Promise}\r\n   */\r\n  execute(...args) {\r\n    if (this._isLocked) {\r\n      return Promise.reject(rejectMessages.isLock);\r\n    }\r\n\r\n    let [command] = args;\r\n    if (isString(command)) {\r\n      command = commandFactory.create(...args);\r\n    }\r\n\r\n    return this._invokeExecution(command).then((value) => {\r\n      this.clearRedoStack();\r\n\r\n      return value;\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Undo command\r\n   * @returns {Promise}\r\n   */\r\n  undo() {\r\n    let command = this._undoStack.pop();\r\n    let promise;\r\n    let message = '';\r\n\r\n    if (command && this._isLocked) {\r\n      this.pushUndoStack(command, true);\r\n      command = null;\r\n    }\r\n    if (command) {\r\n      if (this.isEmptyUndoStack()) {\r\n        this._fireUndoStackChanged();\r\n      }\r\n      promise = this._invokeUndo(command);\r\n    } else {\r\n      message = rejectMessages.undo;\r\n      if (this._isLocked) {\r\n        message = `${message} Because ${rejectMessages.isLock}`;\r\n      }\r\n      promise = Promise.reject(message);\r\n    }\r\n\r\n    return promise;\r\n  }\r\n\r\n  /**\r\n   * Redo command\r\n   * @returns {Promise}\r\n   */\r\n  redo() {\r\n    let command = this._redoStack.pop();\r\n    let promise;\r\n    let message = '';\r\n\r\n    if (command && this._isLocked) {\r\n      this.pushRedoStack(command, true);\r\n      command = null;\r\n    }\r\n    if (command) {\r\n      if (this.isEmptyRedoStack()) {\r\n        this._fireRedoStackChanged();\r\n      }\r\n      promise = this._invokeExecution(command, true);\r\n    } else {\r\n      message = rejectMessages.redo;\r\n      if (this._isLocked) {\r\n        message = `${message} Because ${rejectMessages.isLock}`;\r\n      }\r\n      promise = Promise.reject(message);\r\n    }\r\n\r\n    return promise;\r\n  }\r\n\r\n  /**\r\n   * Push undo stack\r\n   * @param {Command} command - command\r\n   * @param {boolean} [isSilent] - Fire event or not\r\n   */\r\n  pushUndoStack(command, isSilent) {\r\n    this._undoStack.push(command);\r\n    if (!isSilent) {\r\n      this._fireUndoStackChanged();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Push redo stack\r\n   * @param {Command} command - command\r\n   * @param {boolean} [isSilent] - Fire event or not\r\n   */\r\n  pushRedoStack(command, isSilent) {\r\n    this._redoStack.push(command);\r\n    if (!isSilent) {\r\n      this._fireRedoStackChanged();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Return whether the redoStack is empty\r\n   * @returns {boolean}\r\n   */\r\n  isEmptyRedoStack() {\r\n    return this._redoStack.length === 0;\r\n  }\r\n\r\n  /**\r\n   * Return whether the undoStack is empty\r\n   * @returns {boolean}\r\n   */\r\n  isEmptyUndoStack() {\r\n    return this._undoStack.length === 0;\r\n  }\r\n\r\n  /**\r\n   * Clear undoStack\r\n   */\r\n  clearUndoStack() {\r\n    if (!this.isEmptyUndoStack()) {\r\n      this._undoStack = [];\r\n      this._fireUndoStackChanged();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Clear redoStack\r\n   */\r\n  clearRedoStack() {\r\n    if (!this.isEmptyRedoStack()) {\r\n      this._redoStack = [];\r\n      this._fireRedoStackChanged();\r\n    }\r\n  }\r\n}\r\n\r\nCustomEvents.mixin(Invoker);\r\n\r\nexport default Invoker;\r\n","// https://developer.mozilla.org/en-US/docs/Web/API/Element/closest\r\n// Any copyright is dedicated to the Public Domain. http://creativecommons.org/publicdomain/zero/1.0/if (!Element.prototype.matches)\r\nElement.prototype.matches =\r\n  Element.prototype.msMatchesSelector || Element.prototype.webkitMatchesSelector;\r\n\r\nif (!Element.prototype.closest)\r\n  Element.prototype.closest = function (s) {\r\n    var el = this;\r\n    if (!document.documentElement.contains(el)) return null;\r\n    do {\r\n      if (el.matches(s)) return el;\r\n      el = el.parentElement || el.parentNode;\r\n    } while (el !== null && el.nodeType === 1);\r\n    return null;\r\n  };\r\n\r\n/*\r\n * classList.js: Cross-browser full element.classList implementation.\r\n * 1.1.20170427\r\n *\r\n * By Eli Grey, http://eligrey.com\r\n * License: Dedicated to the public domain.\r\n *   See https://github.com/eligrey/classList.js/blob/master/LICENSE.md\r\n */\r\n\r\n/*global self, document, DOMException */\r\n\r\n/*! @source http://purl.eligrey.com/github/classList.js/blob/master/classList.js */\r\n\r\nif ('document' in window.self) {\r\n  // Full polyfill for browsers with no classList support\r\n  // Including IE < Edge missing SVGElement.classList\r\n  if (\r\n    !('classList' in document.createElement('_')) ||\r\n    (document.createElementNS &&\r\n      !('classList' in document.createElementNS('http://www.w3.org/2000/svg', 'g')))\r\n  ) {\r\n    (function (view) {\r\n      'use strict';\r\n\r\n      if (!('Element' in view)) return;\r\n\r\n      var classListProp = 'classList',\r\n        protoProp = 'prototype',\r\n        elemCtrProto = view.Element[protoProp],\r\n        objCtr = Object,\r\n        strTrim =\r\n          String[protoProp].trim ||\r\n          function () {\r\n            return this.replace(/^\\s+|\\s+$/g, '');\r\n          },\r\n        arrIndexOf =\r\n          Array[protoProp].indexOf ||\r\n          function (item) {\r\n            var i = 0,\r\n              len = this.length;\r\n            for (; i < len; i++) {\r\n              if (i in this && this[i] === item) {\r\n                return i;\r\n              }\r\n            }\r\n            return -1;\r\n          },\r\n        // Vendors: please allow content code to instantiate DOMExceptions\r\n        DOMEx = function (type, message) {\r\n          this.name = type;\r\n          this.code = DOMException[type];\r\n          this.message = message;\r\n        },\r\n        checkTokenAndGetIndex = function (classList, token) {\r\n          if (token === '') {\r\n            throw new DOMEx('SYNTAX_ERR', 'An invalid or illegal string was specified');\r\n          }\r\n          if (/\\s/.test(token)) {\r\n            throw new DOMEx('INVALID_CHARACTER_ERR', 'String contains an invalid character');\r\n          }\r\n          return arrIndexOf.call(classList, token);\r\n        },\r\n        ClassList = function (elem) {\r\n          var trimmedClasses = strTrim.call(elem.getAttribute('class') || ''),\r\n            classes = trimmedClasses ? trimmedClasses.split(/\\s+/) : [],\r\n            i = 0,\r\n            len = classes.length;\r\n          for (; i < len; i++) {\r\n            this.push(classes[i]);\r\n          }\r\n          this._updateClassName = function () {\r\n            elem.setAttribute('class', this.toString());\r\n          };\r\n        },\r\n        classListProto = (ClassList[protoProp] = []),\r\n        classListGetter = function () {\r\n          return new ClassList(this);\r\n        };\r\n      // Most DOMException implementations don't allow calling DOMException's toString()\r\n      // on non-DOMExceptions. Error's toString() is sufficient here.\r\n      DOMEx[protoProp] = Error[protoProp];\r\n      classListProto.item = function (i) {\r\n        return this[i] || null;\r\n      };\r\n      classListProto.contains = function (token) {\r\n        token += '';\r\n        return checkTokenAndGetIndex(this, token) !== -1;\r\n      };\r\n      classListProto.add = function () {\r\n        var tokens = arguments,\r\n          i = 0,\r\n          l = tokens.length,\r\n          token,\r\n          updated = false;\r\n        do {\r\n          token = tokens[i] + '';\r\n          if (checkTokenAndGetIndex(this, token) === -1) {\r\n            this.push(token);\r\n            updated = true;\r\n          }\r\n        } while (++i < l);\r\n\r\n        if (updated) {\r\n          this._updateClassName();\r\n        }\r\n      };\r\n      classListProto.remove = function () {\r\n        var tokens = arguments,\r\n          i = 0,\r\n          l = tokens.length,\r\n          token,\r\n          updated = false,\r\n          index;\r\n        do {\r\n          token = tokens[i] + '';\r\n          index = checkTokenAndGetIndex(this, token);\r\n          while (index !== -1) {\r\n            this.splice(index, 1);\r\n            updated = true;\r\n            index = checkTokenAndGetIndex(this, token);\r\n          }\r\n        } while (++i < l);\r\n\r\n        if (updated) {\r\n          this._updateClassName();\r\n        }\r\n      };\r\n      classListProto.toggle = function (token, force) {\r\n        token += '';\r\n\r\n        var result = this.contains(token),\r\n          method = result ? force !== true && 'remove' : force !== false && 'add';\r\n        if (method) {\r\n          this[method](token);\r\n        }\r\n\r\n        if (force === true || force === false) {\r\n          return force;\r\n        } else {\r\n          return !result;\r\n        }\r\n      };\r\n      classListProto.toString = function () {\r\n        return this.join(' ');\r\n      };\r\n\r\n      if (objCtr.defineProperty) {\r\n        var classListPropDesc = {\r\n          get: classListGetter,\r\n          enumerable: true,\r\n          configurable: true,\r\n        };\r\n        try {\r\n          objCtr.defineProperty(elemCtrProto, classListProp, classListPropDesc);\r\n        } catch (ex) {\r\n          // IE 8 doesn't support enumerable:true\r\n          // adding undefined to fight this issue https://github.com/eligrey/classList.js/issues/36\r\n          // modernie IE8-MSW7 machine has IE8 8.0.6001.18702 and is affected\r\n          if (ex.number === undefined || ex.number === -0x7ff5ec54) {\r\n            classListPropDesc.enumerable = false;\r\n            objCtr.defineProperty(elemCtrProto, classListProp, classListPropDesc);\r\n          }\r\n        }\r\n      } else if (objCtr[protoProp].__defineGetter__) {\r\n        elemCtrProto.__defineGetter__(classListProp, classListGetter);\r\n      }\r\n    })(window.self);\r\n  }\r\n\r\n  // There is full or partial native classList support, so just check if we need\r\n  // to normalize the add/remove and toggle APIs.\r\n\r\n  (function () {\r\n    'use strict';\r\n\r\n    var testElement = document.createElement('_');\r\n\r\n    testElement.classList.add('c1', 'c2');\r\n\r\n    // Polyfill for IE 10/11 and Firefox <26, where classList.add and\r\n    // classList.remove exist but support only one argument at a time.\r\n    if (!testElement.classList.contains('c2')) {\r\n      var createMethod = function (method) {\r\n        var original = DOMTokenList.prototype[method];\r\n\r\n        DOMTokenList.prototype[method] = function (token) {\r\n          var i,\r\n            len = arguments.length;\r\n\r\n          for (i = 0; i < len; i++) {\r\n            token = arguments[i];\r\n            original.call(this, token);\r\n          }\r\n        };\r\n      };\r\n      createMethod('add');\r\n      createMethod('remove');\r\n    }\r\n\r\n    testElement.classList.toggle('c3', false);\r\n\r\n    // Polyfill for IE 10 and Firefox <24, where classList.toggle does not\r\n    // support the second argument.\r\n    if (testElement.classList.contains('c3')) {\r\n      var _toggle = DOMTokenList.prototype.toggle;\r\n\r\n      DOMTokenList.prototype.toggle = function (token, force) {\r\n        if (1 in arguments && !this.contains(token) === !force) {\r\n          return force;\r\n        } else {\r\n          return _toggle.call(this, token);\r\n        }\r\n      };\r\n    }\r\n\r\n    testElement = null;\r\n  })();\r\n}\r\n\r\n/*!\r\n * @copyright Copyright (c) 2017 IcoMoon.io\r\n * @license   Licensed under MIT license\r\n *            See https://github.com/Keyamoon/svgxuse\r\n * @version   1.2.6\r\n */\r\n/*jslint browser: true */\r\n/*global XDomainRequest, MutationObserver, window */\r\n(function () {\r\n  'use strict';\r\n  if (typeof window !== 'undefined' && window.addEventListener) {\r\n    var cache = Object.create(null); // holds xhr objects to prevent multiple requests\r\n    var checkUseElems;\r\n    var tid; // timeout id\r\n    var debouncedCheck = function () {\r\n      clearTimeout(tid);\r\n      tid = setTimeout(checkUseElems, 100);\r\n    };\r\n    var unobserveChanges = function () {\r\n      return;\r\n    };\r\n    var observeChanges = function () {\r\n      var observer;\r\n      window.addEventListener('resize', debouncedCheck, false);\r\n      window.addEventListener('orientationchange', debouncedCheck, false);\r\n      if (window.MutationObserver) {\r\n        observer = new MutationObserver(debouncedCheck);\r\n        observer.observe(document.documentElement, {\r\n          childList: true,\r\n          subtree: true,\r\n          attributes: true,\r\n        });\r\n        unobserveChanges = function () {\r\n          try {\r\n            observer.disconnect();\r\n            window.removeEventListener('resize', debouncedCheck, false);\r\n            window.removeEventListener('orientationchange', debouncedCheck, false);\r\n          } catch (ignore) {}\r\n        };\r\n      } else {\r\n        document.documentElement.addEventListener('DOMSubtreeModified', debouncedCheck, false);\r\n        unobserveChanges = function () {\r\n          document.documentElement.removeEventListener('DOMSubtreeModified', debouncedCheck, false);\r\n          window.removeEventListener('resize', debouncedCheck, false);\r\n          window.removeEventListener('orientationchange', debouncedCheck, false);\r\n        };\r\n      }\r\n    };\r\n    var createRequest = function (url) {\r\n      // In IE 9, cross origin requests can only be sent using XDomainRequest.\r\n      // XDomainRequest would fail if CORS headers are not set.\r\n      // Therefore, XDomainRequest should only be used with cross origin requests.\r\n      function getOrigin(loc) {\r\n        var a;\r\n        if (loc.protocol !== undefined) {\r\n          a = loc;\r\n        } else {\r\n          a = document.createElement('a');\r\n          a.href = loc;\r\n        }\r\n        return a.protocol.replace(/:/g, '') + a.host;\r\n      }\r\n      var Request;\r\n      var origin;\r\n      var origin2;\r\n      if (window.XMLHttpRequest) {\r\n        Request = new XMLHttpRequest();\r\n        origin = getOrigin(location);\r\n        origin2 = getOrigin(url);\r\n        if (Request.withCredentials === undefined && origin2 !== '' && origin2 !== origin) {\r\n          Request = XDomainRequest || undefined;\r\n        } else {\r\n          Request = XMLHttpRequest;\r\n        }\r\n      }\r\n      return Request;\r\n    };\r\n    var xlinkNS = 'http://www.w3.org/1999/xlink';\r\n    checkUseElems = function () {\r\n      var base;\r\n      var bcr;\r\n      var fallback = ''; // optional fallback URL in case no base path to SVG file was given and no symbol definition was found.\r\n      var hash;\r\n      var href;\r\n      var i;\r\n      var inProgressCount = 0;\r\n      var isHidden;\r\n      var Request;\r\n      var url;\r\n      var uses;\r\n      var xhr;\r\n      function observeIfDone() {\r\n        // If done with making changes, start watching for chagnes in DOM again\r\n        inProgressCount -= 1;\r\n        if (inProgressCount === 0) {\r\n          // if all xhrs were resolved\r\n          unobserveChanges(); // make sure to remove old handlers\r\n          observeChanges(); // watch for changes to DOM\r\n        }\r\n      }\r\n      function attrUpdateFunc(spec) {\r\n        return function () {\r\n          if (cache[spec.base] !== true) {\r\n            spec.useEl.setAttributeNS(xlinkNS, 'xlink:href', '#' + spec.hash);\r\n            if (spec.useEl.hasAttribute('href')) {\r\n              spec.useEl.setAttribute('href', '#' + spec.hash);\r\n            }\r\n          }\r\n        };\r\n      }\r\n      function onloadFunc(xhr) {\r\n        return function () {\r\n          var body = document.body;\r\n          var x = document.createElement('x');\r\n          var svg;\r\n          xhr.onload = null;\r\n          x.innerHTML = xhr.responseText;\r\n          svg = x.getElementsByTagName('svg')[0];\r\n          if (svg) {\r\n            svg.setAttribute('aria-hidden', 'true');\r\n            svg.style.position = 'absolute';\r\n            svg.style.width = 0;\r\n            svg.style.height = 0;\r\n            svg.style.overflow = 'hidden';\r\n            body.insertBefore(svg, body.firstChild);\r\n          }\r\n          observeIfDone();\r\n        };\r\n      }\r\n      function onErrorTimeout(xhr) {\r\n        return function () {\r\n          xhr.onerror = null;\r\n          xhr.ontimeout = null;\r\n          observeIfDone();\r\n        };\r\n      }\r\n      unobserveChanges(); // stop watching for changes to DOM\r\n      // find all use elements\r\n      uses = document.getElementsByTagName('use');\r\n      for (i = 0; i < uses.length; i += 1) {\r\n        try {\r\n          bcr = uses[i].getBoundingClientRect();\r\n        } catch (ignore) {\r\n          // failed to get bounding rectangle of the use element\r\n          bcr = false;\r\n        }\r\n        href =\r\n          uses[i].getAttribute('href') ||\r\n          uses[i].getAttributeNS(xlinkNS, 'href') ||\r\n          uses[i].getAttribute('xlink:href');\r\n        if (href && href.split) {\r\n          url = href.split('#');\r\n        } else {\r\n          url = ['', ''];\r\n        }\r\n        base = url[0];\r\n        hash = url[1];\r\n        isHidden = bcr && bcr.left === 0 && bcr.right === 0 && bcr.top === 0 && bcr.bottom === 0;\r\n        if (bcr && bcr.width === 0 && bcr.height === 0 && !isHidden) {\r\n          // the use element is empty\r\n          // if there is a reference to an external SVG, try to fetch it\r\n          // use the optional fallback URL if there is no reference to an external SVG\r\n          if (fallback && !base.length && hash && !document.getElementById(hash)) {\r\n            base = fallback;\r\n          }\r\n          if (uses[i].hasAttribute('href')) {\r\n            uses[i].setAttributeNS(xlinkNS, 'xlink:href', href);\r\n          }\r\n          if (base.length) {\r\n            // schedule updating xlink:href\r\n            xhr = cache[base];\r\n            if (xhr !== true) {\r\n              // true signifies that prepending the SVG was not required\r\n              setTimeout(\r\n                attrUpdateFunc({\r\n                  useEl: uses[i],\r\n                  base: base,\r\n                  hash: hash,\r\n                }),\r\n                0\r\n              );\r\n            }\r\n            if (xhr === undefined) {\r\n              Request = createRequest(base);\r\n              if (Request !== undefined) {\r\n                xhr = new Request();\r\n                cache[base] = xhr;\r\n                xhr.onload = onloadFunc(xhr);\r\n                xhr.onerror = onErrorTimeout(xhr);\r\n                xhr.ontimeout = onErrorTimeout(xhr);\r\n                xhr.open('GET', base);\r\n                xhr.send();\r\n                inProgressCount += 1;\r\n              }\r\n            }\r\n          }\r\n        } else {\r\n          if (!isHidden) {\r\n            if (cache[base] === undefined) {\r\n              // remember this URL if the use element was not empty and no request was sent\r\n              cache[base] = true;\r\n            } else if (cache[base].onload) {\r\n              // if it turns out that prepending the SVG is not necessary,\r\n              // abort the in-progress xhr.\r\n              cache[base].abort();\r\n              delete cache[base].onload;\r\n              cache[base] = true;\r\n            }\r\n          } else if (base.length && cache[base]) {\r\n            setTimeout(\r\n              attrUpdateFunc({\r\n                useEl: uses[i],\r\n                base: base,\r\n                hash: hash,\r\n              }),\r\n              0\r\n            );\r\n          }\r\n        }\r\n      }\r\n      uses = '';\r\n      inProgressCount += 1;\r\n      observeIfDone();\r\n    };\r\n    var winLoad;\r\n    winLoad = function () {\r\n      window.removeEventListener('load', winLoad, false); // to prevent memory leaks\r\n      tid = setTimeout(checkUseElems, 0);\r\n    };\r\n    if (document.readyState !== 'complete') {\r\n      // The load event fires when all resources have finished loading, which allows detecting whether SVG use elements are empty.\r\n      window.addEventListener('load', winLoad, false);\r\n    } else {\r\n      // No need to add a listener if the document is already loaded, initialize immediately.\r\n      winLoad();\r\n    }\r\n  }\r\n})();\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Util\r\n */\r\nimport { forEach, sendHostname, extend, isString, pick, inArray } from 'tui-code-snippet';\r\nimport Promise from 'core-js-pure/features/promise';\r\nimport {\r\n  commandNames,\r\n  filterType,\r\n  historyNames,\r\n  SHAPE_FILL_TYPE,\r\n  SHAPE_TYPE,\r\n  emptyCropRectValues,\r\n} from '@/consts';\r\n\r\nconst FLOATING_POINT_DIGIT = 2;\r\nconst CSS_PREFIX = 'tui-image-editor-';\r\nconst { min, max } = Math;\r\nlet hostnameSent = false;\r\n\r\n/**\r\n * Export Promise Class (for simplified module path)\r\n * @returns {Promise} promise class\r\n */\r\nexport { Promise };\r\n\r\n/**\r\n * Clamp value\r\n * @param {number} value - Value\r\n * @param {number} minValue - Minimum value\r\n * @param {number} maxValue - Maximum value\r\n * @returns {number} clamped value\r\n */\r\nexport function clamp(value, minValue, maxValue) {\r\n  if (minValue > maxValue) {\r\n    [minValue, maxValue] = [maxValue, minValue];\r\n  }\r\n\r\n  return max(minValue, min(value, maxValue));\r\n}\r\n\r\n/**\r\n * Make key-value object from arguments\r\n * @returns {object.<string, string>}\r\n */\r\nexport function keyMirror(...args) {\r\n  const obj = {};\r\n\r\n  forEach(args, (key) => {\r\n    obj[key] = key;\r\n  });\r\n\r\n  return obj;\r\n}\r\n\r\n/**\r\n * Make CSSText\r\n * @param {Object} styleObj - Style info object\r\n * @returns {string} Connected string of style\r\n */\r\nexport function makeStyleText(styleObj) {\r\n  let styleStr = '';\r\n\r\n  forEach(styleObj, (value, prop) => {\r\n    styleStr += `${prop}: ${value};`;\r\n  });\r\n\r\n  return styleStr;\r\n}\r\n\r\n/**\r\n * Get object's properties\r\n * @param {Object} obj - object\r\n * @param {Array} keys - keys\r\n * @returns {Object} properties object\r\n */\r\nexport function getProperties(obj, keys) {\r\n  const props = {};\r\n  const { length } = keys;\r\n  let i = 0;\r\n  let key;\r\n\r\n  for (i = 0; i < length; i += 1) {\r\n    key = keys[i];\r\n    props[key] = obj[key];\r\n  }\r\n\r\n  return props;\r\n}\r\n\r\n/**\r\n * ParseInt simpliment\r\n * @param {number} value - Value\r\n * @returns {number}\r\n */\r\nexport function toInteger(value) {\r\n  return parseInt(value, 10);\r\n}\r\n\r\n/**\r\n * String to camelcase string\r\n * @param {string} targetString - change target\r\n * @returns {string}\r\n * @private\r\n */\r\nexport function toCamelCase(targetString) {\r\n  return targetString.replace(/-([a-z])/g, ($0, $1) => $1.toUpperCase());\r\n}\r\n\r\n/**\r\n * Check browser file api support\r\n * @returns {boolean}\r\n * @private\r\n */\r\nexport function isSupportFileApi() {\r\n  return !!(window.File && window.FileList && window.FileReader);\r\n}\r\n\r\n/**\r\n * hex to rgb\r\n * @param {string} color - hex color\r\n * @param {string} alpha - color alpha value\r\n * @returns {string} rgb expression\r\n */\r\nexport function getRgb(color, alpha) {\r\n  if (color.length === 4) {\r\n    color = `${color}${color.slice(1, 4)}`;\r\n  }\r\n  const r = parseInt(color.slice(1, 3), 16);\r\n  const g = parseInt(color.slice(3, 5), 16);\r\n  const b = parseInt(color.slice(5, 7), 16);\r\n  const a = alpha || 1;\r\n\r\n  return `rgba(${r}, ${g}, ${b}, ${a})`;\r\n}\r\n\r\n/**\r\n * send hostname\r\n */\r\nexport function sendHostName() {\r\n  if (hostnameSent) {\r\n    return;\r\n  }\r\n  hostnameSent = true;\r\n\r\n  sendHostname('image-editor', 'UA-129999381-1');\r\n}\r\n\r\n/**\r\n * Apply css resource\r\n * @param {string} styleBuffer - serialized css text\r\n * @param {string} tagId - style tag id\r\n */\r\nexport function styleLoad(styleBuffer, tagId) {\r\n  const [head] = document.getElementsByTagName('head');\r\n  const linkElement = document.createElement('link');\r\n  const styleData = encodeURIComponent(styleBuffer);\r\n  if (tagId) {\r\n    linkElement.id = tagId;\r\n    // linkElement.id = 'tui-image-editor-theme-style';\r\n  }\r\n  linkElement.setAttribute('rel', 'stylesheet');\r\n  linkElement.setAttribute('type', 'text/css');\r\n  linkElement.setAttribute('href', `data:text/css;charset=UTF-8,${styleData}`);\r\n  head.appendChild(linkElement);\r\n}\r\n\r\n/**\r\n * Get selector\r\n * @param {HTMLElement} targetElement - target element\r\n * @returns {Function} selector\r\n */\r\nexport function getSelector(targetElement) {\r\n  return (str) => targetElement.querySelector(str);\r\n}\r\n\r\n/**\r\n * Change base64 to blob\r\n * @param {String} data - base64 string data\r\n * @returns {Blob} Blob Data\r\n */\r\nexport function base64ToBlob(data) {\r\n  const rImageType = /data:(image\\/.+);base64,/;\r\n  let mimeString = '';\r\n  let raw, uInt8Array, i;\r\n\r\n  raw = data.replace(rImageType, (header, imageType) => {\r\n    mimeString = imageType;\r\n\r\n    return '';\r\n  });\r\n\r\n  raw = atob(raw);\r\n  const rawLength = raw.length;\r\n  uInt8Array = new Uint8Array(rawLength); // eslint-disable-line\r\n\r\n  for (i = 0; i < rawLength; i += 1) {\r\n    uInt8Array[i] = raw.charCodeAt(i);\r\n  }\r\n\r\n  return new Blob([uInt8Array], { type: mimeString });\r\n}\r\n\r\n/**\r\n * Fix floating point diff.\r\n * @param {number} value - original value\r\n * @returns {number} fixed value\r\n */\r\nexport function fixFloatingPoint(value) {\r\n  return Number(value.toFixed(FLOATING_POINT_DIGIT));\r\n}\r\n\r\n/**\r\n * Assignment for destroying objects.\r\n * @param {Object} targetObject - object to be removed.\r\n */\r\nexport function assignmentForDestroy(targetObject) {\r\n  forEach(targetObject, (value, key) => {\r\n    targetObject[key] = null;\r\n  });\r\n}\r\n\r\n/**\r\n * Make class name for ui\r\n * @param {String} str  - main string of className\r\n * @param {String} prefix - prefix string of className\r\n * @returns {String} class name\r\n */\r\nexport function cls(str = '', prefix = '') {\r\n  if (str.charAt(0) === '.') {\r\n    return `.${CSS_PREFIX}${prefix}${str.slice(1)}`;\r\n  }\r\n\r\n  return `${CSS_PREFIX}${prefix}${str}`;\r\n}\r\n\r\n/**\r\n * Change object origin\r\n * @param {fabric.Object} fObject - fabric object\r\n * @param {Object} origin - origin of fabric object\r\n *   @param {string} originX - horizontal basis.\r\n *   @param {string} originY - vertical basis.\r\n */\r\nexport function changeOrigin(fObject, origin) {\r\n  const { originX, originY } = origin;\r\n  const { x: left, y: top } = fObject.getPointByOrigin(originX, originY);\r\n\r\n  fObject.set({\r\n    left,\r\n    top,\r\n    originX,\r\n    originY,\r\n  });\r\n\r\n  fObject.setCoords();\r\n}\r\n\r\n/**\r\n * Object key value flip\r\n * @param {Object} targetObject - The data object of the key value.\r\n * @returns {Object}\r\n */\r\nexport function flipObject(targetObject) {\r\n  const result = {};\r\n\r\n  Object.keys(targetObject).forEach((key) => {\r\n    result[targetObject[key]] = key;\r\n  });\r\n\r\n  return result;\r\n}\r\n\r\n/**\r\n * Set custom properties\r\n * @param {Object} targetObject - target object\r\n * @param {Object} props - custom props object\r\n */\r\nexport function setCustomProperty(targetObject, props) {\r\n  targetObject.customProps = targetObject.customProps || {};\r\n  extend(targetObject.customProps, props);\r\n}\r\n\r\n/**\r\n * Get custom property\r\n * @param {fabric.Object} fObject - fabric object\r\n * @param {Array|string} propNames - prop name array\r\n * @returns {object | number | string}\r\n */\r\nexport function getCustomProperty(fObject, propNames) {\r\n  const resultObject = {};\r\n  if (isString(propNames)) {\r\n    propNames = [propNames];\r\n  }\r\n  forEach(propNames, (propName) => {\r\n    resultObject[propName] = fObject.customProps[propName];\r\n  });\r\n\r\n  return resultObject;\r\n}\r\n\r\n/**\r\n * Capitalize string\r\n * @param {string} targetString - target string\r\n * @returns {string}\r\n */\r\nexport function capitalizeString(targetString) {\r\n  return targetString.charAt(0).toUpperCase() + targetString.slice(1);\r\n}\r\n\r\n/**\r\n * Array includes check\r\n * @param {Array} targetArray - target array\r\n * @param {string|number} compareValue - compare value\r\n * @returns {boolean}\r\n */\r\nexport function includes(targetArray, compareValue) {\r\n  return targetArray.indexOf(compareValue) >= 0;\r\n}\r\n\r\n/**\r\n * Get fill type\r\n * @param {Object | string} fillOption - shape fill option\r\n * @returns {string} 'color' or 'filter'\r\n */\r\nexport function getFillTypeFromOption(fillOption = {}) {\r\n  return pick(fillOption, 'type') || SHAPE_FILL_TYPE.COLOR;\r\n}\r\n\r\n/**\r\n * Get fill type of shape type object\r\n * @param {fabric.Object} shapeObj - fabric object\r\n * @returns {string} 'transparent' or 'color' or 'filter'\r\n */\r\nexport function getFillTypeFromObject(shapeObj) {\r\n  const { fill = {} } = shapeObj;\r\n  if (fill.source) {\r\n    return SHAPE_FILL_TYPE.FILTER;\r\n  }\r\n\r\n  return SHAPE_FILL_TYPE.COLOR;\r\n}\r\n\r\n/**\r\n * Check if the object is a shape object.\r\n * @param {fabric.Object} obj - fabric object\r\n * @returns {boolean}\r\n */\r\nexport function isShape(obj) {\r\n  return inArray(obj.get('type'), SHAPE_TYPE) >= 0;\r\n}\r\n\r\n/**\r\n * Get object type\r\n * @param {string} type - fabric object type\r\n * @returns {string} type of object (ex: shape, icon, ...)\r\n */\r\nexport function getObjectType(type) {\r\n  if (includes(SHAPE_TYPE, type)) {\r\n    return 'Shape';\r\n  }\r\n\r\n  switch (type) {\r\n    case 'i-text':\r\n      return 'Text';\r\n    case 'path':\r\n    case 'line':\r\n      return 'Draw';\r\n    case 'activeSelection':\r\n      return 'Group';\r\n    default:\r\n      return toStartOfCapital(type);\r\n  }\r\n}\r\n\r\n/**\r\n * Get filter type\r\n * @param {string} type - fabric filter type\r\n * @param {object} [options] - filter type options\r\n *   @param {boolean} [options.useAlpha=true] - usage of alpha(true is 'color filter', false is 'remove white')\r\n *   @param {string} [options.mode] - mode of blendColor\r\n * @returns {string} type of filter (ex: sepia, blur, ...)\r\n */\r\nfunction getFilterType(type, { useAlpha = true, mode } = {}) {\r\n  const { VINTAGE, REMOVE_COLOR, BLEND_COLOR, SEPIA2, COLOR_FILTER, REMOVE_WHITE, BLEND } =\r\n    filterType;\r\n\r\n  let filterName;\r\n\r\n  switch (type) {\r\n    case VINTAGE:\r\n      filterName = SEPIA2;\r\n      break;\r\n    case REMOVE_COLOR:\r\n      filterName = useAlpha ? COLOR_FILTER : REMOVE_WHITE;\r\n      break;\r\n    case BLEND_COLOR:\r\n      filterName = mode === 'add' ? BLEND : mode;\r\n      break;\r\n    default:\r\n      filterName = type;\r\n  }\r\n\r\n  return toStartOfCapital(filterName);\r\n}\r\n\r\n/**\r\n * Check if command is silent command\r\n * @param {Command|string} command - command or command name\r\n * @returns {boolean}\r\n */\r\nexport function isSilentCommand(command) {\r\n  const { LOAD_IMAGE } = commandNames;\r\n\r\n  return typeof command === 'string' ? LOAD_IMAGE === command : LOAD_IMAGE === command.name;\r\n}\r\n\r\n/**\r\n * Get command name\r\n * @param {Command|string} command - command or command name\r\n * @returns {{name: string, ?detail: string}}\r\n */\r\n// eslint-disable-next-line complexity, require-jsdoc\r\nexport function getHistoryTitle(command) {\r\n  const {\r\n    FLIP_IMAGE,\r\n    ROTATE_IMAGE,\r\n    ADD_TEXT,\r\n    APPLY_FILTER,\r\n    REMOVE_FILTER,\r\n    CHANGE_SHAPE,\r\n    CHANGE_ICON_COLOR,\r\n    CHANGE_TEXT_STYLE,\r\n    CLEAR_OBJECTS,\r\n    ADD_IMAGE_OBJECT,\r\n    REMOVE_OBJECT,\r\n    RESIZE_IMAGE,\r\n  } = commandNames;\r\n  const { name, args } = command;\r\n  let historyInfo;\r\n\r\n  switch (name) {\r\n    case FLIP_IMAGE:\r\n      historyInfo = { name, detail: args[1] === 'reset' ? args[1] : args[1].slice(4) };\r\n      break;\r\n    case ROTATE_IMAGE:\r\n      historyInfo = { name, detail: args[2] };\r\n      break;\r\n    case APPLY_FILTER:\r\n      historyInfo = { name: historyNames.APPLY_FILTER, detail: getFilterType(args[1], args[2]) };\r\n      break;\r\n    case REMOVE_FILTER:\r\n      historyInfo = { name: historyNames.REMOVE_FILTER, detail: 'Remove' };\r\n      break;\r\n    case CHANGE_SHAPE:\r\n      historyInfo = { name: historyNames.CHANGE_SHAPE, detail: 'Change' };\r\n      break;\r\n    case CHANGE_ICON_COLOR:\r\n      historyInfo = { name: historyNames.CHANGE_ICON_COLOR, detail: 'Change' };\r\n      break;\r\n    case CHANGE_TEXT_STYLE:\r\n      historyInfo = { name: historyNames.CHANGE_TEXT_STYLE, detail: 'Change' };\r\n      break;\r\n    case REMOVE_OBJECT:\r\n      historyInfo = { name: historyNames.REMOVE_OBJECT, detail: args[2] };\r\n      break;\r\n    case CLEAR_OBJECTS:\r\n      historyInfo = { name: historyNames.CLEAR_OBJECTS, detail: 'All' };\r\n      break;\r\n    case ADD_IMAGE_OBJECT:\r\n      historyInfo = { name: historyNames.ADD_IMAGE_OBJECT, detail: 'Add' };\r\n      break;\r\n    case ADD_TEXT:\r\n      historyInfo = { name: historyNames.ADD_TEXT };\r\n      break;\r\n    case RESIZE_IMAGE:\r\n      historyInfo = { name: historyNames.RESIZE, detail: `${~~args[1].width}x${~~args[1].height}` };\r\n      break;\r\n\r\n    default:\r\n      historyInfo = { name };\r\n      break;\r\n  }\r\n\r\n  if (args[1] === 'mask') {\r\n    historyInfo = { name: historyNames.LOAD_MASK_IMAGE, detail: 'Apply' };\r\n  }\r\n\r\n  return historyInfo;\r\n}\r\n\r\n/**\r\n * Get help menubar position(opposite of menubar)\r\n * @param {string} position - position of menubar\r\n * @returns {string} position of help menubar\r\n */\r\nexport function getHelpMenuBarPosition(position) {\r\n  if (position === 'top') {\r\n    return 'bottom';\r\n  }\r\n  if (position === 'left') {\r\n    return 'right';\r\n  }\r\n  if (position === 'right') {\r\n    return 'left';\r\n  }\r\n\r\n  return 'top';\r\n}\r\n\r\n/**\r\n * Change to capital start letter\r\n * @param {string} str - string to change\r\n * @returns {string}\r\n */\r\nfunction toStartOfCapital(str) {\r\n  return str.replace(/[a-z]/, (first) => first.toUpperCase());\r\n}\r\n\r\n/**\r\n * Check if cropRect is Empty.\r\n * @param {Object} cropRect - cropRect object\r\n *  @param {Number} cropRect.left - cropRect left position value\r\n *  @param {Number} cropRect.top - cropRect top position value\r\n *  @param {Number} cropRect.width - cropRect width value\r\n *  @param {Number} cropRect.height - cropRect height value\r\n * @returns {boolean}\r\n */\r\nexport function isEmptyCropzone(cropRect) {\r\n  const { left, top, width, height } = cropRect;\r\n  const { LEFT, TOP, WIDTH, HEIGHT } = emptyCropRectValues;\r\n\r\n  return left === LEFT && top === TOP && width === WIDTH && height === HEIGHT;\r\n}\r\n","module.exports = __WEBPACK_EXTERNAL_MODULE_fabric__;","module.exports = __WEBPACK_EXTERNAL_MODULE_tui_code_snippet__;"],"sourceRoot":""}