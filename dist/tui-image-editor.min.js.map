{"version":3,"sources":["webpack://tui.ImageEditor/webpack/universalModuleDefinition","webpack://tui.ImageEditor/webpack/bootstrap","webpack://tui.ImageEditor/./src/js/consts.js","webpack://tui.ImageEditor/./src/js/util.js","webpack://tui.ImageEditor/./src/js/factory/command.js","webpack://tui.ImageEditor/external {\"commonjs\":\"tui-code-snippet\",\"commonjs2\":\"tui-code-snippet\",\"amd\":\"tui-code-snippet\",\"root\":[\"tui\",\"util\"]}","webpack://tui.ImageEditor/external {\"commonjs\":[\"fabric\",\"fabric\"],\"commonjs2\":[\"fabric\",\"fabric\"],\"amd\":\"fabric\",\"root\":\"fabric\"}","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/global.js","webpack://tui.ImageEditor/./src/js/interface/component.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/well-known-symbol.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/fails.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/create-non-enumerable-property.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/has.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/an-object.js","webpack://tui.ImageEditor/./src/js/interface/drawingMode.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/export.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/is-object.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/descriptors.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/a-function.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/get-built-in.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/iterators.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/is-pure.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/new-promise-capability.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/create-property-descriptor.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/to-indexed-object.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/object-define-property.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/iterate.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/redefine.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/perform.js","webpack://tui.ImageEditor/./src/js/helper/selectionModifyHelper.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/classof-raw.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/require-object-coercible.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/document-create-element.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/path.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/function-bind-context.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/object-get-prototype-of.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/shared-key.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/shared-store.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/object-set-prototype-of.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/to-integer.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/hidden-keys.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/engine-user-agent.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/classof.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/to-string-tag-support.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/set-to-string-tag.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/engine-is-node.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/internal-state.js","webpack://tui.ImageEditor/./src/js/factory/errorMessage.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/modules/es.aggregate-error.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/object-get-own-property-descriptor.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/to-primitive.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/to-object.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/ie8-dom-define.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/is-forced.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/shared.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/uid.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/object-create.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/to-length.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/enum-bug-keys.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/html.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/native-symbol.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/engine-v8-version.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/native-promise-constructor.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/inspect-source.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/species-constructor.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/task.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/engine-is-ios.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/promise-resolve.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/modules/es.promise.all-settled.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/modules/es.promise.any.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/define-iterator.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/iterators-core.js","webpack://tui.ImageEditor/./src/js/helper/shapeResizeHelper.js","webpack://tui.ImageEditor/./src/index.js","webpack://tui.ImageEditor/./src/js/polyfill.js","webpack://tui.ImageEditor/./src/js/imageEditor.js","webpack://tui.ImageEditor/./src/js/invoker.js","webpack://tui.ImageEditor/./src/js/interface/command.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/features/promise/index.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/es/promise/index.js","webpack://tui.ImageEditor/(webpack)/buildin/global.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/object-property-is-enumerable.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/indexed-object.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/set-global.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/correct-prototype-getter.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/a-possible-prototype.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/object-define-properties.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/object-keys.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/object-keys-internal.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/array-includes.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/to-absolute-index.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/is-array-iterator-method.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/use-symbol-as-uid.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/get-iterator-method.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/iterator-close.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/modules/es.promise.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/redefine-all.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/object-to-string.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/set-species.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/an-instance.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/check-correctness-of-iteration.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/microtask.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/engine-is-webos-webkit.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/host-report-errors.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/native-weak-map.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/engine-is-browser.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/modules/es.promise.finally.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/modules/es.string.iterator.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/string-multibyte.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/create-iterator-constructor.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/modules/web.dom-collections.iterator.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/modules/es.array.iterator.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/add-to-unscopables.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/internals/dom-iterables.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/modules/esnext.aggregate-error.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/modules/esnext.promise.all-settled.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/modules/esnext.promise.try.js","webpack://tui.ImageEditor/./node_modules/core-js-pure/modules/esnext.promise.any.js","webpack://tui.ImageEditor/./src/js/graphics.js","webpack://tui.ImageEditor/./src/js/component/imageLoader.js","webpack://tui.ImageEditor/./src/js/component/cropper.js","webpack://tui.ImageEditor/./src/js/extension/cropzone.js","webpack://tui.ImageEditor/./src/js/component/flip.js","webpack://tui.ImageEditor/./src/js/component/rotation.js","webpack://tui.ImageEditor/./src/js/component/freeDrawing.js","webpack://tui.ImageEditor/./src/js/component/line.js","webpack://tui.ImageEditor/./src/js/extension/arrowLine.js","webpack://tui.ImageEditor/./src/js/component/text.js","webpack://tui.ImageEditor/./src/js/component/icon.js","webpack://tui.ImageEditor/./src/js/component/filter.js","webpack://tui.ImageEditor/./src/js/extension/mask.js","webpack://tui.ImageEditor/./src/js/extension/sharpen.js","webpack://tui.ImageEditor/./src/js/extension/emboss.js","webpack://tui.ImageEditor/./src/js/extension/colorFilter.js","webpack://tui.ImageEditor/./src/js/component/shape.js","webpack://tui.ImageEditor/./src/js/helper/shapeFilterFillHelper.js","webpack://tui.ImageEditor/./src/js/component/zoom.js","webpack://tui.ImageEditor/./src/js/drawingMode/cropper.js","webpack://tui.ImageEditor/./src/js/drawingMode/freeDrawing.js","webpack://tui.ImageEditor/./src/js/drawingMode/lineDrawing.js","webpack://tui.ImageEditor/./src/js/drawingMode/shape.js","webpack://tui.ImageEditor/./src/js/drawingMode/text.js","webpack://tui.ImageEditor/./src/js/drawingMode/icon.js","webpack://tui.ImageEditor/./src/js/drawingMode/zoom.js","webpack://tui.ImageEditor/./src/js/component/resize.js","webpack://tui.ImageEditor/./src/js/drawingMode/resize.js","webpack://tui.ImageEditor/./src/js/component/jsonLoader.js","webpack://tui.ImageEditor/./src/js/command/addIcon.js","webpack://tui.ImageEditor/./src/js/command/addImageObject.js","webpack://tui.ImageEditor/./src/js/command/addObject.js","webpack://tui.ImageEditor/./src/js/command/addShape.js","webpack://tui.ImageEditor/./src/js/command/addText.js","webpack://tui.ImageEditor/./src/js/command/applyFilter.js","webpack://tui.ImageEditor/./src/js/command/changeIconColor.js","webpack://tui.ImageEditor/./src/js/command/changeShape.js","webpack://tui.ImageEditor/./src/js/command/changeText.js","webpack://tui.ImageEditor/./src/js/command/changeTextStyle.js","webpack://tui.ImageEditor/./src/js/command/clearObjects.js","webpack://tui.ImageEditor/./src/js/command/flip.js","webpack://tui.ImageEditor/./src/js/command/loadImage.js","webpack://tui.ImageEditor/./src/js/command/loadJson.js","webpack://tui.ImageEditor/./src/js/command/removeFilter.js","webpack://tui.ImageEditor/./src/js/command/removeObject.js","webpack://tui.ImageEditor/./src/js/command/resizeCanvasDimension.js","webpack://tui.ImageEditor/./src/js/command/rotate.js","webpack://tui.ImageEditor/./src/js/command/setObjectProperties.js","webpack://tui.ImageEditor/./src/js/command/setObjectPosition.js","webpack://tui.ImageEditor/./src/js/command/changeSelection.js","webpack://tui.ImageEditor/./src/js/command/resize.js"],"names":["root","factory","exports","module","require","define","amd","window","__WEBPACK_EXTERNAL_MODULE__3__","__WEBPACK_EXTERNAL_MODULE__4__","installedModules","__webpack_require__","m","ZOOM_HELP_MENUS","COMMAND_HELP_MENUS","DELETE_HELP_MENUS","HELP_MENUS","SHAPE_FILL_TYPE","FILTER","COLOR","SHAPE_TYPE","OBJ_TYPE","CROPZONE","filterType","VINTAGE","SEPIA2","REMOVE_COLOR","COLOR_FILTER","REMOVE_WHITE","BLEND_COLOR","BLEND","componentNames","keyMirror","SHAPE_DEFAULT_OPTIONS","lockSkewingX","lockSkewingY","bringForward","isRegular","CROPZONE_DEFAULT_OPTIONS","hasRotatingPoint","hasBorders","lockScalingFlip","lockRotation","commandNames","CLEAR_OBJECTS","LOAD_IMAGE","LOAD_JSON","FLIP_IMAGE","ROTATE_IMAGE","ADD_OBJECT","REMOVE_OBJECT","APPLY_FILTER","REMOVE_FILTER","ADD_ICON","CHANGE_ICON_COLOR","ADD_SHAPE","CHANGE_SHAPE","ADD_TEXT","CHANGE_TEXT","CHANGE_TEXT_STYLE","ADD_IMAGE_OBJECT","RESIZE_CANVAS_DIMENSION","SET_OBJECT_PROPERTIES","SET_OBJECT_POSITION","CHANGE_SELECTION","RESIZE_IMAGE","eventNames","OBJECT_ACTIVATED","OBJECT_MOVED","OBJECT_SCALED","OBJECT_CREATED","OBJECT_ROTATED","OBJECT_ADDED","OBJECT_MODIFIED","TEXT_EDITING","TEXT_CHANGED","ICON_CREATE_RESIZE","ICON_CREATE_END","ADD_OBJECT_AFTER","MOUSE_DOWN","MOUSE_UP","MOUSE_MOVE","MOUSE_WHEEL","REDO_STACK_CHANGED","UNDO_STACK_CHANGED","SELECTION_CLEARED","SELECTION_CREATED","EXECUTE_COMMAND","AFTER_UNDO","AFTER_REDO","ZOOM_CHANGED","HAND_STARTED","HAND_STOPPED","KEY_DOWN","KEY_UP","INPUT_BOX_EDITING_STARTED","INPUT_BOX_EDITING_STOPPED","FOCUS","BLUR","IMAGE_RESIZED","selectorNames","COLOR_PICKER_INPUT_BOX","historyNames","LOAD_MASK_IMAGE","ADD_MASK_IMAGE","CROP","RESIZE","drawingModes","drawingMenuNames","TEXT","SHAPE","ZOOM","zoomModes","DEFAULT","HAND","keyCodes","Z","Y","C","V","SHIFT","BACKSPACE","DEL","ARROW_DOWN","ARROW_UP","SPACE","fObjectOptions","SELECTION_STYLE","borderColor","cornerColor","cornerSize","originX","originY","transparentCorners","rejectMessages","addedObject","flip","invalidDrawingMode","invalidParameters","isLock","loadImage","loadJson","loadingImageFailed","noActiveObject","noObject","redo","rotation","undo","unsupportedOperation","unsupportedType","defaultIconPath","defaultRotateRangeValues","realTimeEvent","min","max","value","defaultDrawRangeValues","defaultShapeStrokeValues","defaultTextRangeValues","defaultFilterRangeValues","tintOpacityRange","useDecimal","removewhiteDistanceRange","brightnessRange","noiseRange","pixelateRange","colorfilterThresholdRange","blurFilterRange","emptyCropRectValues","LEFT","TOP","WIDTH","HEIGHT","defaultResizePixelValues","clamp","minValue","maxValue","obj","args","forEach","key","makeStyleText","styleObj","styleStr","prop","getProperties","keys","props","length","i","toInteger","parseInt","toCamelCase","targetString","replace","$0","$1","toUpperCase","isSupportFileApi","File","FileList","FileReader","getRgb","color","alpha","slice","r","g","b","sendHostName","hostnameSent","sendHostname","styleLoad","styleBuffer","tagId","head","document","getElementsByTagName","linkElement","createElement","styleData","encodeURIComponent","id","setAttribute","appendChild","getSelector","targetElement","str","querySelector","base64ToBlob","data","mimeString","raw","uInt8Array","header","imageType","rawLength","atob","Uint8Array","charCodeAt","Blob","type","fixFloatingPoint","Number","toFixed","FLOATING_POINT_DIGIT","assignmentForDestroy","targetObject","cls","prefix","charAt","CSS_PREFIX","changeOrigin","fObject","origin","getPointByOrigin","left","x","top","y","set","setCoords","flipObject","result","Object","setCustomProperty","customProps","extend","getCustomProperty","propNames","resultObject","isString","propName","capitalizeString","includes","getFillTypeFromOption","fillOption","pick","getFillTypeFromObject","shapeObj","fill","source","isShape","inArray","get","getObjectType","toStartOfCapital","isSilentCommand","command","name","getHistoryTitle","historyInfo","detail","useAlpha","mode","filterName","getFilterType","width","height","getHelpMenuBarPosition","position","isEmptyCropzone","cropRect","Math","targetArray","compareValue","indexOf","first","Promise","commands","create","actions","Command","register","it","check","globalThis","self","global","this","Function","Component","context","graphics","fire","apply","oImage","setCanvasImage","getCanvasElement","getCanvas","getCanvasImage","getImageName","getEditor","setting","withRendering","setImageProperties","dimension","setCanvasCssDimension","setCanvasBackstoreDimension","adjustCanvasDimension","adjustCanvasDimensionBase","shared","has","uid","NATIVE_SYMBOL","USE_SYMBOL_AS_UID","WellKnownSymbolsStore","Symbol","createWellKnownSymbol","withoutSetter","exec","error","DESCRIPTORS","definePropertyModule","createPropertyDescriptor","object","f","toObject","hasOwnProperty","call","isObject","TypeError","String","createMessage","errorMessage","errorTypes","types","DrawingMode","Error","UN_IMPLEMENTATION","wrapConstructor","NativeConstructor","Wrapper","a","c","arguments","prototype","getOwnPropertyDescriptor","isForced","path","bind","createNonEnumerableProperty","options","targetProperty","nativeProperty","resultProperty","descriptor","TARGET","target","GLOBAL","STATIC","stat","PROTO","proto","nativeSource","targetPrototype","USE_NATIVE","forced","noTargetGet","sourceProperty","wrap","sham","VIRTUAL_PROTOTYPE","real","fails","defineProperty","aFunction","variable","undefined","namespace","method","PromiseCapability","resolve","reject","promise","$$resolve","$$reject","bitmap","enumerable","configurable","writable","IndexedObject","requireObjectCoercible","IE8_DOM_DEFINE","anObject","toPrimitive","$defineProperty","O","P","Attributes","Result","stopped","isArrayIteratorMethod","toLength","getIteratorMethod","iteratorClose","iterable","unboundFunction","stop","condition","iterator","callFn","AS_ENTRIES","INTERRUPTED","fn","index","next","step","that","IS_ITERATOR","iterFn","done","setCachedUndoDataForDimension","undoData","cachedUndoDataForChangeDimension","getCachedUndoDataForDimension","makeSelectionUndoData","undoDatumMaker","getObjects","map","item","angle","scaleX","scaleY","fabric","util","addTransformToObject","calcTransformMatrix","makeSelectionUndoDatum","objId","isSelection","toString","EXISTS","sharedKey","CORRECT_PROTOTYPE_GETTER","IE_PROTO","ObjectPrototype","getPrototypeOf","constructor","setGlobal","SHARED","store","aPossiblePrototype","setPrototypeOf","setter","CORRECT_SETTER","test","Array","__proto__","ceil","floor","argument","isNaN","getBuiltIn","TO_STRING_TAG_SUPPORT","classofRaw","TO_STRING_TAG","wellKnownSymbol","CORRECT_ARGUMENTS","tag","tryGet","callee","TAG","SET_METHOD","classof","process","wmget","wmhas","wmset","STATE","NATIVE_WEAK_MAP","objectHas","hiddenKeys","OBJECT_ALREADY_INITIALIZED","WeakMap","state","metadata","facade","enforce","getterFor","TYPE","messages","methodName","NO_COMPONENT_NAME","snippet","toLowerCase","func","$","iterate","$AggregateError","errors","message","errorsArray","push","AggregateError","propertyIsEnumerableModule","toIndexedObject","$getOwnPropertyDescriptor","input","PREFERRED_STRING","val","valueOf","replacement","feature","detection","normalize","POLYFILL","NATIVE","string","IS_PURE","version","copyright","postfix","random","EmptyConstructor","scriptTag","content","LT","SCRIPT","activeXDocument","defineProperties","enumBugKeys","html","documentCreateElement","PROTOTYPE","NullProtoObject","domain","ActiveXObject","iframe","write","close","temp","parentWindow","NullProtoObjectViaActiveX","style","display","src","iframeDocument","contentWindow","open","F","Properties","V8_VERSION","getOwnPropertySymbols","match","userAgent","versions","v8","split","functionToString","inspectSource","SPECIES","defaultConstructor","S","run","queue","runner","listener","event","defer","IS_IOS","IS_NODE","location","setImmediate","clear","clearImmediate","MessageChannel","Dispatch","counter","ONREADYSTATECHANGE","post","postMessage","protocol","host","nextTick","now","port","channel","port2","port1","onmessage","addEventListener","importScripts","removeChild","setTimeout","newPromiseCapability","promiseCapability","newPromiseCapabilityModule","perform","allSettled","capability","promiseResolve","values","remaining","alreadyCalled","then","status","reason","PROMISE_ANY_ERROR","any","alreadyResolved","alreadyRejected","returnThis","createIteratorConstructor","setToStringTag","redefine","Iterators","IteratorsCore","IteratorPrototype","BUGGY_SAFARI_ITERATORS","ITERATOR","VALUES","ENTRIES","Iterable","NAME","IteratorConstructor","IS_SET","FORCED","getIterationMethod","KIND","defaultIterator","IterablePrototype","methods","KEY","INCORRECT_VALUES_NAME","nativeIterator","anyNativeIterator","entries","CurrentIteratorPrototype","arrayIterator","PrototypeOfArrayIteratorPrototype","NEW_ITERATOR_PROTOTYPE","DIVISOR","rect","circle","triangle","DIMENSION_KEYS","w","h","getPositionsOfRotatedOrigin","pointer","sx","sy","px","py","PI","cos","sin","setOrigins","shape","leftTopPoint","rightTopPoint","rightBottomPoint","leftBottomPoint","origins","lt","rt","rb","lb","resize","isScaling","strokeWidth","divisor","dimensionKeys","centerPoint","originPositions","originKey","substring","startPoint","maxScale","hasControls","adjustDimensionOnScaling","isTriangle","abs","sqrt","setPositionByOrigin","adjustOriginToCenter","ImageEditor","createMethod","_toggle","testElement","cache","tid","debouncedCheck","unobserveChanges","xlinkNS","checkUseElems","winLoad","Element","matches","msMatchesSelector","webkitMatchesSelector","closest","s","el","documentElement","contains","parentElement","parentNode","nodeType","createElementNS","view","classListProp","protoProp","elemCtrProto","objCtr","strTrim","trim","arrIndexOf","len","DOMEx","code","DOMException","checkTokenAndGetIndex","classList","token","ClassList","elem","trimmedClasses","getAttribute","classes","_updateClassName","classListProto","classListGetter","add","tokens","l","updated","remove","splice","toggle","force","join","classListPropDesc","ex","number","__defineGetter__","original","DOMTokenList","clearTimeout","base","bcr","hash","isHidden","uses","xhr","url","getOrigin","Request","inProgressCount","observeIfDone","observer","MutationObserver","observe","childList","subtree","attributes","disconnect","removeEventListener","ignore","attrUpdateFunc","spec","useEl","setAttributeNS","hasAttribute","onErrorTimeout","onerror","ontimeout","getBoundingClientRect","href","getAttributeNS","right","bottom","loc","XMLHttpRequest","origin2","withCredentials","XDomainRequest","onload","body","innerHTML","responseText","svg","overflow","insertBefore","firstChild","onloadFunc","send","abort","readyState","isUndefined","CustomEvents","events","selectionStyle","applyCropSelectionStyle","applyGroupSelectionStyle","_graphics","setSelectionStyle","setCropSelectionStyle","on","eventTarget","_invoker","_handlers","mousedown","mouseup","mousemove","mousewheel","objectMoved","objectScaled","objectRotated","objectActivated","objectAdded","objectModified","addText","addObject","textEditing","textChanged","iconCreateResize","iconCreateEnd","selectionCleared","selectionCreated","keydown","e","ctrlKey","keyCode","metaKey","resetTargetObjectForCopyPaste","pasteObject","clearRedoStack","isDeleteKey","isRemoveReady","isReadyRemoveObject","isColorPickerInputBoxEditing","preventDefault","removeActiveObject","activeObjectId","getActiveObjectIdForRemove","removeObject","originPointer","commandFactory","pushUndoStack","getObjectId","execute","getDrawingMode","deactivateAll","renderAll","discardSelection","selectable","changeSelectableAll","clearUndoStack","commandName","theArgs","concat","executeSilent","iterationCount","zoomLevel","zoom","resetZoom","canvasZoom","getCanvasZoom","imgFile","imageName","imgUrl","URL","createObjectURL","loadImageFromURL","revokeObjectURL","option","startDrawingMode","stopDrawingMode","getCroppedImageData","getCropzoneRect","setCropzoneRect","_flip","isSilent","_rotate","setBrush","setDrawingShape","iconColor","setIconStyle","_setPositions","text","originPosition","clientPosition","objectProps","getObject","_pushAddObjectCommand","_pushModifyObjectCommand","infos","registerPaths","cursorType","changeCursor","hasFilter","toDataURL","isEmptyUndoStack","isEmptyRedoStack","_detachDomEvents","destroy","centerPosition","getCenter","keyValue","setObjectProperties","getObjectProperties","getCanvasSize","getObjectPosition","posInfo","dimensions","propertiesToInclude","toJSON","json","setBackgroundColor","wrapper","includeUI","usageStatistics","Invoker","Graphics","backgroundColor","cssMaxWidth","cssMaxHeight","preserveObjectStacking","_onKeyDown","_onMouseDown","_onMouseUp","_onMouseMove","_onMouseWheel","_onObjectActivated","_onObjectMoved","_onObjectScaled","_onObjectRotated","_onObjectAdded","_onObjectModified","createdPath","_onCreatedPath","_onAddText","_onAddObject","_onTextEditing","_onTextChanged","_onIconCreateResize","_onIconCreateEnd","_selectionCleared","_selectionCreated","_attachInvokerEvents","_attachGraphicsEvents","_attachDomEvents","_setSelectionStyle","enableGLFiltering","mixin","isFunction","isRedo","lock","_isSilent","unlock","executeCallback","pushRedoStack","undoCallback","_redoStack","_undoStack","_isLocked","_invokeExecution","pop","_fireUndoStackChanged","_invokeUndo","_fireRedoStackChanged","cachedUndoDataForSilent","callback","parent","$propertyIsEnumerable","propertyIsEnumerable","NASHORN_BUG","1","objectKeys","internalObjectKeys","names","toAbsoluteIndex","IS_INCLUDES","$this","fromIndex","integer","ArrayPrototype","returnMethod","isThenable","notify","isReject","chain","notified","reactions","microtask","ok","exited","reaction","handler","fail","rejection","onHandleUnhandled","enter","exit","onUnhandled","dispatchEvent","DISPATCH_EVENT","createEvent","initEvent","NATIVE_REJECTION_EVENT","UNHANDLED_REJECTION","hostReportErrors","unwrap","internalReject","Internal","OwnPromiseCapability","PromiseWrapper","nativeThen","NativePromise","redefineAll","setSpecies","anInstance","checkCorrectnessOfIteration","speciesConstructor","task","InternalStateModule","IS_BROWSER","PROMISE","getInternalState","setInternalState","getInternalPromiseState","NativePromisePrototype","PromiseConstructor","PromiseConstructorPrototype","newGenericPromiseCapability","PromiseRejectionEvent","SUBCLASSING","GLOBAL_CORE_JS_PROMISE","FakePromise","INCORRECT_ITERATION","all","IS_UNHANDLED","isUnhandled","emit","internalResolve","executor","onFulfilled","onRejected","unsafe","$promiseResolve","race","CONSTRUCTOR_NAME","Constructor","SAFE_CLOSING","called","iteratorWithReturn","from","SKIP_CLOSING","ITERATION_SUPPORT","flush","last","node","macrotask","IS_WEBOS_WEBKIT","WebKitMutationObserver","queueMicrotaskDescriptor","queueMicrotask","createTextNode","characterData","console","onFinally","defineIterator","STRING_ITERATOR","iterated","point","CONVERT_TO_STRING","pos","second","size","codeAt","COLLECTION_NAME","DOMIterables","Collection","CollectionPrototype","addToUnscopables","ARRAY_ITERATOR","kind","Arguments","CSSRuleList","CSSStyleDeclaration","CSSValueList","ClientRectList","DOMRectList","DOMStringList","DataTransferItemList","HTMLAllCollection","HTMLCollection","HTMLFormElement","HTMLSelectElement","MediaList","MimeTypeArray","NamedNodeMap","NodeList","PaintRequestList","Plugin","PluginArray","SVGLengthList","SVGNumberList","SVGPathSegList","SVGPointList","SVGStringList","SVGTransformList","SourceBufferList","StyleSheetList","TextTrackCueList","TextTrackList","TouchList","callbackfn","stamp","isArray","forEachArray","forEachOwnProperties","DEFAULT_CSS_MAX_WIDTH","DEFAULT_CSS_MAX_HEIGHT","cssOnly","backstoreOnly","wrapperEl","_canvas","_detachZoomEvents","getComponent","components","attachKeyboardZoomEvents","detachKeyboardZoomEvents","discardActiveObject","objects","_objects","includesBackground","canvas","isType","isEmpty","forEachObject","_activeObject","activeObject","getActiveObject","group","Group","_addFabricObject","isEditing","ActiveSelection","setActiveObject","cropSelectionStyle","_componentMap","_drawingMode","_isSameDrawingMode","drawingModeInstance","_getDrawingModeInstance","start","NORMAL","end","zoomToPoint","getZoom","startZoomInMode","endZoomInMode","zoomOut","startHandMode","endHandMode","cropper","CROPPER","changeVisibility","dataUrl","canvasImage","maxDimension","scale","getBoundingRect","_calcMaxDimension","centerObject","setDimensions","getElement","_callbackAfterLoadingImageObject","Image","fromURL","image","createObjectProperties","crossOrigin","drawingMode","compName","FREE_DRAWING","LINE_DRAWING","LINE","setStates","ICON","pathInfos","defaultCursor","styles","clone","targetObj","targetOrigin","centerOrigin","diffX","diffY","staticCanvas","StaticCanvas","enableRetinaScaling","modeName","_drawingModeMap","objectCaching","element","selectedElement","canvasElement","nodeName","Canvas","containerClass","_register","CropperDrawingMode","FreeDrawingMode","LineDrawingMode","ShapeDrawingMode","TextDrawingMode","IconDrawingMode","ZoomDrawingMode","ResizeDrawingMode","ImageLoader","JsonLoader","Cropper","Flip","Rotation","FreeDrawing","Line","Text","Icon","Filter","Shape","Zoom","Resize","getName","wScaleFactor","hScaleFactor","centerPos","getCenterPoint","_handler","onMouseDown","onMouseUp","onMouseMove","onMouseWheel","onObjectAdded","onObjectRemoved","onObjectMoved","onObjectScaled","onObjectModified","onObjectRotated","onPathCreated","onSelectionCleared","onSelectionCreated","onObjectSelected","fEvent","getPointer","_removeFabricObject","_lazyFire","eventName","paramsMaker","delegationState","canvasEventDelegation","canvasEventRegister","params","hoverCursor","shapeComp","_createTextProperties","makeFillPropertyForUserEvent","targetObjectForCopyPaste","targetObjects","newTargetObject","_cloneObject","addedObjects","getActiveSelectionFromObjects","_cloneObjectItem","_copyFabricObjectForPaste","clonedObject","objectProperties","addExtraPx","isReverse","_copyFabricObject","canvasWidth","canvasHeight","cloned","processForCopiedObject","getCurrentDimensions","getOriginalDimensions","setOriginalDimensions","loadFromJSON","_onObjectRemoved","_onObjectSelected","_onPathCreated","_onSelectionCleared","_onSelectionCreated","_setObjectCachingToFalse","_setCanvasElement","_createDrawingModeInstances","_createComponents","_attachCanvasEvents","_attachZoomEvents","imageOption","padding","img","_setBackgroundImage","backgroundImage","setBackgroundImage","IMAGE_LOADER","DEFAULT_OPTION","presetRatio","_cropzone","evented","Cropzone","_listeners","selection","addListener","keyup","cropzone","off","removeListener","visible","coord","_startX","_startY","_calcRectDimensionFromPoint","getWidth","getHeight","startX","startY","_withShiftKey","listeners","containsCropzone","imageData","isValid","_getPresetPropertiesForCropSize","getScale","orignalValue","originalWidth","originalHeight","standardSize","scaleWidth","sizeValue","scaleHeight","_onKeyUp","_onFabricMouseDown","_onFabricMouseMove","_onFabricMouseUp","NOOP_FUNCTION","CORNER_TYPE_LIST","getScaleBasis","createClass","Rect","initialize","extendsOptions","callSuper","_addEventHandler","canvasEventTrigger","eventTrigger","moving","_onMoving","scaling","_onScaling","_renderCropzone","ctx","originalFlipX","flipX","originalFlipY","flipY","originalScaleX","originalScaleY","_fillOuterRect","lineWidth","_fillInnerRect","_strokeBorder","lineDashWidth","lineDashOffset","_render","fillStyle","_getCoordinates","save","beginPath","moveTo","lineTo","closePath","restore","outerX","outerY","_caculateInnerPosition","strokeStyle","stroke","outer","halfWidth","halfHeight","setLineDash","maxLeft","maxTop","selectedCorner","transform","corner","settings","_calcScalingSizeFromPointer","_resizeCropZone","adjustRatioCropzoneSize","leftMaker","topMaker","maxWidth","maxHeight","scaleTo","maxScaleFactor","v","_getCropzoneRectInfo","rectTop","rectLeft","rectWidth","rectHeight","rectRight","rectBottom","resizeInfoMap","tl","newWidth","newHeight","tr","mt","ml","mr","mb","bl","br","newSetting","getCurrentSetting","isChangingFlipX","isChangingFlipY","_invertAngle","_flipObjects","rotate","parseFloat","current","FLIP","oldAngle","getCurrentAngle","oldImageCenter","newImageCenter","_rotateForEachObject","angleDiff","centerDiff","objCenter","radian","degreesToRadians","newObjCenter","rotatePoint","additionalAngle","setAngle","ROTATION","isDrawingMode","brush","freeDrawingBrush","oColor","Color","toRgba","arrowType","_arrowType","tail","setHeadOption","_width","_oColor","_line","ArrowLine","_createLineEventObjectProperties","x2","y2","x1","y1","startPosition","endPosition","points","calcLinePoints","linePosition","fromX","fromY","toX","toY","_renderBasicLinePath","_drawDecoratorPath","_renderStroke","_drawDecoratorPathType","_drawTrianglePath","_drawChevronPath","decorateSize","standardX","standardY","atan2","rotatedPosition","changeAngle","getRotatePosition","distance","referencePosition","defaultStyles","resetStyles","fontStyle","fontWeight","textAlign","underline","select","selectClear","adjustOriginPosition","setCanvasRatio","editStatus","newText","_defaultStyles","_setInitPos","isExisty","autofocus","IText","enterEditing","selectAll","isPrevEditing","activeObj","_getTextDecorationAdaptObject","textDecoration","_selectedObj","_isSelected","cssWidth","originWidth","_ratio","linethrough","overline","ratio","getCanvasRatio","_editingObj","textareaStyle","_textarea","editingObj","editingObjInfos","_editingObjInfos","textContent","transWidth","transHeight","scrollLeft","scrollTop","fontSize","getSelectedObj","setSelectedInfo","_fireAddText","clientX","clientY","newClickTime","Date","getTime","_isDoubleClick","_lastClickTime","_onFabricSelect","_onFabricSelectClear","_onFabricScaling","_onFabricTextChanged","pathMap","arrow","cancel","_type","_iconColor","_pathMap","icon","_createIcon","_icon","controlStyle","Path","_startPoint","moveOriginPointer","filters","Mask","Sharpen","Emboss","ColorFilter","sourceImg","_getSourceImage","imgFilter","_getFilter","_createFilter","_changeFilterValues","_apply","action","getOptions","_removeFilter","applyFilters","filterObj","fabricType","_getFabricFilterType","ImageFilter","filter","BlendImage","applyTo","pipelineState","maskCtx","mask","canvasEl","maskCanvasEl","_createCanvasOfMask","getContext","getImageData","_drawMask","_mapData","createCanvasElement","maskImg","translate","drawImage","imgHeight","sourceData","maskData","Convolute","matrix","BaseFilter","threshold","filterColor","sourceFromHex","_getColor","_isOutsideThreshold","putImageData","color1","color2","SHAPE_INIT_OPTIONS","rx","ry","DEFAULT_TYPE","makeFabricFillOption","createStaticCanvas","fillType","extOption","newStaticCanvas","makeFillPatternForFilter","uniformScaling","_options","extendOption","_extendOptions","_createInstance","_bindEventOnShape","_resetPositionFillFilter","hasFillOption","filterOption","fillProp","fillImage","getFillImageFromShape","makeFilterOptionFromFabricImage","originalShapeObj","instance","Ellipse","Triangle","selectionStyles","added","_shapeObj","resizeHelper","selected","deselected","modified","currentObj","modifiedInGroup","activeSelection","_fillFilterRePositionInGroupSelection","rotating","setCursor","startPointX","startPointY","KEY_CODES","patternSourceCanvas","originalAngle","reMakePatternImageSource","rePositionFilterTypeFillImage","resetFillPatternCanvas","addWithUpdate","rotatedShapeCornerDimension","getShapeEdgePoint","ax","ay","bx","by","cx","cy","dx","dy","getRotatedDimension","diffLeft","diffTop","cropX","cropY","fillImageMaxSize","overflowAreaPositionFixer","outDistance","imageLeft","imageTop","shapePointNavigation","linePointsOutsideCanvas","shapeNeighborPointNavigation","minimumPoint","minimumPointIndex","endPointIndex1","endPointIndex2","startPointIndex","calculateLinePointsOutsideCanvas","reatAngles","linePointsOfOneVertexIndex","horizontalVerticalAngle","pointIndex","endPoint","calculateLineAngleOfOutsideCanvas","diffPosition","rotationChangePoint1","rotationChangePoint2","isForward","isReverseLeftPositionForFlip","isReverseTopPositionForFlip","getReversePositionForFlip","cropDistance","compareSize","POSITION_DIMENSION_MAP","cachedCanvasImageElement","calculateDimensionLeftTopEdge","insideCanvasRealImageWidth","insideCanvasRealImageHeight","diff","cropDistance2","calculateDimensionRightBottomEdge","calculateFillImageDimensionOutsideCanvas","makeFillImage","getCachedCanvasImageElement","fabricProperty","Pattern","repeat","innerImage","newFillImage","FILTER_OPTION_MAP","pixelate","blur","FILTER_NAME_VALUE_MAP","imageObject","toCanvasElement","copiedCanvasElement","currentCanvasImageAngle","fabricFilterClassName","DEFAULT_SCROLL_OPTION","opacity","DEFAULT_VERTICAL_SCROLL_RATIO","DEFAULT_HORIZONTAL_SCROLL_RATIO","DEFAULT_ZOOM_LEVEL","isTextEditing","withSpace","zoomArea","zoomMode","_changeObjectsEventedState","startZoom","moveZoom","stopZoom","_startHandPoint","startHand","center","_getCenterPoint","_isMaxZoomLevel","_centerPoints","prevZoomLevel","_fireZoomChanged","aspectRatio","centerPoints","prevX","prevY","_isDefaultZoomLevel","setViewportTransform","deltaX","deltaY","moveHand","stopHand","_movePointOfZoom","horizontalScrollLeft","verticalScrollTop","viewport","_verticalScroll","_horizontalScroll","viewportWidth","horizontalScrollHeight","viewportHeight","horizontalScrollWidth","horizontalScrollBorderRadius","verticalScrollWidth","verticalScrollHeight","verticalScrollBorderRadius","_addScrollBar","scrollBarTid","calcViewportBoundaries","_onMouseDownWithZoomMode","_onMouseMoveWithZoomMode","_onMouseUpWithZoomMode","_onMouseDownWithHandMode","_onMouseMoveWithHandMode","_onMouseUpWithHandMode","zoomChanged","_changeScrollState","_startHandModeWithSpaceBar","_endHandModeWithSpaceBar","_startTextEditingHandler","_stopTextEditingHandler","_dimensions","_originalDimensions","dimensionsWidth","dimensionsHeight","scaleValues","_loadJson","objs","loadingJsonFailed","JSON_LOADER","addImageObject","textComp","undoObject","textObject","filterComp","maskObj","maskObjId","prevfilterOption","setUndoData","iconComp","getColor","setColor","change","getText","textObj","undoValue","setStyle","removeAll","flipComp","loader","prevImage","prevImageWidth","prevImageHeight","objectItem","load","newImage","oldWidth","oldHeight","texComp","removeObjectById","setCssMaxDimension","rotationComp","objectId","setObjectPosition","datum","resizeComp","originalDimensions","d","getter","o","toStringTag","t","__esModule","ns","n","property","p","moduleId","modules"],"mappings":"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","file":"tui-image-editor.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"tui-code-snippet\"), require(\"fabric\")[\"fabric\"]);\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"tui-code-snippet\", \"fabric\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"ImageEditor\"] = factory(require(\"tui-code-snippet\"), require(\"fabric\")[\"fabric\"]);\n\telse\n\t\troot[\"tui\"] = root[\"tui\"] || {}, root[\"tui\"][\"ImageEditor\"] = factory(root[\"tui\"][\"util\"], root[\"fabric\"]);\n})(window, function(__WEBPACK_EXTERNAL_MODULE__3__, __WEBPACK_EXTERNAL_MODULE__4__) {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/dist\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 71);\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Constants\r\n */\r\nimport { keyMirror } from '@/util';\r\n\r\n/**\r\n * Help features for zoom\r\n * @type {Array.<string>}\r\n */\r\nexport const ZOOM_HELP_MENUS = ['zoomIn', 'zoomOut', 'hand'];\r\n\r\n/**\r\n * Help features for command\r\n * @type {Array.<string>}\r\n */\r\nexport const COMMAND_HELP_MENUS = ['history', 'undo', 'redo', 'reset'];\r\n\r\n/**\r\n * Help features for delete\r\n * @type {Array.<string>}\r\n */\r\nexport const DELETE_HELP_MENUS = ['delete', 'deleteAll'];\r\n\r\n/**\r\n * Editor help features\r\n * @type {Array.<string>}\r\n */\r\nexport const HELP_MENUS = [...ZOOM_HELP_MENUS, ...COMMAND_HELP_MENUS, ...DELETE_HELP_MENUS];\r\n\r\n/**\r\n * Fill type for shape\r\n * @type {Object.<string, string>}\r\n */\r\nexport const SHAPE_FILL_TYPE = {\r\n  FILTER: 'filter',\r\n  COLOR: 'color',\r\n};\r\n\r\n/**\r\n * Shape type list\r\n * @type {Array.<string>}\r\n */\r\nexport const SHAPE_TYPE = ['rect', 'circle', 'triangle'];\r\n\r\n/**\r\n * Object type\r\n * @type {Object.<string, string>}\r\n */\r\nexport const OBJ_TYPE = {\r\n  CROPZONE: 'cropzone',\r\n};\r\n\r\n/**\r\n * Filter type map\r\n * @type {Object.<string, string>}\r\n */\r\nexport const filterType = {\r\n  VINTAGE: 'vintage',\r\n  SEPIA2: 'sepia2',\r\n  REMOVE_COLOR: 'removeColor',\r\n  COLOR_FILTER: 'colorFilter',\r\n  REMOVE_WHITE: 'removeWhite',\r\n  BLEND_COLOR: 'blendColor',\r\n  BLEND: 'blend',\r\n};\r\n\r\n/**\r\n * Component names\r\n * @type {Object.<string, string>}\r\n */\r\nexport const componentNames = keyMirror(\r\n  'IMAGE_LOADER',\r\n  'JSON_LOADER',\r\n  'CROPPER',\r\n  'FLIP',\r\n  'ROTATION',\r\n  'FREE_DRAWING',\r\n  'LINE',\r\n  'TEXT',\r\n  'ICON',\r\n  'FILTER',\r\n  'SHAPE',\r\n  'ZOOM',\r\n  'RESIZE'\r\n);\r\n\r\n/**\r\n * Shape default option\r\n * @type {Object}\r\n */\r\nexport const SHAPE_DEFAULT_OPTIONS = {\r\n  lockSkewingX: true,\r\n  lockSkewingY: true,\r\n  bringForward: true,\r\n  isRegular: false,\r\n};\r\n\r\n/**\r\n * Cropzone default option\r\n * @type {Object}\r\n */\r\nexport const CROPZONE_DEFAULT_OPTIONS = {\r\n  hasRotatingPoint: false,\r\n  hasBorders: false,\r\n  lockScalingFlip: true,\r\n  lockRotation: true,\r\n  lockSkewingX: true,\r\n  lockSkewingY: true,\r\n};\r\n\r\n/**\r\n * Command names\r\n * @type {Object.<string, string>}\r\n */\r\nexport const commandNames = {\r\n  CLEAR_OBJECTS: 'clearObjects',\r\n  LOAD_IMAGE: 'loadImage',\r\n  LOAD_JSON: 'loadJson',\r\n  FLIP_IMAGE: 'flip',\r\n  ROTATE_IMAGE: 'rotate',\r\n  ADD_OBJECT: 'addObject',\r\n  REMOVE_OBJECT: 'removeObject',\r\n  APPLY_FILTER: 'applyFilter',\r\n  REMOVE_FILTER: 'removeFilter',\r\n  ADD_ICON: 'addIcon',\r\n  CHANGE_ICON_COLOR: 'changeIconColor',\r\n  ADD_SHAPE: 'addShape',\r\n  CHANGE_SHAPE: 'changeShape',\r\n  ADD_TEXT: 'addText',\r\n  CHANGE_TEXT: 'changeText',\r\n  CHANGE_TEXT_STYLE: 'changeTextStyle',\r\n  ADD_IMAGE_OBJECT: 'addImageObject',\r\n  RESIZE_CANVAS_DIMENSION: 'resizeCanvasDimension',\r\n  SET_OBJECT_PROPERTIES: 'setObjectProperties',\r\n  SET_OBJECT_POSITION: 'setObjectPosition',\r\n  CHANGE_SELECTION: 'changeSelection',\r\n  RESIZE_IMAGE: 'resize',\r\n};\r\n\r\n/**\r\n * Event names\r\n * @type {Object.<string, string>}\r\n */\r\nexport const eventNames = {\r\n  OBJECT_ACTIVATED: 'objectActivated',\r\n  OBJECT_MOVED: 'objectMoved',\r\n  OBJECT_SCALED: 'objectScaled',\r\n  OBJECT_CREATED: 'objectCreated',\r\n  OBJECT_ROTATED: 'objectRotated',\r\n  OBJECT_ADDED: 'objectAdded',\r\n  OBJECT_MODIFIED: 'objectModified',\r\n  TEXT_EDITING: 'textEditing',\r\n  TEXT_CHANGED: 'textChanged',\r\n  ICON_CREATE_RESIZE: 'iconCreateResize',\r\n  ICON_CREATE_END: 'iconCreateEnd',\r\n  ADD_TEXT: 'addText',\r\n  ADD_OBJECT: 'addObject',\r\n  ADD_OBJECT_AFTER: 'addObjectAfter',\r\n  MOUSE_DOWN: 'mousedown',\r\n  MOUSE_UP: 'mouseup',\r\n  MOUSE_MOVE: 'mousemove',\r\n  MOUSE_WHEEL: 'mousewheel',\r\n  // UNDO/REDO Events\r\n  REDO_STACK_CHANGED: 'redoStackChanged',\r\n  UNDO_STACK_CHANGED: 'undoStackChanged',\r\n  SELECTION_CLEARED: 'selectionCleared',\r\n  SELECTION_CREATED: 'selectionCreated',\r\n  EXECUTE_COMMAND: 'executeCommand',\r\n  AFTER_UNDO: 'afterUndo',\r\n  AFTER_REDO: 'afterRedo',\r\n  ZOOM_CHANGED: 'zoomChanged',\r\n  HAND_STARTED: 'handStarted',\r\n  HAND_STOPPED: 'handStopped',\r\n  KEY_DOWN: 'keydown',\r\n  KEY_UP: 'keyup',\r\n  INPUT_BOX_EDITING_STARTED: 'inputBoxEditingStarted',\r\n  INPUT_BOX_EDITING_STOPPED: 'inputBoxEditingStopped',\r\n  FOCUS: 'focus',\r\n  BLUR: 'blur',\r\n  IMAGE_RESIZED: 'imageResized',\r\n};\r\n\r\n/**\r\n * Selector names\r\n * @type {Object.<string, string>}\r\n */\r\nexport const selectorNames = {\r\n  COLOR_PICKER_INPUT_BOX: '.tui-colorpicker-palette-hex',\r\n};\r\n\r\n/**\r\n * History names\r\n * @type {Object.<string, string>}\r\n */\r\nexport const historyNames = {\r\n  LOAD_IMAGE: 'Load',\r\n  LOAD_JSON: 'Load Json',\r\n  LOAD_MASK_IMAGE: 'Mask',\r\n  ADD_MASK_IMAGE: 'Mask',\r\n  ADD_IMAGE_OBJECT: 'Mask',\r\n  CROP: 'Crop',\r\n  RESIZE: 'Resize',\r\n  APPLY_FILTER: 'Filter',\r\n  REMOVE_FILTER: 'Filter',\r\n  CHANGE_SHAPE: 'Shape',\r\n  CHANGE_ICON_COLOR: 'Icon',\r\n  ADD_TEXT: 'Text',\r\n  CHANGE_TEXT_STYLE: 'Text',\r\n  REMOVE_OBJECT: 'Delete',\r\n  CLEAR_OBJECTS: 'Delete',\r\n};\r\n\r\n/**\r\n * Editor states\r\n * @type {Object.<string, string>}\r\n */\r\nexport const drawingModes = keyMirror(\r\n  'NORMAL',\r\n  'CROPPER',\r\n  'FREE_DRAWING',\r\n  'LINE_DRAWING',\r\n  'TEXT',\r\n  'SHAPE',\r\n  'ICON',\r\n  'ZOOM',\r\n  'RESIZE'\r\n);\r\n\r\n/**\r\n * Menu names with drawing mode\r\n * @type {Object.<string, string>}\r\n */\r\nexport const drawingMenuNames = {\r\n  TEXT: 'text',\r\n  CROP: 'crop',\r\n  RESIZE: 'resize',\r\n  SHAPE: 'shape',\r\n  ZOOM: 'zoom',\r\n};\r\n\r\n/**\r\n * Zoom modes\r\n * @type {Object.<string, string>}\r\n */\r\nexport const zoomModes = {\r\n  DEFAULT: 'normal',\r\n  ZOOM: 'zoom',\r\n  HAND: 'hand',\r\n};\r\n\r\n/**\r\n * Shortcut key values\r\n * @type {Object.<string, number>}\r\n */\r\nexport const keyCodes = {\r\n  Z: 90,\r\n  Y: 89,\r\n  C: 67,\r\n  V: 86,\r\n  SHIFT: 16,\r\n  BACKSPACE: 8,\r\n  DEL: 46,\r\n  ARROW_DOWN: 40,\r\n  ARROW_UP: 38,\r\n  SPACE: 32,\r\n};\r\n\r\n/**\r\n * Fabric object options\r\n * @type {Object.<string, Object>}\r\n */\r\nexport const fObjectOptions = {\r\n  SELECTION_STYLE: {\r\n    borderColor: 'red',\r\n    cornerColor: 'green',\r\n    cornerSize: 10,\r\n    originX: 'center',\r\n    originY: 'center',\r\n    transparentCorners: false,\r\n  },\r\n};\r\n\r\n/**\r\n * Promise reject messages\r\n * @type {Object.<string, string>}\r\n */\r\nexport const rejectMessages = {\r\n  addedObject: 'The object is already added.',\r\n  flip: 'The flipX and flipY setting values are not changed.',\r\n  invalidDrawingMode: 'This operation is not supported in the drawing mode.',\r\n  invalidParameters: 'Invalid parameters.',\r\n  isLock: 'The executing command state is locked.',\r\n  loadImage: 'The background image is empty.',\r\n  loadJson: 'The JSON is invalid',\r\n  loadingImageFailed: 'Invalid image loaded.',\r\n  noActiveObject: 'There is no active object.',\r\n  noObject: 'The object is not in canvas.',\r\n  redo: 'The promise of redo command is reject.',\r\n  rotation: 'The current angle is same the old angle.',\r\n  undo: 'The promise of undo command is reject.',\r\n  unsupportedOperation: 'Unsupported operation.',\r\n  unsupportedType: 'Unsupported object type.',\r\n};\r\n\r\n/**\r\n * Default icon menu svg path\r\n * @type {Object.<string, string>}\r\n */\r\nexport const defaultIconPath = {\r\n  'icon-arrow': 'M40 12V0l24 24-24 24V36H0V12h40z',\r\n  'icon-arrow-2': 'M49,32 H3 V22 h46 l-18,-18 h12 l23,23 L43,50 h-12 l18,-18  z ',\r\n  'icon-arrow-3':\r\n    'M43.349998,27 L17.354,53 H1.949999 l25.996,-26 L1.949999,1 h15.404 L43.349998,27  z ',\r\n  'icon-star':\r\n    'M35,54.557999 l-19.912001,10.468 l3.804,-22.172001 l-16.108,-15.7 l22.26,-3.236 L35,3.746 l9.956,20.172001 l22.26,3.236 l-16.108,15.7 l3.804,22.172001  z ',\r\n  'icon-star-2':\r\n    'M17,31.212 l-7.194,4.08 l-4.728,-6.83 l-8.234,0.524 l-1.328,-8.226 l-7.644,-3.14 l2.338,-7.992 l-5.54,-6.18 l5.54,-6.176 l-2.338,-7.994 l7.644,-3.138 l1.328,-8.226 l8.234,0.522 l4.728,-6.83 L17,-24.312 l7.194,-4.08 l4.728,6.83 l8.234,-0.522 l1.328,8.226 l7.644,3.14 l-2.338,7.992 l5.54,6.178 l-5.54,6.178 l2.338,7.992 l-7.644,3.14 l-1.328,8.226 l-8.234,-0.524 l-4.728,6.83  z ',\r\n  'icon-polygon': 'M3,31 L19,3 h32 l16,28 l-16,28 H19  z ',\r\n  'icon-location':\r\n    'M24 62C8 45.503 0 32.837 0 24 0 10.745 10.745 0 24 0s24 10.745 24 24c0 8.837-8 21.503-24 38zm0-28c5.523 0 10-4.477 10-10s-4.477-10-10-10-10 4.477-10 10 4.477 10 10 10z',\r\n  'icon-heart':\r\n    'M49.994999,91.349998 l-6.96,-6.333 C18.324001,62.606995 2.01,47.829002 2.01,29.690998 C2.01,14.912998 13.619999,3.299999 28.401001,3.299999 c8.349,0 16.362,5.859 21.594,12 c5.229,-6.141 13.242001,-12 21.591,-12 c14.778,0 26.390999,11.61 26.390999,26.390999 c0,18.138 -16.314001,32.916 -41.025002,55.374001 l-6.96,6.285  z ',\r\n  'icon-bubble':\r\n    'M44 48L34 58V48H12C5.373 48 0 42.627 0 36V12C0 5.373 5.373 0 12 0h40c6.627 0 12 5.373 12 12v24c0 6.627-5.373 12-12 12h-8z',\r\n};\r\n\r\nexport const defaultRotateRangeValues = {\r\n  realTimeEvent: true,\r\n  min: -360,\r\n  max: 360,\r\n  value: 0,\r\n};\r\n\r\nexport const defaultDrawRangeValues = {\r\n  min: 5,\r\n  max: 30,\r\n  value: 12,\r\n};\r\n\r\nexport const defaultShapeStrokeValues = {\r\n  realTimeEvent: true,\r\n  min: 2,\r\n  max: 300,\r\n  value: 3,\r\n};\r\n\r\nexport const defaultTextRangeValues = {\r\n  realTimeEvent: true,\r\n  min: 10,\r\n  max: 100,\r\n  value: 50,\r\n};\r\n\r\nexport const defaultFilterRangeValues = {\r\n  tintOpacityRange: {\r\n    realTimeEvent: true,\r\n    min: 0,\r\n    max: 1,\r\n    value: 0.7,\r\n    useDecimal: true,\r\n  },\r\n  removewhiteDistanceRange: {\r\n    realTimeEvent: true,\r\n    min: 0,\r\n    max: 1,\r\n    value: 0.2,\r\n    useDecimal: true,\r\n  },\r\n  brightnessRange: {\r\n    realTimeEvent: true,\r\n    min: -1,\r\n    max: 1,\r\n    value: 0,\r\n    useDecimal: true,\r\n  },\r\n  noiseRange: {\r\n    realTimeEvent: true,\r\n    min: 0,\r\n    max: 1000,\r\n    value: 100,\r\n  },\r\n  pixelateRange: {\r\n    realTimeEvent: true,\r\n    min: 2,\r\n    max: 20,\r\n    value: 4,\r\n  },\r\n  colorfilterThresholdRange: {\r\n    realTimeEvent: true,\r\n    min: 0,\r\n    max: 1,\r\n    value: 0.2,\r\n    useDecimal: true,\r\n  },\r\n  blurFilterRange: {\r\n    value: 0.1,\r\n  },\r\n};\r\n\r\nexport const emptyCropRectValues = {\r\n  LEFT: 0,\r\n  TOP: 0,\r\n  WIDTH: 0.5,\r\n  HEIGHT: 0.5,\r\n};\r\n\r\nexport const defaultResizePixelValues = {\r\n  realTimeEvent: true,\r\n  min: 32,\r\n  max: 4088,\r\n  value: 800,\r\n};\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Util\r\n */\r\nimport { forEach, sendHostname, extend, isString, pick, inArray } from 'tui-code-snippet';\r\nimport Promise from 'core-js-pure/features/promise';\r\nimport {\r\n  commandNames,\r\n  filterType,\r\n  historyNames,\r\n  SHAPE_FILL_TYPE,\r\n  SHAPE_TYPE,\r\n  emptyCropRectValues,\r\n} from '@/consts';\r\n\r\nconst FLOATING_POINT_DIGIT = 2;\r\nconst CSS_PREFIX = 'tui-image-editor-';\r\nconst { min, max } = Math;\r\nlet hostnameSent = false;\r\n\r\n/**\r\n * Export Promise Class (for simplified module path)\r\n * @returns {Promise} promise class\r\n */\r\nexport { Promise };\r\n\r\n/**\r\n * Clamp value\r\n * @param {number} value - Value\r\n * @param {number} minValue - Minimum value\r\n * @param {number} maxValue - Maximum value\r\n * @returns {number} clamped value\r\n */\r\nexport function clamp(value, minValue, maxValue) {\r\n  if (minValue > maxValue) {\r\n    [minValue, maxValue] = [maxValue, minValue];\r\n  }\r\n\r\n  return max(minValue, min(value, maxValue));\r\n}\r\n\r\n/**\r\n * Make key-value object from arguments\r\n * @returns {object.<string, string>}\r\n */\r\nexport function keyMirror(...args) {\r\n  const obj = {};\r\n\r\n  forEach(args, (key) => {\r\n    obj[key] = key;\r\n  });\r\n\r\n  return obj;\r\n}\r\n\r\n/**\r\n * Make CSSText\r\n * @param {Object} styleObj - Style info object\r\n * @returns {string} Connected string of style\r\n */\r\nexport function makeStyleText(styleObj) {\r\n  let styleStr = '';\r\n\r\n  forEach(styleObj, (value, prop) => {\r\n    styleStr += `${prop}: ${value};`;\r\n  });\r\n\r\n  return styleStr;\r\n}\r\n\r\n/**\r\n * Get object's properties\r\n * @param {Object} obj - object\r\n * @param {Array} keys - keys\r\n * @returns {Object} properties object\r\n */\r\nexport function getProperties(obj, keys) {\r\n  const props = {};\r\n  const { length } = keys;\r\n  let i = 0;\r\n  let key;\r\n\r\n  for (i = 0; i < length; i += 1) {\r\n    key = keys[i];\r\n    props[key] = obj[key];\r\n  }\r\n\r\n  return props;\r\n}\r\n\r\n/**\r\n * ParseInt simpliment\r\n * @param {number} value - Value\r\n * @returns {number}\r\n */\r\nexport function toInteger(value) {\r\n  return parseInt(value, 10);\r\n}\r\n\r\n/**\r\n * String to camelcase string\r\n * @param {string} targetString - change target\r\n * @returns {string}\r\n * @private\r\n */\r\nexport function toCamelCase(targetString) {\r\n  return targetString.replace(/-([a-z])/g, ($0, $1) => $1.toUpperCase());\r\n}\r\n\r\n/**\r\n * Check browser file api support\r\n * @returns {boolean}\r\n * @private\r\n */\r\nexport function isSupportFileApi() {\r\n  return !!(window.File && window.FileList && window.FileReader);\r\n}\r\n\r\n/**\r\n * hex to rgb\r\n * @param {string} color - hex color\r\n * @param {string} alpha - color alpha value\r\n * @returns {string} rgb expression\r\n */\r\nexport function getRgb(color, alpha) {\r\n  if (color.length === 4) {\r\n    color = `${color}${color.slice(1, 4)}`;\r\n  }\r\n  const r = parseInt(color.slice(1, 3), 16);\r\n  const g = parseInt(color.slice(3, 5), 16);\r\n  const b = parseInt(color.slice(5, 7), 16);\r\n  const a = alpha || 1;\r\n\r\n  return `rgba(${r}, ${g}, ${b}, ${a})`;\r\n}\r\n\r\n/**\r\n * send hostname\r\n */\r\nexport function sendHostName() {\r\n  if (hostnameSent) {\r\n    return;\r\n  }\r\n  hostnameSent = true;\r\n\r\n  sendHostname('image-editor', 'UA-129999381-1');\r\n}\r\n\r\n/**\r\n * Apply css resource\r\n * @param {string} styleBuffer - serialized css text\r\n * @param {string} tagId - style tag id\r\n */\r\nexport function styleLoad(styleBuffer, tagId) {\r\n  const [head] = document.getElementsByTagName('head');\r\n  const linkElement = document.createElement('link');\r\n  const styleData = encodeURIComponent(styleBuffer);\r\n  if (tagId) {\r\n    linkElement.id = tagId;\r\n    // linkElement.id = 'tui-image-editor-theme-style';\r\n  }\r\n  linkElement.setAttribute('rel', 'stylesheet');\r\n  linkElement.setAttribute('type', 'text/css');\r\n  linkElement.setAttribute('href', `data:text/css;charset=UTF-8,${styleData}`);\r\n  head.appendChild(linkElement);\r\n}\r\n\r\n/**\r\n * Get selector\r\n * @param {HTMLElement} targetElement - target element\r\n * @returns {Function} selector\r\n */\r\nexport function getSelector(targetElement) {\r\n  return (str) => targetElement.querySelector(str);\r\n}\r\n\r\n/**\r\n * Change base64 to blob\r\n * @param {String} data - base64 string data\r\n * @returns {Blob} Blob Data\r\n */\r\nexport function base64ToBlob(data) {\r\n  const rImageType = /data:(image\\/.+);base64,/;\r\n  let mimeString = '';\r\n  let raw, uInt8Array, i;\r\n\r\n  raw = data.replace(rImageType, (header, imageType) => {\r\n    mimeString = imageType;\r\n\r\n    return '';\r\n  });\r\n\r\n  raw = atob(raw);\r\n  const rawLength = raw.length;\r\n  uInt8Array = new Uint8Array(rawLength); // eslint-disable-line\r\n\r\n  for (i = 0; i < rawLength; i += 1) {\r\n    uInt8Array[i] = raw.charCodeAt(i);\r\n  }\r\n\r\n  return new Blob([uInt8Array], { type: mimeString });\r\n}\r\n\r\n/**\r\n * Fix floating point diff.\r\n * @param {number} value - original value\r\n * @returns {number} fixed value\r\n */\r\nexport function fixFloatingPoint(value) {\r\n  return Number(value.toFixed(FLOATING_POINT_DIGIT));\r\n}\r\n\r\n/**\r\n * Assignment for destroying objects.\r\n * @param {Object} targetObject - object to be removed.\r\n */\r\nexport function assignmentForDestroy(targetObject) {\r\n  forEach(targetObject, (value, key) => {\r\n    targetObject[key] = null;\r\n  });\r\n}\r\n\r\n/**\r\n * Make class name for ui\r\n * @param {String} str  - main string of className\r\n * @param {String} prefix - prefix string of className\r\n * @returns {String} class name\r\n */\r\nexport function cls(str = '', prefix = '') {\r\n  if (str.charAt(0) === '.') {\r\n    return `.${CSS_PREFIX}${prefix}${str.slice(1)}`;\r\n  }\r\n\r\n  return `${CSS_PREFIX}${prefix}${str}`;\r\n}\r\n\r\n/**\r\n * Change object origin\r\n * @param {fabric.Object} fObject - fabric object\r\n * @param {Object} origin - origin of fabric object\r\n *   @param {string} originX - horizontal basis.\r\n *   @param {string} originY - vertical basis.\r\n */\r\nexport function changeOrigin(fObject, origin) {\r\n  const { originX, originY } = origin;\r\n  const { x: left, y: top } = fObject.getPointByOrigin(originX, originY);\r\n\r\n  fObject.set({\r\n    left,\r\n    top,\r\n    originX,\r\n    originY,\r\n  });\r\n\r\n  fObject.setCoords();\r\n}\r\n\r\n/**\r\n * Object key value flip\r\n * @param {Object} targetObject - The data object of the key value.\r\n * @returns {Object}\r\n */\r\nexport function flipObject(targetObject) {\r\n  const result = {};\r\n\r\n  Object.keys(targetObject).forEach((key) => {\r\n    result[targetObject[key]] = key;\r\n  });\r\n\r\n  return result;\r\n}\r\n\r\n/**\r\n * Set custom properties\r\n * @param {Object} targetObject - target object\r\n * @param {Object} props - custom props object\r\n */\r\nexport function setCustomProperty(targetObject, props) {\r\n  targetObject.customProps = targetObject.customProps || {};\r\n  extend(targetObject.customProps, props);\r\n}\r\n\r\n/**\r\n * Get custom property\r\n * @param {fabric.Object} fObject - fabric object\r\n * @param {Array|string} propNames - prop name array\r\n * @returns {object | number | string}\r\n */\r\nexport function getCustomProperty(fObject, propNames) {\r\n  const resultObject = {};\r\n  if (isString(propNames)) {\r\n    propNames = [propNames];\r\n  }\r\n  forEach(propNames, (propName) => {\r\n    resultObject[propName] = fObject.customProps[propName];\r\n  });\r\n\r\n  return resultObject;\r\n}\r\n\r\n/**\r\n * Capitalize string\r\n * @param {string} targetString - target string\r\n * @returns {string}\r\n */\r\nexport function capitalizeString(targetString) {\r\n  return targetString.charAt(0).toUpperCase() + targetString.slice(1);\r\n}\r\n\r\n/**\r\n * Array includes check\r\n * @param {Array} targetArray - target array\r\n * @param {string|number} compareValue - compare value\r\n * @returns {boolean}\r\n */\r\nexport function includes(targetArray, compareValue) {\r\n  return targetArray.indexOf(compareValue) >= 0;\r\n}\r\n\r\n/**\r\n * Get fill type\r\n * @param {Object | string} fillOption - shape fill option\r\n * @returns {string} 'color' or 'filter'\r\n */\r\nexport function getFillTypeFromOption(fillOption = {}) {\r\n  return pick(fillOption, 'type') || SHAPE_FILL_TYPE.COLOR;\r\n}\r\n\r\n/**\r\n * Get fill type of shape type object\r\n * @param {fabric.Object} shapeObj - fabric object\r\n * @returns {string} 'transparent' or 'color' or 'filter'\r\n */\r\nexport function getFillTypeFromObject(shapeObj) {\r\n  const { fill = {} } = shapeObj;\r\n  if (fill.source) {\r\n    return SHAPE_FILL_TYPE.FILTER;\r\n  }\r\n\r\n  return SHAPE_FILL_TYPE.COLOR;\r\n}\r\n\r\n/**\r\n * Check if the object is a shape object.\r\n * @param {fabric.Object} obj - fabric object\r\n * @returns {boolean}\r\n */\r\nexport function isShape(obj) {\r\n  return inArray(obj.get('type'), SHAPE_TYPE) >= 0;\r\n}\r\n\r\n/**\r\n * Get object type\r\n * @param {string} type - fabric object type\r\n * @returns {string} type of object (ex: shape, icon, ...)\r\n */\r\nexport function getObjectType(type) {\r\n  if (includes(SHAPE_TYPE, type)) {\r\n    return 'Shape';\r\n  }\r\n\r\n  switch (type) {\r\n    case 'i-text':\r\n      return 'Text';\r\n    case 'path':\r\n    case 'line':\r\n      return 'Draw';\r\n    case 'activeSelection':\r\n      return 'Group';\r\n    default:\r\n      return toStartOfCapital(type);\r\n  }\r\n}\r\n\r\n/**\r\n * Get filter type\r\n * @param {string} type - fabric filter type\r\n * @param {object} [options] - filter type options\r\n *   @param {boolean} [options.useAlpha=true] - usage of alpha(true is 'color filter', false is 'remove white')\r\n *   @param {string} [options.mode] - mode of blendColor\r\n * @returns {string} type of filter (ex: sepia, blur, ...)\r\n */\r\nfunction getFilterType(type, { useAlpha = true, mode } = {}) {\r\n  const { VINTAGE, REMOVE_COLOR, BLEND_COLOR, SEPIA2, COLOR_FILTER, REMOVE_WHITE, BLEND } =\r\n    filterType;\r\n\r\n  let filterName;\r\n\r\n  switch (type) {\r\n    case VINTAGE:\r\n      filterName = SEPIA2;\r\n      break;\r\n    case REMOVE_COLOR:\r\n      filterName = useAlpha ? COLOR_FILTER : REMOVE_WHITE;\r\n      break;\r\n    case BLEND_COLOR:\r\n      filterName = mode === 'add' ? BLEND : mode;\r\n      break;\r\n    default:\r\n      filterName = type;\r\n  }\r\n\r\n  return toStartOfCapital(filterName);\r\n}\r\n\r\n/**\r\n * Check if command is silent command\r\n * @param {Command|string} command - command or command name\r\n * @returns {boolean}\r\n */\r\nexport function isSilentCommand(command) {\r\n  const { LOAD_IMAGE } = commandNames;\r\n\r\n  return typeof command === 'string' ? LOAD_IMAGE === command : LOAD_IMAGE === command.name;\r\n}\r\n\r\n/**\r\n * Get command name\r\n * @param {Command|string} command - command or command name\r\n * @returns {{name: string, ?detail: string}}\r\n */\r\n// eslint-disable-next-line complexity, require-jsdoc\r\nexport function getHistoryTitle(command) {\r\n  const {\r\n    FLIP_IMAGE,\r\n    ROTATE_IMAGE,\r\n    ADD_TEXT,\r\n    APPLY_FILTER,\r\n    REMOVE_FILTER,\r\n    CHANGE_SHAPE,\r\n    CHANGE_ICON_COLOR,\r\n    CHANGE_TEXT_STYLE,\r\n    CLEAR_OBJECTS,\r\n    ADD_IMAGE_OBJECT,\r\n    REMOVE_OBJECT,\r\n    RESIZE_IMAGE,\r\n  } = commandNames;\r\n  const { name, args } = command;\r\n  let historyInfo;\r\n\r\n  switch (name) {\r\n    case FLIP_IMAGE:\r\n      historyInfo = { name, detail: args[1] === 'reset' ? args[1] : args[1].slice(4) };\r\n      break;\r\n    case ROTATE_IMAGE:\r\n      historyInfo = { name, detail: args[2] };\r\n      break;\r\n    case APPLY_FILTER:\r\n      historyInfo = { name: historyNames.APPLY_FILTER, detail: getFilterType(args[1], args[2]) };\r\n      break;\r\n    case REMOVE_FILTER:\r\n      historyInfo = { name: historyNames.REMOVE_FILTER, detail: 'Remove' };\r\n      break;\r\n    case CHANGE_SHAPE:\r\n      historyInfo = { name: historyNames.CHANGE_SHAPE, detail: 'Change' };\r\n      break;\r\n    case CHANGE_ICON_COLOR:\r\n      historyInfo = { name: historyNames.CHANGE_ICON_COLOR, detail: 'Change' };\r\n      break;\r\n    case CHANGE_TEXT_STYLE:\r\n      historyInfo = { name: historyNames.CHANGE_TEXT_STYLE, detail: 'Change' };\r\n      break;\r\n    case REMOVE_OBJECT:\r\n      historyInfo = { name: historyNames.REMOVE_OBJECT, detail: args[2] };\r\n      break;\r\n    case CLEAR_OBJECTS:\r\n      historyInfo = { name: historyNames.CLEAR_OBJECTS, detail: 'All' };\r\n      break;\r\n    case ADD_IMAGE_OBJECT:\r\n      historyInfo = { name: historyNames.ADD_IMAGE_OBJECT, detail: 'Add' };\r\n      break;\r\n    case ADD_TEXT:\r\n      historyInfo = { name: historyNames.ADD_TEXT };\r\n      break;\r\n    case RESIZE_IMAGE:\r\n      historyInfo = { name: historyNames.RESIZE, detail: `${~~args[1].width}x${~~args[1].height}` };\r\n      break;\r\n\r\n    default:\r\n      historyInfo = { name };\r\n      break;\r\n  }\r\n\r\n  if (args[1] === 'mask') {\r\n    historyInfo = { name: historyNames.LOAD_MASK_IMAGE, detail: 'Apply' };\r\n  }\r\n\r\n  return historyInfo;\r\n}\r\n\r\n/**\r\n * Get help menubar position(opposite of menubar)\r\n * @param {string} position - position of menubar\r\n * @returns {string} position of help menubar\r\n */\r\nexport function getHelpMenuBarPosition(position) {\r\n  if (position === 'top') {\r\n    return 'bottom';\r\n  }\r\n  if (position === 'left') {\r\n    return 'right';\r\n  }\r\n  if (position === 'right') {\r\n    return 'left';\r\n  }\r\n\r\n  return 'top';\r\n}\r\n\r\n/**\r\n * Change to capital start letter\r\n * @param {string} str - string to change\r\n * @returns {string}\r\n */\r\nfunction toStartOfCapital(str) {\r\n  return str.replace(/[a-z]/, (first) => first.toUpperCase());\r\n}\r\n\r\n/**\r\n * Check if cropRect is Empty.\r\n * @param {Object} cropRect - cropRect object\r\n *  @param {Number} cropRect.left - cropRect left position value\r\n *  @param {Number} cropRect.top - cropRect top position value\r\n *  @param {Number} cropRect.width - cropRect width value\r\n *  @param {Number} cropRect.height - cropRect height value\r\n * @returns {boolean}\r\n */\r\nexport function isEmptyCropzone(cropRect) {\r\n  const { left, top, width, height } = cropRect;\r\n  const { LEFT, TOP, WIDTH, HEIGHT } = emptyCropRectValues;\r\n\r\n  return left === LEFT && top === TOP && width === WIDTH && height === HEIGHT;\r\n}\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Command factory\r\n */\r\nimport Command from '@/interface/command';\r\n\r\nconst commands = {};\r\n\r\n/**\r\n * Create a command\r\n * @param {string} name - Command name\r\n * @param {...*} args - Arguments for creating command\r\n * @returns {Command}\r\n * @ignore\r\n */\r\nfunction create(name, ...args) {\r\n  const actions = commands[name];\r\n  if (actions) {\r\n    return new Command(actions, args);\r\n  }\r\n\r\n  return null;\r\n}\r\n\r\n/**\r\n * Register a command with name as a key\r\n * @param {Object} command - {name:{string}, execute: {function}, undo: {function}}\r\n * @param {string} command.name - command name\r\n * @param {function} command.execute - executable function\r\n * @param {function} command.undo - undo function\r\n * @ignore\r\n */\r\nfunction register(command) {\r\n  commands[command.name] = command;\r\n}\r\n\r\nexport default {\r\n  create,\r\n  register,\r\n};\r\n","module.exports = __WEBPACK_EXTERNAL_MODULE__3__;","module.exports = __WEBPACK_EXTERNAL_MODULE__4__;","var check = function (it) {\n  return it && it.Math == Math && it;\n};\n\n// https://github.com/zloirock/core-js/issues/86#issuecomment-115759028\nmodule.exports =\n  // eslint-disable-next-line es/no-global-this -- safe\n  check(typeof globalThis == 'object' && globalThis) ||\n  check(typeof window == 'object' && window) ||\n  // eslint-disable-next-line no-restricted-globals -- safe\n  check(typeof self == 'object' && self) ||\n  check(typeof global == 'object' && global) ||\n  // eslint-disable-next-line no-new-func -- fallback\n  (function () { return this; })() || Function('return this')();\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Component interface\r\n */\r\n\r\n/**\r\n * Component interface\r\n * @class\r\n * @param {string} name - component name\r\n * @param {Graphics} graphics - Graphics instance\r\n * @ignore\r\n */\r\nclass Component {\r\n  constructor(name, graphics) {\r\n    /**\r\n     * Component name\r\n     * @type {string}\r\n     */\r\n    this.name = name;\r\n\r\n    /**\r\n     * Graphics instance\r\n     * @type {Graphics}\r\n     */\r\n    this.graphics = graphics;\r\n  }\r\n\r\n  /**\r\n   * Fire Graphics event\r\n   * @returns {Object} return value\r\n   */\r\n  fire(...args) {\r\n    const context = this.graphics;\r\n\r\n    return this.graphics.fire.apply(context, args);\r\n  }\r\n\r\n  /**\r\n   * Save image(background) of canvas\r\n   * @param {string} name - Name of image\r\n   * @param {fabric.Image} oImage - Fabric image instance\r\n   */\r\n  setCanvasImage(name, oImage) {\r\n    this.graphics.setCanvasImage(name, oImage);\r\n  }\r\n\r\n  /**\r\n   * Returns canvas element of fabric.Canvas[[lower-canvas]]\r\n   * @returns {HTMLCanvasElement}\r\n   */\r\n  getCanvasElement() {\r\n    return this.graphics.getCanvasElement();\r\n  }\r\n\r\n  /**\r\n   * Get fabric.Canvas instance\r\n   * @returns {fabric.Canvas}\r\n   */\r\n  getCanvas() {\r\n    return this.graphics.getCanvas();\r\n  }\r\n\r\n  /**\r\n   * Get canvasImage (fabric.Image instance)\r\n   * @returns {fabric.Image}\r\n   */\r\n  getCanvasImage() {\r\n    return this.graphics.getCanvasImage();\r\n  }\r\n\r\n  /**\r\n   * Get image name\r\n   * @returns {string}\r\n   */\r\n  getImageName() {\r\n    return this.graphics.getImageName();\r\n  }\r\n\r\n  /**\r\n   * Get image editor\r\n   * @returns {ImageEditor}\r\n   */\r\n  getEditor() {\r\n    return this.graphics.getEditor();\r\n  }\r\n\r\n  /**\r\n   * Return component name\r\n   * @returns {string}\r\n   */\r\n  getName() {\r\n    return this.name;\r\n  }\r\n\r\n  /**\r\n   * Set image properties\r\n   * @param {Object} setting - Image properties\r\n   * @param {boolean} [withRendering] - If true, The changed image will be reflected in the canvas\r\n   */\r\n  setImageProperties(setting, withRendering) {\r\n    this.graphics.setImageProperties(setting, withRendering);\r\n  }\r\n\r\n  /**\r\n   * Set canvas dimension - css only\r\n   * @param {Object} dimension - Canvas css dimension\r\n   */\r\n  setCanvasCssDimension(dimension) {\r\n    this.graphics.setCanvasCssDimension(dimension);\r\n  }\r\n\r\n  /**\r\n   * Set canvas dimension - css only\r\n   * @param {Object} dimension - Canvas backstore dimension\r\n   */\r\n  setCanvasBackstoreDimension(dimension) {\r\n    this.graphics.setCanvasBackstoreDimension(dimension);\r\n  }\r\n\r\n  /**\r\n   * Adjust canvas dimension with scaling image\r\n   */\r\n  adjustCanvasDimension() {\r\n    this.graphics.adjustCanvasDimension();\r\n  }\r\n\r\n  adjustCanvasDimensionBase() {\r\n    this.graphics.adjustCanvasDimensionBase();\r\n  }\r\n}\r\n\r\nexport default Component;\r\n","var global = require('../internals/global');\nvar shared = require('../internals/shared');\nvar has = require('../internals/has');\nvar uid = require('../internals/uid');\nvar NATIVE_SYMBOL = require('../internals/native-symbol');\nvar USE_SYMBOL_AS_UID = require('../internals/use-symbol-as-uid');\n\nvar WellKnownSymbolsStore = shared('wks');\nvar Symbol = global.Symbol;\nvar createWellKnownSymbol = USE_SYMBOL_AS_UID ? Symbol : Symbol && Symbol.withoutSetter || uid;\n\nmodule.exports = function (name) {\n  if (!has(WellKnownSymbolsStore, name) || !(NATIVE_SYMBOL || typeof WellKnownSymbolsStore[name] == 'string')) {\n    if (NATIVE_SYMBOL && has(Symbol, name)) {\n      WellKnownSymbolsStore[name] = Symbol[name];\n    } else {\n      WellKnownSymbolsStore[name] = createWellKnownSymbol('Symbol.' + name);\n    }\n  } return WellKnownSymbolsStore[name];\n};\n","module.exports = function (exec) {\n  try {\n    return !!exec();\n  } catch (error) {\n    return true;\n  }\n};\n","var DESCRIPTORS = require('../internals/descriptors');\nvar definePropertyModule = require('../internals/object-define-property');\nvar createPropertyDescriptor = require('../internals/create-property-descriptor');\n\nmodule.exports = DESCRIPTORS ? function (object, key, value) {\n  return definePropertyModule.f(object, key, createPropertyDescriptor(1, value));\n} : function (object, key, value) {\n  object[key] = value;\n  return object;\n};\n","var toObject = require('../internals/to-object');\n\nvar hasOwnProperty = {}.hasOwnProperty;\n\nmodule.exports = function hasOwn(it, key) {\n  return hasOwnProperty.call(toObject(it), key);\n};\n","var isObject = require('../internals/is-object');\n\nmodule.exports = function (it) {\n  if (!isObject(it)) {\n    throw TypeError(String(it) + ' is not an object');\n  } return it;\n};\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview DrawingMode interface\r\n */\r\nimport errorMessage from '@/factory/errorMessage';\r\n\r\nconst createMessage = errorMessage.create;\r\nconst errorTypes = errorMessage.types;\r\n\r\n/**\r\n * DrawingMode interface\r\n * @class\r\n * @param {string} name - drawing mode name\r\n * @ignore\r\n */\r\nclass DrawingMode {\r\n  constructor(name) {\r\n    /**\r\n     * the name of drawing mode\r\n     * @type {string}\r\n     */\r\n    this.name = name;\r\n  }\r\n\r\n  /**\r\n   * Get this drawing mode name;\r\n   * @returns {string} drawing mode name\r\n   */\r\n  getName() {\r\n    return this.name;\r\n  }\r\n\r\n  /**\r\n   * start this drawing mode\r\n   * @param {Object} options - drawing mode options\r\n   * @abstract\r\n   */\r\n  start() {\r\n    throw new Error(createMessage(errorTypes.UN_IMPLEMENTATION, 'start'));\r\n  }\r\n\r\n  /**\r\n   * stop this drawing mode\r\n   * @abstract\r\n   */\r\n  end() {\r\n    throw new Error(createMessage(errorTypes.UN_IMPLEMENTATION, 'stop'));\r\n  }\r\n}\r\n\r\nexport default DrawingMode;\r\n","'use strict';\nvar global = require('../internals/global');\nvar getOwnPropertyDescriptor = require('../internals/object-get-own-property-descriptor').f;\nvar isForced = require('../internals/is-forced');\nvar path = require('../internals/path');\nvar bind = require('../internals/function-bind-context');\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\nvar has = require('../internals/has');\n\nvar wrapConstructor = function (NativeConstructor) {\n  var Wrapper = function (a, b, c) {\n    if (this instanceof NativeConstructor) {\n      switch (arguments.length) {\n        case 0: return new NativeConstructor();\n        case 1: return new NativeConstructor(a);\n        case 2: return new NativeConstructor(a, b);\n      } return new NativeConstructor(a, b, c);\n    } return NativeConstructor.apply(this, arguments);\n  };\n  Wrapper.prototype = NativeConstructor.prototype;\n  return Wrapper;\n};\n\n/*\n  options.target      - name of the target object\n  options.global      - target is the global object\n  options.stat        - export as static methods of target\n  options.proto       - export as prototype methods of target\n  options.real        - real prototype method for the `pure` version\n  options.forced      - export even if the native feature is available\n  options.bind        - bind methods to the target, required for the `pure` version\n  options.wrap        - wrap constructors to preventing global pollution, required for the `pure` version\n  options.unsafe      - use the simple assignment of property instead of delete + defineProperty\n  options.sham        - add a flag to not completely full polyfills\n  options.enumerable  - export as enumerable property\n  options.noTargetGet - prevent calling a getter on target\n*/\nmodule.exports = function (options, source) {\n  var TARGET = options.target;\n  var GLOBAL = options.global;\n  var STATIC = options.stat;\n  var PROTO = options.proto;\n\n  var nativeSource = GLOBAL ? global : STATIC ? global[TARGET] : (global[TARGET] || {}).prototype;\n\n  var target = GLOBAL ? path : path[TARGET] || (path[TARGET] = {});\n  var targetPrototype = target.prototype;\n\n  var FORCED, USE_NATIVE, VIRTUAL_PROTOTYPE;\n  var key, sourceProperty, targetProperty, nativeProperty, resultProperty, descriptor;\n\n  for (key in source) {\n    FORCED = isForced(GLOBAL ? key : TARGET + (STATIC ? '.' : '#') + key, options.forced);\n    // contains in native\n    USE_NATIVE = !FORCED && nativeSource && has(nativeSource, key);\n\n    targetProperty = target[key];\n\n    if (USE_NATIVE) if (options.noTargetGet) {\n      descriptor = getOwnPropertyDescriptor(nativeSource, key);\n      nativeProperty = descriptor && descriptor.value;\n    } else nativeProperty = nativeSource[key];\n\n    // export native or implementation\n    sourceProperty = (USE_NATIVE && nativeProperty) ? nativeProperty : source[key];\n\n    if (USE_NATIVE && typeof targetProperty === typeof sourceProperty) continue;\n\n    // bind timers to global for call from export context\n    if (options.bind && USE_NATIVE) resultProperty = bind(sourceProperty, global);\n    // wrap global constructors for prevent changs in this version\n    else if (options.wrap && USE_NATIVE) resultProperty = wrapConstructor(sourceProperty);\n    // make static versions for prototype methods\n    else if (PROTO && typeof sourceProperty == 'function') resultProperty = bind(Function.call, sourceProperty);\n    // default case\n    else resultProperty = sourceProperty;\n\n    // add a flag to not completely full polyfills\n    if (options.sham || (sourceProperty && sourceProperty.sham) || (targetProperty && targetProperty.sham)) {\n      createNonEnumerableProperty(resultProperty, 'sham', true);\n    }\n\n    target[key] = resultProperty;\n\n    if (PROTO) {\n      VIRTUAL_PROTOTYPE = TARGET + 'Prototype';\n      if (!has(path, VIRTUAL_PROTOTYPE)) {\n        createNonEnumerableProperty(path, VIRTUAL_PROTOTYPE, {});\n      }\n      // export virtual prototype methods\n      path[VIRTUAL_PROTOTYPE][key] = sourceProperty;\n      // export real prototype methods\n      if (options.real && targetPrototype && !targetPrototype[key]) {\n        createNonEnumerableProperty(targetPrototype, key, sourceProperty);\n      }\n    }\n  }\n};\n","module.exports = function (it) {\n  return typeof it === 'object' ? it !== null : typeof it === 'function';\n};\n","var fails = require('../internals/fails');\n\n// Detect IE8's incomplete defineProperty implementation\nmodule.exports = !fails(function () {\n  // eslint-disable-next-line es/no-object-defineproperty -- required for testing\n  return Object.defineProperty({}, 1, { get: function () { return 7; } })[1] != 7;\n});\n","module.exports = function (it) {\n  if (typeof it != 'function') {\n    throw TypeError(String(it) + ' is not a function');\n  } return it;\n};\n","var path = require('../internals/path');\nvar global = require('../internals/global');\n\nvar aFunction = function (variable) {\n  return typeof variable == 'function' ? variable : undefined;\n};\n\nmodule.exports = function (namespace, method) {\n  return arguments.length < 2 ? aFunction(path[namespace]) || aFunction(global[namespace])\n    : path[namespace] && path[namespace][method] || global[namespace] && global[namespace][method];\n};\n","module.exports = {};\n","module.exports = true;\n","'use strict';\nvar aFunction = require('../internals/a-function');\n\nvar PromiseCapability = function (C) {\n  var resolve, reject;\n  this.promise = new C(function ($$resolve, $$reject) {\n    if (resolve !== undefined || reject !== undefined) throw TypeError('Bad Promise constructor');\n    resolve = $$resolve;\n    reject = $$reject;\n  });\n  this.resolve = aFunction(resolve);\n  this.reject = aFunction(reject);\n};\n\n// 25.4.1.5 NewPromiseCapability(C)\nmodule.exports.f = function (C) {\n  return new PromiseCapability(C);\n};\n","module.exports = function (bitmap, value) {\n  return {\n    enumerable: !(bitmap & 1),\n    configurable: !(bitmap & 2),\n    writable: !(bitmap & 4),\n    value: value\n  };\n};\n","// toObject with fallback for non-array-like ES3 strings\nvar IndexedObject = require('../internals/indexed-object');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\n\nmodule.exports = function (it) {\n  return IndexedObject(requireObjectCoercible(it));\n};\n","var DESCRIPTORS = require('../internals/descriptors');\nvar IE8_DOM_DEFINE = require('../internals/ie8-dom-define');\nvar anObject = require('../internals/an-object');\nvar toPrimitive = require('../internals/to-primitive');\n\n// eslint-disable-next-line es/no-object-defineproperty -- safe\nvar $defineProperty = Object.defineProperty;\n\n// `Object.defineProperty` method\n// https://tc39.es/ecma262/#sec-object.defineproperty\nexports.f = DESCRIPTORS ? $defineProperty : function defineProperty(O, P, Attributes) {\n  anObject(O);\n  P = toPrimitive(P, true);\n  anObject(Attributes);\n  if (IE8_DOM_DEFINE) try {\n    return $defineProperty(O, P, Attributes);\n  } catch (error) { /* empty */ }\n  if ('get' in Attributes || 'set' in Attributes) throw TypeError('Accessors not supported');\n  if ('value' in Attributes) O[P] = Attributes.value;\n  return O;\n};\n","var anObject = require('../internals/an-object');\nvar isArrayIteratorMethod = require('../internals/is-array-iterator-method');\nvar toLength = require('../internals/to-length');\nvar bind = require('../internals/function-bind-context');\nvar getIteratorMethod = require('../internals/get-iterator-method');\nvar iteratorClose = require('../internals/iterator-close');\n\nvar Result = function (stopped, result) {\n  this.stopped = stopped;\n  this.result = result;\n};\n\nmodule.exports = function (iterable, unboundFunction, options) {\n  var that = options && options.that;\n  var AS_ENTRIES = !!(options && options.AS_ENTRIES);\n  var IS_ITERATOR = !!(options && options.IS_ITERATOR);\n  var INTERRUPTED = !!(options && options.INTERRUPTED);\n  var fn = bind(unboundFunction, that, 1 + AS_ENTRIES + INTERRUPTED);\n  var iterator, iterFn, index, length, result, next, step;\n\n  var stop = function (condition) {\n    if (iterator) iteratorClose(iterator);\n    return new Result(true, condition);\n  };\n\n  var callFn = function (value) {\n    if (AS_ENTRIES) {\n      anObject(value);\n      return INTERRUPTED ? fn(value[0], value[1], stop) : fn(value[0], value[1]);\n    } return INTERRUPTED ? fn(value, stop) : fn(value);\n  };\n\n  if (IS_ITERATOR) {\n    iterator = iterable;\n  } else {\n    iterFn = getIteratorMethod(iterable);\n    if (typeof iterFn != 'function') throw TypeError('Target is not iterable');\n    // optimisation for array iterators\n    if (isArrayIteratorMethod(iterFn)) {\n      for (index = 0, length = toLength(iterable.length); length > index; index++) {\n        result = callFn(iterable[index]);\n        if (result && result instanceof Result) return result;\n      } return new Result(false);\n    }\n    iterator = iterFn.call(iterable);\n  }\n\n  next = iterator.next;\n  while (!(step = next.call(iterator)).done) {\n    try {\n      result = callFn(step.value);\n    } catch (error) {\n      iteratorClose(iterator);\n      throw error;\n    }\n    if (typeof result == 'object' && result && result instanceof Result) return result;\n  } return new Result(false);\n};\n","var createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\n\nmodule.exports = function (target, key, value, options) {\n  if (options && options.enumerable) target[key] = value;\n  else createNonEnumerableProperty(target, key, value);\n};\n","module.exports = function (exec) {\n  try {\n    return { error: false, value: exec() };\n  } catch (error) {\n    return { error: true, value: error };\n  }\n};\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Selection modification helper\r\n */\r\n\r\nimport { extend } from 'tui-code-snippet';\r\nimport fabric from 'fabric';\r\n\r\n/**\r\n * Cached selection's info\r\n * @type {Array}\r\n * @private\r\n */\r\nlet cachedUndoDataForChangeDimension = null;\r\n\r\n/**\r\n * Set cached undo data\r\n * @param {Array} undoData - selection object\r\n * @private\r\n */\r\nexport function setCachedUndoDataForDimension(undoData) {\r\n  cachedUndoDataForChangeDimension = undoData;\r\n}\r\n\r\n/**\r\n * Get cached undo data\r\n * @returns {Object} cached undo data\r\n * @private\r\n */\r\nexport function getCachedUndoDataForDimension() {\r\n  return cachedUndoDataForChangeDimension;\r\n}\r\n\r\n/**\r\n * Make undo data\r\n * @param {fabric.Object} obj - selection object\r\n * @param {Function} undoDatumMaker - make undo datum\r\n * @returns {Array} undoData\r\n * @private\r\n */\r\nexport function makeSelectionUndoData(obj, undoDatumMaker) {\r\n  let undoData;\r\n\r\n  if (obj.type === 'activeSelection') {\r\n    undoData = obj.getObjects().map((item) => {\r\n      const { angle, left, top, scaleX, scaleY, width, height } = item;\r\n\r\n      fabric.util.addTransformToObject(item, obj.calcTransformMatrix());\r\n      const result = undoDatumMaker(item);\r\n\r\n      item.set({\r\n        angle,\r\n        left,\r\n        top,\r\n        width,\r\n        height,\r\n        scaleX,\r\n        scaleY,\r\n      });\r\n\r\n      return result;\r\n    });\r\n  } else {\r\n    undoData = [undoDatumMaker(obj)];\r\n  }\r\n\r\n  return undoData;\r\n}\r\n\r\n/**\r\n * Make undo datum\r\n * @param {number} objId - object id\r\n * @param {fabric.Object} obj - selection object\r\n * @param {boolean} isSelection - whether or not object is selection\r\n * @returns {Object} undo datum\r\n * @private\r\n */\r\nexport function makeSelectionUndoDatum(objId, obj, isSelection) {\r\n  return isSelection\r\n    ? {\r\n        objId,\r\n        width: obj.width,\r\n        height: obj.height,\r\n        top: obj.top,\r\n        left: obj.left,\r\n        angle: obj.angle,\r\n        scaleX: obj.scaleX,\r\n        scaleY: obj.scaleY,\r\n      }\r\n    : extend({ objId }, obj);\r\n}\r\n","var toString = {}.toString;\n\nmodule.exports = function (it) {\n  return toString.call(it).slice(8, -1);\n};\n","// `RequireObjectCoercible` abstract operation\n// https://tc39.es/ecma262/#sec-requireobjectcoercible\nmodule.exports = function (it) {\n  if (it == undefined) throw TypeError(\"Can't call method on \" + it);\n  return it;\n};\n","var global = require('../internals/global');\nvar isObject = require('../internals/is-object');\n\nvar document = global.document;\n// typeof document.createElement is 'object' in old IE\nvar EXISTS = isObject(document) && isObject(document.createElement);\n\nmodule.exports = function (it) {\n  return EXISTS ? document.createElement(it) : {};\n};\n","module.exports = {};\n","var aFunction = require('../internals/a-function');\n\n// optional / simple context binding\nmodule.exports = function (fn, that, length) {\n  aFunction(fn);\n  if (that === undefined) return fn;\n  switch (length) {\n    case 0: return function () {\n      return fn.call(that);\n    };\n    case 1: return function (a) {\n      return fn.call(that, a);\n    };\n    case 2: return function (a, b) {\n      return fn.call(that, a, b);\n    };\n    case 3: return function (a, b, c) {\n      return fn.call(that, a, b, c);\n    };\n  }\n  return function (/* ...args */) {\n    return fn.apply(that, arguments);\n  };\n};\n","var has = require('../internals/has');\nvar toObject = require('../internals/to-object');\nvar sharedKey = require('../internals/shared-key');\nvar CORRECT_PROTOTYPE_GETTER = require('../internals/correct-prototype-getter');\n\nvar IE_PROTO = sharedKey('IE_PROTO');\nvar ObjectPrototype = Object.prototype;\n\n// `Object.getPrototypeOf` method\n// https://tc39.es/ecma262/#sec-object.getprototypeof\n// eslint-disable-next-line es/no-object-getprototypeof -- safe\nmodule.exports = CORRECT_PROTOTYPE_GETTER ? Object.getPrototypeOf : function (O) {\n  O = toObject(O);\n  if (has(O, IE_PROTO)) return O[IE_PROTO];\n  if (typeof O.constructor == 'function' && O instanceof O.constructor) {\n    return O.constructor.prototype;\n  } return O instanceof Object ? ObjectPrototype : null;\n};\n","var shared = require('../internals/shared');\nvar uid = require('../internals/uid');\n\nvar keys = shared('keys');\n\nmodule.exports = function (key) {\n  return keys[key] || (keys[key] = uid(key));\n};\n","var global = require('../internals/global');\nvar setGlobal = require('../internals/set-global');\n\nvar SHARED = '__core-js_shared__';\nvar store = global[SHARED] || setGlobal(SHARED, {});\n\nmodule.exports = store;\n","/* eslint-disable no-proto -- safe */\nvar anObject = require('../internals/an-object');\nvar aPossiblePrototype = require('../internals/a-possible-prototype');\n\n// `Object.setPrototypeOf` method\n// https://tc39.es/ecma262/#sec-object.setprototypeof\n// Works with __proto__ only. Old v8 can't work with null proto objects.\n// eslint-disable-next-line es/no-object-setprototypeof -- safe\nmodule.exports = Object.setPrototypeOf || ('__proto__' in {} ? function () {\n  var CORRECT_SETTER = false;\n  var test = {};\n  var setter;\n  try {\n    // eslint-disable-next-line es/no-object-getownpropertydescriptor -- safe\n    setter = Object.getOwnPropertyDescriptor(Object.prototype, '__proto__').set;\n    setter.call(test, []);\n    CORRECT_SETTER = test instanceof Array;\n  } catch (error) { /* empty */ }\n  return function setPrototypeOf(O, proto) {\n    anObject(O);\n    aPossiblePrototype(proto);\n    if (CORRECT_SETTER) setter.call(O, proto);\n    else O.__proto__ = proto;\n    return O;\n  };\n}() : undefined);\n","var ceil = Math.ceil;\nvar floor = Math.floor;\n\n// `ToInteger` abstract operation\n// https://tc39.es/ecma262/#sec-tointeger\nmodule.exports = function (argument) {\n  return isNaN(argument = +argument) ? 0 : (argument > 0 ? floor : ceil)(argument);\n};\n","module.exports = {};\n","var getBuiltIn = require('../internals/get-built-in');\n\nmodule.exports = getBuiltIn('navigator', 'userAgent') || '';\n","var TO_STRING_TAG_SUPPORT = require('../internals/to-string-tag-support');\nvar classofRaw = require('../internals/classof-raw');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar TO_STRING_TAG = wellKnownSymbol('toStringTag');\n// ES3 wrong here\nvar CORRECT_ARGUMENTS = classofRaw(function () { return arguments; }()) == 'Arguments';\n\n// fallback for IE11 Script Access Denied error\nvar tryGet = function (it, key) {\n  try {\n    return it[key];\n  } catch (error) { /* empty */ }\n};\n\n// getting tag from ES6+ `Object.prototype.toString`\nmodule.exports = TO_STRING_TAG_SUPPORT ? classofRaw : function (it) {\n  var O, tag, result;\n  return it === undefined ? 'Undefined' : it === null ? 'Null'\n    // @@toStringTag case\n    : typeof (tag = tryGet(O = Object(it), TO_STRING_TAG)) == 'string' ? tag\n    // builtinTag case\n    : CORRECT_ARGUMENTS ? classofRaw(O)\n    // ES3 arguments fallback\n    : (result = classofRaw(O)) == 'Object' && typeof O.callee == 'function' ? 'Arguments' : result;\n};\n","var wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar TO_STRING_TAG = wellKnownSymbol('toStringTag');\nvar test = {};\n\ntest[TO_STRING_TAG] = 'z';\n\nmodule.exports = String(test) === '[object z]';\n","var TO_STRING_TAG_SUPPORT = require('../internals/to-string-tag-support');\nvar defineProperty = require('../internals/object-define-property').f;\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\nvar has = require('../internals/has');\nvar toString = require('../internals/object-to-string');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar TO_STRING_TAG = wellKnownSymbol('toStringTag');\n\nmodule.exports = function (it, TAG, STATIC, SET_METHOD) {\n  if (it) {\n    var target = STATIC ? it : it.prototype;\n    if (!has(target, TO_STRING_TAG)) {\n      defineProperty(target, TO_STRING_TAG, { configurable: true, value: TAG });\n    }\n    if (SET_METHOD && !TO_STRING_TAG_SUPPORT) {\n      createNonEnumerableProperty(target, 'toString', toString);\n    }\n  }\n};\n","var classof = require('../internals/classof-raw');\nvar global = require('../internals/global');\n\nmodule.exports = classof(global.process) == 'process';\n","var NATIVE_WEAK_MAP = require('../internals/native-weak-map');\nvar global = require('../internals/global');\nvar isObject = require('../internals/is-object');\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\nvar objectHas = require('../internals/has');\nvar shared = require('../internals/shared-store');\nvar sharedKey = require('../internals/shared-key');\nvar hiddenKeys = require('../internals/hidden-keys');\n\nvar OBJECT_ALREADY_INITIALIZED = 'Object already initialized';\nvar WeakMap = global.WeakMap;\nvar set, get, has;\n\nvar enforce = function (it) {\n  return has(it) ? get(it) : set(it, {});\n};\n\nvar getterFor = function (TYPE) {\n  return function (it) {\n    var state;\n    if (!isObject(it) || (state = get(it)).type !== TYPE) {\n      throw TypeError('Incompatible receiver, ' + TYPE + ' required');\n    } return state;\n  };\n};\n\nif (NATIVE_WEAK_MAP || shared.state) {\n  var store = shared.state || (shared.state = new WeakMap());\n  var wmget = store.get;\n  var wmhas = store.has;\n  var wmset = store.set;\n  set = function (it, metadata) {\n    if (wmhas.call(store, it)) throw new TypeError(OBJECT_ALREADY_INITIALIZED);\n    metadata.facade = it;\n    wmset.call(store, it, metadata);\n    return metadata;\n  };\n  get = function (it) {\n    return wmget.call(store, it) || {};\n  };\n  has = function (it) {\n    return wmhas.call(store, it);\n  };\n} else {\n  var STATE = sharedKey('state');\n  hiddenKeys[STATE] = true;\n  set = function (it, metadata) {\n    if (objectHas(it, STATE)) throw new TypeError(OBJECT_ALREADY_INITIALIZED);\n    metadata.facade = it;\n    createNonEnumerableProperty(it, STATE, metadata);\n    return metadata;\n  };\n  get = function (it) {\n    return objectHas(it, STATE) ? it[STATE] : {};\n  };\n  has = function (it) {\n    return objectHas(it, STATE);\n  };\n}\n\nmodule.exports = {\n  set: set,\n  get: get,\n  has: has,\n  enforce: enforce,\n  getterFor: getterFor\n};\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Error-message factory\r\n */\r\nimport snippet from 'tui-code-snippet';\r\nimport { keyMirror } from '@/util';\r\n\r\nconst types = keyMirror('UN_IMPLEMENTATION', 'NO_COMPONENT_NAME');\r\nconst messages = {\r\n  UN_IMPLEMENTATION: 'Should implement a method: ',\r\n  NO_COMPONENT_NAME: 'Should set a component name',\r\n};\r\nconst map = {\r\n  UN_IMPLEMENTATION(methodName) {\r\n    return messages.UN_IMPLEMENTATION + methodName;\r\n  },\r\n  NO_COMPONENT_NAME() {\r\n    return messages.NO_COMPONENT_NAME;\r\n  },\r\n};\r\n\r\nexport default {\r\n  types: snippet.extend({}, types),\r\n\r\n  create(type, ...args) {\r\n    type = type.toLowerCase();\r\n    const func = map[type];\r\n\r\n    return func(...args);\r\n  },\r\n};\r\n","'use strict';\nvar $ = require('../internals/export');\nvar getPrototypeOf = require('../internals/object-get-prototype-of');\nvar setPrototypeOf = require('../internals/object-set-prototype-of');\nvar create = require('../internals/object-create');\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\nvar createPropertyDescriptor = require('../internals/create-property-descriptor');\nvar iterate = require('../internals/iterate');\n\nvar $AggregateError = function AggregateError(errors, message) {\n  var that = this;\n  if (!(that instanceof $AggregateError)) return new $AggregateError(errors, message);\n  if (setPrototypeOf) {\n    // eslint-disable-next-line unicorn/error-message -- expected\n    that = setPrototypeOf(new Error(undefined), getPrototypeOf(that));\n  }\n  if (message !== undefined) createNonEnumerableProperty(that, 'message', String(message));\n  var errorsArray = [];\n  iterate(errors, errorsArray.push, { that: errorsArray });\n  createNonEnumerableProperty(that, 'errors', errorsArray);\n  return that;\n};\n\n$AggregateError.prototype = create(Error.prototype, {\n  constructor: createPropertyDescriptor(5, $AggregateError),\n  message: createPropertyDescriptor(5, ''),\n  name: createPropertyDescriptor(5, 'AggregateError')\n});\n\n// `AggregateError` constructor\n// https://tc39.es/ecma262/#sec-aggregate-error-constructor\n$({ global: true }, {\n  AggregateError: $AggregateError\n});\n","var DESCRIPTORS = require('../internals/descriptors');\nvar propertyIsEnumerableModule = require('../internals/object-property-is-enumerable');\nvar createPropertyDescriptor = require('../internals/create-property-descriptor');\nvar toIndexedObject = require('../internals/to-indexed-object');\nvar toPrimitive = require('../internals/to-primitive');\nvar has = require('../internals/has');\nvar IE8_DOM_DEFINE = require('../internals/ie8-dom-define');\n\n// eslint-disable-next-line es/no-object-getownpropertydescriptor -- safe\nvar $getOwnPropertyDescriptor = Object.getOwnPropertyDescriptor;\n\n// `Object.getOwnPropertyDescriptor` method\n// https://tc39.es/ecma262/#sec-object.getownpropertydescriptor\nexports.f = DESCRIPTORS ? $getOwnPropertyDescriptor : function getOwnPropertyDescriptor(O, P) {\n  O = toIndexedObject(O);\n  P = toPrimitive(P, true);\n  if (IE8_DOM_DEFINE) try {\n    return $getOwnPropertyDescriptor(O, P);\n  } catch (error) { /* empty */ }\n  if (has(O, P)) return createPropertyDescriptor(!propertyIsEnumerableModule.f.call(O, P), O[P]);\n};\n","var isObject = require('../internals/is-object');\n\n// `ToPrimitive` abstract operation\n// https://tc39.es/ecma262/#sec-toprimitive\n// instead of the ES6 spec version, we didn't implement @@toPrimitive case\n// and the second argument - flag - preferred type is a string\nmodule.exports = function (input, PREFERRED_STRING) {\n  if (!isObject(input)) return input;\n  var fn, val;\n  if (PREFERRED_STRING && typeof (fn = input.toString) == 'function' && !isObject(val = fn.call(input))) return val;\n  if (typeof (fn = input.valueOf) == 'function' && !isObject(val = fn.call(input))) return val;\n  if (!PREFERRED_STRING && typeof (fn = input.toString) == 'function' && !isObject(val = fn.call(input))) return val;\n  throw TypeError(\"Can't convert object to primitive value\");\n};\n","var requireObjectCoercible = require('../internals/require-object-coercible');\n\n// `ToObject` abstract operation\n// https://tc39.es/ecma262/#sec-toobject\nmodule.exports = function (argument) {\n  return Object(requireObjectCoercible(argument));\n};\n","var DESCRIPTORS = require('../internals/descriptors');\nvar fails = require('../internals/fails');\nvar createElement = require('../internals/document-create-element');\n\n// Thank's IE8 for his funny defineProperty\nmodule.exports = !DESCRIPTORS && !fails(function () {\n  // eslint-disable-next-line es/no-object-defineproperty -- requied for testing\n  return Object.defineProperty(createElement('div'), 'a', {\n    get: function () { return 7; }\n  }).a != 7;\n});\n","var fails = require('../internals/fails');\n\nvar replacement = /#|\\.prototype\\./;\n\nvar isForced = function (feature, detection) {\n  var value = data[normalize(feature)];\n  return value == POLYFILL ? true\n    : value == NATIVE ? false\n    : typeof detection == 'function' ? fails(detection)\n    : !!detection;\n};\n\nvar normalize = isForced.normalize = function (string) {\n  return String(string).replace(replacement, '.').toLowerCase();\n};\n\nvar data = isForced.data = {};\nvar NATIVE = isForced.NATIVE = 'N';\nvar POLYFILL = isForced.POLYFILL = 'P';\n\nmodule.exports = isForced;\n","var IS_PURE = require('../internals/is-pure');\nvar store = require('../internals/shared-store');\n\n(module.exports = function (key, value) {\n  return store[key] || (store[key] = value !== undefined ? value : {});\n})('versions', []).push({\n  version: '3.13.0',\n  mode: IS_PURE ? 'pure' : 'global',\n  copyright: ' 2021 Denis Pushkarev (zloirock.ru)'\n});\n","var id = 0;\nvar postfix = Math.random();\n\nmodule.exports = function (key) {\n  return 'Symbol(' + String(key === undefined ? '' : key) + ')_' + (++id + postfix).toString(36);\n};\n","var anObject = require('../internals/an-object');\nvar defineProperties = require('../internals/object-define-properties');\nvar enumBugKeys = require('../internals/enum-bug-keys');\nvar hiddenKeys = require('../internals/hidden-keys');\nvar html = require('../internals/html');\nvar documentCreateElement = require('../internals/document-create-element');\nvar sharedKey = require('../internals/shared-key');\n\nvar GT = '>';\nvar LT = '<';\nvar PROTOTYPE = 'prototype';\nvar SCRIPT = 'script';\nvar IE_PROTO = sharedKey('IE_PROTO');\n\nvar EmptyConstructor = function () { /* empty */ };\n\nvar scriptTag = function (content) {\n  return LT + SCRIPT + GT + content + LT + '/' + SCRIPT + GT;\n};\n\n// Create object with fake `null` prototype: use ActiveX Object with cleared prototype\nvar NullProtoObjectViaActiveX = function (activeXDocument) {\n  activeXDocument.write(scriptTag(''));\n  activeXDocument.close();\n  var temp = activeXDocument.parentWindow.Object;\n  activeXDocument = null; // avoid memory leak\n  return temp;\n};\n\n// Create object with fake `null` prototype: use iframe Object with cleared prototype\nvar NullProtoObjectViaIFrame = function () {\n  // Thrash, waste and sodomy: IE GC bug\n  var iframe = documentCreateElement('iframe');\n  var JS = 'java' + SCRIPT + ':';\n  var iframeDocument;\n  iframe.style.display = 'none';\n  html.appendChild(iframe);\n  // https://github.com/zloirock/core-js/issues/475\n  iframe.src = String(JS);\n  iframeDocument = iframe.contentWindow.document;\n  iframeDocument.open();\n  iframeDocument.write(scriptTag('document.F=Object'));\n  iframeDocument.close();\n  return iframeDocument.F;\n};\n\n// Check for document.domain and active x support\n// No need to use active x approach when document.domain is not set\n// see https://github.com/es-shims/es5-shim/issues/150\n// variation of https://github.com/kitcambridge/es5-shim/commit/4f738ac066346\n// avoid IE GC bug\nvar activeXDocument;\nvar NullProtoObject = function () {\n  try {\n    /* global ActiveXObject -- old IE */\n    activeXDocument = document.domain && new ActiveXObject('htmlfile');\n  } catch (error) { /* ignore */ }\n  NullProtoObject = activeXDocument ? NullProtoObjectViaActiveX(activeXDocument) : NullProtoObjectViaIFrame();\n  var length = enumBugKeys.length;\n  while (length--) delete NullProtoObject[PROTOTYPE][enumBugKeys[length]];\n  return NullProtoObject();\n};\n\nhiddenKeys[IE_PROTO] = true;\n\n// `Object.create` method\n// https://tc39.es/ecma262/#sec-object.create\nmodule.exports = Object.create || function create(O, Properties) {\n  var result;\n  if (O !== null) {\n    EmptyConstructor[PROTOTYPE] = anObject(O);\n    result = new EmptyConstructor();\n    EmptyConstructor[PROTOTYPE] = null;\n    // add \"__proto__\" for Object.getPrototypeOf polyfill\n    result[IE_PROTO] = O;\n  } else result = NullProtoObject();\n  return Properties === undefined ? result : defineProperties(result, Properties);\n};\n","var toInteger = require('../internals/to-integer');\n\nvar min = Math.min;\n\n// `ToLength` abstract operation\n// https://tc39.es/ecma262/#sec-tolength\nmodule.exports = function (argument) {\n  return argument > 0 ? min(toInteger(argument), 0x1FFFFFFFFFFFFF) : 0; // 2 ** 53 - 1 == 9007199254740991\n};\n","// IE8- don't enum bug keys\nmodule.exports = [\n  'constructor',\n  'hasOwnProperty',\n  'isPrototypeOf',\n  'propertyIsEnumerable',\n  'toLocaleString',\n  'toString',\n  'valueOf'\n];\n","var getBuiltIn = require('../internals/get-built-in');\n\nmodule.exports = getBuiltIn('document', 'documentElement');\n","/* eslint-disable es/no-symbol -- required for testing */\nvar V8_VERSION = require('../internals/engine-v8-version');\nvar fails = require('../internals/fails');\n\n// eslint-disable-next-line es/no-object-getownpropertysymbols -- required for testing\nmodule.exports = !!Object.getOwnPropertySymbols && !fails(function () {\n  return !String(Symbol()) ||\n    // Chrome 38 Symbol has incorrect toString conversion\n    // Chrome 38-40 symbols are not inherited from DOM collections prototypes to instances\n    !Symbol.sham && V8_VERSION && V8_VERSION < 41;\n});\n","var global = require('../internals/global');\nvar userAgent = require('../internals/engine-user-agent');\n\nvar process = global.process;\nvar versions = process && process.versions;\nvar v8 = versions && versions.v8;\nvar match, version;\n\nif (v8) {\n  match = v8.split('.');\n  version = match[0] < 4 ? 1 : match[0] + match[1];\n} else if (userAgent) {\n  match = userAgent.match(/Edge\\/(\\d+)/);\n  if (!match || match[1] >= 74) {\n    match = userAgent.match(/Chrome\\/(\\d+)/);\n    if (match) version = match[1];\n  }\n}\n\nmodule.exports = version && +version;\n","var global = require('../internals/global');\n\nmodule.exports = global.Promise;\n","var store = require('../internals/shared-store');\n\nvar functionToString = Function.toString;\n\n// this helper broken in `3.4.1-3.4.4`, so we can't use `shared` helper\nif (typeof store.inspectSource != 'function') {\n  store.inspectSource = function (it) {\n    return functionToString.call(it);\n  };\n}\n\nmodule.exports = store.inspectSource;\n","var anObject = require('../internals/an-object');\nvar aFunction = require('../internals/a-function');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar SPECIES = wellKnownSymbol('species');\n\n// `SpeciesConstructor` abstract operation\n// https://tc39.es/ecma262/#sec-speciesconstructor\nmodule.exports = function (O, defaultConstructor) {\n  var C = anObject(O).constructor;\n  var S;\n  return C === undefined || (S = anObject(C)[SPECIES]) == undefined ? defaultConstructor : aFunction(S);\n};\n","var global = require('../internals/global');\nvar fails = require('../internals/fails');\nvar bind = require('../internals/function-bind-context');\nvar html = require('../internals/html');\nvar createElement = require('../internals/document-create-element');\nvar IS_IOS = require('../internals/engine-is-ios');\nvar IS_NODE = require('../internals/engine-is-node');\n\nvar location = global.location;\nvar set = global.setImmediate;\nvar clear = global.clearImmediate;\nvar process = global.process;\nvar MessageChannel = global.MessageChannel;\nvar Dispatch = global.Dispatch;\nvar counter = 0;\nvar queue = {};\nvar ONREADYSTATECHANGE = 'onreadystatechange';\nvar defer, channel, port;\n\nvar run = function (id) {\n  // eslint-disable-next-line no-prototype-builtins -- safe\n  if (queue.hasOwnProperty(id)) {\n    var fn = queue[id];\n    delete queue[id];\n    fn();\n  }\n};\n\nvar runner = function (id) {\n  return function () {\n    run(id);\n  };\n};\n\nvar listener = function (event) {\n  run(event.data);\n};\n\nvar post = function (id) {\n  // old engines have not location.origin\n  global.postMessage(id + '', location.protocol + '//' + location.host);\n};\n\n// Node.js 0.9+ & IE10+ has setImmediate, otherwise:\nif (!set || !clear) {\n  set = function setImmediate(fn) {\n    var args = [];\n    var i = 1;\n    while (arguments.length > i) args.push(arguments[i++]);\n    queue[++counter] = function () {\n      // eslint-disable-next-line no-new-func -- spec requirement\n      (typeof fn == 'function' ? fn : Function(fn)).apply(undefined, args);\n    };\n    defer(counter);\n    return counter;\n  };\n  clear = function clearImmediate(id) {\n    delete queue[id];\n  };\n  // Node.js 0.8-\n  if (IS_NODE) {\n    defer = function (id) {\n      process.nextTick(runner(id));\n    };\n  // Sphere (JS game engine) Dispatch API\n  } else if (Dispatch && Dispatch.now) {\n    defer = function (id) {\n      Dispatch.now(runner(id));\n    };\n  // Browsers with MessageChannel, includes WebWorkers\n  // except iOS - https://github.com/zloirock/core-js/issues/624\n  } else if (MessageChannel && !IS_IOS) {\n    channel = new MessageChannel();\n    port = channel.port2;\n    channel.port1.onmessage = listener;\n    defer = bind(port.postMessage, port, 1);\n  // Browsers with postMessage, skip WebWorkers\n  // IE8 has postMessage, but it's sync & typeof its postMessage is 'object'\n  } else if (\n    global.addEventListener &&\n    typeof postMessage == 'function' &&\n    !global.importScripts &&\n    location && location.protocol !== 'file:' &&\n    !fails(post)\n  ) {\n    defer = post;\n    global.addEventListener('message', listener, false);\n  // IE8-\n  } else if (ONREADYSTATECHANGE in createElement('script')) {\n    defer = function (id) {\n      html.appendChild(createElement('script'))[ONREADYSTATECHANGE] = function () {\n        html.removeChild(this);\n        run(id);\n      };\n    };\n  // Rest old browsers\n  } else {\n    defer = function (id) {\n      setTimeout(runner(id), 0);\n    };\n  }\n}\n\nmodule.exports = {\n  set: set,\n  clear: clear\n};\n","var userAgent = require('../internals/engine-user-agent');\n\nmodule.exports = /(?:iphone|ipod|ipad).*applewebkit/i.test(userAgent);\n","var anObject = require('../internals/an-object');\nvar isObject = require('../internals/is-object');\nvar newPromiseCapability = require('../internals/new-promise-capability');\n\nmodule.exports = function (C, x) {\n  anObject(C);\n  if (isObject(x) && x.constructor === C) return x;\n  var promiseCapability = newPromiseCapability.f(C);\n  var resolve = promiseCapability.resolve;\n  resolve(x);\n  return promiseCapability.promise;\n};\n","'use strict';\nvar $ = require('../internals/export');\nvar aFunction = require('../internals/a-function');\nvar newPromiseCapabilityModule = require('../internals/new-promise-capability');\nvar perform = require('../internals/perform');\nvar iterate = require('../internals/iterate');\n\n// `Promise.allSettled` method\n// https://tc39.es/ecma262/#sec-promise.allsettled\n$({ target: 'Promise', stat: true }, {\n  allSettled: function allSettled(iterable) {\n    var C = this;\n    var capability = newPromiseCapabilityModule.f(C);\n    var resolve = capability.resolve;\n    var reject = capability.reject;\n    var result = perform(function () {\n      var promiseResolve = aFunction(C.resolve);\n      var values = [];\n      var counter = 0;\n      var remaining = 1;\n      iterate(iterable, function (promise) {\n        var index = counter++;\n        var alreadyCalled = false;\n        values.push(undefined);\n        remaining++;\n        promiseResolve.call(C, promise).then(function (value) {\n          if (alreadyCalled) return;\n          alreadyCalled = true;\n          values[index] = { status: 'fulfilled', value: value };\n          --remaining || resolve(values);\n        }, function (error) {\n          if (alreadyCalled) return;\n          alreadyCalled = true;\n          values[index] = { status: 'rejected', reason: error };\n          --remaining || resolve(values);\n        });\n      });\n      --remaining || resolve(values);\n    });\n    if (result.error) reject(result.value);\n    return capability.promise;\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar aFunction = require('../internals/a-function');\nvar getBuiltIn = require('../internals/get-built-in');\nvar newPromiseCapabilityModule = require('../internals/new-promise-capability');\nvar perform = require('../internals/perform');\nvar iterate = require('../internals/iterate');\n\nvar PROMISE_ANY_ERROR = 'No one promise resolved';\n\n// `Promise.any` method\n// https://tc39.es/ecma262/#sec-promise.any\n$({ target: 'Promise', stat: true }, {\n  any: function any(iterable) {\n    var C = this;\n    var capability = newPromiseCapabilityModule.f(C);\n    var resolve = capability.resolve;\n    var reject = capability.reject;\n    var result = perform(function () {\n      var promiseResolve = aFunction(C.resolve);\n      var errors = [];\n      var counter = 0;\n      var remaining = 1;\n      var alreadyResolved = false;\n      iterate(iterable, function (promise) {\n        var index = counter++;\n        var alreadyRejected = false;\n        errors.push(undefined);\n        remaining++;\n        promiseResolve.call(C, promise).then(function (value) {\n          if (alreadyRejected || alreadyResolved) return;\n          alreadyResolved = true;\n          resolve(value);\n        }, function (error) {\n          if (alreadyRejected || alreadyResolved) return;\n          alreadyRejected = true;\n          errors[index] = error;\n          --remaining || reject(new (getBuiltIn('AggregateError'))(errors, PROMISE_ANY_ERROR));\n        });\n      });\n      --remaining || reject(new (getBuiltIn('AggregateError'))(errors, PROMISE_ANY_ERROR));\n    });\n    if (result.error) reject(result.value);\n    return capability.promise;\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar createIteratorConstructor = require('../internals/create-iterator-constructor');\nvar getPrototypeOf = require('../internals/object-get-prototype-of');\nvar setPrototypeOf = require('../internals/object-set-prototype-of');\nvar setToStringTag = require('../internals/set-to-string-tag');\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\nvar redefine = require('../internals/redefine');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\nvar IS_PURE = require('../internals/is-pure');\nvar Iterators = require('../internals/iterators');\nvar IteratorsCore = require('../internals/iterators-core');\n\nvar IteratorPrototype = IteratorsCore.IteratorPrototype;\nvar BUGGY_SAFARI_ITERATORS = IteratorsCore.BUGGY_SAFARI_ITERATORS;\nvar ITERATOR = wellKnownSymbol('iterator');\nvar KEYS = 'keys';\nvar VALUES = 'values';\nvar ENTRIES = 'entries';\n\nvar returnThis = function () { return this; };\n\nmodule.exports = function (Iterable, NAME, IteratorConstructor, next, DEFAULT, IS_SET, FORCED) {\n  createIteratorConstructor(IteratorConstructor, NAME, next);\n\n  var getIterationMethod = function (KIND) {\n    if (KIND === DEFAULT && defaultIterator) return defaultIterator;\n    if (!BUGGY_SAFARI_ITERATORS && KIND in IterablePrototype) return IterablePrototype[KIND];\n    switch (KIND) {\n      case KEYS: return function keys() { return new IteratorConstructor(this, KIND); };\n      case VALUES: return function values() { return new IteratorConstructor(this, KIND); };\n      case ENTRIES: return function entries() { return new IteratorConstructor(this, KIND); };\n    } return function () { return new IteratorConstructor(this); };\n  };\n\n  var TO_STRING_TAG = NAME + ' Iterator';\n  var INCORRECT_VALUES_NAME = false;\n  var IterablePrototype = Iterable.prototype;\n  var nativeIterator = IterablePrototype[ITERATOR]\n    || IterablePrototype['@@iterator']\n    || DEFAULT && IterablePrototype[DEFAULT];\n  var defaultIterator = !BUGGY_SAFARI_ITERATORS && nativeIterator || getIterationMethod(DEFAULT);\n  var anyNativeIterator = NAME == 'Array' ? IterablePrototype.entries || nativeIterator : nativeIterator;\n  var CurrentIteratorPrototype, methods, KEY;\n\n  // fix native\n  if (anyNativeIterator) {\n    CurrentIteratorPrototype = getPrototypeOf(anyNativeIterator.call(new Iterable()));\n    if (IteratorPrototype !== Object.prototype && CurrentIteratorPrototype.next) {\n      if (!IS_PURE && getPrototypeOf(CurrentIteratorPrototype) !== IteratorPrototype) {\n        if (setPrototypeOf) {\n          setPrototypeOf(CurrentIteratorPrototype, IteratorPrototype);\n        } else if (typeof CurrentIteratorPrototype[ITERATOR] != 'function') {\n          createNonEnumerableProperty(CurrentIteratorPrototype, ITERATOR, returnThis);\n        }\n      }\n      // Set @@toStringTag to native iterators\n      setToStringTag(CurrentIteratorPrototype, TO_STRING_TAG, true, true);\n      if (IS_PURE) Iterators[TO_STRING_TAG] = returnThis;\n    }\n  }\n\n  // fix Array#{values, @@iterator}.name in V8 / FF\n  if (DEFAULT == VALUES && nativeIterator && nativeIterator.name !== VALUES) {\n    INCORRECT_VALUES_NAME = true;\n    defaultIterator = function values() { return nativeIterator.call(this); };\n  }\n\n  // define iterator\n  if ((!IS_PURE || FORCED) && IterablePrototype[ITERATOR] !== defaultIterator) {\n    createNonEnumerableProperty(IterablePrototype, ITERATOR, defaultIterator);\n  }\n  Iterators[NAME] = defaultIterator;\n\n  // export additional methods\n  if (DEFAULT) {\n    methods = {\n      values: getIterationMethod(VALUES),\n      keys: IS_SET ? defaultIterator : getIterationMethod(KEYS),\n      entries: getIterationMethod(ENTRIES)\n    };\n    if (FORCED) for (KEY in methods) {\n      if (BUGGY_SAFARI_ITERATORS || INCORRECT_VALUES_NAME || !(KEY in IterablePrototype)) {\n        redefine(IterablePrototype, KEY, methods[KEY]);\n      }\n    } else $({ target: NAME, proto: true, forced: BUGGY_SAFARI_ITERATORS || INCORRECT_VALUES_NAME }, methods);\n  }\n\n  return methods;\n};\n","'use strict';\nvar fails = require('../internals/fails');\nvar getPrototypeOf = require('../internals/object-get-prototype-of');\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\nvar has = require('../internals/has');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\nvar IS_PURE = require('../internals/is-pure');\n\nvar ITERATOR = wellKnownSymbol('iterator');\nvar BUGGY_SAFARI_ITERATORS = false;\n\nvar returnThis = function () { return this; };\n\n// `%IteratorPrototype%` object\n// https://tc39.es/ecma262/#sec-%iteratorprototype%-object\nvar IteratorPrototype, PrototypeOfArrayIteratorPrototype, arrayIterator;\n\n/* eslint-disable es/no-array-prototype-keys -- safe */\nif ([].keys) {\n  arrayIterator = [].keys();\n  // Safari 8 has buggy iterators w/o `next`\n  if (!('next' in arrayIterator)) BUGGY_SAFARI_ITERATORS = true;\n  else {\n    PrototypeOfArrayIteratorPrototype = getPrototypeOf(getPrototypeOf(arrayIterator));\n    if (PrototypeOfArrayIteratorPrototype !== Object.prototype) IteratorPrototype = PrototypeOfArrayIteratorPrototype;\n  }\n}\n\nvar NEW_ITERATOR_PROTOTYPE = IteratorPrototype == undefined || fails(function () {\n  var test = {};\n  // FF44- legacy iterators case\n  return IteratorPrototype[ITERATOR].call(test) !== test;\n});\n\nif (NEW_ITERATOR_PROTOTYPE) IteratorPrototype = {};\n\n// 25.1.2.1.1 %IteratorPrototype%[@@iterator]()\nif ((!IS_PURE || NEW_ITERATOR_PROTOTYPE) && !has(IteratorPrototype, ITERATOR)) {\n  createNonEnumerableProperty(IteratorPrototype, ITERATOR, returnThis);\n}\n\nmodule.exports = {\n  IteratorPrototype: IteratorPrototype,\n  BUGGY_SAFARI_ITERATORS: BUGGY_SAFARI_ITERATORS\n};\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Shape resize helper\r\n */\r\nconst DIVISOR = {\r\n  rect: 1,\r\n  circle: 2,\r\n  triangle: 1,\r\n};\r\nconst DIMENSION_KEYS = {\r\n  rect: {\r\n    w: 'width',\r\n    h: 'height',\r\n  },\r\n  circle: {\r\n    w: 'rx',\r\n    h: 'ry',\r\n  },\r\n  triangle: {\r\n    w: 'width',\r\n    h: 'height',\r\n  },\r\n};\r\n\r\n/**\r\n * Set the start point value to the shape object\r\n * @param {fabric.Object} shape - Shape object\r\n * @ignore\r\n */\r\nfunction setStartPoint(shape) {\r\n  const { originX, originY } = shape;\r\n  const originKey = originX.substring(0, 1) + originY.substring(0, 1);\r\n\r\n  shape.startPoint = shape.origins[originKey];\r\n}\r\n\r\n/**\r\n * Get the positions of ratated origin by the pointer value\r\n * @param {{x: number, y: number}} origin - Origin value\r\n * @param {{x: number, y: number}} pointer - Pointer value\r\n * @param {number} angle - Rotating angle\r\n * @returns {Object} Postions of origin\r\n * @ignore\r\n */\r\nfunction getPositionsOfRotatedOrigin(origin, pointer, angle) {\r\n  const sx = origin.x;\r\n  const sy = origin.y;\r\n  const px = pointer.x;\r\n  const py = pointer.y;\r\n  const r = (angle * Math.PI) / 180;\r\n  const rx = (px - sx) * Math.cos(r) - (py - sy) * Math.sin(r) + sx;\r\n  const ry = (px - sx) * Math.sin(r) + (py - sy) * Math.cos(r) + sy;\r\n\r\n  return {\r\n    originX: sx > rx ? 'right' : 'left',\r\n    originY: sy > ry ? 'bottom' : 'top',\r\n  };\r\n}\r\n\r\n/**\r\n * Whether the shape has the center origin or not\r\n * @param {fabric.Object} shape - Shape object\r\n * @returns {boolean} State\r\n * @ignore\r\n */\r\nfunction hasCenterOrigin(shape) {\r\n  return shape.originX === 'center' && shape.originY === 'center';\r\n}\r\n\r\n/**\r\n * Adjust the origin of shape by the start point\r\n * @param {{x: number, y: number}} pointer - Pointer value\r\n * @param {fabric.Object} shape - Shape object\r\n * @ignore\r\n */\r\nfunction adjustOriginByStartPoint(pointer, shape) {\r\n  const centerPoint = shape.getPointByOrigin('center', 'center');\r\n  const angle = -shape.angle;\r\n  const originPositions = getPositionsOfRotatedOrigin(centerPoint, pointer, angle);\r\n  const { originX, originY } = originPositions;\r\n  const origin = shape.getPointByOrigin(originX, originY);\r\n  const left = shape.left - (centerPoint.x - origin.x);\r\n  const top = shape.top - (centerPoint.y - origin.y);\r\n\r\n  shape.set({\r\n    originX,\r\n    originY,\r\n    left,\r\n    top,\r\n  });\r\n\r\n  shape.setCoords();\r\n}\r\n\r\n/**\r\n * Adjust the origin of shape by the moving pointer value\r\n * @param {{x: number, y: number}} pointer - Pointer value\r\n * @param {fabric.Object} shape - Shape object\r\n * @ignore\r\n */\r\nfunction adjustOriginByMovingPointer(pointer, shape) {\r\n  const origin = shape.startPoint;\r\n  const angle = -shape.angle;\r\n  const originPositions = getPositionsOfRotatedOrigin(origin, pointer, angle);\r\n  const { originX, originY } = originPositions;\r\n\r\n  shape.setPositionByOrigin(origin, originX, originY);\r\n  shape.setCoords();\r\n}\r\n\r\n/**\r\n * Adjust the dimension of shape on firing scaling event\r\n * @param {fabric.Object} shape - Shape object\r\n * @ignore\r\n */\r\nfunction adjustDimensionOnScaling(shape) {\r\n  const { type, scaleX, scaleY } = shape;\r\n  const dimensionKeys = DIMENSION_KEYS[type];\r\n  let width = shape[dimensionKeys.w] * scaleX;\r\n  let height = shape[dimensionKeys.h] * scaleY;\r\n\r\n  if (shape.isRegular) {\r\n    const maxScale = Math.max(scaleX, scaleY);\r\n\r\n    width = shape[dimensionKeys.w] * maxScale;\r\n    height = shape[dimensionKeys.h] * maxScale;\r\n  }\r\n\r\n  const options = {\r\n    hasControls: false,\r\n    hasBorders: false,\r\n    scaleX: 1,\r\n    scaleY: 1,\r\n  };\r\n\r\n  options[dimensionKeys.w] = width;\r\n  options[dimensionKeys.h] = height;\r\n\r\n  shape.set(options);\r\n}\r\n\r\n/**\r\n * Adjust the dimension of shape on firing mouse move event\r\n * @param {{x: number, y: number}} pointer - Pointer value\r\n * @param {fabric.Object} shape - Shape object\r\n * @ignore\r\n */\r\nfunction adjustDimensionOnMouseMove(pointer, shape) {\r\n  const { type, strokeWidth, startPoint: origin } = shape;\r\n  const divisor = DIVISOR[type];\r\n  const dimensionKeys = DIMENSION_KEYS[type];\r\n  const isTriangle = !!(shape.type === 'triangle');\r\n  const options = {};\r\n  let width = Math.abs(origin.x - pointer.x) / divisor;\r\n  let height = Math.abs(origin.y - pointer.y) / divisor;\r\n\r\n  if (width > strokeWidth) {\r\n    width -= strokeWidth / divisor;\r\n  }\r\n\r\n  if (height > strokeWidth) {\r\n    height -= strokeWidth / divisor;\r\n  }\r\n\r\n  if (shape.isRegular) {\r\n    width = height = Math.max(width, height);\r\n\r\n    if (isTriangle) {\r\n      height = (Math.sqrt(3) / 2) * width;\r\n    }\r\n  }\r\n\r\n  options[dimensionKeys.w] = width;\r\n  options[dimensionKeys.h] = height;\r\n\r\n  shape.set(options);\r\n}\r\n\r\nmodule.exports = {\r\n  /**\r\n   * Set each origin value to shape\r\n   * @param {fabric.Object} shape - Shape object\r\n   */\r\n  setOrigins(shape) {\r\n    const leftTopPoint = shape.getPointByOrigin('left', 'top');\r\n    const rightTopPoint = shape.getPointByOrigin('right', 'top');\r\n    const rightBottomPoint = shape.getPointByOrigin('right', 'bottom');\r\n    const leftBottomPoint = shape.getPointByOrigin('left', 'bottom');\r\n\r\n    shape.origins = {\r\n      lt: leftTopPoint,\r\n      rt: rightTopPoint,\r\n      rb: rightBottomPoint,\r\n      lb: leftBottomPoint,\r\n    };\r\n  },\r\n\r\n  /**\r\n   * Resize the shape\r\n   * @param {fabric.Object} shape - Shape object\r\n   * @param {{x: number, y: number}} pointer - Mouse pointer values on canvas\r\n   * @param {boolean} isScaling - Whether the resizing action is scaling or not\r\n   */\r\n  resize(shape, pointer, isScaling) {\r\n    if (hasCenterOrigin(shape)) {\r\n      adjustOriginByStartPoint(pointer, shape);\r\n      setStartPoint(shape);\r\n    }\r\n\r\n    if (isScaling) {\r\n      adjustDimensionOnScaling(shape, pointer);\r\n    } else {\r\n      adjustDimensionOnMouseMove(pointer, shape);\r\n    }\r\n\r\n    adjustOriginByMovingPointer(pointer, shape);\r\n  },\r\n\r\n  /**\r\n   * Adjust the origin position of shape to center\r\n   * @param {fabric.Object} shape - Shape object\r\n   */\r\n  adjustOriginToCenter(shape) {\r\n    const centerPoint = shape.getPointByOrigin('center', 'center');\r\n    const { originX, originY } = shape;\r\n    const origin = shape.getPointByOrigin(originX, originY);\r\n    const left = shape.left + (centerPoint.x - origin.x);\r\n    const top = shape.top + (centerPoint.y - origin.y);\r\n\r\n    shape.set({\r\n      hasControls: true,\r\n      hasBorders: true,\r\n      originX: 'center',\r\n      originY: 'center',\r\n      left,\r\n      top,\r\n    });\r\n\r\n    shape.setCoords(); // For left, top properties\r\n  },\r\n};\r\n","import '@/polyfill';\r\nimport ImageEditor from '@/imageEditor';\r\nimport '@css/index.styl';\r\n\r\n// commands\r\nimport '@/command/addIcon';\r\nimport '@/command/addImageObject';\r\nimport '@/command/addObject';\r\nimport '@/command/addShape';\r\nimport '@/command/addText';\r\nimport '@/command/applyFilter';\r\nimport '@/command/changeIconColor';\r\nimport '@/command/changeShape';\r\nimport '@/command/changeText';\r\nimport '@/command/changeTextStyle';\r\nimport '@/command/clearObjects';\r\nimport '@/command/flip';\r\nimport '@/command/loadImage';\r\nimport '@/command/loadJson';\r\nimport '@/command/removeFilter';\r\nimport '@/command/removeObject';\r\nimport '@/command/resizeCanvasDimension';\r\nimport '@/command/rotate';\r\nimport '@/command/setObjectProperties';\r\nimport '@/command/setObjectPosition';\r\nimport '@/command/changeSelection';\r\nimport '@/command/resize';\r\n\r\nmodule.exports = ImageEditor;\r\n","// https://developer.mozilla.org/en-US/docs/Web/API/Element/closest\r\n// Any copyright is dedicated to the Public Domain. http://creativecommons.org/publicdomain/zero/1.0/if (!Element.prototype.matches)\r\nElement.prototype.matches =\r\n  Element.prototype.msMatchesSelector || Element.prototype.webkitMatchesSelector;\r\n\r\nif (!Element.prototype.closest)\r\n  Element.prototype.closest = function (s) {\r\n    var el = this;\r\n    if (!document.documentElement.contains(el)) return null;\r\n    do {\r\n      if (el.matches(s)) return el;\r\n      el = el.parentElement || el.parentNode;\r\n    } while (el !== null && el.nodeType === 1);\r\n    return null;\r\n  };\r\n\r\n/*\r\n * classList.js: Cross-browser full element.classList implementation.\r\n * 1.1.20170427\r\n *\r\n * By Eli Grey, http://eligrey.com\r\n * License: Dedicated to the public domain.\r\n *   See https://github.com/eligrey/classList.js/blob/master/LICENSE.md\r\n */\r\n\r\n/*global self, document, DOMException */\r\n\r\n/*! @source http://purl.eligrey.com/github/classList.js/blob/master/classList.js */\r\n\r\nif ('document' in window.self) {\r\n  // Full polyfill for browsers with no classList support\r\n  // Including IE < Edge missing SVGElement.classList\r\n  if (\r\n    !('classList' in document.createElement('_')) ||\r\n    (document.createElementNS &&\r\n      !('classList' in document.createElementNS('http://www.w3.org/2000/svg', 'g')))\r\n  ) {\r\n    (function (view) {\r\n      'use strict';\r\n\r\n      if (!('Element' in view)) return;\r\n\r\n      var classListProp = 'classList',\r\n        protoProp = 'prototype',\r\n        elemCtrProto = view.Element[protoProp],\r\n        objCtr = Object,\r\n        strTrim =\r\n          String[protoProp].trim ||\r\n          function () {\r\n            return this.replace(/^\\s+|\\s+$/g, '');\r\n          },\r\n        arrIndexOf =\r\n          Array[protoProp].indexOf ||\r\n          function (item) {\r\n            var i = 0,\r\n              len = this.length;\r\n            for (; i < len; i++) {\r\n              if (i in this && this[i] === item) {\r\n                return i;\r\n              }\r\n            }\r\n            return -1;\r\n          },\r\n        // Vendors: please allow content code to instantiate DOMExceptions\r\n        DOMEx = function (type, message) {\r\n          this.name = type;\r\n          this.code = DOMException[type];\r\n          this.message = message;\r\n        },\r\n        checkTokenAndGetIndex = function (classList, token) {\r\n          if (token === '') {\r\n            throw new DOMEx('SYNTAX_ERR', 'An invalid or illegal string was specified');\r\n          }\r\n          if (/\\s/.test(token)) {\r\n            throw new DOMEx('INVALID_CHARACTER_ERR', 'String contains an invalid character');\r\n          }\r\n          return arrIndexOf.call(classList, token);\r\n        },\r\n        ClassList = function (elem) {\r\n          var trimmedClasses = strTrim.call(elem.getAttribute('class') || ''),\r\n            classes = trimmedClasses ? trimmedClasses.split(/\\s+/) : [],\r\n            i = 0,\r\n            len = classes.length;\r\n          for (; i < len; i++) {\r\n            this.push(classes[i]);\r\n          }\r\n          this._updateClassName = function () {\r\n            elem.setAttribute('class', this.toString());\r\n          };\r\n        },\r\n        classListProto = (ClassList[protoProp] = []),\r\n        classListGetter = function () {\r\n          return new ClassList(this);\r\n        };\r\n      // Most DOMException implementations don't allow calling DOMException's toString()\r\n      // on non-DOMExceptions. Error's toString() is sufficient here.\r\n      DOMEx[protoProp] = Error[protoProp];\r\n      classListProto.item = function (i) {\r\n        return this[i] || null;\r\n      };\r\n      classListProto.contains = function (token) {\r\n        token += '';\r\n        return checkTokenAndGetIndex(this, token) !== -1;\r\n      };\r\n      classListProto.add = function () {\r\n        var tokens = arguments,\r\n          i = 0,\r\n          l = tokens.length,\r\n          token,\r\n          updated = false;\r\n        do {\r\n          token = tokens[i] + '';\r\n          if (checkTokenAndGetIndex(this, token) === -1) {\r\n            this.push(token);\r\n            updated = true;\r\n          }\r\n        } while (++i < l);\r\n\r\n        if (updated) {\r\n          this._updateClassName();\r\n        }\r\n      };\r\n      classListProto.remove = function () {\r\n        var tokens = arguments,\r\n          i = 0,\r\n          l = tokens.length,\r\n          token,\r\n          updated = false,\r\n          index;\r\n        do {\r\n          token = tokens[i] + '';\r\n          index = checkTokenAndGetIndex(this, token);\r\n          while (index !== -1) {\r\n            this.splice(index, 1);\r\n            updated = true;\r\n            index = checkTokenAndGetIndex(this, token);\r\n          }\r\n        } while (++i < l);\r\n\r\n        if (updated) {\r\n          this._updateClassName();\r\n        }\r\n      };\r\n      classListProto.toggle = function (token, force) {\r\n        token += '';\r\n\r\n        var result = this.contains(token),\r\n          method = result ? force !== true && 'remove' : force !== false && 'add';\r\n        if (method) {\r\n          this[method](token);\r\n        }\r\n\r\n        if (force === true || force === false) {\r\n          return force;\r\n        } else {\r\n          return !result;\r\n        }\r\n      };\r\n      classListProto.toString = function () {\r\n        return this.join(' ');\r\n      };\r\n\r\n      if (objCtr.defineProperty) {\r\n        var classListPropDesc = {\r\n          get: classListGetter,\r\n          enumerable: true,\r\n          configurable: true,\r\n        };\r\n        try {\r\n          objCtr.defineProperty(elemCtrProto, classListProp, classListPropDesc);\r\n        } catch (ex) {\r\n          // IE 8 doesn't support enumerable:true\r\n          // adding undefined to fight this issue https://github.com/eligrey/classList.js/issues/36\r\n          // modernie IE8-MSW7 machine has IE8 8.0.6001.18702 and is affected\r\n          if (ex.number === undefined || ex.number === -0x7ff5ec54) {\r\n            classListPropDesc.enumerable = false;\r\n            objCtr.defineProperty(elemCtrProto, classListProp, classListPropDesc);\r\n          }\r\n        }\r\n      } else if (objCtr[protoProp].__defineGetter__) {\r\n        elemCtrProto.__defineGetter__(classListProp, classListGetter);\r\n      }\r\n    })(window.self);\r\n  }\r\n\r\n  // There is full or partial native classList support, so just check if we need\r\n  // to normalize the add/remove and toggle APIs.\r\n\r\n  (function () {\r\n    'use strict';\r\n\r\n    var testElement = document.createElement('_');\r\n\r\n    testElement.classList.add('c1', 'c2');\r\n\r\n    // Polyfill for IE 10/11 and Firefox <26, where classList.add and\r\n    // classList.remove exist but support only one argument at a time.\r\n    if (!testElement.classList.contains('c2')) {\r\n      var createMethod = function (method) {\r\n        var original = DOMTokenList.prototype[method];\r\n\r\n        DOMTokenList.prototype[method] = function (token) {\r\n          var i,\r\n            len = arguments.length;\r\n\r\n          for (i = 0; i < len; i++) {\r\n            token = arguments[i];\r\n            original.call(this, token);\r\n          }\r\n        };\r\n      };\r\n      createMethod('add');\r\n      createMethod('remove');\r\n    }\r\n\r\n    testElement.classList.toggle('c3', false);\r\n\r\n    // Polyfill for IE 10 and Firefox <24, where classList.toggle does not\r\n    // support the second argument.\r\n    if (testElement.classList.contains('c3')) {\r\n      var _toggle = DOMTokenList.prototype.toggle;\r\n\r\n      DOMTokenList.prototype.toggle = function (token, force) {\r\n        if (1 in arguments && !this.contains(token) === !force) {\r\n          return force;\r\n        } else {\r\n          return _toggle.call(this, token);\r\n        }\r\n      };\r\n    }\r\n\r\n    testElement = null;\r\n  })();\r\n}\r\n\r\n/*!\r\n * @copyright Copyright (c) 2017 IcoMoon.io\r\n * @license   Licensed under MIT license\r\n *            See https://github.com/Keyamoon/svgxuse\r\n * @version   1.2.6\r\n */\r\n/*jslint browser: true */\r\n/*global XDomainRequest, MutationObserver, window */\r\n(function () {\r\n  'use strict';\r\n  if (typeof window !== 'undefined' && window.addEventListener) {\r\n    var cache = Object.create(null); // holds xhr objects to prevent multiple requests\r\n    var checkUseElems;\r\n    var tid; // timeout id\r\n    var debouncedCheck = function () {\r\n      clearTimeout(tid);\r\n      tid = setTimeout(checkUseElems, 100);\r\n    };\r\n    var unobserveChanges = function () {\r\n      return;\r\n    };\r\n    var observeChanges = function () {\r\n      var observer;\r\n      window.addEventListener('resize', debouncedCheck, false);\r\n      window.addEventListener('orientationchange', debouncedCheck, false);\r\n      if (window.MutationObserver) {\r\n        observer = new MutationObserver(debouncedCheck);\r\n        observer.observe(document.documentElement, {\r\n          childList: true,\r\n          subtree: true,\r\n          attributes: true,\r\n        });\r\n        unobserveChanges = function () {\r\n          try {\r\n            observer.disconnect();\r\n            window.removeEventListener('resize', debouncedCheck, false);\r\n            window.removeEventListener('orientationchange', debouncedCheck, false);\r\n          } catch (ignore) {}\r\n        };\r\n      } else {\r\n        document.documentElement.addEventListener('DOMSubtreeModified', debouncedCheck, false);\r\n        unobserveChanges = function () {\r\n          document.documentElement.removeEventListener('DOMSubtreeModified', debouncedCheck, false);\r\n          window.removeEventListener('resize', debouncedCheck, false);\r\n          window.removeEventListener('orientationchange', debouncedCheck, false);\r\n        };\r\n      }\r\n    };\r\n    var createRequest = function (url) {\r\n      // In IE 9, cross origin requests can only be sent using XDomainRequest.\r\n      // XDomainRequest would fail if CORS headers are not set.\r\n      // Therefore, XDomainRequest should only be used with cross origin requests.\r\n      function getOrigin(loc) {\r\n        var a;\r\n        if (loc.protocol !== undefined) {\r\n          a = loc;\r\n        } else {\r\n          a = document.createElement('a');\r\n          a.href = loc;\r\n        }\r\n        return a.protocol.replace(/:/g, '') + a.host;\r\n      }\r\n      var Request;\r\n      var origin;\r\n      var origin2;\r\n      if (window.XMLHttpRequest) {\r\n        Request = new XMLHttpRequest();\r\n        origin = getOrigin(location);\r\n        origin2 = getOrigin(url);\r\n        if (Request.withCredentials === undefined && origin2 !== '' && origin2 !== origin) {\r\n          Request = XDomainRequest || undefined;\r\n        } else {\r\n          Request = XMLHttpRequest;\r\n        }\r\n      }\r\n      return Request;\r\n    };\r\n    var xlinkNS = 'http://www.w3.org/1999/xlink';\r\n    checkUseElems = function () {\r\n      var base;\r\n      var bcr;\r\n      var fallback = ''; // optional fallback URL in case no base path to SVG file was given and no symbol definition was found.\r\n      var hash;\r\n      var href;\r\n      var i;\r\n      var inProgressCount = 0;\r\n      var isHidden;\r\n      var Request;\r\n      var url;\r\n      var uses;\r\n      var xhr;\r\n      function observeIfDone() {\r\n        // If done with making changes, start watching for chagnes in DOM again\r\n        inProgressCount -= 1;\r\n        if (inProgressCount === 0) {\r\n          // if all xhrs were resolved\r\n          unobserveChanges(); // make sure to remove old handlers\r\n          observeChanges(); // watch for changes to DOM\r\n        }\r\n      }\r\n      function attrUpdateFunc(spec) {\r\n        return function () {\r\n          if (cache[spec.base] !== true) {\r\n            spec.useEl.setAttributeNS(xlinkNS, 'xlink:href', '#' + spec.hash);\r\n            if (spec.useEl.hasAttribute('href')) {\r\n              spec.useEl.setAttribute('href', '#' + spec.hash);\r\n            }\r\n          }\r\n        };\r\n      }\r\n      function onloadFunc(xhr) {\r\n        return function () {\r\n          var body = document.body;\r\n          var x = document.createElement('x');\r\n          var svg;\r\n          xhr.onload = null;\r\n          x.innerHTML = xhr.responseText;\r\n          svg = x.getElementsByTagName('svg')[0];\r\n          if (svg) {\r\n            svg.setAttribute('aria-hidden', 'true');\r\n            svg.style.position = 'absolute';\r\n            svg.style.width = 0;\r\n            svg.style.height = 0;\r\n            svg.style.overflow = 'hidden';\r\n            body.insertBefore(svg, body.firstChild);\r\n          }\r\n          observeIfDone();\r\n        };\r\n      }\r\n      function onErrorTimeout(xhr) {\r\n        return function () {\r\n          xhr.onerror = null;\r\n          xhr.ontimeout = null;\r\n          observeIfDone();\r\n        };\r\n      }\r\n      unobserveChanges(); // stop watching for changes to DOM\r\n      // find all use elements\r\n      uses = document.getElementsByTagName('use');\r\n      for (i = 0; i < uses.length; i += 1) {\r\n        try {\r\n          bcr = uses[i].getBoundingClientRect();\r\n        } catch (ignore) {\r\n          // failed to get bounding rectangle of the use element\r\n          bcr = false;\r\n        }\r\n        href =\r\n          uses[i].getAttribute('href') ||\r\n          uses[i].getAttributeNS(xlinkNS, 'href') ||\r\n          uses[i].getAttribute('xlink:href');\r\n        if (href && href.split) {\r\n          url = href.split('#');\r\n        } else {\r\n          url = ['', ''];\r\n        }\r\n        base = url[0];\r\n        hash = url[1];\r\n        isHidden = bcr && bcr.left === 0 && bcr.right === 0 && bcr.top === 0 && bcr.bottom === 0;\r\n        if (bcr && bcr.width === 0 && bcr.height === 0 && !isHidden) {\r\n          // the use element is empty\r\n          // if there is a reference to an external SVG, try to fetch it\r\n          // use the optional fallback URL if there is no reference to an external SVG\r\n          if (fallback && !base.length && hash && !document.getElementById(hash)) {\r\n            base = fallback;\r\n          }\r\n          if (uses[i].hasAttribute('href')) {\r\n            uses[i].setAttributeNS(xlinkNS, 'xlink:href', href);\r\n          }\r\n          if (base.length) {\r\n            // schedule updating xlink:href\r\n            xhr = cache[base];\r\n            if (xhr !== true) {\r\n              // true signifies that prepending the SVG was not required\r\n              setTimeout(\r\n                attrUpdateFunc({\r\n                  useEl: uses[i],\r\n                  base: base,\r\n                  hash: hash,\r\n                }),\r\n                0\r\n              );\r\n            }\r\n            if (xhr === undefined) {\r\n              Request = createRequest(base);\r\n              if (Request !== undefined) {\r\n                xhr = new Request();\r\n                cache[base] = xhr;\r\n                xhr.onload = onloadFunc(xhr);\r\n                xhr.onerror = onErrorTimeout(xhr);\r\n                xhr.ontimeout = onErrorTimeout(xhr);\r\n                xhr.open('GET', base);\r\n                xhr.send();\r\n                inProgressCount += 1;\r\n              }\r\n            }\r\n          }\r\n        } else {\r\n          if (!isHidden) {\r\n            if (cache[base] === undefined) {\r\n              // remember this URL if the use element was not empty and no request was sent\r\n              cache[base] = true;\r\n            } else if (cache[base].onload) {\r\n              // if it turns out that prepending the SVG is not necessary,\r\n              // abort the in-progress xhr.\r\n              cache[base].abort();\r\n              delete cache[base].onload;\r\n              cache[base] = true;\r\n            }\r\n          } else if (base.length && cache[base]) {\r\n            setTimeout(\r\n              attrUpdateFunc({\r\n                useEl: uses[i],\r\n                base: base,\r\n                hash: hash,\r\n              }),\r\n              0\r\n            );\r\n          }\r\n        }\r\n      }\r\n      uses = '';\r\n      inProgressCount += 1;\r\n      observeIfDone();\r\n    };\r\n    var winLoad;\r\n    winLoad = function () {\r\n      window.removeEventListener('load', winLoad, false); // to prevent memory leaks\r\n      tid = setTimeout(checkUseElems, 0);\r\n    };\r\n    if (document.readyState !== 'complete') {\r\n      // The load event fires when all resources have finished loading, which allows detecting whether SVG use elements are empty.\r\n      window.addEventListener('load', winLoad, false);\r\n    } else {\r\n      // No need to add a listener if the document is already loaded, initialize immediately.\r\n      winLoad();\r\n    }\r\n  }\r\n})();\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Image-editor application class\r\n */\r\nimport snippet from 'tui-code-snippet';\r\nimport Invoker from '@/invoker';\r\nimport commandFactory from '@/factory/command';\r\nimport Graphics from '@/graphics';\r\nimport { makeSelectionUndoData, makeSelectionUndoDatum } from '@/helper/selectionModifyHelper';\r\nimport { sendHostName, Promise, getObjectType } from '@/util';\r\nimport {\r\n  eventNames as events,\r\n  commandNames as commands,\r\n  keyCodes,\r\n  rejectMessages,\r\n  OBJ_TYPE,\r\n} from '@/consts';\r\n\r\nconst { isUndefined, forEach, CustomEvents } = snippet;\r\n\r\nconst {\r\n  MOUSE_DOWN,\r\n  MOUSE_UP,\r\n  MOUSE_MOVE,\r\n  MOUSE_WHEEL,\r\n  OBJECT_MOVED,\r\n  OBJECT_SCALED,\r\n  OBJECT_ACTIVATED,\r\n  OBJECT_ROTATED,\r\n  OBJECT_ADDED,\r\n  OBJECT_MODIFIED,\r\n  ADD_TEXT,\r\n  ADD_OBJECT,\r\n  TEXT_EDITING,\r\n  TEXT_CHANGED,\r\n  ICON_CREATE_RESIZE,\r\n  ICON_CREATE_END,\r\n  SELECTION_CLEARED,\r\n  SELECTION_CREATED,\r\n  ADD_OBJECT_AFTER,\r\n} = events;\r\n\r\n/**\r\n * Image filter result\r\n * @typedef {object} FilterResult\r\n * @property {string} type - filter type like 'mask', 'Grayscale' and so on\r\n * @property {string} action - action type like 'add', 'remove'\r\n */\r\n\r\n/**\r\n * Flip status\r\n * @typedef {object} FlipStatus\r\n * @property {boolean} flipX - x axis\r\n * @property {boolean} flipY - y axis\r\n * @property {Number} angle - angle\r\n */\r\n/**\r\n * Rotation status\r\n * @typedef {Number} RotateStatus\r\n * @property {Number} angle - angle\r\n */\r\n\r\n/**\r\n * Old and new Size\r\n * @typedef {object} SizeChange\r\n * @property {Number} oldWidth - old width\r\n * @property {Number} oldHeight - old height\r\n * @property {Number} newWidth - new width\r\n * @property {Number} newHeight - new height\r\n */\r\n\r\n/**\r\n * @typedef {string} ErrorMsg - {string} error message\r\n */\r\n\r\n/**\r\n * @typedef {object} ObjectProps - graphics object properties\r\n * @property {number} objId -  object id\r\n * @property {string} type - object type\r\n * @property {string} text - text content\r\n * @property {(string | number)} left - Left\r\n * @property {(string | number)} top - Top\r\n * @property {(string | number)} width - Width\r\n * @property {(string | number)} height - Height\r\n * @property {string} fill - Color\r\n * @property {string} stroke - Stroke\r\n * @property {(string | number)} strokeWidth - StrokeWidth\r\n * @property {string} fontFamily - Font type for text\r\n * @property {number} fontSize - Font Size\r\n * @property {string} fontStyle - Type of inclination (normal / italic)\r\n * @property {string} fontWeight - Type of thicker or thinner looking (normal / bold)\r\n * @property {string} textAlign - Type of text align (left / center / right)\r\n * @property {string} textDecoration - Type of line (underline / line-through / overline)\r\n */\r\n\r\n/**\r\n * Shape filter option\r\n * @typedef {object.<string, number>} ShapeFilterOption\r\n */\r\n\r\n/**\r\n * Shape filter option\r\n * @typedef {object} ShapeFillOption - fill option of shape\r\n * @property {string} type - fill type ('color' or 'filter')\r\n * @property {Array.<ShapeFillFilterOption>} [filter] - {@link ShapeFilterOption} List.\r\n *  only applies to filter types\r\n *  (ex: \\[\\{pixelate: 20\\}, \\{blur: 0.3\\}\\])\r\n * @property {string} [color] - Shape foreground color (ex: '#fff', 'transparent')\r\n */\r\n\r\n/**\r\n * Image editor\r\n * @class\r\n * @param {string|HTMLElement} wrapper - Wrapper's element or selector\r\n * @param {Object} [options] - Canvas max width & height of css\r\n *  @param {number} [options.includeUI] - Use the provided UI\r\n *    @param {Object} [options.includeUI.loadImage] - Basic editing image\r\n *      @param {string} options.includeUI.loadImage.path - image path\r\n *      @param {string} options.includeUI.loadImage.name - image name\r\n *    @param {Object} [options.includeUI.theme] - Theme object\r\n *    @param {Array} [options.includeUI.menu] - It can be selected when only specific menu is used, Default values are \\['crop', 'flip', 'rotate', 'draw', 'shape', 'icon', 'text', 'mask', 'filter'\\].\r\n *    @param {string} [options.includeUI.initMenu] - The first menu to be selected and started.\r\n *    @param {Object} [options.includeUI.uiSize] - ui size of editor\r\n *      @param {string} options.includeUI.uiSize.width - width of ui\r\n *      @param {string} options.includeUI.uiSize.height - height of ui\r\n *    @param {string} [options.includeUI.menuBarPosition=bottom] - Menu bar position('top', 'bottom', 'left', 'right')\r\n *  @param {number} options.cssMaxWidth - Canvas css-max-width\r\n *  @param {number} options.cssMaxHeight - Canvas css-max-height\r\n *  @param {Object} [options.selectionStyle] - selection style\r\n *  @param {string} [options.selectionStyle.cornerStyle] - selection corner style\r\n *  @param {number} [options.selectionStyle.cornerSize] - selection corner size\r\n *  @param {string} [options.selectionStyle.cornerColor] - selection corner color\r\n *  @param {string} [options.selectionStyle.cornerStrokeColor] = selection corner stroke color\r\n *  @param {boolean} [options.selectionStyle.transparentCorners] - selection corner transparent\r\n *  @param {number} [options.selectionStyle.lineWidth] - selection line width\r\n *  @param {string} [options.selectionStyle.borderColor] - selection border color\r\n *  @param {number} [options.selectionStyle.rotatingPointOffset] - selection rotating point length\r\n *  @param {Boolean} [options.usageStatistics=true] - Let us know the hostname. If you don't want to send the hostname, please set to false.\r\n * @example\r\n * var ImageEditor = require('tui-image-editor');\r\n * var blackTheme = require('./js/theme/black-theme.js');\r\n * var instance = new ImageEditor(document.querySelector('#tui-image-editor'), {\r\n *   includeUI: {\r\n *     loadImage: {\r\n *       path: 'img/sampleImage.jpg',\r\n *       name: 'SampleImage'\r\n *     },\r\n *     theme: blackTheme, // or whiteTheme\r\n *     menu: ['shape', 'filter'],\r\n *     initMenu: 'filter',\r\n *     uiSize: {\r\n *         width: '1000px',\r\n *         height: '700px'\r\n *     },\r\n *     menuBarPosition: 'bottom'\r\n *   },\r\n *   cssMaxWidth: 700,\r\n *   cssMaxHeight: 500,\r\n *   selectionStyle: {\r\n *     cornerSize: 20,\r\n *     rotatingPointOffset: 70\r\n *   }\r\n * });\r\n */\r\nclass ImageEditor {\r\n  constructor(wrapper, options) {\r\n    options = snippet.extend(\r\n      {\r\n        includeUI: false,\r\n        usageStatistics: true,\r\n      },\r\n      options\r\n    );\r\n\r\n    this.mode = null;\r\n\r\n    this.activeObjectId = null;\r\n\r\n    /**\r\n     * Invoker\r\n     * @type {Invoker}\r\n     * @private\r\n     */\r\n    this._invoker = new Invoker();\r\n\r\n    /**\r\n     * Graphics instance\r\n     * @type {Graphics}\r\n     * @private\r\n     */\r\n    this._graphics = new Graphics(wrapper, {\r\n      backgroundColor: options.backgroundColor ? options.backgroundColor : 'transparent',\r\n      cssMaxWidth: options.cssMaxWidth,\r\n      cssMaxHeight: options.cssMaxHeight,\r\n      preserveObjectStacking: options.preserveObjectStacking\r\n        ? options.preserveObjectStacking\r\n        : false,\r\n    });\r\n\r\n    /**\r\n     * Event handler list\r\n     * @type {Object}\r\n     * @private\r\n     */\r\n    this._handlers = {\r\n      keydown: this._onKeyDown.bind(this),\r\n      mousedown: this._onMouseDown.bind(this),\r\n      mouseup: this._onMouseUp.bind(this),\r\n      mousemove: this._onMouseMove.bind(this),\r\n      mousewheel: this._onMouseWheel.bind(this),\r\n      objectActivated: this._onObjectActivated.bind(this),\r\n      objectMoved: this._onObjectMoved.bind(this),\r\n      objectScaled: this._onObjectScaled.bind(this),\r\n      objectRotated: this._onObjectRotated.bind(this),\r\n      objectAdded: this._onObjectAdded.bind(this),\r\n      objectModified: this._onObjectModified.bind(this),\r\n      createdPath: this._onCreatedPath,\r\n      addText: this._onAddText.bind(this),\r\n      addObject: this._onAddObject.bind(this),\r\n      textEditing: this._onTextEditing.bind(this),\r\n      textChanged: this._onTextChanged.bind(this),\r\n      iconCreateResize: this._onIconCreateResize.bind(this),\r\n      iconCreateEnd: this._onIconCreateEnd.bind(this),\r\n      selectionCleared: this._selectionCleared.bind(this),\r\n      selectionCreated: this._selectionCreated.bind(this),\r\n    };\r\n\r\n    this._attachInvokerEvents();\r\n    this._attachGraphicsEvents();\r\n    this._attachDomEvents();\r\n    this._setSelectionStyle(options.selectionStyle, {\r\n      applyCropSelectionStyle: options.applyCropSelectionStyle,\r\n      applyGroupSelectionStyle: options.applyGroupSelectionStyle,\r\n    });\r\n\r\n    if (options.usageStatistics) {\r\n      sendHostName();\r\n    }\r\n    fabric.enableGLFiltering = false;\r\n  }\r\n\r\n  /**\r\n   * Set selection style by init option\r\n   * @param {Object} selectionStyle - Selection styles\r\n   * @param {Object} applyTargets - Selection apply targets\r\n   *   @param {boolean} applyCropSelectionStyle - whether apply with crop selection style or not\r\n   *   @param {boolean} applyGroupSelectionStyle - whether apply with group selection style or not\r\n   * @private\r\n   */\r\n  _setSelectionStyle(selectionStyle, { applyCropSelectionStyle, applyGroupSelectionStyle }) {\r\n    if (selectionStyle) {\r\n      this._graphics.setSelectionStyle(selectionStyle);\r\n    }\r\n\r\n    if (applyCropSelectionStyle) {\r\n      this._graphics.setCropSelectionStyle(selectionStyle);\r\n    }\r\n\r\n    if (applyGroupSelectionStyle) {\r\n      this.on('selectionCreated', (eventTarget) => {\r\n        if (eventTarget.type === 'activeSelection') {\r\n          eventTarget.set(selectionStyle);\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Attach invoker events\r\n   * @private\r\n   */\r\n  _attachInvokerEvents() {\r\n    const { UNDO_STACK_CHANGED, REDO_STACK_CHANGED } = events;\r\n\r\n    /**\r\n     * Undo stack changed event\r\n     * @event ImageEditor#undoStackChanged\r\n     * @param {Number} length - undo stack length\r\n     * @example\r\n     * imageEditor.on('undoStackChanged', function(length) {\r\n     *     console.log(length);\r\n     * });\r\n     */\r\n    this._invoker.on(UNDO_STACK_CHANGED, this.fire.bind(this, UNDO_STACK_CHANGED));\r\n    /**\r\n     * Redo stack changed event\r\n     * @event ImageEditor#redoStackChanged\r\n     * @param {Number} length - redo stack length\r\n     * @example\r\n     * imageEditor.on('redoStackChanged', function(length) {\r\n     *     console.log(length);\r\n     * });\r\n     */\r\n    this._invoker.on(REDO_STACK_CHANGED, this.fire.bind(this, REDO_STACK_CHANGED));\r\n  }\r\n\r\n  /**\r\n   * Attach canvas events\r\n   * @private\r\n   */\r\n  _attachGraphicsEvents() {\r\n    this._graphics.on({\r\n      [MOUSE_DOWN]: this._handlers.mousedown,\r\n      [MOUSE_UP]: this._handlers.mouseup,\r\n      [MOUSE_MOVE]: this._handlers.mousemove,\r\n      [MOUSE_WHEEL]: this._handlers.mousewheel,\r\n      [OBJECT_MOVED]: this._handlers.objectMoved,\r\n      [OBJECT_SCALED]: this._handlers.objectScaled,\r\n      [OBJECT_ROTATED]: this._handlers.objectRotated,\r\n      [OBJECT_ACTIVATED]: this._handlers.objectActivated,\r\n      [OBJECT_ADDED]: this._handlers.objectAdded,\r\n      [OBJECT_MODIFIED]: this._handlers.objectModified,\r\n      [ADD_TEXT]: this._handlers.addText,\r\n      [ADD_OBJECT]: this._handlers.addObject,\r\n      [TEXT_EDITING]: this._handlers.textEditing,\r\n      [TEXT_CHANGED]: this._handlers.textChanged,\r\n      [ICON_CREATE_RESIZE]: this._handlers.iconCreateResize,\r\n      [ICON_CREATE_END]: this._handlers.iconCreateEnd,\r\n      [SELECTION_CLEARED]: this._handlers.selectionCleared,\r\n      [SELECTION_CREATED]: this._handlers.selectionCreated,\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Attach dom events\r\n   * @private\r\n   */\r\n  _attachDomEvents() {\r\n    // ImageEditor supports IE 9 higher\r\n    document.addEventListener('keydown', this._handlers.keydown);\r\n  }\r\n\r\n  /**\r\n   * Detach dom events\r\n   * @private\r\n   */\r\n  _detachDomEvents() {\r\n    // ImageEditor supports IE 9 higher\r\n    document.removeEventListener('keydown', this._handlers.keydown);\r\n  }\r\n\r\n  /**\r\n   * Keydown event handler\r\n   * @param {KeyboardEvent} e - Event object\r\n   * @private\r\n   */\r\n  /* eslint-disable complexity */\r\n  _onKeyDown(e) {\r\n    const { ctrlKey, keyCode, metaKey } = e;\r\n    const isModifierKey = ctrlKey || metaKey;\r\n\r\n    if (isModifierKey) {\r\n      if (keyCode === keyCodes.C) {\r\n        this._graphics.resetTargetObjectForCopyPaste();\r\n      } else if (keyCode === keyCodes.V) {\r\n        this._graphics.pasteObject();\r\n        this.clearRedoStack();\r\n      } else if (keyCode === keyCodes.Z) {\r\n        // There is no error message on shortcut when it's empty\r\n        this.undo()['catch'](() => {});\r\n      } else if (keyCode === keyCodes.Y) {\r\n        // There is no error message on shortcut when it's empty\r\n        this.redo()['catch'](() => {});\r\n      }\r\n    }\r\n\r\n    const isDeleteKey = keyCode === keyCodes.BACKSPACE || keyCode === keyCodes.DEL;\r\n    const isRemoveReady = this._graphics.isReadyRemoveObject();\r\n\r\n    if (!this.isColorPickerInputBoxEditing && isRemoveReady && isDeleteKey) {\r\n      e.preventDefault();\r\n      this.removeActiveObject();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Remove Active Object\r\n   */\r\n  removeActiveObject() {\r\n    const activeObjectId = this._graphics.getActiveObjectIdForRemove();\r\n\r\n    this.removeObject(activeObjectId);\r\n  }\r\n\r\n  /**\r\n   * mouse down event handler\r\n   * @param {Event} event - mouse down event\r\n   * @param {Object} originPointer - origin pointer\r\n   *  @param {Number} originPointer.x x position\r\n   *  @param {Number} originPointer.y y position\r\n   * @private\r\n   */\r\n  _onMouseDown(event, originPointer) {\r\n    /**\r\n     * The mouse down event with position x, y on canvas\r\n     * @event ImageEditor#mousedown\r\n     * @param {Object} event - browser mouse event object\r\n     * @param {Object} originPointer origin pointer\r\n     *  @param {Number} originPointer.x x position\r\n     *  @param {Number} originPointer.y y position\r\n     * @example\r\n     * imageEditor.on('mousedown', function(event, originPointer) {\r\n     *     console.log(event);\r\n     *     console.log(originPointer);\r\n     *     if (imageEditor.hasFilter('colorFilter')) {\r\n     *         imageEditor.applyFilter('colorFilter', {\r\n     *             x: parseInt(originPointer.x, 10),\r\n     *             y: parseInt(originPointer.y, 10)\r\n     *         });\r\n     *     }\r\n     * });\r\n     */\r\n\r\n    this.fire(events.MOUSE_DOWN, event, originPointer);\r\n  }\r\n\r\n  _onMouseUp(event, originPointer) {\r\n    this.fire(events.MOUSE_UP, event, originPointer);\r\n  }\r\n\r\n  _onMouseMove(event, originPointer) {\r\n    this.fire(events.MOUSE_MOVE, event, originPointer);\r\n  }\r\n\r\n  _onMouseWheel(event, originPointer) {\r\n    this.fire(events.MOUSE_WHEEL, event, originPointer);\r\n  }\r\n\r\n  /**\r\n   * Add a 'addObject' command\r\n   * @param {Object} obj - Fabric object\r\n   * @private\r\n   */\r\n  _pushAddObjectCommand(obj) {\r\n    const command = commandFactory.create(commands.ADD_OBJECT, this._graphics, obj);\r\n    this._invoker.pushUndoStack(command);\r\n  }\r\n\r\n  /**\r\n   * Add a 'changeSelection' command\r\n   * @param {fabric.Object} obj - selection object\r\n   * @private\r\n   */\r\n  _pushModifyObjectCommand(obj) {\r\n    const { type } = obj;\r\n    const props = makeSelectionUndoData(obj, (item) =>\r\n      makeSelectionUndoDatum(this._graphics.getObjectId(item), item, type === 'activeSelection')\r\n    );\r\n    const command = commandFactory.create(commands.CHANGE_SELECTION, this._graphics, props);\r\n    command.execute(this._graphics, props);\r\n\r\n    this._invoker.pushUndoStack(command);\r\n  }\r\n\r\n  /**\r\n   * 'objectActivated' event handler\r\n   * @param {ObjectProps} props - object properties\r\n   * @private\r\n   */\r\n  _onObjectActivated(props) {\r\n    /**\r\n     * The event when object is selected(aka activated).\r\n     * @event ImageEditor#objectActivated\r\n     * @param {ObjectProps} objectProps - object properties\r\n     * @example\r\n     * imageEditor.on('objectActivated', function(props) {\r\n     *     console.log(props);\r\n     *     console.log(props.type);\r\n     *     console.log(props.objId);\r\n     * });\r\n     */\r\n    this.fire(events.OBJECT_ACTIVATED, props);\r\n  }\r\n\r\n  /**\r\n   * 'objectMoved' event handler\r\n   * @param {ObjectProps} props - object properties\r\n   * @private\r\n   */\r\n  _onObjectMoved(props) {\r\n    /**\r\n     * The event when object is moved\r\n     * @event ImageEditor#objectMoved\r\n     * @param {ObjectProps} props - object properties\r\n     * @example\r\n     * imageEditor.on('objectMoved', function(props) {\r\n     *     console.log(props);\r\n     *     console.log(props.type);\r\n     * });\r\n     */\r\n    this.fire(events.OBJECT_MOVED, props);\r\n  }\r\n\r\n  /**\r\n   * 'objectScaled' event handler\r\n   * @param {ObjectProps} props - object properties\r\n   * @private\r\n   */\r\n  _onObjectScaled(props) {\r\n    /**\r\n     * The event when scale factor is changed\r\n     * @event ImageEditor#objectScaled\r\n     * @param {ObjectProps} props - object properties\r\n     * @example\r\n     * imageEditor.on('objectScaled', function(props) {\r\n     *     console.log(props);\r\n     *     console.log(props.type);\r\n     * });\r\n     */\r\n    this.fire(events.OBJECT_SCALED, props);\r\n  }\r\n\r\n  /**\r\n   * 'objectRotated' event handler\r\n   * @param {ObjectProps} props - object properties\r\n   * @private\r\n   */\r\n  _onObjectRotated(props) {\r\n    /**\r\n     * The event when object angle is changed\r\n     * @event ImageEditor#objectRotated\r\n     * @param {ObjectProps} props - object properties\r\n     * @example\r\n     * imageEditor.on('objectRotated', function(props) {\r\n     *     console.log(props);\r\n     *     console.log(props.type);\r\n     * });\r\n     */\r\n    this.fire(events.OBJECT_ROTATED, props);\r\n  }\r\n\r\n  /**\r\n   * Get current drawing mode\r\n   * @returns {string}\r\n   * @example\r\n   * // Image editor drawing mode\r\n   * //\r\n   * //    NORMAL: 'NORMAL'\r\n   * //    CROPPER: 'CROPPER'\r\n   * //    FREE_DRAWING: 'FREE_DRAWING'\r\n   * //    LINE_DRAWING: 'LINE_DRAWING'\r\n   * //    TEXT: 'TEXT'\r\n   * //\r\n   * if (imageEditor.getDrawingMode() === 'FREE_DRAWING') {\r\n   *     imageEditor.stopDrawingMode();\r\n   * }\r\n   */\r\n  getDrawingMode() {\r\n    return this._graphics.getDrawingMode();\r\n  }\r\n\r\n  /**\r\n   * Clear all objects\r\n   * @returns {Promise}\r\n   * @example\r\n   * imageEditor.clearObjects();\r\n   */\r\n  clearObjects() {\r\n    return this.execute(commands.CLEAR_OBJECTS);\r\n  }\r\n\r\n  /**\r\n   * Deactivate all objects\r\n   * @example\r\n   * imageEditor.deactivateAll();\r\n   */\r\n  deactivateAll() {\r\n    this._graphics.deactivateAll();\r\n    this._graphics.renderAll();\r\n  }\r\n\r\n  /**\r\n   * discard selction\r\n   * @example\r\n   * imageEditor.discardSelection();\r\n   */\r\n  discardSelection() {\r\n    this._graphics.discardSelection();\r\n  }\r\n\r\n  /**\r\n   * selectable status change\r\n   * @param {boolean} selectable - selectable status\r\n   * @example\r\n   * imageEditor.changeSelectableAll(false); // or true\r\n   */\r\n  changeSelectableAll(selectable) {\r\n    this._graphics.changeSelectableAll(selectable);\r\n  }\r\n\r\n  /**\r\n   * Clear history\r\n   */\r\n  clearHistory() {\r\n    this._invoker.clearUndoStack();\r\n    this._invoker.clearRedoStack();\r\n  }\r\n\r\n  /**\r\n   * Invoke command\r\n   * @param {String} commandName - Command name\r\n   * @param {...*} args - Arguments for creating command\r\n   * @returns {Promise}\r\n   * @private\r\n   */\r\n  execute(commandName, ...args) {\r\n    // Inject an Graphics instance as first parameter\r\n    const theArgs = [this._graphics].concat(args);\r\n\r\n    return this._invoker.execute(commandName, ...theArgs);\r\n  }\r\n\r\n  /**\r\n   * Invoke command\r\n   * @param {String} commandName - Command name\r\n   * @param {...*} args - Arguments for creating command\r\n   * @returns {Promise}\r\n   * @private\r\n   */\r\n  executeSilent(commandName, ...args) {\r\n    // Inject an Graphics instance as first parameter\r\n    const theArgs = [this._graphics].concat(args);\r\n\r\n    return this._invoker.executeSilent(commandName, ...theArgs);\r\n  }\r\n\r\n  /**\r\n   * Undo\r\n   * @param {number} [iterationCount=1] - Iteration count of undo\r\n   * @returns {Promise}\r\n   * @example\r\n   * imageEditor.undo();\r\n   */\r\n  undo(iterationCount = 1) {\r\n    let promise = Promise.resolve();\r\n\r\n    for (let i = 0; i < iterationCount; i += 1) {\r\n      promise = promise.then(() => this._invoker.undo());\r\n    }\r\n\r\n    return promise;\r\n  }\r\n\r\n  /**\r\n   * Redo\r\n   * @param {number} [iterationCount=1] - Iteration count of redo\r\n   * @returns {Promise}\r\n   * @example\r\n   * imageEditor.redo();\r\n   */\r\n  redo(iterationCount = 1) {\r\n    let promise = Promise.resolve();\r\n\r\n    for (let i = 0; i < iterationCount; i += 1) {\r\n      promise = promise.then(() => this._invoker.redo());\r\n    }\r\n\r\n    return promise;\r\n  }\r\n\r\n  /**\r\n   * Zoom\r\n   * @param {number} x - x axis of center point for zoom\r\n   * @param {number} y - y axis of center point for zoom\r\n   * @param {number} zoomLevel - level of zoom(1.0 ~ 5.0)\r\n   */\r\n  zoom({ x, y, zoomLevel }) {\r\n    this._graphics.zoom({ x, y }, zoomLevel);\r\n  }\r\n\r\n  /**\r\n   * Reset zoom. Change zoom level to 1.0\r\n   */\r\n  resetZoom() {\r\n    this._graphics.resetZoom();\r\n  }\r\n\r\n  canvasZoom({ x, y, zoomLevel }) {\r\n    this._graphics.canvasZoom({ x, y, zoomLevel });\r\n  }\r\n\r\n  getCanvasZoom() {\r\n    return this._graphics.getCanvasZoom();\r\n  }\r\n\r\n  resetCanvasZoom() {\r\n    return this._graphics.canvasZoom(1.0);\r\n  }\r\n\r\n  /**\r\n   * Load image from file\r\n   * @param {File} imgFile - Image file\r\n   * @param {string} [imageName] - imageName\r\n   * @returns {Promise<SizeChange, ErrorMsg>}\r\n   * @example\r\n   * imageEditor.loadImageFromFile(file).then(result => {\r\n   *      console.log('old : ' + result.oldWidth + ', ' + result.oldHeight);\r\n   *      console.log('new : ' + result.newWidth + ', ' + result.newHeight);\r\n   * });\r\n   */\r\n  loadImageFromFile(imgFile, imageName) {\r\n    if (!imgFile) {\r\n      return Promise.reject(rejectMessages.invalidParameters);\r\n    }\r\n\r\n    const imgUrl = URL.createObjectURL(imgFile);\r\n    imageName = imageName || imgFile.name;\r\n\r\n    return this.loadImageFromURL(imgUrl, imageName).then((value) => {\r\n      URL.revokeObjectURL(imgFile);\r\n\r\n      return value;\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Load image from url\r\n   * @param {string} url - File url\r\n   * @param {string} imageName - imageName\r\n   * @returns {Promise<SizeChange, ErrorMsg>}\r\n   * @example\r\n   * imageEditor.loadImageFromURL('http://url/testImage.png', 'lena').then(result => {\r\n   *      console.log('old : ' + result.oldWidth + ', ' + result.oldHeight);\r\n   *      console.log('new : ' + result.newWidth + ', ' + result.newHeight);\r\n   * });\r\n   */\r\n  loadImageFromURL(url, imageName) {\r\n    if (!imageName || !url) {\r\n      return Promise.reject(rejectMessages.invalidParameters);\r\n    }\r\n\r\n    return this.execute(commands.LOAD_IMAGE, imageName, url);\r\n  }\r\n\r\n  /**\r\n   * Add image object on canvas\r\n   * @param {string} imgUrl - Image url to make object\r\n   * @returns {Promise<ObjectProps, ErrorMsg>}\r\n   * @example\r\n   * imageEditor.addImageObject('path/fileName.jpg').then(objectProps => {\r\n   *     console.log(ojectProps.objId);\r\n   * });\r\n   */\r\n  addImageObject(imgUrl) {\r\n    if (!imgUrl) {\r\n      return Promise.reject(rejectMessages.invalidParameters);\r\n    }\r\n\r\n    return this.execute(commands.ADD_IMAGE_OBJECT, imgUrl);\r\n  }\r\n\r\n  /**\r\n   * Start a drawing mode. If the current mode is not 'NORMAL', 'stopDrawingMode()' will be called first.\r\n   * @param {String} mode Can be one of <I>'CROPPER', 'FREE_DRAWING', 'LINE_DRAWING', 'TEXT', 'SHAPE'</I>\r\n   * @param {Object} [option] parameters of drawing mode, it's available with 'FREE_DRAWING', 'LINE_DRAWING'\r\n   *  @param {Number} [option.width] brush width\r\n   *  @param {String} [option.color] brush color\r\n   *  @param {Object} [option.arrowType] arrow decorate\r\n   *    @param {string} [option.arrowType.tail] arrow decorate for tail. 'chevron' or 'triangle'\r\n   *    @param {string} [option.arrowType.head] arrow decorate for head. 'chevron' or 'triangle'\r\n   * @returns {boolean} true if success or false\r\n   * @example\r\n   * imageEditor.startDrawingMode('FREE_DRAWING', {\r\n   *      width: 10,\r\n   *      color: 'rgba(255,0,0,0.5)'\r\n   * });\r\n   * imageEditor.startDrawingMode('LINE_DRAWING', {\r\n   *      width: 10,\r\n   *      color: 'rgba(255,0,0,0.5)',\r\n   *      arrowType: {\r\n   *          tail: 'chevron' // triangle\r\n   *      }\r\n   * });\r\n   *\r\n   */\r\n  startDrawingMode(mode, option) {\r\n    return this._graphics.startDrawingMode(mode, option);\r\n  }\r\n\r\n  /**\r\n   * Stop the current drawing mode and back to the 'NORMAL' mode\r\n   * @example\r\n   * imageEditor.stopDrawingMode();\r\n   */\r\n  stopDrawingMode() {\r\n    this._graphics.stopDrawingMode();\r\n  }\r\n\r\n  /**\r\n   * Crop this image with rect\r\n   * @param {Object} rect crop rect\r\n   *  @param {Number} rect.left left position\r\n   *  @param {Number} rect.top top position\r\n   *  @param {Number} rect.width width\r\n   *  @param {Number} rect.height height\r\n   * @returns {Promise}\r\n   * @example\r\n   * imageEditor.crop(imageEditor.getCropzoneRect());\r\n   */\r\n  crop(rect) {\r\n    const data = this._graphics.getCroppedImageData(rect);\r\n    if (!data) {\r\n      return Promise.reject(rejectMessages.invalidParameters);\r\n    }\r\n\r\n    return this.loadImageFromURL(data.url, data.imageName);\r\n  }\r\n\r\n  /**\r\n   * Get the cropping rect\r\n   * @returns {Object}  {{left: number, top: number, width: number, height: number}} rect\r\n   */\r\n  getCropzoneRect() {\r\n    return this._graphics.getCropzoneRect();\r\n  }\r\n\r\n  /**\r\n   * Set the cropping rect\r\n   * @param {number} [mode] crop rect mode [1, 1.5, 1.3333333333333333, 1.25, 1.7777777777777777]\r\n   */\r\n  setCropzoneRect(mode) {\r\n    this._graphics.setCropzoneRect(mode);\r\n  }\r\n\r\n  /**\r\n   * Flip\r\n   * @returns {Promise}\r\n   * @param {string} type - 'flipX' or 'flipY' or 'reset'\r\n   * @returns {Promise<FlipStatus, ErrorMsg>}\r\n   * @private\r\n   */\r\n  _flip(type) {\r\n    return this.execute(commands.FLIP_IMAGE, type);\r\n  }\r\n\r\n  /**\r\n   * Flip x\r\n   * @returns {Promise<FlipStatus, ErrorMsg>}\r\n   * @example\r\n   * imageEditor.flipX().then((status => {\r\n   *     console.log('flipX: ', status.flipX);\r\n   *     console.log('flipY: ', status.flipY);\r\n   *     console.log('angle: ', status.angle);\r\n   * }).catch(message => {\r\n   *     console.log('error: ', message);\r\n   * });\r\n   */\r\n  flipX() {\r\n    return this._flip('flipX');\r\n  }\r\n\r\n  /**\r\n   * Flip y\r\n   * @returns {Promise<FlipStatus, ErrorMsg>}\r\n   * @example\r\n   * imageEditor.flipY().then(status => {\r\n   *     console.log('flipX: ', status.flipX);\r\n   *     console.log('flipY: ', status.flipY);\r\n   *     console.log('angle: ', status.angle);\r\n   * }).catch(message => {\r\n   *     console.log('error: ', message);\r\n   * });\r\n   */\r\n  flipY() {\r\n    return this._flip('flipY');\r\n  }\r\n\r\n  /**\r\n   * Reset flip\r\n   * @returns {Promise<FlipStatus, ErrorMsg>}\r\n   * @example\r\n   * imageEditor.resetFlip().then(status => {\r\n   *     console.log('flipX: ', status.flipX);\r\n   *     console.log('flipY: ', status.flipY);\r\n   *     console.log('angle: ', status.angle);\r\n   * }).catch(message => {\r\n   *     console.log('error: ', message);\r\n   * });;\r\n   */\r\n  resetFlip() {\r\n    return this._flip('reset');\r\n  }\r\n\r\n  /**\r\n   * @param {string} type - 'rotate' or 'setAngle'\r\n   * @param {number} angle - angle value (degree)\r\n   * @param {boolean} isSilent - is silent execution or not\r\n   * @returns {Promise<RotateStatus, ErrorMsg>}\r\n   * @private\r\n   */\r\n  _rotate(type, angle, isSilent) {\r\n    let result = null;\r\n\r\n    if (isSilent) {\r\n      result = this.executeSilent(commands.ROTATE_IMAGE, type, angle);\r\n    } else {\r\n      result = this.execute(commands.ROTATE_IMAGE, type, angle);\r\n    }\r\n\r\n    return result;\r\n  }\r\n\r\n  /**\r\n   * Rotate image\r\n   * @returns {Promise}\r\n   * @param {number} angle - Additional angle to rotate image\r\n   * @param {boolean} isSilent - is silent execution or not\r\n   * @returns {Promise<RotateStatus, ErrorMsg>}\r\n   * @example\r\n   * imageEditor.rotate(10); // angle = 10\r\n   * imageEditor.rotate(10); // angle = 20\r\n   * imageEditor.rotate(5); // angle = 5\r\n   * imageEditor.rotate(-95); // angle = -90\r\n   * imageEditor.rotate(10).then(status => {\r\n   *     console.log('angle: ', status.angle);\r\n   * })).catch(message => {\r\n   *     console.log('error: ', message);\r\n   * });\r\n   */\r\n  rotate(angle, isSilent) {\r\n    return this._rotate('rotate', angle, isSilent);\r\n  }\r\n\r\n  /**\r\n   * Set angle\r\n   * @param {number} angle - Angle of image\r\n   * @param {boolean} isSilent - is silent execution or not\r\n   * @returns {Promise<RotateStatus, ErrorMsg>}\r\n   * @example\r\n   * imageEditor.setAngle(10); // angle = 10\r\n   * imageEditor.rotate(10); // angle = 20\r\n   * imageEditor.setAngle(5); // angle = 5\r\n   * imageEditor.rotate(50); // angle = 55\r\n   * imageEditor.setAngle(-40); // angle = -40\r\n   * imageEditor.setAngle(10).then(status => {\r\n   *     console.log('angle: ', status.angle);\r\n   * })).catch(message => {\r\n   *     console.log('error: ', message);\r\n   * });\r\n   */\r\n  setAngle(angle, isSilent) {\r\n    return this._rotate('setAngle', angle, isSilent);\r\n  }\r\n\r\n  /**\r\n   * Set drawing brush\r\n   * @param {Object} option brush option\r\n   *  @param {Number} option.width width\r\n   *  @param {String} option.color color like 'FFFFFF', 'rgba(0, 0, 0, 0.5)'\r\n   * @example\r\n   * imageEditor.startDrawingMode('FREE_DRAWING');\r\n   * imageEditor.setBrush({\r\n   *     width: 12,\r\n   *     color: 'rgba(0, 0, 0, 0.5)'\r\n   * });\r\n   * imageEditor.setBrush({\r\n   *     width: 8,\r\n   *     color: 'FFFFFF'\r\n   * });\r\n   */\r\n  setBrush(option) {\r\n    this._graphics.setBrush(option);\r\n  }\r\n\r\n  /**\r\n   * Set states of current drawing shape\r\n   * @param {string} type - Shape type (ex: 'rect', 'circle', 'triangle')\r\n   * @param {Object} [options] - Shape options\r\n   *      @param {(ShapeFillOption | string)} [options.fill] - {@link ShapeFillOption} or\r\n   *        Shape foreground color (ex: '#fff', 'transparent')\r\n   *      @param {string} [options.stoke] - Shape outline color\r\n   *      @param {number} [options.strokeWidth] - Shape outline width\r\n   *      @param {number} [options.width] - Width value (When type option is 'rect', this options can use)\r\n   *      @param {number} [options.height] - Height value (When type option is 'rect', this options can use)\r\n   *      @param {number} [options.rx] - Radius x value (When type option is 'circle', this options can use)\r\n   *      @param {number} [options.ry] - Radius y value (When type option is 'circle', this options can use)\r\n   *      @param {number} [options.isRegular] - Whether resizing shape has 1:1 ratio or not\r\n   * @example\r\n   * imageEditor.setDrawingShape('rect', {\r\n   *     fill: 'red',\r\n   *     width: 100,\r\n   *     height: 200\r\n   * });\r\n   * @example\r\n   * imageEditor.setDrawingShape('rect', {\r\n   *     fill: {\r\n   *         type: 'filter',\r\n   *         filter: [{blur: 0.3}, {pixelate: 20}]\r\n   *     },\r\n   *     width: 100,\r\n   *     height: 200\r\n   * });\r\n   * @example\r\n   * imageEditor.setDrawingShape('circle', {\r\n   *     fill: 'transparent',\r\n   *     stroke: 'blue',\r\n   *     strokeWidth: 3,\r\n   *     rx: 10,\r\n   *     ry: 100\r\n   * });\r\n   * @example\r\n   * imageEditor.setDrawingShape('triangle', { // When resizing, the shape keep the 1:1 ratio\r\n   *     width: 1,\r\n   *     height: 1,\r\n   *     isRegular: true\r\n   * });\r\n   * @example\r\n   * imageEditor.setDrawingShape('circle', { // When resizing, the shape keep the 1:1 ratio\r\n   *     rx: 10,\r\n   *     ry: 10,\r\n   *     isRegular: true\r\n   * });\r\n   */\r\n  setDrawingShape(type, options) {\r\n    this._graphics.setDrawingShape(type, options);\r\n  }\r\n\r\n  setDrawingIcon(type, iconColor) {\r\n    this._graphics.setIconStyle(type, iconColor);\r\n  }\r\n\r\n  /**\r\n   * Add shape\r\n   * @param {string} type - Shape type (ex: 'rect', 'circle', 'triangle')\r\n   * @param {Object} options - Shape options\r\n   *      @param {(ShapeFillOption | string)} [options.fill] - {@link ShapeFillOption} or\r\n   *        Shape foreground color (ex: '#fff', 'transparent')\r\n   *      @param {string} [options.stroke] - Shape outline color\r\n   *      @param {number} [options.strokeWidth] - Shape outline width\r\n   *      @param {number} [options.width] - Width value (When type option is 'rect', this options can use)\r\n   *      @param {number} [options.height] - Height value (When type option is 'rect', this options can use)\r\n   *      @param {number} [options.rx] - Radius x value (When type option is 'circle', this options can use)\r\n   *      @param {number} [options.ry] - Radius y value (When type option is 'circle', this options can use)\r\n   *      @param {number} [options.left] - Shape x position\r\n   *      @param {number} [options.top] - Shape y position\r\n   *      @param {boolean} [options.isRegular] - Whether resizing shape has 1:1 ratio or not\r\n   * @returns {Promise<ObjectProps, ErrorMsg>}\r\n   * @example\r\n   * imageEditor.addShape('rect', {\r\n   *     fill: 'red',\r\n   *     stroke: 'blue',\r\n   *     strokeWidth: 3,\r\n   *     width: 100,\r\n   *     height: 200,\r\n   *     left: 10,\r\n   *     top: 10,\r\n   *     isRegular: true\r\n   * });\r\n   * @example\r\n   * imageEditor.addShape('circle', {\r\n   *     fill: 'red',\r\n   *     stroke: 'blue',\r\n   *     strokeWidth: 3,\r\n   *     rx: 10,\r\n   *     ry: 100,\r\n   *     isRegular: false\r\n   * }).then(objectProps => {\r\n   *     console.log(objectProps.objId);\r\n   * });\r\n   * @example\r\n   * imageEditor.addShape('rect', {\r\n   *     fill: {\r\n   *         type: 'filter',\r\n   *         filter: [{blur: 0.3}, {pixelate: 20}]\r\n   *     },\r\n   *     stroke: 'blue',\r\n   *     strokeWidth: 3,\r\n   *     rx: 10,\r\n   *     ry: 100,\r\n   *     isRegular: false\r\n   * }).then(objectProps => {\r\n   *     console.log(objectProps.objId);\r\n   * });\r\n   */\r\n  addShape(type, options) {\r\n    options = options || {};\r\n\r\n    this._setPositions(options);\r\n\r\n    return this.execute(commands.ADD_SHAPE, type, options);\r\n  }\r\n\r\n  /**\r\n   * Change shape\r\n   * @param {number} objId -  object id\r\n   * @param {Object} options - Shape options\r\n   *      @param {(ShapeFillOption | string)} [options.fill] - {@link ShapeFillOption} or\r\n   *        Shape foreground color (ex: '#fff', 'transparent')\r\n   *      @param {string} [options.stroke] - Shape outline color\r\n   *      @param {number} [options.strokeWidth] - Shape outline width\r\n   *      @param {number} [options.width] - Width value (When type option is 'rect', this options can use)\r\n   *      @param {number} [options.height] - Height value (When type option is 'rect', this options can use)\r\n   *      @param {number} [options.rx] - Radius x value (When type option is 'circle', this options can use)\r\n   *      @param {number} [options.ry] - Radius y value (When type option is 'circle', this options can use)\r\n   *      @param {boolean} [options.isRegular] - Whether resizing shape has 1:1 ratio or not\r\n   * @param {boolean} isSilent - is silent execution or not\r\n   * @returns {Promise}\r\n   * @example\r\n   * // call after selecting shape object on canvas\r\n   * imageEditor.changeShape(objId, { // change rectagle or triangle\r\n   *     fill: 'red',\r\n   *     stroke: 'blue',\r\n   *     strokeWidth: 3,\r\n   *     width: 100,\r\n   *     height: 200\r\n   * });\r\n   * @example\r\n   * // call after selecting shape object on canvas\r\n   * imageEditor.changeShape(objId, { // change circle\r\n   *     fill: 'red',\r\n   *     stroke: 'blue',\r\n   *     strokeWidth: 3,\r\n   *     rx: 10,\r\n   *     ry: 100\r\n   * });\r\n   */\r\n  changeShape(objId, options, isSilent) {\r\n    const executeMethodName = isSilent ? 'executeSilent' : 'execute';\r\n\r\n    return this[executeMethodName](commands.CHANGE_SHAPE, objId, options);\r\n  }\r\n\r\n  /**\r\n   * Add text on image\r\n   * @param {string} text - Initial input text\r\n   * @param {Object} [options] Options for generating text\r\n   *     @param {Object} [options.styles] Initial styles\r\n   *         @param {string} [options.styles.fill] Color\r\n   *         @param {string} [options.styles.fontFamily] Font type for text\r\n   *         @param {number} [options.styles.fontSize] Size\r\n   *         @param {string} [options.styles.fontStyle] Type of inclination (normal / italic)\r\n   *         @param {string} [options.styles.fontWeight] Type of thicker or thinner looking (normal / bold)\r\n   *         @param {string} [options.styles.textAlign] Type of text align (left / center / right)\r\n   *         @param {string} [options.styles.textDecoration] Type of line (underline / line-through / overline)\r\n   *     @param {{x: number, y: number}} [options.position] - Initial position\r\n   *     @param {boolean} [options.autofocus] - text autofocus, default is true\r\n   * @returns {Promise}\r\n   * @example\r\n   * imageEditor.addText('init text');\r\n   * @example\r\n   * imageEditor.addText('init text', {\r\n   *     styles: {\r\n   *         fill: '#000',\r\n   *         fontSize: 20,\r\n   *         fontWeight: 'bold'\r\n   *     },\r\n   *     position: {\r\n   *         x: 10,\r\n   *         y: 10\r\n   *     }\r\n   * }).then(objectProps => {\r\n   *     console.log(objectProps.objId);\r\n   * });\r\n   */\r\n  addText(text, options) {\r\n    text = text || '';\r\n    options = options || {};\r\n\r\n    return this.execute(commands.ADD_TEXT, text, options);\r\n  }\r\n\r\n  /**\r\n   * Change contents of selected text object on image\r\n   * @param {number} objId -  object id\r\n   * @param {string} text - Changing text\r\n   * @returns {Promise<ObjectProps, ErrorMsg>}\r\n   * @example\r\n   * imageEditor.changeText(objId, 'change text');\r\n   */\r\n  changeText(objId, text) {\r\n    text = text || '';\r\n\r\n    return this.execute(commands.CHANGE_TEXT, objId, text);\r\n  }\r\n\r\n  /**\r\n   * Set style\r\n   * @param {number} objId -  object id\r\n   * @param {Object} styleObj - text styles\r\n   *     @param {string} [styleObj.fill] Color\r\n   *     @param {string} [styleObj.fontFamily] Font type for text\r\n   *     @param {number} [styleObj.fontSize] Size\r\n   *     @param {string} [styleObj.fontStyle] Type of inclination (normal / italic)\r\n   *     @param {string} [styleObj.fontWeight] Type of thicker or thinner looking (normal / bold)\r\n   *     @param {string} [styleObj.textAlign] Type of text align (left / center / right)\r\n   *     @param {string} [styleObj.textDecoration] Type of line (underline / line-through / overline)\r\n   * @param {boolean} isSilent - is silent execution or not\r\n   * @returns {Promise}\r\n   * @example\r\n   * imageEditor.changeTextStyle(objId, {\r\n   *     fontStyle: 'italic'\r\n   * });\r\n   */\r\n  changeTextStyle(objId, styleObj, isSilent) {\r\n    const executeMethodName = isSilent ? 'executeSilent' : 'execute';\r\n\r\n    return this[executeMethodName](commands.CHANGE_TEXT_STYLE, objId, styleObj);\r\n  }\r\n\r\n  /**\r\n   * change text mode\r\n   * @param {string} type - change type\r\n   * @private\r\n   */\r\n  _changeActivateMode(type) {\r\n    if (type !== 'ICON' && this.getDrawingMode() !== type) {\r\n      this.startDrawingMode(type);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 'textChanged' event handler\r\n   * @param {Object} target - changed text object\r\n   * @private\r\n   */\r\n  _onTextChanged(target) {\r\n    this.fire(events.TEXT_CHANGED, target);\r\n  }\r\n\r\n  /**\r\n   * 'iconCreateResize' event handler\r\n   * @param {Object} originPointer origin pointer\r\n   *  @param {Number} originPointer.x x position\r\n   *  @param {Number} originPointer.y y position\r\n   * @private\r\n   */\r\n  _onIconCreateResize(originPointer) {\r\n    this.fire(events.ICON_CREATE_RESIZE, originPointer);\r\n  }\r\n\r\n  /**\r\n   * 'iconCreateEnd' event handler\r\n   * @param {Object} originPointer origin pointer\r\n   *  @param {Number} originPointer.x x position\r\n   *  @param {Number} originPointer.y y position\r\n   * @private\r\n   */\r\n  _onIconCreateEnd(originPointer) {\r\n    this.fire(events.ICON_CREATE_END, originPointer);\r\n  }\r\n\r\n  /**\r\n   * 'textEditing' event handler\r\n   * @private\r\n   */\r\n  _onTextEditing() {\r\n    /**\r\n     * The event which starts to edit text object\r\n     * @event ImageEditor#textEditing\r\n     * @example\r\n     * imageEditor.on('textEditing', function() {\r\n     *     console.log('text editing');\r\n     * });\r\n     */\r\n\r\n    this.fire(events.TEXT_EDITING);\r\n  }\r\n\r\n  /**\r\n   * Mousedown event handler in case of 'TEXT' drawing mode\r\n   * @param {fabric.Event} event - Current mousedown event object\r\n   * @private\r\n   */\r\n  _onAddText(event) {\r\n    /**\r\n     * The event when 'TEXT' drawing mode is enabled and click non-object area.\r\n     * @event ImageEditor#addText\r\n     * @param {Object} pos\r\n     *  @param {Object} pos.originPosition - Current position on origin canvas\r\n     *      @param {Number} pos.originPosition.x - x\r\n     *      @param {Number} pos.originPosition.y - y\r\n     *  @param {Object} pos.clientPosition - Current position on client area\r\n     *      @param {Number} pos.clientPosition.x - x\r\n     *      @param {Number} pos.clientPosition.y - y\r\n     * @example\r\n     * imageEditor.on('addText', function(pos) {\r\n     *     console.log('text position on canvas: ' + pos.originPosition);\r\n     *     console.log('text position on brwoser: ' + pos.clientPosition);\r\n     * });\r\n     */\r\n\r\n    this.fire(events.ADD_TEXT, {\r\n      originPosition: event.originPosition,\r\n      clientPosition: event.clientPosition,\r\n    });\r\n  }\r\n\r\n  /**\r\n   * 'addObject' event handler\r\n   * @param {Object} objectProps added object properties\r\n   * @private\r\n   */\r\n  _onAddObject(objectProps) {\r\n    const obj = this._graphics.getObject(objectProps.objId);\r\n    this._invoker.fire(events.EXECUTE_COMMAND, getObjectType(obj.type));\r\n    this._pushAddObjectCommand(obj);\r\n  }\r\n\r\n  /**\r\n   * 'objectAdded' event handler\r\n   * @param {Object} objectProps added object properties\r\n   * @private\r\n   */\r\n  _onObjectAdded(objectProps) {\r\n    /**\r\n     * The event when object added\r\n     * @event ImageEditor#objectAdded\r\n     * @param {ObjectProps} props - object properties\r\n     * @example\r\n     * imageEditor.on('objectAdded', function(props) {\r\n     *     console.log(props);\r\n     * });\r\n     */\r\n    this.fire(OBJECT_ADDED, objectProps);\r\n\r\n    /**\r\n     * The event when object added (deprecated)\r\n     * @event ImageEditor#addObjectAfter\r\n     * @param {ObjectProps} props - object properties\r\n     * @deprecated\r\n     */\r\n    this.fire(ADD_OBJECT_AFTER, objectProps);\r\n  }\r\n\r\n  /**\r\n   * 'objectModified' event handler\r\n   * @param {fabric.Object} obj - selection object\r\n   * @private\r\n   */\r\n  _onObjectModified(obj) {\r\n    if (obj.type !== OBJ_TYPE.CROPZONE) {\r\n      this._invoker.fire(events.EXECUTE_COMMAND, getObjectType(obj.type));\r\n      this._pushModifyObjectCommand(obj);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 'selectionCleared' event handler\r\n   * @private\r\n   */\r\n  _selectionCleared() {\r\n    this.fire(SELECTION_CLEARED);\r\n  }\r\n\r\n  /**\r\n   * 'selectionCreated' event handler\r\n   * @param {Object} eventTarget - Fabric object\r\n   * @private\r\n   */\r\n  _selectionCreated(eventTarget) {\r\n    this.fire(SELECTION_CREATED, eventTarget);\r\n  }\r\n\r\n  /**\r\n   * Register custom icons\r\n   * @param {{iconType: string, pathValue: string}} infos - Infos to register icons\r\n   * @example\r\n   * imageEditor.registerIcons({\r\n   *     customIcon: 'M 0 0 L 20 20 L 10 10 Z',\r\n   *     customArrow: 'M 60 0 L 120 60 H 90 L 75 45 V 180 H 45 V 45 L 30 60 H 0 Z'\r\n   * });\r\n   */\r\n  registerIcons(infos) {\r\n    this._graphics.registerPaths(infos);\r\n  }\r\n\r\n  /**\r\n   * Change canvas cursor type\r\n   * @param {string} cursorType - cursor type\r\n   * @example\r\n   * imageEditor.changeCursor('crosshair');\r\n   */\r\n  changeCursor(cursorType) {\r\n    this._graphics.changeCursor(cursorType);\r\n  }\r\n\r\n  /**\r\n   * Add icon on canvas\r\n   * @param {string} type - Icon type ('arrow', 'cancel', custom icon name)\r\n   * @param {Object} options - Icon options\r\n   *      @param {string} [options.fill] - Icon foreground color\r\n   *      @param {number} [options.left] - Icon x position\r\n   *      @param {number} [options.top] - Icon y position\r\n   * @returns {Promise<ObjectProps, ErrorMsg>}\r\n   * @example\r\n   * imageEditor.addIcon('arrow'); // The position is center on canvas\r\n   * @example\r\n   * imageEditor.addIcon('arrow', {\r\n   *     left: 100,\r\n   *     top: 100\r\n   * }).then(objectProps => {\r\n   *     console.log(objectProps.objId);\r\n   * });\r\n   */\r\n  addIcon(type, options) {\r\n    options = options || {};\r\n\r\n    this._setPositions(options);\r\n\r\n    return this.execute(commands.ADD_ICON, type, options);\r\n  }\r\n\r\n  /**\r\n   * Change icon color\r\n   * @param {number} objId -  object id\r\n   * @param {string} color - Color for icon\r\n   * @returns {Promise}\r\n   * @example\r\n   * imageEditor.changeIconColor(objId, '#000000');\r\n   */\r\n  changeIconColor(objId, color) {\r\n    return this.execute(commands.CHANGE_ICON_COLOR, objId, color);\r\n  }\r\n\r\n  /**\r\n   * Remove an object or group by id\r\n   * @param {number} objId -  object id\r\n   * @returns {Promise}\r\n   * @example\r\n   * imageEditor.removeObject(objId);\r\n   */\r\n  removeObject(objId) {\r\n    const { type } = this._graphics.getObject(objId);\r\n\r\n    return this.execute(commands.REMOVE_OBJECT, objId, getObjectType(type));\r\n  }\r\n\r\n  /**\r\n   * Whether it has the filter or not\r\n   * @param {string} type - Filter type\r\n   * @returns {boolean} true if it has the filter\r\n   */\r\n  hasFilter(type) {\r\n    return this._graphics.hasFilter(type);\r\n  }\r\n\r\n  /**\r\n   * Remove filter on canvas image\r\n   * @param {string} type - Filter type\r\n   * @returns {Promise<FilterResult, ErrorMsg>}\r\n   * @example\r\n   * imageEditor.removeFilter('Grayscale').then(obj => {\r\n   *     console.log('filterType: ', obj.type);\r\n   *     console.log('actType: ', obj.action);\r\n   * }).catch(message => {\r\n   *     console.log('error: ', message);\r\n   * });\r\n   */\r\n  removeFilter(type) {\r\n    return this.execute(commands.REMOVE_FILTER, type);\r\n  }\r\n\r\n  /**\r\n   * Apply filter on canvas image\r\n   * @param {string} type - Filter type\r\n   * @param {object} options - Options to apply filter\r\n   * @param {boolean} isSilent - is silent execution or not\r\n   * @returns {Promise<FilterResult, ErrorMsg>}\r\n   * @example\r\n   * imageEditor.applyFilter('Grayscale');\r\n   * @example\r\n   * imageEditor.applyFilter('mask', {maskObjId: id}).then(obj => {\r\n   *     console.log('filterType: ', obj.type);\r\n   *     console.log('actType: ', obj.action);\r\n   * }).catch(message => {\r\n   *     console.log('error: ', message);\r\n   * });;\r\n   */\r\n  applyFilter(type, options, isSilent) {\r\n    const executeMethodName = isSilent ? 'executeSilent' : 'execute';\r\n\r\n    return this[executeMethodName](commands.APPLY_FILTER, type, options);\r\n  }\r\n\r\n  /**\r\n   * Get data url\r\n   * @param {Object} options - options for toDataURL\r\n   *   @param {String} [options.format=png] The format of the output image. Either \"jpeg\" or \"png\"\r\n   *   @param {Number} [options.quality=1] Quality level (0..1). Only used for jpeg.\r\n   *   @param {Number} [options.multiplier=1] Multiplier to scale by\r\n   *   @param {Number} [options.left] Cropping left offset. Introduced in fabric v1.2.14\r\n   *   @param {Number} [options.top] Cropping top offset. Introduced in fabric v1.2.14\r\n   *   @param {Number} [options.width] Cropping width. Introduced in fabric v1.2.14\r\n   *   @param {Number} [options.height] Cropping height. Introduced in fabric v1.2.14\r\n   * @returns {string} A DOMString containing the requested data URI\r\n   * @example\r\n   * imgEl.src = imageEditor.toDataURL();\r\n   *\r\n   * imageEditor.loadImageFromURL(imageEditor.toDataURL(), 'FilterImage').then(() => {\r\n   *      imageEditor.addImageObject(imgUrl);\r\n   * });\r\n   */\r\n  toDataURL(options) {\r\n    return this._graphics.toDataURL(options);\r\n  }\r\n\r\n  /**\r\n   * Get image name\r\n   * @returns {string} image name\r\n   * @example\r\n   * console.log(imageEditor.getImageName());\r\n   */\r\n  getImageName() {\r\n    return this._graphics.getImageName();\r\n  }\r\n\r\n  /**\r\n   * Clear undoStack\r\n   * @example\r\n   * imageEditor.clearUndoStack();\r\n   */\r\n  clearUndoStack() {\r\n    this._invoker.clearUndoStack();\r\n  }\r\n\r\n  /**\r\n   * Clear redoStack\r\n   * @example\r\n   * imageEditor.clearRedoStack();\r\n   */\r\n  clearRedoStack() {\r\n    this._invoker.clearRedoStack();\r\n  }\r\n\r\n  /**\r\n   * Whehter the undo stack is empty or not\r\n   * @returns {boolean}\r\n   * imageEditor.isEmptyUndoStack();\r\n   */\r\n  isEmptyUndoStack() {\r\n    return this._invoker.isEmptyUndoStack();\r\n  }\r\n\r\n  /**\r\n   * Whehter the redo stack is empty or not\r\n   * @returns {boolean}\r\n   * imageEditor.isEmptyRedoStack();\r\n   */\r\n  isEmptyRedoStack() {\r\n    return this._invoker.isEmptyRedoStack();\r\n  }\r\n\r\n  /**\r\n   * Resize canvas dimension\r\n   * @param {{width: number, height: number}} dimension - Max width & height\r\n   * @returns {Promise}\r\n   */\r\n  resizeCanvasDimension(dimension) {\r\n    if (!dimension) {\r\n      return Promise.reject(rejectMessages.invalidParameters);\r\n    }\r\n\r\n    return this.execute(commands.RESIZE_CANVAS_DIMENSION, dimension);\r\n  }\r\n\r\n  /**\r\n   * Destroy\r\n   */\r\n  destroy() {\r\n    this.stopDrawingMode();\r\n    this._detachDomEvents();\r\n    this._graphics.destroy();\r\n    this._graphics = null;\r\n\r\n    forEach(\r\n      this,\r\n      (value, key) => {\r\n        this[key] = null;\r\n      },\r\n      this\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Set position\r\n   * @param {Object} options - Position options (left or top)\r\n   * @private\r\n   */\r\n  _setPositions(options) {\r\n    const centerPosition = this._graphics.getCenter();\r\n\r\n    if (isUndefined(options.left)) {\r\n      options.left = centerPosition.left;\r\n    }\r\n\r\n    if (isUndefined(options.top)) {\r\n      options.top = centerPosition.top;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Set properties of active object\r\n   * @param {number} objId -  object id\r\n   * @param {Object} keyValue - key & value\r\n   * @returns {Promise}\r\n   * @example\r\n   * imageEditor.setObjectProperties(objId, {\r\n   *     left:100,\r\n   *     top:100,\r\n   *     width: 200,\r\n   *     height: 200,\r\n   *     opacity: 0.5\r\n   * });\r\n   */\r\n  setObjectProperties(objId, keyValue) {\r\n    return this.execute(commands.SET_OBJECT_PROPERTIES, objId, keyValue);\r\n  }\r\n\r\n  /**\r\n   * Set properties of active object, Do not leave an invoke history.\r\n   * @param {number} objId -  object id\r\n   * @param {Object} keyValue - key & value\r\n   * @example\r\n   * imageEditor.setObjectPropertiesQuietly(objId, {\r\n   *     left:100,\r\n   *     top:100,\r\n   *     width: 200,\r\n   *     height: 200,\r\n   *     opacity: 0.5\r\n   * });\r\n   */\r\n  setObjectPropertiesQuietly(objId, keyValue) {\r\n    this._graphics.setObjectProperties(objId, keyValue);\r\n  }\r\n\r\n  /**\r\n   * Get properties of active object corresponding key\r\n   * @param {number} objId -  object id\r\n   * @param {Array<string>|ObjectProps|string} keys - property's key\r\n   * @returns {ObjectProps} properties if id is valid or null\r\n   * @example\r\n   * var props = imageEditor.getObjectProperties(objId, 'left');\r\n   * console.log(props);\r\n   * @example\r\n   * var props = imageEditor.getObjectProperties(objId, ['left', 'top', 'width', 'height']);\r\n   * console.log(props);\r\n   * @example\r\n   * var props = imageEditor.getObjectProperties(objId, {\r\n   *     left: null,\r\n   *     top: null,\r\n   *     width: null,\r\n   *     height: null,\r\n   *     opacity: null\r\n   * });\r\n   * console.log(props);\r\n   */\r\n  getObjectProperties(objId, keys) {\r\n    const object = this._graphics.getObject(objId);\r\n    if (!object) {\r\n      return null;\r\n    }\r\n\r\n    return this._graphics.getObjectProperties(objId, keys);\r\n  }\r\n\r\n  /**\r\n   * Get the canvas size\r\n   * @returns {Object} {{width: number, height: number}} canvas size\r\n   * @example\r\n   * var canvasSize = imageEditor.getCanvasSize();\r\n   * console.log(canvasSize.width);\r\n   * console.height(canvasSize.height);\r\n   */\r\n  getCanvasSize() {\r\n    return this._graphics.getCanvasSize();\r\n  }\r\n\r\n  /**\r\n   * Get object position by originX, originY\r\n   * @param {number} objId -  object id\r\n   * @param {string} originX - can be 'left', 'center', 'right'\r\n   * @param {string} originY - can be 'top', 'center', 'bottom'\r\n   * @returns {Object} {{x:number, y: number}} position by origin if id is valid, or null\r\n   * @example\r\n   * var position = imageEditor.getObjectPosition(objId, 'left', 'top');\r\n   * console.log(position);\r\n   */\r\n  getObjectPosition(objId, originX, originY) {\r\n    return this._graphics.getObjectPosition(objId, originX, originY);\r\n  }\r\n\r\n  /**\r\n   * Set object position  by originX, originY\r\n   * @param {number} objId -  object id\r\n   * @param {Object} posInfo - position object\r\n   *  @param {number} posInfo.x - x position\r\n   *  @param {number} posInfo.y - y position\r\n   *  @param {string} posInfo.originX - can be 'left', 'center', 'right'\r\n   *  @param {string} posInfo.originY - can be 'top', 'center', 'bottom'\r\n   * @returns {Promise}\r\n   * @example\r\n   * // align the object to 'left', 'top'\r\n   * imageEditor.setObjectPosition(objId, {\r\n   *     x: 0,\r\n   *     y: 0,\r\n   *     originX: 'left',\r\n   *     originY: 'top'\r\n   * });\r\n   * @example\r\n   * // align the object to 'right', 'top'\r\n   * var canvasSize = imageEditor.getCanvasSize();\r\n   * imageEditor.setObjectPosition(objId, {\r\n   *     x: canvasSize.width,\r\n   *     y: 0,\r\n   *     originX: 'right',\r\n   *     originY: 'top'\r\n   * });\r\n   * @example\r\n   * // align the object to 'left', 'bottom'\r\n   * var canvasSize = imageEditor.getCanvasSize();\r\n   * imageEditor.setObjectPosition(objId, {\r\n   *     x: 0,\r\n   *     y: canvasSize.height,\r\n   *     originX: 'left',\r\n   *     originY: 'bottom'\r\n   * });\r\n   * @example\r\n   * // align the object to 'right', 'bottom'\r\n   * var canvasSize = imageEditor.getCanvasSize();\r\n   * imageEditor.setObjectPosition(objId, {\r\n   *     x: canvasSize.width,\r\n   *     y: canvasSize.height,\r\n   *     originX: 'right',\r\n   *     originY: 'bottom'\r\n   * });\r\n   */\r\n  setObjectPosition(objId, posInfo) {\r\n    return this.execute(commands.SET_OBJECT_POSITION, objId, posInfo);\r\n  }\r\n\r\n  /**\r\n   * @param {object} dimensions - Image Dimensions\r\n   * @returns {Promise<ErrorMsg>}\r\n   */\r\n  resize(dimensions) {\r\n    return this.execute(commands.RESIZE_IMAGE, dimensions);\r\n  }\r\n\r\n  /**\r\n   * @param {Array} [propertiesToInclude] Any properties that you might want to additionally include in the output\r\n   * @returns {Object} Object representation of an instance\r\n   */\r\n  toJSON(propertiesToInclude) {\r\n    return this._graphics.toJSON(propertiesToInclude);\r\n  }\r\n\r\n  loadFromJSON(json) {\r\n    if (!json) {\r\n      return Promise.reject(rejectMessages.invalidParameters);\r\n    }\r\n\r\n    return this.execute(commands.LOAD_JSON, json);\r\n  }\r\n\r\n  setBackgroundColor(color) {\r\n    return this._graphics.setBackgroundColor(color);\r\n  }\r\n}\r\n\r\nCustomEvents.mixin(ImageEditor);\r\n\r\nexport default ImageEditor;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Invoker - invoke commands\r\n */\r\nimport snippet from 'tui-code-snippet';\r\nimport commandFactory from '@/factory/command';\r\nimport { Promise } from '@/util';\r\nimport { eventNames, rejectMessages } from '@/consts';\r\n\r\nconst { isFunction, isString, CustomEvents } = snippet;\r\n\r\n/**\r\n * Invoker\r\n * @class\r\n * @ignore\r\n */\r\nclass Invoker {\r\n  constructor() {\r\n    /**\r\n     * Undo stack\r\n     * @type {Array.<Command>}\r\n     * @private\r\n     */\r\n    this._undoStack = [];\r\n\r\n    /**\r\n     * Redo stack\r\n     * @type {Array.<Command>}\r\n     * @private\r\n     */\r\n    this._redoStack = [];\r\n\r\n    /**\r\n     * Lock-flag for executing command\r\n     * @type {boolean}\r\n     * @private\r\n     */\r\n    this._isLocked = false;\r\n\r\n    this._isSilent = false;\r\n  }\r\n\r\n  /**\r\n   * Invoke command execution\r\n   * @param {Command} command - Command\r\n   * @param {boolean} [isRedo=false] - check if command is redo\r\n   * @returns {Promise}\r\n   * @private\r\n   */\r\n  _invokeExecution(command, isRedo = false) {\r\n    this.lock();\r\n\r\n    let { args } = command;\r\n    if (!args) {\r\n      args = [];\r\n    }\r\n\r\n    return command\r\n      .execute(...args)\r\n      .then((value) => {\r\n        if (!this._isSilent) {\r\n          this.pushUndoStack(command);\r\n\r\n          this.fire(isRedo ? eventNames.AFTER_REDO : eventNames.EXECUTE_COMMAND, command);\r\n        }\r\n        this.unlock();\r\n        if (isFunction(command.executeCallback)) {\r\n          command.executeCallback(value);\r\n        }\r\n\r\n        return value;\r\n      })\r\n      ['catch']((message) => {\r\n        this.unlock();\r\n\r\n        return Promise.reject(message);\r\n      });\r\n  }\r\n\r\n  /**\r\n   * Invoke command undo\r\n   * @param {Command} command - Command\r\n   * @returns {Promise}\r\n   * @private\r\n   */\r\n  _invokeUndo(command) {\r\n    this.lock();\r\n\r\n    let { args } = command;\r\n    if (!args) {\r\n      args = [];\r\n    }\r\n\r\n    return command\r\n      .undo(...args)\r\n      .then((value) => {\r\n        this.pushRedoStack(command);\r\n        this.fire(eventNames.AFTER_UNDO, command);\r\n        this.unlock();\r\n        if (isFunction(command.undoCallback)) {\r\n          command.undoCallback(value);\r\n        }\r\n\r\n        return value;\r\n      })\r\n      ['catch']((message) => {\r\n        this.unlock();\r\n\r\n        return Promise.reject(message);\r\n      });\r\n  }\r\n\r\n  /**\r\n   * fire REDO_STACK_CHANGED event\r\n   * @private\r\n   */\r\n  _fireRedoStackChanged() {\r\n    this.fire(eventNames.REDO_STACK_CHANGED, this._redoStack.length);\r\n  }\r\n\r\n  /**\r\n   * fire UNDO_STACK_CHANGED event\r\n   * @private\r\n   */\r\n  _fireUndoStackChanged() {\r\n    this.fire(eventNames.UNDO_STACK_CHANGED, this._undoStack.length);\r\n  }\r\n\r\n  /**\r\n   * Lock this invoker\r\n   */\r\n  lock() {\r\n    this._isLocked = true;\r\n  }\r\n\r\n  /**\r\n   * Unlock this invoker\r\n   */\r\n  unlock() {\r\n    this._isLocked = false;\r\n  }\r\n\r\n  executeSilent(...args) {\r\n    this._isSilent = true;\r\n\r\n    return this.execute(...args, this._isSilent).then(() => {\r\n      this._isSilent = false;\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Invoke command\r\n   * Store the command to the undoStack\r\n   * Clear the redoStack\r\n   * @param {String} commandName - Command name\r\n   * @param {...*} args - Arguments for creating command\r\n   * @returns {Promise}\r\n   */\r\n  execute(...args) {\r\n    if (this._isLocked) {\r\n      return Promise.reject(rejectMessages.isLock);\r\n    }\r\n\r\n    let [command] = args;\r\n    if (isString(command)) {\r\n      command = commandFactory.create(...args);\r\n    }\r\n\r\n    return this._invokeExecution(command).then((value) => {\r\n      this.clearRedoStack();\r\n\r\n      return value;\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Undo command\r\n   * @returns {Promise}\r\n   */\r\n  undo() {\r\n    let command = this._undoStack.pop();\r\n    let promise;\r\n    let message = '';\r\n\r\n    if (command && this._isLocked) {\r\n      this.pushUndoStack(command, true);\r\n      command = null;\r\n    }\r\n    if (command) {\r\n      if (this.isEmptyUndoStack()) {\r\n        this._fireUndoStackChanged();\r\n      }\r\n      promise = this._invokeUndo(command);\r\n    } else {\r\n      message = rejectMessages.undo;\r\n      if (this._isLocked) {\r\n        message = `${message} Because ${rejectMessages.isLock}`;\r\n      }\r\n      promise = Promise.reject(message);\r\n    }\r\n\r\n    return promise;\r\n  }\r\n\r\n  /**\r\n   * Redo command\r\n   * @returns {Promise}\r\n   */\r\n  redo() {\r\n    let command = this._redoStack.pop();\r\n    let promise;\r\n    let message = '';\r\n\r\n    if (command && this._isLocked) {\r\n      this.pushRedoStack(command, true);\r\n      command = null;\r\n    }\r\n    if (command) {\r\n      if (this.isEmptyRedoStack()) {\r\n        this._fireRedoStackChanged();\r\n      }\r\n      promise = this._invokeExecution(command, true);\r\n    } else {\r\n      message = rejectMessages.redo;\r\n      if (this._isLocked) {\r\n        message = `${message} Because ${rejectMessages.isLock}`;\r\n      }\r\n      promise = Promise.reject(message);\r\n    }\r\n\r\n    return promise;\r\n  }\r\n\r\n  /**\r\n   * Push undo stack\r\n   * @param {Command} command - command\r\n   * @param {boolean} [isSilent] - Fire event or not\r\n   */\r\n  pushUndoStack(command, isSilent) {\r\n    this._undoStack.push(command);\r\n    if (!isSilent) {\r\n      this._fireUndoStackChanged();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Push redo stack\r\n   * @param {Command} command - command\r\n   * @param {boolean} [isSilent] - Fire event or not\r\n   */\r\n  pushRedoStack(command, isSilent) {\r\n    this._redoStack.push(command);\r\n    if (!isSilent) {\r\n      this._fireRedoStackChanged();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Return whether the redoStack is empty\r\n   * @returns {boolean}\r\n   */\r\n  isEmptyRedoStack() {\r\n    return this._redoStack.length === 0;\r\n  }\r\n\r\n  /**\r\n   * Return whether the undoStack is empty\r\n   * @returns {boolean}\r\n   */\r\n  isEmptyUndoStack() {\r\n    return this._undoStack.length === 0;\r\n  }\r\n\r\n  /**\r\n   * Clear undoStack\r\n   */\r\n  clearUndoStack() {\r\n    if (!this.isEmptyUndoStack()) {\r\n      this._undoStack = [];\r\n      this._fireUndoStackChanged();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Clear redoStack\r\n   */\r\n  clearRedoStack() {\r\n    if (!this.isEmptyRedoStack()) {\r\n      this._redoStack = [];\r\n      this._fireRedoStackChanged();\r\n    }\r\n  }\r\n}\r\n\r\nCustomEvents.mixin(Invoker);\r\n\r\nexport default Invoker;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Command interface\r\n */\r\nimport snippet from 'tui-code-snippet';\r\nimport errorMessage from '@/factory/errorMessage';\r\n\r\nconst createMessage = errorMessage.create;\r\nconst errorTypes = errorMessage.types;\r\n\r\n/**\r\n * Command class\r\n * @class\r\n * @param {{name:function, execute: function, undo: function,\r\n *          executeCallback: function, undoCallback: function}} actions - Command actions\r\n * @param {Array} args - passing arguments on execute, undo\r\n * @ignore\r\n */\r\nclass Command {\r\n  constructor(actions, args) {\r\n    /**\r\n     * command name\r\n     * @type {string}\r\n     */\r\n    this.name = actions.name;\r\n\r\n    /**\r\n     * arguments\r\n     * @type {Array}\r\n     */\r\n    this.args = args;\r\n\r\n    /**\r\n     * Execute function\r\n     * @type {function}\r\n     */\r\n    this.execute = actions.execute;\r\n\r\n    /**\r\n     * Undo function\r\n     * @type {function}\r\n     */\r\n    this.undo = actions.undo;\r\n\r\n    /**\r\n     * executeCallback\r\n     * @type {function}\r\n     */\r\n    this.executeCallback = actions.executeCallback || null;\r\n\r\n    /**\r\n     * undoCallback\r\n     * @type {function}\r\n     */\r\n    this.undoCallback = actions.undoCallback || null;\r\n\r\n    /**\r\n     * data for undo\r\n     * @type {Object}\r\n     */\r\n    this.undoData = {};\r\n  }\r\n\r\n  /**\r\n   * Execute action\r\n   * @param {Object.<string, Component>} compMap - Components injection\r\n   * @abstract\r\n   */\r\n  execute() {\r\n    throw new Error(createMessage(errorTypes.UN_IMPLEMENTATION, 'execute'));\r\n  }\r\n\r\n  /**\r\n   * Undo action\r\n   * @param {Object.<string, Component>} compMap - Components injection\r\n   * @abstract\r\n   */\r\n  undo() {\r\n    throw new Error(createMessage(errorTypes.UN_IMPLEMENTATION, 'undo'));\r\n  }\r\n\r\n  /**\r\n   * command for redo if undoData exists\r\n   * @returns {boolean} isRedo\r\n   */\r\n  get isRedo() {\r\n    return Object.keys(this.undoData).length > 0;\r\n  }\r\n\r\n  /**\r\n   * Set undoData action\r\n   * @param {Object} undoData - maked undo data\r\n   * @param {Object} cachedUndoDataForSilent - cached undo data\r\n   * @param {boolean} isSilent - is silent execution or not\r\n   * @returns {Object} cachedUndoDataForSilent\r\n   */\r\n  setUndoData(undoData, cachedUndoDataForSilent, isSilent) {\r\n    if (cachedUndoDataForSilent) {\r\n      undoData = cachedUndoDataForSilent;\r\n    }\r\n\r\n    if (!isSilent) {\r\n      snippet.extend(this.undoData, undoData);\r\n      cachedUndoDataForSilent = null;\r\n    } else if (!cachedUndoDataForSilent) {\r\n      cachedUndoDataForSilent = undoData;\r\n    }\r\n\r\n    return cachedUndoDataForSilent;\r\n  }\r\n\r\n  /**\r\n   * Attach execute callabck\r\n   * @param {function} callback - Callback after execution\r\n   * @returns {Command} this\r\n   */\r\n  setExecuteCallback(callback) {\r\n    this.executeCallback = callback;\r\n\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Attach undo callback\r\n   * @param {function} callback - Callback after undo\r\n   * @returns {Command} this\r\n   */\r\n  setUndoCallback(callback) {\r\n    this.undoCallback = callback;\r\n\r\n    return this;\r\n  }\r\n}\r\n\r\nexport default Command;\r\n","var parent = require('../../es/promise');\nrequire('../../modules/esnext.aggregate-error');\n// TODO: Remove from `core-js@4`\nrequire('../../modules/esnext.promise.all-settled');\nrequire('../../modules/esnext.promise.try');\nrequire('../../modules/esnext.promise.any');\n\nmodule.exports = parent;\n","require('../../modules/es.aggregate-error');\nrequire('../../modules/es.object.to-string');\nrequire('../../modules/es.promise');\nrequire('../../modules/es.promise.all-settled');\nrequire('../../modules/es.promise.any');\nrequire('../../modules/es.promise.finally');\nrequire('../../modules/es.string.iterator');\nrequire('../../modules/web.dom-collections.iterator');\nvar path = require('../../internals/path');\n\nmodule.exports = path.Promise;\n","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function(\"return this\")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n","'use strict';\nvar $propertyIsEnumerable = {}.propertyIsEnumerable;\n// eslint-disable-next-line es/no-object-getownpropertydescriptor -- safe\nvar getOwnPropertyDescriptor = Object.getOwnPropertyDescriptor;\n\n// Nashorn ~ JDK8 bug\nvar NASHORN_BUG = getOwnPropertyDescriptor && !$propertyIsEnumerable.call({ 1: 2 }, 1);\n\n// `Object.prototype.propertyIsEnumerable` method implementation\n// https://tc39.es/ecma262/#sec-object.prototype.propertyisenumerable\nexports.f = NASHORN_BUG ? function propertyIsEnumerable(V) {\n  var descriptor = getOwnPropertyDescriptor(this, V);\n  return !!descriptor && descriptor.enumerable;\n} : $propertyIsEnumerable;\n","var fails = require('../internals/fails');\nvar classof = require('../internals/classof-raw');\n\nvar split = ''.split;\n\n// fallback for non-array-like ES3 and non-enumerable old V8 strings\nmodule.exports = fails(function () {\n  // throws an error in rhino, see https://github.com/mozilla/rhino/issues/346\n  // eslint-disable-next-line no-prototype-builtins -- safe\n  return !Object('z').propertyIsEnumerable(0);\n}) ? function (it) {\n  return classof(it) == 'String' ? split.call(it, '') : Object(it);\n} : Object;\n","var global = require('../internals/global');\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\n\nmodule.exports = function (key, value) {\n  try {\n    createNonEnumerableProperty(global, key, value);\n  } catch (error) {\n    global[key] = value;\n  } return value;\n};\n","var fails = require('../internals/fails');\n\nmodule.exports = !fails(function () {\n  function F() { /* empty */ }\n  F.prototype.constructor = null;\n  // eslint-disable-next-line es/no-object-getprototypeof -- required for testing\n  return Object.getPrototypeOf(new F()) !== F.prototype;\n});\n","var isObject = require('../internals/is-object');\n\nmodule.exports = function (it) {\n  if (!isObject(it) && it !== null) {\n    throw TypeError(\"Can't set \" + String(it) + ' as a prototype');\n  } return it;\n};\n","var DESCRIPTORS = require('../internals/descriptors');\nvar definePropertyModule = require('../internals/object-define-property');\nvar anObject = require('../internals/an-object');\nvar objectKeys = require('../internals/object-keys');\n\n// `Object.defineProperties` method\n// https://tc39.es/ecma262/#sec-object.defineproperties\n// eslint-disable-next-line es/no-object-defineproperties -- safe\nmodule.exports = DESCRIPTORS ? Object.defineProperties : function defineProperties(O, Properties) {\n  anObject(O);\n  var keys = objectKeys(Properties);\n  var length = keys.length;\n  var index = 0;\n  var key;\n  while (length > index) definePropertyModule.f(O, key = keys[index++], Properties[key]);\n  return O;\n};\n","var internalObjectKeys = require('../internals/object-keys-internal');\nvar enumBugKeys = require('../internals/enum-bug-keys');\n\n// `Object.keys` method\n// https://tc39.es/ecma262/#sec-object.keys\n// eslint-disable-next-line es/no-object-keys -- safe\nmodule.exports = Object.keys || function keys(O) {\n  return internalObjectKeys(O, enumBugKeys);\n};\n","var has = require('../internals/has');\nvar toIndexedObject = require('../internals/to-indexed-object');\nvar indexOf = require('../internals/array-includes').indexOf;\nvar hiddenKeys = require('../internals/hidden-keys');\n\nmodule.exports = function (object, names) {\n  var O = toIndexedObject(object);\n  var i = 0;\n  var result = [];\n  var key;\n  for (key in O) !has(hiddenKeys, key) && has(O, key) && result.push(key);\n  // Don't enum bug & hidden keys\n  while (names.length > i) if (has(O, key = names[i++])) {\n    ~indexOf(result, key) || result.push(key);\n  }\n  return result;\n};\n","var toIndexedObject = require('../internals/to-indexed-object');\nvar toLength = require('../internals/to-length');\nvar toAbsoluteIndex = require('../internals/to-absolute-index');\n\n// `Array.prototype.{ indexOf, includes }` methods implementation\nvar createMethod = function (IS_INCLUDES) {\n  return function ($this, el, fromIndex) {\n    var O = toIndexedObject($this);\n    var length = toLength(O.length);\n    var index = toAbsoluteIndex(fromIndex, length);\n    var value;\n    // Array#includes uses SameValueZero equality algorithm\n    // eslint-disable-next-line no-self-compare -- NaN check\n    if (IS_INCLUDES && el != el) while (length > index) {\n      value = O[index++];\n      // eslint-disable-next-line no-self-compare -- NaN check\n      if (value != value) return true;\n    // Array#indexOf ignores holes, Array#includes - not\n    } else for (;length > index; index++) {\n      if ((IS_INCLUDES || index in O) && O[index] === el) return IS_INCLUDES || index || 0;\n    } return !IS_INCLUDES && -1;\n  };\n};\n\nmodule.exports = {\n  // `Array.prototype.includes` method\n  // https://tc39.es/ecma262/#sec-array.prototype.includes\n  includes: createMethod(true),\n  // `Array.prototype.indexOf` method\n  // https://tc39.es/ecma262/#sec-array.prototype.indexof\n  indexOf: createMethod(false)\n};\n","var toInteger = require('../internals/to-integer');\n\nvar max = Math.max;\nvar min = Math.min;\n\n// Helper for a popular repeating case of the spec:\n// Let integer be ? ToInteger(index).\n// If integer < 0, let result be max((length + integer), 0); else let result be min(integer, length).\nmodule.exports = function (index, length) {\n  var integer = toInteger(index);\n  return integer < 0 ? max(integer + length, 0) : min(integer, length);\n};\n","var wellKnownSymbol = require('../internals/well-known-symbol');\nvar Iterators = require('../internals/iterators');\n\nvar ITERATOR = wellKnownSymbol('iterator');\nvar ArrayPrototype = Array.prototype;\n\n// check on default Array iterator\nmodule.exports = function (it) {\n  return it !== undefined && (Iterators.Array === it || ArrayPrototype[ITERATOR] === it);\n};\n","/* eslint-disable es/no-symbol -- required for testing */\nvar NATIVE_SYMBOL = require('../internals/native-symbol');\n\nmodule.exports = NATIVE_SYMBOL\n  && !Symbol.sham\n  && typeof Symbol.iterator == 'symbol';\n","var classof = require('../internals/classof');\nvar Iterators = require('../internals/iterators');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar ITERATOR = wellKnownSymbol('iterator');\n\nmodule.exports = function (it) {\n  if (it != undefined) return it[ITERATOR]\n    || it['@@iterator']\n    || Iterators[classof(it)];\n};\n","var anObject = require('../internals/an-object');\n\nmodule.exports = function (iterator) {\n  var returnMethod = iterator['return'];\n  if (returnMethod !== undefined) {\n    return anObject(returnMethod.call(iterator)).value;\n  }\n};\n","'use strict';\nvar $ = require('../internals/export');\nvar IS_PURE = require('../internals/is-pure');\nvar global = require('../internals/global');\nvar getBuiltIn = require('../internals/get-built-in');\nvar NativePromise = require('../internals/native-promise-constructor');\nvar redefine = require('../internals/redefine');\nvar redefineAll = require('../internals/redefine-all');\nvar setPrototypeOf = require('../internals/object-set-prototype-of');\nvar setToStringTag = require('../internals/set-to-string-tag');\nvar setSpecies = require('../internals/set-species');\nvar isObject = require('../internals/is-object');\nvar aFunction = require('../internals/a-function');\nvar anInstance = require('../internals/an-instance');\nvar inspectSource = require('../internals/inspect-source');\nvar iterate = require('../internals/iterate');\nvar checkCorrectnessOfIteration = require('../internals/check-correctness-of-iteration');\nvar speciesConstructor = require('../internals/species-constructor');\nvar task = require('../internals/task').set;\nvar microtask = require('../internals/microtask');\nvar promiseResolve = require('../internals/promise-resolve');\nvar hostReportErrors = require('../internals/host-report-errors');\nvar newPromiseCapabilityModule = require('../internals/new-promise-capability');\nvar perform = require('../internals/perform');\nvar InternalStateModule = require('../internals/internal-state');\nvar isForced = require('../internals/is-forced');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\nvar IS_BROWSER = require('../internals/engine-is-browser');\nvar IS_NODE = require('../internals/engine-is-node');\nvar V8_VERSION = require('../internals/engine-v8-version');\n\nvar SPECIES = wellKnownSymbol('species');\nvar PROMISE = 'Promise';\nvar getInternalState = InternalStateModule.get;\nvar setInternalState = InternalStateModule.set;\nvar getInternalPromiseState = InternalStateModule.getterFor(PROMISE);\nvar NativePromisePrototype = NativePromise && NativePromise.prototype;\nvar PromiseConstructor = NativePromise;\nvar PromiseConstructorPrototype = NativePromisePrototype;\nvar TypeError = global.TypeError;\nvar document = global.document;\nvar process = global.process;\nvar newPromiseCapability = newPromiseCapabilityModule.f;\nvar newGenericPromiseCapability = newPromiseCapability;\nvar DISPATCH_EVENT = !!(document && document.createEvent && global.dispatchEvent);\nvar NATIVE_REJECTION_EVENT = typeof PromiseRejectionEvent == 'function';\nvar UNHANDLED_REJECTION = 'unhandledrejection';\nvar REJECTION_HANDLED = 'rejectionhandled';\nvar PENDING = 0;\nvar FULFILLED = 1;\nvar REJECTED = 2;\nvar HANDLED = 1;\nvar UNHANDLED = 2;\nvar SUBCLASSING = false;\nvar Internal, OwnPromiseCapability, PromiseWrapper, nativeThen;\n\nvar FORCED = isForced(PROMISE, function () {\n  var GLOBAL_CORE_JS_PROMISE = inspectSource(PromiseConstructor) !== String(PromiseConstructor);\n  // V8 6.6 (Node 10 and Chrome 66) have a bug with resolving custom thenables\n  // https://bugs.chromium.org/p/chromium/issues/detail?id=830565\n  // We can't detect it synchronously, so just check versions\n  if (!GLOBAL_CORE_JS_PROMISE && V8_VERSION === 66) return true;\n  // We need Promise#finally in the pure version for preventing prototype pollution\n  if (IS_PURE && !PromiseConstructorPrototype['finally']) return true;\n  // We can't use @@species feature detection in V8 since it causes\n  // deoptimization and performance degradation\n  // https://github.com/zloirock/core-js/issues/679\n  if (V8_VERSION >= 51 && /native code/.test(PromiseConstructor)) return false;\n  // Detect correctness of subclassing with @@species support\n  var promise = new PromiseConstructor(function (resolve) { resolve(1); });\n  var FakePromise = function (exec) {\n    exec(function () { /* empty */ }, function () { /* empty */ });\n  };\n  var constructor = promise.constructor = {};\n  constructor[SPECIES] = FakePromise;\n  SUBCLASSING = promise.then(function () { /* empty */ }) instanceof FakePromise;\n  if (!SUBCLASSING) return true;\n  // Unhandled rejections tracking support, NodeJS Promise without it fails @@species test\n  return !GLOBAL_CORE_JS_PROMISE && IS_BROWSER && !NATIVE_REJECTION_EVENT;\n});\n\nvar INCORRECT_ITERATION = FORCED || !checkCorrectnessOfIteration(function (iterable) {\n  PromiseConstructor.all(iterable)['catch'](function () { /* empty */ });\n});\n\n// helpers\nvar isThenable = function (it) {\n  var then;\n  return isObject(it) && typeof (then = it.then) == 'function' ? then : false;\n};\n\nvar notify = function (state, isReject) {\n  if (state.notified) return;\n  state.notified = true;\n  var chain = state.reactions;\n  microtask(function () {\n    var value = state.value;\n    var ok = state.state == FULFILLED;\n    var index = 0;\n    // variable length - can't use forEach\n    while (chain.length > index) {\n      var reaction = chain[index++];\n      var handler = ok ? reaction.ok : reaction.fail;\n      var resolve = reaction.resolve;\n      var reject = reaction.reject;\n      var domain = reaction.domain;\n      var result, then, exited;\n      try {\n        if (handler) {\n          if (!ok) {\n            if (state.rejection === UNHANDLED) onHandleUnhandled(state);\n            state.rejection = HANDLED;\n          }\n          if (handler === true) result = value;\n          else {\n            if (domain) domain.enter();\n            result = handler(value); // can throw\n            if (domain) {\n              domain.exit();\n              exited = true;\n            }\n          }\n          if (result === reaction.promise) {\n            reject(TypeError('Promise-chain cycle'));\n          } else if (then = isThenable(result)) {\n            then.call(result, resolve, reject);\n          } else resolve(result);\n        } else reject(value);\n      } catch (error) {\n        if (domain && !exited) domain.exit();\n        reject(error);\n      }\n    }\n    state.reactions = [];\n    state.notified = false;\n    if (isReject && !state.rejection) onUnhandled(state);\n  });\n};\n\nvar dispatchEvent = function (name, promise, reason) {\n  var event, handler;\n  if (DISPATCH_EVENT) {\n    event = document.createEvent('Event');\n    event.promise = promise;\n    event.reason = reason;\n    event.initEvent(name, false, true);\n    global.dispatchEvent(event);\n  } else event = { promise: promise, reason: reason };\n  if (!NATIVE_REJECTION_EVENT && (handler = global['on' + name])) handler(event);\n  else if (name === UNHANDLED_REJECTION) hostReportErrors('Unhandled promise rejection', reason);\n};\n\nvar onUnhandled = function (state) {\n  task.call(global, function () {\n    var promise = state.facade;\n    var value = state.value;\n    var IS_UNHANDLED = isUnhandled(state);\n    var result;\n    if (IS_UNHANDLED) {\n      result = perform(function () {\n        if (IS_NODE) {\n          process.emit('unhandledRejection', value, promise);\n        } else dispatchEvent(UNHANDLED_REJECTION, promise, value);\n      });\n      // Browsers should not trigger `rejectionHandled` event if it was handled here, NodeJS - should\n      state.rejection = IS_NODE || isUnhandled(state) ? UNHANDLED : HANDLED;\n      if (result.error) throw result.value;\n    }\n  });\n};\n\nvar isUnhandled = function (state) {\n  return state.rejection !== HANDLED && !state.parent;\n};\n\nvar onHandleUnhandled = function (state) {\n  task.call(global, function () {\n    var promise = state.facade;\n    if (IS_NODE) {\n      process.emit('rejectionHandled', promise);\n    } else dispatchEvent(REJECTION_HANDLED, promise, state.value);\n  });\n};\n\nvar bind = function (fn, state, unwrap) {\n  return function (value) {\n    fn(state, value, unwrap);\n  };\n};\n\nvar internalReject = function (state, value, unwrap) {\n  if (state.done) return;\n  state.done = true;\n  if (unwrap) state = unwrap;\n  state.value = value;\n  state.state = REJECTED;\n  notify(state, true);\n};\n\nvar internalResolve = function (state, value, unwrap) {\n  if (state.done) return;\n  state.done = true;\n  if (unwrap) state = unwrap;\n  try {\n    if (state.facade === value) throw TypeError(\"Promise can't be resolved itself\");\n    var then = isThenable(value);\n    if (then) {\n      microtask(function () {\n        var wrapper = { done: false };\n        try {\n          then.call(value,\n            bind(internalResolve, wrapper, state),\n            bind(internalReject, wrapper, state)\n          );\n        } catch (error) {\n          internalReject(wrapper, error, state);\n        }\n      });\n    } else {\n      state.value = value;\n      state.state = FULFILLED;\n      notify(state, false);\n    }\n  } catch (error) {\n    internalReject({ done: false }, error, state);\n  }\n};\n\n// constructor polyfill\nif (FORCED) {\n  // 25.4.3.1 Promise(executor)\n  PromiseConstructor = function Promise(executor) {\n    anInstance(this, PromiseConstructor, PROMISE);\n    aFunction(executor);\n    Internal.call(this);\n    var state = getInternalState(this);\n    try {\n      executor(bind(internalResolve, state), bind(internalReject, state));\n    } catch (error) {\n      internalReject(state, error);\n    }\n  };\n  PromiseConstructorPrototype = PromiseConstructor.prototype;\n  // eslint-disable-next-line no-unused-vars -- required for `.length`\n  Internal = function Promise(executor) {\n    setInternalState(this, {\n      type: PROMISE,\n      done: false,\n      notified: false,\n      parent: false,\n      reactions: [],\n      rejection: false,\n      state: PENDING,\n      value: undefined\n    });\n  };\n  Internal.prototype = redefineAll(PromiseConstructorPrototype, {\n    // `Promise.prototype.then` method\n    // https://tc39.es/ecma262/#sec-promise.prototype.then\n    then: function then(onFulfilled, onRejected) {\n      var state = getInternalPromiseState(this);\n      var reaction = newPromiseCapability(speciesConstructor(this, PromiseConstructor));\n      reaction.ok = typeof onFulfilled == 'function' ? onFulfilled : true;\n      reaction.fail = typeof onRejected == 'function' && onRejected;\n      reaction.domain = IS_NODE ? process.domain : undefined;\n      state.parent = true;\n      state.reactions.push(reaction);\n      if (state.state != PENDING) notify(state, false);\n      return reaction.promise;\n    },\n    // `Promise.prototype.catch` method\n    // https://tc39.es/ecma262/#sec-promise.prototype.catch\n    'catch': function (onRejected) {\n      return this.then(undefined, onRejected);\n    }\n  });\n  OwnPromiseCapability = function () {\n    var promise = new Internal();\n    var state = getInternalState(promise);\n    this.promise = promise;\n    this.resolve = bind(internalResolve, state);\n    this.reject = bind(internalReject, state);\n  };\n  newPromiseCapabilityModule.f = newPromiseCapability = function (C) {\n    return C === PromiseConstructor || C === PromiseWrapper\n      ? new OwnPromiseCapability(C)\n      : newGenericPromiseCapability(C);\n  };\n\n  if (!IS_PURE && typeof NativePromise == 'function' && NativePromisePrototype !== Object.prototype) {\n    nativeThen = NativePromisePrototype.then;\n\n    if (!SUBCLASSING) {\n      // make `Promise#then` return a polyfilled `Promise` for native promise-based APIs\n      redefine(NativePromisePrototype, 'then', function then(onFulfilled, onRejected) {\n        var that = this;\n        return new PromiseConstructor(function (resolve, reject) {\n          nativeThen.call(that, resolve, reject);\n        }).then(onFulfilled, onRejected);\n      // https://github.com/zloirock/core-js/issues/640\n      }, { unsafe: true });\n\n      // makes sure that native promise-based APIs `Promise#catch` properly works with patched `Promise#then`\n      redefine(NativePromisePrototype, 'catch', PromiseConstructorPrototype['catch'], { unsafe: true });\n    }\n\n    // make `.constructor === Promise` work for native promise-based APIs\n    try {\n      delete NativePromisePrototype.constructor;\n    } catch (error) { /* empty */ }\n\n    // make `instanceof Promise` work for native promise-based APIs\n    if (setPrototypeOf) {\n      setPrototypeOf(NativePromisePrototype, PromiseConstructorPrototype);\n    }\n  }\n}\n\n$({ global: true, wrap: true, forced: FORCED }, {\n  Promise: PromiseConstructor\n});\n\nsetToStringTag(PromiseConstructor, PROMISE, false, true);\nsetSpecies(PROMISE);\n\nPromiseWrapper = getBuiltIn(PROMISE);\n\n// statics\n$({ target: PROMISE, stat: true, forced: FORCED }, {\n  // `Promise.reject` method\n  // https://tc39.es/ecma262/#sec-promise.reject\n  reject: function reject(r) {\n    var capability = newPromiseCapability(this);\n    capability.reject.call(undefined, r);\n    return capability.promise;\n  }\n});\n\n$({ target: PROMISE, stat: true, forced: IS_PURE || FORCED }, {\n  // `Promise.resolve` method\n  // https://tc39.es/ecma262/#sec-promise.resolve\n  resolve: function resolve(x) {\n    return promiseResolve(IS_PURE && this === PromiseWrapper ? PromiseConstructor : this, x);\n  }\n});\n\n$({ target: PROMISE, stat: true, forced: INCORRECT_ITERATION }, {\n  // `Promise.all` method\n  // https://tc39.es/ecma262/#sec-promise.all\n  all: function all(iterable) {\n    var C = this;\n    var capability = newPromiseCapability(C);\n    var resolve = capability.resolve;\n    var reject = capability.reject;\n    var result = perform(function () {\n      var $promiseResolve = aFunction(C.resolve);\n      var values = [];\n      var counter = 0;\n      var remaining = 1;\n      iterate(iterable, function (promise) {\n        var index = counter++;\n        var alreadyCalled = false;\n        values.push(undefined);\n        remaining++;\n        $promiseResolve.call(C, promise).then(function (value) {\n          if (alreadyCalled) return;\n          alreadyCalled = true;\n          values[index] = value;\n          --remaining || resolve(values);\n        }, reject);\n      });\n      --remaining || resolve(values);\n    });\n    if (result.error) reject(result.value);\n    return capability.promise;\n  },\n  // `Promise.race` method\n  // https://tc39.es/ecma262/#sec-promise.race\n  race: function race(iterable) {\n    var C = this;\n    var capability = newPromiseCapability(C);\n    var reject = capability.reject;\n    var result = perform(function () {\n      var $promiseResolve = aFunction(C.resolve);\n      iterate(iterable, function (promise) {\n        $promiseResolve.call(C, promise).then(capability.resolve, reject);\n      });\n    });\n    if (result.error) reject(result.value);\n    return capability.promise;\n  }\n});\n","var redefine = require('../internals/redefine');\n\nmodule.exports = function (target, src, options) {\n  for (var key in src) {\n    if (options && options.unsafe && target[key]) target[key] = src[key];\n    else redefine(target, key, src[key], options);\n  } return target;\n};\n","'use strict';\nvar TO_STRING_TAG_SUPPORT = require('../internals/to-string-tag-support');\nvar classof = require('../internals/classof');\n\n// `Object.prototype.toString` method implementation\n// https://tc39.es/ecma262/#sec-object.prototype.tostring\nmodule.exports = TO_STRING_TAG_SUPPORT ? {}.toString : function toString() {\n  return '[object ' + classof(this) + ']';\n};\n","'use strict';\nvar getBuiltIn = require('../internals/get-built-in');\nvar definePropertyModule = require('../internals/object-define-property');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\nvar DESCRIPTORS = require('../internals/descriptors');\n\nvar SPECIES = wellKnownSymbol('species');\n\nmodule.exports = function (CONSTRUCTOR_NAME) {\n  var Constructor = getBuiltIn(CONSTRUCTOR_NAME);\n  var defineProperty = definePropertyModule.f;\n\n  if (DESCRIPTORS && Constructor && !Constructor[SPECIES]) {\n    defineProperty(Constructor, SPECIES, {\n      configurable: true,\n      get: function () { return this; }\n    });\n  }\n};\n","module.exports = function (it, Constructor, name) {\n  if (!(it instanceof Constructor)) {\n    throw TypeError('Incorrect ' + (name ? name + ' ' : '') + 'invocation');\n  } return it;\n};\n","var wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar ITERATOR = wellKnownSymbol('iterator');\nvar SAFE_CLOSING = false;\n\ntry {\n  var called = 0;\n  var iteratorWithReturn = {\n    next: function () {\n      return { done: !!called++ };\n    },\n    'return': function () {\n      SAFE_CLOSING = true;\n    }\n  };\n  iteratorWithReturn[ITERATOR] = function () {\n    return this;\n  };\n  // eslint-disable-next-line es/no-array-from, no-throw-literal -- required for testing\n  Array.from(iteratorWithReturn, function () { throw 2; });\n} catch (error) { /* empty */ }\n\nmodule.exports = function (exec, SKIP_CLOSING) {\n  if (!SKIP_CLOSING && !SAFE_CLOSING) return false;\n  var ITERATION_SUPPORT = false;\n  try {\n    var object = {};\n    object[ITERATOR] = function () {\n      return {\n        next: function () {\n          return { done: ITERATION_SUPPORT = true };\n        }\n      };\n    };\n    exec(object);\n  } catch (error) { /* empty */ }\n  return ITERATION_SUPPORT;\n};\n","var global = require('../internals/global');\nvar getOwnPropertyDescriptor = require('../internals/object-get-own-property-descriptor').f;\nvar macrotask = require('../internals/task').set;\nvar IS_IOS = require('../internals/engine-is-ios');\nvar IS_WEBOS_WEBKIT = require('../internals/engine-is-webos-webkit');\nvar IS_NODE = require('../internals/engine-is-node');\n\nvar MutationObserver = global.MutationObserver || global.WebKitMutationObserver;\nvar document = global.document;\nvar process = global.process;\nvar Promise = global.Promise;\n// Node.js 11 shows ExperimentalWarning on getting `queueMicrotask`\nvar queueMicrotaskDescriptor = getOwnPropertyDescriptor(global, 'queueMicrotask');\nvar queueMicrotask = queueMicrotaskDescriptor && queueMicrotaskDescriptor.value;\n\nvar flush, head, last, notify, toggle, node, promise, then;\n\n// modern engines have queueMicrotask method\nif (!queueMicrotask) {\n  flush = function () {\n    var parent, fn;\n    if (IS_NODE && (parent = process.domain)) parent.exit();\n    while (head) {\n      fn = head.fn;\n      head = head.next;\n      try {\n        fn();\n      } catch (error) {\n        if (head) notify();\n        else last = undefined;\n        throw error;\n      }\n    } last = undefined;\n    if (parent) parent.enter();\n  };\n\n  // browsers with MutationObserver, except iOS - https://github.com/zloirock/core-js/issues/339\n  // also except WebOS Webkit https://github.com/zloirock/core-js/issues/898\n  if (!IS_IOS && !IS_NODE && !IS_WEBOS_WEBKIT && MutationObserver && document) {\n    toggle = true;\n    node = document.createTextNode('');\n    new MutationObserver(flush).observe(node, { characterData: true });\n    notify = function () {\n      node.data = toggle = !toggle;\n    };\n  // environments with maybe non-completely correct, but existent Promise\n  } else if (Promise && Promise.resolve) {\n    // Promise.resolve without an argument throws an error in LG WebOS 2\n    promise = Promise.resolve(undefined);\n    // workaround of WebKit ~ iOS Safari 10.1 bug\n    promise.constructor = Promise;\n    then = promise.then;\n    notify = function () {\n      then.call(promise, flush);\n    };\n  // Node.js without promises\n  } else if (IS_NODE) {\n    notify = function () {\n      process.nextTick(flush);\n    };\n  // for other environments - macrotask based on:\n  // - setImmediate\n  // - MessageChannel\n  // - window.postMessag\n  // - onreadystatechange\n  // - setTimeout\n  } else {\n    notify = function () {\n      // strange IE + webpack dev server bug - use .call(global)\n      macrotask.call(global, flush);\n    };\n  }\n}\n\nmodule.exports = queueMicrotask || function (fn) {\n  var task = { fn: fn, next: undefined };\n  if (last) last.next = task;\n  if (!head) {\n    head = task;\n    notify();\n  } last = task;\n};\n","var userAgent = require('../internals/engine-user-agent');\n\nmodule.exports = /web0s(?!.*chrome)/i.test(userAgent);\n","var global = require('../internals/global');\n\nmodule.exports = function (a, b) {\n  var console = global.console;\n  if (console && console.error) {\n    arguments.length === 1 ? console.error(a) : console.error(a, b);\n  }\n};\n","var global = require('../internals/global');\nvar inspectSource = require('../internals/inspect-source');\n\nvar WeakMap = global.WeakMap;\n\nmodule.exports = typeof WeakMap === 'function' && /native code/.test(inspectSource(WeakMap));\n","module.exports = typeof window == 'object';\n","'use strict';\nvar $ = require('../internals/export');\nvar IS_PURE = require('../internals/is-pure');\nvar NativePromise = require('../internals/native-promise-constructor');\nvar fails = require('../internals/fails');\nvar getBuiltIn = require('../internals/get-built-in');\nvar speciesConstructor = require('../internals/species-constructor');\nvar promiseResolve = require('../internals/promise-resolve');\nvar redefine = require('../internals/redefine');\n\n// Safari bug https://bugs.webkit.org/show_bug.cgi?id=200829\nvar NON_GENERIC = !!NativePromise && fails(function () {\n  NativePromise.prototype['finally'].call({ then: function () { /* empty */ } }, function () { /* empty */ });\n});\n\n// `Promise.prototype.finally` method\n// https://tc39.es/ecma262/#sec-promise.prototype.finally\n$({ target: 'Promise', proto: true, real: true, forced: NON_GENERIC }, {\n  'finally': function (onFinally) {\n    var C = speciesConstructor(this, getBuiltIn('Promise'));\n    var isFunction = typeof onFinally == 'function';\n    return this.then(\n      isFunction ? function (x) {\n        return promiseResolve(C, onFinally()).then(function () { return x; });\n      } : onFinally,\n      isFunction ? function (e) {\n        return promiseResolve(C, onFinally()).then(function () { throw e; });\n      } : onFinally\n    );\n  }\n});\n\n// makes sure that native promise-based APIs `Promise#finally` properly works with patched `Promise#then`\nif (!IS_PURE && typeof NativePromise == 'function') {\n  var method = getBuiltIn('Promise').prototype['finally'];\n  if (NativePromise.prototype['finally'] !== method) {\n    redefine(NativePromise.prototype, 'finally', method, { unsafe: true });\n  }\n}\n","'use strict';\nvar charAt = require('../internals/string-multibyte').charAt;\nvar InternalStateModule = require('../internals/internal-state');\nvar defineIterator = require('../internals/define-iterator');\n\nvar STRING_ITERATOR = 'String Iterator';\nvar setInternalState = InternalStateModule.set;\nvar getInternalState = InternalStateModule.getterFor(STRING_ITERATOR);\n\n// `String.prototype[@@iterator]` method\n// https://tc39.es/ecma262/#sec-string.prototype-@@iterator\ndefineIterator(String, 'String', function (iterated) {\n  setInternalState(this, {\n    type: STRING_ITERATOR,\n    string: String(iterated),\n    index: 0\n  });\n// `%StringIteratorPrototype%.next` method\n// https://tc39.es/ecma262/#sec-%stringiteratorprototype%.next\n}, function next() {\n  var state = getInternalState(this);\n  var string = state.string;\n  var index = state.index;\n  var point;\n  if (index >= string.length) return { value: undefined, done: true };\n  point = charAt(string, index);\n  state.index += point.length;\n  return { value: point, done: false };\n});\n","var toInteger = require('../internals/to-integer');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\n\n// `String.prototype.{ codePointAt, at }` methods implementation\nvar createMethod = function (CONVERT_TO_STRING) {\n  return function ($this, pos) {\n    var S = String(requireObjectCoercible($this));\n    var position = toInteger(pos);\n    var size = S.length;\n    var first, second;\n    if (position < 0 || position >= size) return CONVERT_TO_STRING ? '' : undefined;\n    first = S.charCodeAt(position);\n    return first < 0xD800 || first > 0xDBFF || position + 1 === size\n      || (second = S.charCodeAt(position + 1)) < 0xDC00 || second > 0xDFFF\n        ? CONVERT_TO_STRING ? S.charAt(position) : first\n        : CONVERT_TO_STRING ? S.slice(position, position + 2) : (first - 0xD800 << 10) + (second - 0xDC00) + 0x10000;\n  };\n};\n\nmodule.exports = {\n  // `String.prototype.codePointAt` method\n  // https://tc39.es/ecma262/#sec-string.prototype.codepointat\n  codeAt: createMethod(false),\n  // `String.prototype.at` method\n  // https://github.com/mathiasbynens/String.prototype.at\n  charAt: createMethod(true)\n};\n","'use strict';\nvar IteratorPrototype = require('../internals/iterators-core').IteratorPrototype;\nvar create = require('../internals/object-create');\nvar createPropertyDescriptor = require('../internals/create-property-descriptor');\nvar setToStringTag = require('../internals/set-to-string-tag');\nvar Iterators = require('../internals/iterators');\n\nvar returnThis = function () { return this; };\n\nmodule.exports = function (IteratorConstructor, NAME, next) {\n  var TO_STRING_TAG = NAME + ' Iterator';\n  IteratorConstructor.prototype = create(IteratorPrototype, { next: createPropertyDescriptor(1, next) });\n  setToStringTag(IteratorConstructor, TO_STRING_TAG, false, true);\n  Iterators[TO_STRING_TAG] = returnThis;\n  return IteratorConstructor;\n};\n","require('./es.array.iterator');\nvar DOMIterables = require('../internals/dom-iterables');\nvar global = require('../internals/global');\nvar classof = require('../internals/classof');\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\nvar Iterators = require('../internals/iterators');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar TO_STRING_TAG = wellKnownSymbol('toStringTag');\n\nfor (var COLLECTION_NAME in DOMIterables) {\n  var Collection = global[COLLECTION_NAME];\n  var CollectionPrototype = Collection && Collection.prototype;\n  if (CollectionPrototype && classof(CollectionPrototype) !== TO_STRING_TAG) {\n    createNonEnumerableProperty(CollectionPrototype, TO_STRING_TAG, COLLECTION_NAME);\n  }\n  Iterators[COLLECTION_NAME] = Iterators.Array;\n}\n","'use strict';\nvar toIndexedObject = require('../internals/to-indexed-object');\nvar addToUnscopables = require('../internals/add-to-unscopables');\nvar Iterators = require('../internals/iterators');\nvar InternalStateModule = require('../internals/internal-state');\nvar defineIterator = require('../internals/define-iterator');\n\nvar ARRAY_ITERATOR = 'Array Iterator';\nvar setInternalState = InternalStateModule.set;\nvar getInternalState = InternalStateModule.getterFor(ARRAY_ITERATOR);\n\n// `Array.prototype.entries` method\n// https://tc39.es/ecma262/#sec-array.prototype.entries\n// `Array.prototype.keys` method\n// https://tc39.es/ecma262/#sec-array.prototype.keys\n// `Array.prototype.values` method\n// https://tc39.es/ecma262/#sec-array.prototype.values\n// `Array.prototype[@@iterator]` method\n// https://tc39.es/ecma262/#sec-array.prototype-@@iterator\n// `CreateArrayIterator` internal method\n// https://tc39.es/ecma262/#sec-createarrayiterator\nmodule.exports = defineIterator(Array, 'Array', function (iterated, kind) {\n  setInternalState(this, {\n    type: ARRAY_ITERATOR,\n    target: toIndexedObject(iterated), // target\n    index: 0,                          // next index\n    kind: kind                         // kind\n  });\n// `%ArrayIteratorPrototype%.next` method\n// https://tc39.es/ecma262/#sec-%arrayiteratorprototype%.next\n}, function () {\n  var state = getInternalState(this);\n  var target = state.target;\n  var kind = state.kind;\n  var index = state.index++;\n  if (!target || index >= target.length) {\n    state.target = undefined;\n    return { value: undefined, done: true };\n  }\n  if (kind == 'keys') return { value: index, done: false };\n  if (kind == 'values') return { value: target[index], done: false };\n  return { value: [index, target[index]], done: false };\n}, 'values');\n\n// argumentsList[@@iterator] is %ArrayProto_values%\n// https://tc39.es/ecma262/#sec-createunmappedargumentsobject\n// https://tc39.es/ecma262/#sec-createmappedargumentsobject\nIterators.Arguments = Iterators.Array;\n\n// https://tc39.es/ecma262/#sec-array.prototype-@@unscopables\naddToUnscopables('keys');\naddToUnscopables('values');\naddToUnscopables('entries');\n","module.exports = function () { /* empty */ };\n","// iterable DOM collections\n// flag - `iterable` interface - 'entries', 'keys', 'values', 'forEach' methods\nmodule.exports = {\n  CSSRuleList: 0,\n  CSSStyleDeclaration: 0,\n  CSSValueList: 0,\n  ClientRectList: 0,\n  DOMRectList: 0,\n  DOMStringList: 0,\n  DOMTokenList: 1,\n  DataTransferItemList: 0,\n  FileList: 0,\n  HTMLAllCollection: 0,\n  HTMLCollection: 0,\n  HTMLFormElement: 0,\n  HTMLSelectElement: 0,\n  MediaList: 0,\n  MimeTypeArray: 0,\n  NamedNodeMap: 0,\n  NodeList: 1,\n  PaintRequestList: 0,\n  Plugin: 0,\n  PluginArray: 0,\n  SVGLengthList: 0,\n  SVGNumberList: 0,\n  SVGPathSegList: 0,\n  SVGPointList: 0,\n  SVGStringList: 0,\n  SVGTransformList: 0,\n  SourceBufferList: 0,\n  StyleSheetList: 0,\n  TextTrackCueList: 0,\n  TextTrackList: 0,\n  TouchList: 0\n};\n","// TODO: Remove from `core-js@4`\nrequire('./es.aggregate-error');\n","// TODO: Remove from `core-js@4`\nrequire('./es.promise.all-settled.js');\n","'use strict';\nvar $ = require('../internals/export');\nvar newPromiseCapabilityModule = require('../internals/new-promise-capability');\nvar perform = require('../internals/perform');\n\n// `Promise.try` method\n// https://github.com/tc39/proposal-promise-try\n$({ target: 'Promise', stat: true }, {\n  'try': function (callbackfn) {\n    var promiseCapability = newPromiseCapabilityModule.f(this);\n    var result = perform(callbackfn);\n    (result.error ? promiseCapability.reject : promiseCapability.resolve)(result.value);\n    return promiseCapability.promise;\n  }\n});\n","// TODO: Remove from `core-js@4`\nrequire('./es.promise.any');\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Graphics module\r\n */\r\nimport snippet from 'tui-code-snippet';\r\nimport fabric from 'fabric';\r\nimport ImageLoader from '@/component/imageLoader';\r\nimport Cropper from '@/component/cropper';\r\nimport Flip from '@/component/flip';\r\nimport Rotation from '@/component/rotation';\r\nimport FreeDrawing from '@/component/freeDrawing';\r\nimport Line from '@/component/line';\r\nimport Text from '@/component/text';\r\nimport Icon from '@/component/icon';\r\nimport Filter from '@/component/filter';\r\nimport Shape from '@/component/shape';\r\nimport Zoom from '@/component/zoom';\r\nimport CropperDrawingMode from '@/drawingMode/cropper';\r\nimport FreeDrawingMode from '@/drawingMode/freeDrawing';\r\nimport LineDrawingMode from '@/drawingMode/lineDrawing';\r\nimport ShapeDrawingMode from '@/drawingMode/shape';\r\nimport TextDrawingMode from '@/drawingMode/text';\r\nimport IconDrawingMode from '@/drawingMode/icon';\r\nimport ZoomDrawingMode from '@/drawingMode/zoom';\r\nimport {\r\n  makeSelectionUndoData,\r\n  makeSelectionUndoDatum,\r\n  setCachedUndoDataForDimension,\r\n} from '@/helper/selectionModifyHelper';\r\nimport { getProperties, includes, isShape, Promise } from '@/util';\r\nimport {\r\n  componentNames as components,\r\n  eventNames as events,\r\n  drawingModes,\r\n  fObjectOptions,\r\n} from '@/consts';\r\nimport Resize from '@/component/resize';\r\nimport ResizeDrawingMode from '@/drawingMode/resize';\r\nimport JsonLoader from '@/component/jsonLoader';\r\n\r\nconst { extend, stamp, isArray, isString, forEachArray, forEachOwnProperties, CustomEvents } =\r\n  snippet;\r\nconst DEFAULT_CSS_MAX_WIDTH = 1000;\r\nconst DEFAULT_CSS_MAX_HEIGHT = 800;\r\nconst EXTRA_PX_FOR_PASTE = 10;\r\n\r\nconst cssOnly = {\r\n  cssOnly: true,\r\n};\r\nconst backstoreOnly = {\r\n  backstoreOnly: true,\r\n};\r\n\r\n/**\r\n * Graphics class\r\n * @class\r\n * @param {string|HTMLElement} wrapper - Wrapper's element or selector\r\n * @param {Object} [option] - Canvas max width & height of css\r\n *  @param {number} option.cssMaxWidth - Canvas css-max-width\r\n *  @param {number} option.cssMaxHeight - Canvas css-max-height\r\n *  @param {String} option.backgroundColor - Canvas background color hex code\r\n * @ignore\r\n */\r\nclass Graphics {\r\n  constructor(\r\n    element,\r\n    { cssMaxWidth, cssMaxHeight, preserveObjectStacking, backgroundColor } = {}\r\n  ) {\r\n    /**\r\n     * Fabric image instance\r\n     * @type {fabric.Image}\r\n     */\r\n    this.canvasImage = null;\r\n\r\n    /**\r\n     * Max width of canvas elements\r\n     * @type {number}\r\n     */\r\n    this.cssMaxWidth = cssMaxWidth || DEFAULT_CSS_MAX_WIDTH;\r\n\r\n    /**\r\n     * Max height of canvas elements\r\n     * @type {number}\r\n     */\r\n    this.cssMaxHeight = cssMaxHeight || DEFAULT_CSS_MAX_HEIGHT;\r\n\r\n    /**\r\n     * cropper Selection Style\r\n     * @type {Object}\r\n     */\r\n    this.cropSelectionStyle = {};\r\n\r\n    /**\r\n     * target fabric object for copy paste feature\r\n     * @type {fabric.Object}\r\n     * @private\r\n     */\r\n    this.targetObjectForCopyPaste = null;\r\n\r\n    /**\r\n     * Image name\r\n     * @type {string}\r\n     */\r\n    this.imageName = '';\r\n\r\n    /**\r\n     * Object Map\r\n     * @type {Object}\r\n     * @private\r\n     */\r\n    this._objects = {};\r\n\r\n    /**\r\n     * Fabric-Canvas instance\r\n     * @type {fabric.Canvas}\r\n     * @private\r\n     */\r\n    this._canvas = null;\r\n\r\n    /**\r\n     * Drawing mode\r\n     * @type {string}\r\n     * @private\r\n     */\r\n    this._drawingMode = drawingModes.NORMAL;\r\n\r\n    /**\r\n     * DrawingMode map\r\n     * @type {Object.<string, DrawingMode>}\r\n     * @private\r\n     */\r\n    this._drawingModeMap = {};\r\n\r\n    /**\r\n     * Component map\r\n     * @type {Object.<string, Component>}\r\n     * @private\r\n     */\r\n    this._componentMap = {};\r\n\r\n    /**\r\n     * fabric event handlers\r\n     * @type {Object.<string, function>}\r\n     * @private\r\n     */\r\n    this._handler = {\r\n      onMouseDown: this._onMouseDown.bind(this),\r\n      onMouseUp: this._onMouseUp.bind(this),\r\n      onMouseMove: this._onMouseMove.bind(this),\r\n      onMouseWheel: this._onMouseWheel.bind(this),\r\n      onObjectAdded: this._onObjectAdded.bind(this),\r\n      onObjectRemoved: this._onObjectRemoved.bind(this),\r\n      onObjectMoved: this._onObjectMoved.bind(this),\r\n      onObjectScaled: this._onObjectScaled.bind(this),\r\n      onObjectModified: this._onObjectModified.bind(this),\r\n      onObjectRotated: this._onObjectRotated.bind(this),\r\n      onObjectSelected: this._onObjectSelected.bind(this),\r\n      onPathCreated: this._onPathCreated.bind(this),\r\n      onSelectionCleared: this._onSelectionCleared.bind(this),\r\n      onSelectionCreated: this._onSelectionCreated.bind(this),\r\n    };\r\n\r\n    this._setObjectCachingToFalse();\r\n    this._setCanvasElement(element, preserveObjectStacking, backgroundColor);\r\n    this._createDrawingModeInstances();\r\n    this._createComponents();\r\n    this._attachCanvasEvents();\r\n    this._attachZoomEvents();\r\n  }\r\n\r\n  /**\r\n   * Destroy canvas element\r\n   */\r\n  destroy() {\r\n    const { wrapperEl } = this._canvas;\r\n\r\n    this._canvas.clear();\r\n\r\n    wrapperEl.parentNode.removeChild(wrapperEl);\r\n\r\n    this._detachZoomEvents();\r\n  }\r\n\r\n  /**\r\n   * Attach zoom events\r\n   */\r\n  _attachZoomEvents() {\r\n    const zoom = this.getComponent(components.ZOOM);\r\n\r\n    zoom.attachKeyboardZoomEvents();\r\n  }\r\n\r\n  /**\r\n   * Detach zoom events\r\n   */\r\n  _detachZoomEvents() {\r\n    const zoom = this.getComponent(components.ZOOM);\r\n\r\n    zoom.detachKeyboardZoomEvents();\r\n  }\r\n\r\n  /**\r\n   * Deactivates all objects on canvas\r\n   * @returns {Graphics} this\r\n   */\r\n  deactivateAll() {\r\n    this._canvas.discardActiveObject();\r\n\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Renders all objects on canvas\r\n   * @returns {Graphics} this\r\n   */\r\n  renderAll() {\r\n    this._canvas.renderAll();\r\n\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Adds objects on canvas\r\n   * @param {Object|Array} objects - objects\r\n   */\r\n  add(objects) {\r\n    let theArgs = [];\r\n    if (isArray(objects)) {\r\n      theArgs = objects;\r\n    } else {\r\n      theArgs.push(objects);\r\n    }\r\n\r\n    this._canvas.add(...theArgs);\r\n  }\r\n\r\n  /**\r\n   * Removes the object or group\r\n   * @param {Object} target - graphics object or group\r\n   * @returns {boolean} true if contains or false\r\n   */\r\n  contains(target) {\r\n    return this._canvas.contains(target);\r\n  }\r\n\r\n  /**\r\n   * Gets all objects or group\r\n   * @returns {Array} all objects, shallow copy\r\n   */\r\n  getObjects() {\r\n    return this._canvas.getObjects().slice();\r\n  }\r\n\r\n  /**\r\n   * Get an object by id\r\n   * @param {number} objId -  object id\r\n   * @returns {fabric.Object} object corresponding id\r\n   */\r\n  getObject(objId) {\r\n    return this._objects[objId];\r\n  }\r\n\r\n  /**\r\n   * Removes the object or group\r\n   * @param {Object} target - graphics object or group\r\n   */\r\n  remove(target) {\r\n    this._canvas.remove(target);\r\n  }\r\n\r\n  /**\r\n   * Removes all object or group\r\n   * @param {boolean} includesBackground - remove the background image or not\r\n   * @returns {Array} all objects array which is removed\r\n   */\r\n  removeAll(includesBackground) {\r\n    const canvas = this._canvas;\r\n    const objects = canvas.getObjects().slice();\r\n    canvas.remove(...this._canvas.getObjects());\r\n\r\n    if (includesBackground) {\r\n      canvas.clear();\r\n    }\r\n\r\n    return objects;\r\n  }\r\n\r\n  /**\r\n   * Removes an object or group by id\r\n   * @param {number} objId -  object id\r\n   * @returns {Array} removed objects\r\n   */\r\n  removeObjectById(objId) {\r\n    const objects = [];\r\n    const canvas = this._canvas;\r\n    const target = this.getObject(objId);\r\n    const isValidGroup = target && target.isType('group') && !target.isEmpty();\r\n\r\n    if (isValidGroup) {\r\n      canvas.discardActiveObject(); // restore states for each objects\r\n      target.forEachObject((obj) => {\r\n        objects.push(obj);\r\n        canvas.remove(obj);\r\n      });\r\n    } else if (canvas.contains(target)) {\r\n      objects.push(target);\r\n      canvas.remove(target);\r\n    }\r\n\r\n    return objects;\r\n  }\r\n\r\n  /**\r\n   * Get an id by object instance\r\n   * @param {fabric.Object} object object\r\n   * @returns {number} object id if it exists or null\r\n   */\r\n  getObjectId(object) {\r\n    let key = null;\r\n    for (key in this._objects) {\r\n      if (this._objects.hasOwnProperty(key)) {\r\n        if (object === this._objects[key]) {\r\n          return key;\r\n        }\r\n      }\r\n    }\r\n\r\n    return null;\r\n  }\r\n\r\n  /**\r\n   * Gets an active object or group\r\n   * @returns {Object} active object or group instance\r\n   */\r\n  getActiveObject() {\r\n    return this._canvas._activeObject;\r\n  }\r\n\r\n  /**\r\n   * Returns the object ID to delete the object.\r\n   * @returns {number} object id for remove\r\n   */\r\n  getActiveObjectIdForRemove() {\r\n    const activeObject = this.getActiveObject();\r\n    const { type, left, top } = activeObject;\r\n    const isSelection = type === 'activeSelection';\r\n\r\n    if (isSelection) {\r\n      const group = new fabric.Group([...activeObject.getObjects()], {\r\n        left,\r\n        top,\r\n      });\r\n\r\n      return this._addFabricObject(group);\r\n    }\r\n\r\n    return this.getObjectId(activeObject);\r\n  }\r\n\r\n  /**\r\n   * Verify that you are ready to erase the object.\r\n   * @returns {boolean} ready for object remove\r\n   */\r\n  isReadyRemoveObject() {\r\n    const activeObject = this.getActiveObject();\r\n\r\n    return activeObject && !activeObject.isEditing;\r\n  }\r\n\r\n  /**\r\n   * Gets an active group object\r\n   * @returns {Object} active group object instance\r\n   */\r\n  getActiveObjects() {\r\n    const activeObject = this._canvas._activeObject;\r\n\r\n    return activeObject && activeObject.type === 'activeSelection' ? activeObject : null;\r\n  }\r\n\r\n  /**\r\n   * Get Active object Selection from object ids\r\n   * @param {Array.<Object>} objects - fabric objects\r\n   * @returns {Object} target - target object group\r\n   */\r\n  getActiveSelectionFromObjects(objects) {\r\n    const canvas = this.getCanvas();\r\n\r\n    return new fabric.ActiveSelection(objects, { canvas });\r\n  }\r\n\r\n  /**\r\n   * Activates an object or group\r\n   * @param {Object} target - target object or group\r\n   */\r\n  setActiveObject(target) {\r\n    this._canvas.setActiveObject(target);\r\n  }\r\n\r\n  /**\r\n   * Set Crop selection style\r\n   * @param {Object} style - Selection styles\r\n   */\r\n  setCropSelectionStyle(style) {\r\n    this.cropSelectionStyle = style;\r\n  }\r\n\r\n  /**\r\n   * Get component\r\n   * @param {string} name - Component name\r\n   * @returns {Component}\r\n   */\r\n  getComponent(name) {\r\n    return this._componentMap[name];\r\n  }\r\n\r\n  /**\r\n   * Get current drawing mode\r\n   * @returns {string}\r\n   */\r\n  getDrawingMode() {\r\n    return this._drawingMode;\r\n  }\r\n\r\n  /**\r\n   * Start a drawing mode. If the current mode is not 'NORMAL', 'stopDrawingMode()' will be called first.\r\n   * @param {String} mode Can be one of <I>'CROPPER', 'FREE_DRAWING', 'LINE', 'TEXT', 'SHAPE'</I>\r\n   * @param {Object} [option] parameters of drawing mode, it's available with 'FREE_DRAWING', 'LINE_DRAWING'\r\n   *  @param {Number} [option.width] brush width\r\n   *  @param {String} [option.color] brush color\r\n   * @returns {boolean} true if success or false\r\n   */\r\n  startDrawingMode(mode, option) {\r\n    if (this._isSameDrawingMode(mode)) {\r\n      return true;\r\n    }\r\n\r\n    // If the current mode is not 'NORMAL', 'stopDrawingMode()' will be called first.\r\n    this.stopDrawingMode();\r\n\r\n    const drawingModeInstance = this._getDrawingModeInstance(mode);\r\n    if (drawingModeInstance && drawingModeInstance.start) {\r\n      drawingModeInstance.start(this, option);\r\n\r\n      this._drawingMode = mode;\r\n    }\r\n\r\n    return !!drawingModeInstance;\r\n  }\r\n\r\n  /**\r\n   * Stop the current drawing mode and back to the 'NORMAL' mode\r\n   */\r\n  stopDrawingMode() {\r\n    if (this._isSameDrawingMode(drawingModes.NORMAL)) {\r\n      return;\r\n    }\r\n\r\n    const drawingModeInstance = this._getDrawingModeInstance(this.getDrawingMode());\r\n    if (drawingModeInstance && drawingModeInstance.end) {\r\n      drawingModeInstance.end(this);\r\n    }\r\n    this._drawingMode = drawingModes.NORMAL;\r\n  }\r\n\r\n  canvasZoom({ x, y }, zoomLevel) {\r\n    const canvas = this.getCanvas();\r\n    canvas.zoomToPoint({ x, y }, zoomLevel);\r\n  }\r\n\r\n  getCanvasZoom() {\r\n    return this.getCanvas().getZoom();\r\n  }\r\n\r\n  /**\r\n   * Change zoom of canvas\r\n   * @param {{x: number, y: number}} center - center of zoom\r\n   * @param {number} zoomLevel - zoom level\r\n   */\r\n  zoom({ x, y }, zoomLevel) {\r\n    const zoom = this.getComponent(components.ZOOM);\r\n\r\n    zoom.zoom({ x, y }, zoomLevel);\r\n  }\r\n\r\n  /**\r\n   * Get zoom mode\r\n   * @returns {string}\r\n   */\r\n  getZoomMode() {\r\n    const zoom = this.getComponent(components.ZOOM);\r\n\r\n    return zoom.mode;\r\n  }\r\n\r\n  /**\r\n   * Start zoom-in mode\r\n   */\r\n  startZoomInMode() {\r\n    const zoom = this.getComponent(components.ZOOM);\r\n\r\n    zoom.startZoomInMode();\r\n  }\r\n\r\n  /**\r\n   * Stop zoom-in mode\r\n   */\r\n  endZoomInMode() {\r\n    const zoom = this.getComponent(components.ZOOM);\r\n\r\n    zoom.endZoomInMode();\r\n  }\r\n\r\n  /**\r\n   * Zoom out one step\r\n   */\r\n  zoomOut() {\r\n    const zoom = this.getComponent(components.ZOOM);\r\n\r\n    zoom.zoomOut();\r\n  }\r\n\r\n  /**\r\n   * Start hand mode\r\n   */\r\n  startHandMode() {\r\n    const zoom = this.getComponent(components.ZOOM);\r\n\r\n    zoom.startHandMode();\r\n  }\r\n\r\n  /**\r\n   * Stop hand mode\r\n   */\r\n  endHandMode() {\r\n    const zoom = this.getComponent(components.ZOOM);\r\n\r\n    zoom.endHandMode();\r\n  }\r\n\r\n  /**\r\n   * Zoom reset\r\n   */\r\n  resetZoom() {\r\n    const zoom = this.getComponent(components.ZOOM);\r\n\r\n    zoom.resetZoom();\r\n  }\r\n\r\n  /**\r\n   * To data url from canvas\r\n   * @param {Object} options - options for toDataURL\r\n   *   @param {String} [options.format=png] The format of the output image. Either \"jpeg\" or \"png\"\r\n   *   @param {Number} [options.quality=1] Quality level (0..1). Only used for jpeg.\r\n   *   @param {Number} [options.multiplier=1] Multiplier to scale by\r\n   *   @param {Number} [options.left] Cropping left offset. Introduced in fabric v1.2.14\r\n   *   @param {Number} [options.top] Cropping top offset. Introduced in fabric v1.2.14\r\n   *   @param {Number} [options.width] Cropping width. Introduced in fabric v1.2.14\r\n   *   @param {Number} [options.height] Cropping height. Introduced in fabric v1.2.14\r\n   * @returns {string} A DOMString containing the requested data URI.\r\n   */\r\n  toDataURL(options) {\r\n    const cropper = this.getComponent(components.CROPPER);\r\n    cropper.changeVisibility(false);\r\n\r\n    const dataUrl = this._canvas && this._canvas.toDataURL(options);\r\n    cropper.changeVisibility(true);\r\n\r\n    return dataUrl;\r\n  }\r\n\r\n  /**\r\n   * Save image(background) of canvas\r\n   * @param {string} name - Name of image\r\n   * @param {?fabric.Image} canvasImage - Fabric image instance\r\n   */\r\n  setCanvasImage(name, canvasImage) {\r\n    if (canvasImage) {\r\n      stamp(canvasImage);\r\n    }\r\n    this.imageName = name;\r\n    this.canvasImage = canvasImage;\r\n  }\r\n\r\n  /**\r\n   * Set css max dimension\r\n   * @param {{width: number, height: number}} maxDimension - Max width & Max height\r\n   */\r\n  setCssMaxDimension(maxDimension) {\r\n    this.cssMaxWidth = maxDimension.width || this.cssMaxWidth;\r\n    this.cssMaxHeight = maxDimension.height || this.cssMaxHeight;\r\n  }\r\n\r\n  /**\r\n   * Adjust canvas dimension with scaling image\r\n   */\r\n  adjustCanvasDimension() {\r\n    this.adjustCanvasDimensionBase(this.canvasImage.scale(1));\r\n  }\r\n\r\n  adjustCanvasDimensionBase(canvasImage = null) {\r\n    if (!canvasImage) {\r\n      canvasImage = this.canvasImage;\r\n    }\r\n\r\n    const { width, height } = canvasImage.getBoundingRect();\r\n    const maxDimension = this._calcMaxDimension(width, height);\r\n\r\n    this.setCanvasCssDimension({\r\n      width: '100%',\r\n      height: '100%', // Set height '' for IE9\r\n      'max-width': `${maxDimension.width}px`,\r\n      'max-height': `${maxDimension.height}px`,\r\n    });\r\n\r\n    this.setCanvasBackstoreDimension({\r\n      width,\r\n      height,\r\n    });\r\n    this._canvas.centerObject(canvasImage);\r\n  }\r\n\r\n  /**\r\n   * Set canvas dimension - css only\r\n   *  {@link http://fabricjs.com/docs/fabric.Canvas.html#setDimensions}\r\n   * @param {Object} dimension - Canvas css dimension\r\n   */\r\n  setCanvasCssDimension(dimension) {\r\n    this._canvas.setDimensions(dimension, cssOnly);\r\n  }\r\n\r\n  /**\r\n   * Set canvas dimension - backstore only\r\n   *  {@link http://fabricjs.com/docs/fabric.Canvas.html#setDimensions}\r\n   * @param {Object} dimension - Canvas backstore dimension\r\n   */\r\n  setCanvasBackstoreDimension(dimension) {\r\n    this._canvas.setDimensions(dimension, backstoreOnly);\r\n  }\r\n\r\n  /**\r\n   * Set image properties\r\n   * {@link http://fabricjs.com/docs/fabric.Image.html#set}\r\n   * @param {Object} setting - Image properties\r\n   * @param {boolean} [withRendering] - If true, The changed image will be reflected in the canvas\r\n   */\r\n  setImageProperties(setting, withRendering) {\r\n    const { canvasImage } = this;\r\n\r\n    if (!canvasImage) {\r\n      return;\r\n    }\r\n\r\n    canvasImage.set(setting).setCoords();\r\n    if (withRendering) {\r\n      this._canvas.renderAll();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Returns canvas element of fabric.Canvas[[lower-canvas]]\r\n   * @returns {HTMLCanvasElement}\r\n   */\r\n  getCanvasElement() {\r\n    return this._canvas.getElement();\r\n  }\r\n\r\n  /**\r\n   * Get fabric.Canvas instance\r\n   * @returns {fabric.Canvas}\r\n   */\r\n  getCanvas() {\r\n    return this._canvas;\r\n  }\r\n\r\n  /**\r\n   * Get canvasImage (fabric.Image instance)\r\n   * @returns {fabric.Image}\r\n   */\r\n  getCanvasImage() {\r\n    return this.canvasImage;\r\n  }\r\n\r\n  /**\r\n   * Get image name\r\n   * @returns {string}\r\n   */\r\n  getImageName() {\r\n    return this.imageName;\r\n  }\r\n\r\n  /**\r\n   * Add image object on canvas\r\n   * @param {string} imgUrl - Image url to make object\r\n   * @returns {Promise}\r\n   */\r\n  addImageObject(imgUrl) {\r\n    const callback = this._callbackAfterLoadingImageObject.bind(this);\r\n\r\n    return new Promise((resolve) => {\r\n      fabric.Image.fromURL(\r\n        imgUrl,\r\n        (image) => {\r\n          callback(image);\r\n          resolve(this.createObjectProperties(image));\r\n        },\r\n        {\r\n          crossOrigin: 'Anonymous',\r\n        }\r\n      );\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Get center position of canvas\r\n   * @returns {Object} {left, top}\r\n   */\r\n  getCenter() {\r\n    return this._canvas.getCenter();\r\n  }\r\n\r\n  /**\r\n   * Get cropped rect\r\n   * @returns {Object} rect\r\n   */\r\n  getCropzoneRect() {\r\n    return this.getComponent(components.CROPPER).getCropzoneRect();\r\n  }\r\n\r\n  /**\r\n   * Get cropped rect\r\n   * @param {number} [mode] cropzone rect mode\r\n   */\r\n  setCropzoneRect(mode) {\r\n    this.getComponent(components.CROPPER).setCropzoneRect(mode);\r\n  }\r\n\r\n  /**\r\n   * Get cropped image data\r\n   * @param {Object} cropRect cropzone rect\r\n   *  @param {Number} cropRect.left left position\r\n   *  @param {Number} cropRect.top top position\r\n   *  @param {Number} cropRect.width width\r\n   *  @param {Number} cropRect.height height\r\n   * @returns {?{imageName: string, url: string}} cropped Image data\r\n   */\r\n  getCroppedImageData(cropRect) {\r\n    return this.getComponent(components.CROPPER).getCroppedImageData(cropRect);\r\n  }\r\n\r\n  /**\r\n   * Set brush option\r\n   * @param {Object} option brush option\r\n   *  @param {Number} option.width width\r\n   *  @param {String} option.color color like 'FFFFFF', 'rgba(0, 0, 0, 0.5)'\r\n   */\r\n  setBrush(option) {\r\n    const drawingMode = this._drawingMode;\r\n    let compName = components.FREE_DRAWING;\r\n\r\n    if (drawingMode === drawingModes.LINE_DRAWING) {\r\n      compName = components.LINE;\r\n    }\r\n\r\n    this.getComponent(compName).setBrush(option);\r\n  }\r\n\r\n  /**\r\n   * Set states of current drawing shape\r\n   * @param {string} type - Shape type (ex: 'rect', 'circle', 'triangle')\r\n   * @param {Object} [options] - Shape options\r\n   *      @param {(ShapeFillOption | string)} [options.fill] - {@link ShapeFillOption} or\r\n   *        Shape foreground color (ex: '#fff', 'transparent')\r\n   *      @param {string} [options.stoke] - Shape outline color\r\n   *      @param {number} [options.strokeWidth] - Shape outline width\r\n   *      @param {number} [options.width] - Width value (When type option is 'rect', this options can use)\r\n   *      @param {number} [options.height] - Height value (When type option is 'rect', this options can use)\r\n   *      @param {number} [options.rx] - Radius x value (When type option is 'circle', this options can use)\r\n   *      @param {number} [options.ry] - Radius y value (When type option is 'circle', this options can use)\r\n   *      @param {number} [options.isRegular] - Whether resizing shape has 1:1 ratio or not\r\n   */\r\n  setDrawingShape(type, options) {\r\n    this.getComponent(components.SHAPE).setStates(type, options);\r\n  }\r\n\r\n  /**\r\n   * Set style of current drawing icon\r\n   * @param {string} type - icon type (ex: 'icon-arrow', 'icon-star')\r\n   * @param {Object} [iconColor] - Icon color\r\n   */\r\n  setIconStyle(type, iconColor) {\r\n    this.getComponent(components.ICON).setStates(type, iconColor);\r\n  }\r\n\r\n  /**\r\n   * Register icon paths\r\n   * @param {Object} pathInfos - Path infos\r\n   *  @param {string} pathInfos.key - key\r\n   *  @param {string} pathInfos.value - value\r\n   */\r\n  registerPaths(pathInfos) {\r\n    this.getComponent(components.ICON).registerPaths(pathInfos);\r\n  }\r\n\r\n  /**\r\n   * Change cursor style\r\n   * @param {string} cursorType - cursor type\r\n   */\r\n  changeCursor(cursorType) {\r\n    const canvas = this.getCanvas();\r\n    canvas.defaultCursor = cursorType;\r\n    canvas.renderAll();\r\n  }\r\n\r\n  /**\r\n   * Whether it has the filter or not\r\n   * @param {string} type - Filter type\r\n   * @returns {boolean} true if it has the filter\r\n   */\r\n  hasFilter(type) {\r\n    return this.getComponent(components.FILTER).hasFilter(type);\r\n  }\r\n\r\n  /**\r\n   * Set selection style of fabric object by init option\r\n   * @param {Object} styles - Selection styles\r\n   */\r\n  setSelectionStyle(styles) {\r\n    extend(fObjectOptions.SELECTION_STYLE, styles);\r\n  }\r\n\r\n  /**\r\n   * Set object properties\r\n   * @param {number} objId -  object id\r\n   * @param {Object} props - props\r\n   *     @param {string} [props.fill] Color\r\n   *     @param {string} [props.fontFamily] Font type for text\r\n   *     @param {number} [props.fontSize] Size\r\n   *     @param {string} [props.fontStyle] Type of inclination (normal / italic)\r\n   *     @param {string} [props.fontWeight] Type of thicker or thinner looking (normal / bold)\r\n   *     @param {string} [props.textAlign] Type of text align (left / center / right)\r\n   *     @param {string} [props.textDecoration] Type of line (underline / line-through / overline)\r\n   * @returns {Object} applied properties\r\n   */\r\n  setObjectProperties(objId, props) {\r\n    const object = this.getObject(objId);\r\n    const clone = extend({}, props);\r\n\r\n    object.set(clone);\r\n\r\n    object.setCoords();\r\n\r\n    this.getCanvas().renderAll();\r\n\r\n    return clone;\r\n  }\r\n\r\n  /**\r\n   * Get object properties corresponding key\r\n   * @param {number} objId -  object id\r\n   * @param {Array<string>|ObjectProps|string} keys - property's key\r\n   * @returns {Object} properties\r\n   */\r\n  getObjectProperties(objId, keys) {\r\n    const object = this.getObject(objId);\r\n    const props = {};\r\n\r\n    if (isString(keys)) {\r\n      props[keys] = object[keys];\r\n    } else if (isArray(keys)) {\r\n      forEachArray(keys, (value) => {\r\n        props[value] = object[value];\r\n      });\r\n    } else {\r\n      forEachOwnProperties(keys, (value, key) => {\r\n        props[key] = object[key];\r\n      });\r\n    }\r\n\r\n    return props;\r\n  }\r\n\r\n  /**\r\n   * Get object position by originX, originY\r\n   * @param {number} objId -  object id\r\n   * @param {string} originX - can be 'left', 'center', 'right'\r\n   * @param {string} originY - can be 'top', 'center', 'bottom'\r\n   * @returns {Object} {{x:number, y: number}} position by origin if id is valobjId, or null\r\n   */\r\n  getObjectPosition(objId, originX, originY) {\r\n    const targetObj = this.getObject(objId);\r\n    if (!targetObj) {\r\n      return null;\r\n    }\r\n\r\n    return targetObj.getPointByOrigin(originX, originY);\r\n  }\r\n\r\n  /**\r\n   * Set object position  by originX, originY\r\n   * @param {number} objId -  object id\r\n   * @param {Object} posInfo - position object\r\n   *  @param {number} posInfo.x - x position\r\n   *  @param {number} posInfo.y - y position\r\n   *  @param {string} posInfo.originX - can be 'left', 'center', 'right'\r\n   *  @param {string} posInfo.originY - can be 'top', 'center', 'bottom'\r\n   * @returns {boolean} true if target id is valid or false\r\n   */\r\n  setObjectPosition(objId, posInfo) {\r\n    const targetObj = this.getObject(objId);\r\n    const { x, y, originX, originY } = posInfo;\r\n    if (!targetObj) {\r\n      return false;\r\n    }\r\n\r\n    const targetOrigin = targetObj.getPointByOrigin(originX, originY);\r\n    const centerOrigin = targetObj.getPointByOrigin('center', 'center');\r\n    const diffX = centerOrigin.x - targetOrigin.x;\r\n    const diffY = centerOrigin.y - targetOrigin.y;\r\n\r\n    targetObj.set({\r\n      left: x + diffX,\r\n      top: y + diffY,\r\n    });\r\n\r\n    targetObj.setCoords();\r\n\r\n    return true;\r\n  }\r\n\r\n  /**\r\n   * Get the canvas size\r\n   * @returns {Object} {{width: number, height: number}} image size\r\n   */\r\n  getCanvasSize() {\r\n    const image = this.getCanvasImage();\r\n\r\n    return {\r\n      width: image ? image.width : 0,\r\n      height: image ? image.height : 0,\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Create fabric static canvas\r\n   * @returns {Object} {{width: number, height: number}} image size\r\n   */\r\n  createStaticCanvas() {\r\n    const staticCanvas = new fabric.StaticCanvas();\r\n\r\n    staticCanvas.set({\r\n      enableRetinaScaling: false,\r\n    });\r\n\r\n    return staticCanvas;\r\n  }\r\n\r\n  /**\r\n   * Get a DrawingMode instance\r\n   * @param {string} modeName - DrawingMode Class Name\r\n   * @returns {DrawingMode} DrawingMode instance\r\n   * @private\r\n   */\r\n  _getDrawingModeInstance(modeName) {\r\n    return this._drawingModeMap[modeName];\r\n  }\r\n\r\n  /**\r\n   * Set object caching to false. This brought many bugs when draw Shape & cropzone\r\n   * @see http://fabricjs.com/fabric-object-caching\r\n   * @private\r\n   */\r\n  _setObjectCachingToFalse() {\r\n    fabric.Object.prototype.objectCaching = false;\r\n  }\r\n\r\n  /**\r\n   * Set canvas element to fabric.Canvas\r\n   * @param {Element|string} element - Wrapper or canvas element or selector\r\n   * @param {Boolean} preserveObjectStacking - preserve object stacking or not\r\n   * @param {String} backgroundColor - hex code for canvas background color\r\n   * @private\r\n   */\r\n  _setCanvasElement(element, preserveObjectStacking, backgroundColor) {\r\n    let selectedElement;\r\n    let canvasElement;\r\n\r\n    if (element.nodeType) {\r\n      selectedElement = element;\r\n    } else {\r\n      selectedElement = document.querySelector(element);\r\n    }\r\n\r\n    if (selectedElement.nodeName.toUpperCase() !== 'CANVAS') {\r\n      canvasElement = document.createElement('canvas');\r\n      selectedElement.appendChild(canvasElement);\r\n    }\r\n\r\n    this._canvas = new fabric.Canvas(canvasElement, {\r\n      backgroundColor,\r\n      containerClass: 'tui-image-editor-canvas-container',\r\n      enableRetinaScaling: false,\r\n      preserveObjectStacking,\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Creates DrawingMode instances\r\n   * @private\r\n   */\r\n  _createDrawingModeInstances() {\r\n    this._register(this._drawingModeMap, new CropperDrawingMode());\r\n    this._register(this._drawingModeMap, new FreeDrawingMode());\r\n    this._register(this._drawingModeMap, new LineDrawingMode());\r\n    this._register(this._drawingModeMap, new ShapeDrawingMode());\r\n    this._register(this._drawingModeMap, new TextDrawingMode());\r\n    this._register(this._drawingModeMap, new IconDrawingMode());\r\n    this._register(this._drawingModeMap, new ZoomDrawingMode());\r\n    this._register(this._drawingModeMap, new ResizeDrawingMode());\r\n  }\r\n\r\n  /**\r\n   * Create components\r\n   * @private\r\n   */\r\n  _createComponents() {\r\n    this._register(this._componentMap, new ImageLoader(this));\r\n    this._register(this._componentMap, new JsonLoader(this));\r\n    this._register(this._componentMap, new Cropper(this));\r\n    this._register(this._componentMap, new Flip(this));\r\n    this._register(this._componentMap, new Rotation(this));\r\n    this._register(this._componentMap, new FreeDrawing(this));\r\n    this._register(this._componentMap, new Line(this));\r\n    this._register(this._componentMap, new Text(this));\r\n    this._register(this._componentMap, new Icon(this));\r\n    this._register(this._componentMap, new Filter(this));\r\n    this._register(this._componentMap, new Shape(this));\r\n    this._register(this._componentMap, new Zoom(this));\r\n    this._register(this._componentMap, new Resize(this));\r\n  }\r\n\r\n  /**\r\n   * Register component\r\n   * @param {Object} map - map object\r\n   * @param {Object} module - module which has getName method\r\n   * @private\r\n   */\r\n  _register(map, module) {\r\n    map[module.getName()] = module;\r\n  }\r\n\r\n  /**\r\n   * Get the current drawing mode is same with given mode\r\n   * @param {string} mode drawing mode\r\n   * @returns {boolean} true if same or false\r\n   */\r\n  _isSameDrawingMode(mode) {\r\n    return this.getDrawingMode() === mode;\r\n  }\r\n\r\n  /**\r\n   * Calculate max dimension of canvas\r\n   * The css-max dimension is dynamically decided with maintaining image ratio\r\n   * The css-max dimension is lower than canvas dimension (attribute of canvas, not css)\r\n   * @param {number} width - Canvas width\r\n   * @param {number} height - Canvas height\r\n   * @returns {{width: number, height: number}} - Max width & Max height\r\n   * @private\r\n   */\r\n  _calcMaxDimension(width, height) {\r\n    const wScaleFactor = this.cssMaxWidth / width;\r\n    const hScaleFactor = this.cssMaxHeight / height;\r\n    let cssMaxWidth = Math.min(width, this.cssMaxWidth);\r\n    let cssMaxHeight = Math.min(height, this.cssMaxHeight);\r\n\r\n    if (wScaleFactor < 1 && wScaleFactor < hScaleFactor) {\r\n      cssMaxWidth = width * wScaleFactor;\r\n      cssMaxHeight = height * wScaleFactor;\r\n    } else if (hScaleFactor < 1 && hScaleFactor < wScaleFactor) {\r\n      cssMaxWidth = width * hScaleFactor;\r\n      cssMaxHeight = height * hScaleFactor;\r\n    }\r\n\r\n    return {\r\n      width: Math.floor(cssMaxWidth),\r\n      height: Math.floor(cssMaxHeight),\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Callback function after loading image\r\n   * @param {fabric.Image} obj - Fabric image object\r\n   * @private\r\n   */\r\n  _callbackAfterLoadingImageObject(obj) {\r\n    const centerPos = this.getCanvasImage().getCenterPoint();\r\n\r\n    obj.set(fObjectOptions.SELECTION_STYLE);\r\n    obj.set({\r\n      left: centerPos.x,\r\n      top: centerPos.y,\r\n      crossOrigin: 'Anonymous',\r\n    });\r\n\r\n    this.getCanvas().add(obj).setActiveObject(obj);\r\n  }\r\n\r\n  /**\r\n   * Attach canvas's events\r\n   */\r\n  _attachCanvasEvents() {\r\n    const canvas = this._canvas;\r\n    const handler = this._handler;\r\n    canvas.on({\r\n      'mouse:down': handler.onMouseDown,\r\n      'mouse:up': handler.onMouseUp,\r\n      'mouse:move': handler.onMouseMove,\r\n      'mouse:wheel': handler.onMouseWheel,\r\n      'object:added': handler.onObjectAdded,\r\n      'object:removed': handler.onObjectRemoved,\r\n      'object:moving': handler.onObjectMoved,\r\n      'object:scaling': handler.onObjectScaled,\r\n      'object:modified': handler.onObjectModified,\r\n      'object:rotating': handler.onObjectRotated,\r\n      'path:created': handler.onPathCreated,\r\n      'selection:cleared': handler.onSelectionCleared,\r\n      'selection:created': handler.onSelectionCreated,\r\n      'selection:updated': handler.onObjectSelected,\r\n    });\r\n  }\r\n\r\n  /**\r\n   * \"mouse:down\" canvas event handler\r\n   * @param {{target: fabric.Object, e: MouseEvent}} fEvent - Fabric event\r\n   * @private\r\n   */\r\n  _onMouseDown(fEvent) {\r\n    const { e: event, target } = fEvent;\r\n    const originPointer = this._canvas.getPointer(event);\r\n\r\n    if (target) {\r\n      const { type } = target;\r\n      const undoData = makeSelectionUndoData(target, (item) =>\r\n        makeSelectionUndoDatum(this.getObjectId(item), item, type === 'activeSelection')\r\n      );\r\n\r\n      setCachedUndoDataForDimension(undoData);\r\n    }\r\n\r\n    this.fire(events.MOUSE_DOWN, event, originPointer);\r\n  }\r\n\r\n  _onMouseUp(fEvent) {\r\n    const { e: event } = fEvent;\r\n    const originPointer = this._canvas.getPointer(event);\r\n\r\n    this.fire(events.MOUSE_UP, event, originPointer);\r\n  }\r\n\r\n  _onMouseMove(fEvent) {\r\n    const { e: event } = fEvent;\r\n    const originPointer = this._canvas.getPointer(event);\r\n\r\n    this.fire(events.MOUSE_MOVE, event, originPointer);\r\n  }\r\n\r\n  _onMouseWheel(fEvent) {\r\n    const { e: event } = fEvent;\r\n    const originPointer = this._canvas.getPointer(event);\r\n\r\n    this.fire(events.MOUSE_WHEEL, event, originPointer);\r\n  }\r\n\r\n  /**\r\n   * \"object:added\" canvas event handler\r\n   * @param {{target: fabric.Object, e: MouseEvent}} fEvent - Fabric event\r\n   * @private\r\n   */\r\n  _onObjectAdded(fEvent) {\r\n    const obj = fEvent.target;\r\n    if (obj.isType('cropzone')) {\r\n      return;\r\n    }\r\n\r\n    this._addFabricObject(obj);\r\n  }\r\n\r\n  /**\r\n   * \"object:removed\" canvas event handler\r\n   * @param {{target: fabric.Object, e: MouseEvent}} fEvent - Fabric event\r\n   * @private\r\n   */\r\n  _onObjectRemoved(fEvent) {\r\n    const obj = fEvent.target;\r\n\r\n    this._removeFabricObject(stamp(obj));\r\n  }\r\n\r\n  /**\r\n   * \"object:moving\" canvas event handler\r\n   * @param {{target: fabric.Object, e: MouseEvent}} fEvent - Fabric event\r\n   * @private\r\n   */\r\n  _onObjectMoved(fEvent) {\r\n    this._lazyFire(\r\n      events.OBJECT_MOVED,\r\n      (object) => this.createObjectProperties(object),\r\n      fEvent.target\r\n    );\r\n  }\r\n\r\n  /**\r\n   * \"object:scaling\" canvas event handler\r\n   * @param {{target: fabric.Object, e: MouseEvent}} fEvent - Fabric event\r\n   * @private\r\n   */\r\n  _onObjectScaled(fEvent) {\r\n    this._lazyFire(\r\n      events.OBJECT_SCALED,\r\n      (object) => this.createObjectProperties(object),\r\n      fEvent.target\r\n    );\r\n  }\r\n\r\n  /**\r\n   * \"object:modified\" canvas event handler\r\n   * @param {{target: fabric.Object, e: MouseEvent}} fEvent - Fabric event\r\n   * @private\r\n   */\r\n  _onObjectModified(fEvent) {\r\n    const { target } = fEvent;\r\n    if (target.type === 'activeSelection') {\r\n      const items = target.getObjects();\r\n\r\n      items.forEach((item) => item.fire('modifiedInGroup', target));\r\n    }\r\n\r\n    this.fire(events.OBJECT_MODIFIED, target, this.getObjectId(target));\r\n  }\r\n\r\n  /**\r\n   * \"object:rotating\" canvas event handler\r\n   * @param {{target: fabric.Object, e: MouseEvent}} fEvent - Fabric event\r\n   * @private\r\n   */\r\n  _onObjectRotated(fEvent) {\r\n    this._lazyFire(\r\n      events.OBJECT_ROTATED,\r\n      (object) => this.createObjectProperties(object),\r\n      fEvent.target\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Lazy event emitter\r\n   * @param {string} eventName - event name\r\n   * @param {Function} paramsMaker - make param function\r\n   * @param {Object} [target] - Object of the event owner.\r\n   * @private\r\n   */\r\n  _lazyFire(eventName, paramsMaker, target) {\r\n    const existEventDelegation = target && target.canvasEventDelegation;\r\n    const delegationState = existEventDelegation ? target.canvasEventDelegation(eventName) : 'none';\r\n\r\n    if (delegationState === 'unregistered') {\r\n      target.canvasEventRegister(eventName, (object) => {\r\n        this.fire(eventName, paramsMaker(object));\r\n      });\r\n    }\r\n\r\n    if (delegationState === 'none') {\r\n      this.fire(eventName, paramsMaker(target));\r\n    }\r\n  }\r\n\r\n  /**\r\n   * \"object:selected\" canvas event handler\r\n   * @param {{target: fabric.Object, e: MouseEvent}} fEvent - Fabric event\r\n   * @private\r\n   */\r\n  _onObjectSelected(fEvent) {\r\n    const { target } = fEvent;\r\n    const params = this.createObjectProperties(target);\r\n\r\n    this.fire(events.OBJECT_ACTIVATED, params);\r\n  }\r\n\r\n  /**\r\n   * \"path:created\" canvas event handler\r\n   * @param {{path: fabric.Path}} obj - Path object\r\n   * @private\r\n   */\r\n  _onPathCreated(obj) {\r\n    const { x: left, y: top } = obj.path.getCenterPoint();\r\n    obj.path.set(\r\n      extend(\r\n        {\r\n          left,\r\n          top,\r\n        },\r\n        fObjectOptions.SELECTION_STYLE\r\n      )\r\n    );\r\n\r\n    const params = this.createObjectProperties(obj.path);\r\n\r\n    this.fire(events.ADD_OBJECT, params);\r\n  }\r\n\r\n  /**\r\n   * \"selction:cleared\" canvas event handler\r\n   * @private\r\n   */\r\n  _onSelectionCleared() {\r\n    this.fire(events.SELECTION_CLEARED);\r\n  }\r\n\r\n  /**\r\n   * \"selction:created\" canvas event handler\r\n   * @param {{target: fabric.Object, e: MouseEvent}} fEvent - Fabric event\r\n   * @private\r\n   */\r\n  _onSelectionCreated(fEvent) {\r\n    const { target } = fEvent;\r\n    const params = this.createObjectProperties(target);\r\n\r\n    this.fire(events.OBJECT_ACTIVATED, params);\r\n    this.fire(events.SELECTION_CREATED, fEvent.target);\r\n  }\r\n\r\n  /**\r\n   * Canvas discard selection all\r\n   */\r\n  discardSelection() {\r\n    this._canvas.discardActiveObject();\r\n    this._canvas.renderAll();\r\n  }\r\n\r\n  /**\r\n   * Canvas Selectable status change\r\n   * @param {boolean} selectable - expect status\r\n   */\r\n  changeSelectableAll(selectable) {\r\n    this._canvas.forEachObject((obj) => {\r\n      obj.selectable = selectable;\r\n      obj.hoverCursor = selectable ? 'move' : 'crosshair';\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Return object's properties\r\n   * @param {fabric.Object} obj - fabric object\r\n   * @returns {Object} properties object\r\n   */\r\n  createObjectProperties(obj) {\r\n    const predefinedKeys = [\r\n      'left',\r\n      'top',\r\n      'width',\r\n      'height',\r\n      'fill',\r\n      'stroke',\r\n      'strokeWidth',\r\n      'opacity',\r\n      'angle',\r\n    ];\r\n    const props = {\r\n      objId: stamp(obj),\r\n      type: obj.type,\r\n    };\r\n\r\n    extend(props, getProperties(obj, predefinedKeys));\r\n\r\n    if (includes(['i-text', 'text'], obj.type)) {\r\n      extend(props, this._createTextProperties(obj, props));\r\n    } else if (includes(['rect', 'triangle', 'circle'], obj.type)) {\r\n      const shapeComp = this.getComponent(components.SHAPE);\r\n      extend(props, {\r\n        fill: shapeComp.makeFillPropertyForUserEvent(obj),\r\n      });\r\n    }\r\n\r\n    return props;\r\n  }\r\n\r\n  /**\r\n   * Get text object's properties\r\n   * @param {fabric.Object} obj - fabric text object\r\n   * @param {Object} props - properties\r\n   * @returns {Object} properties object\r\n   */\r\n  _createTextProperties(obj) {\r\n    const predefinedKeys = [\r\n      'text',\r\n      'fontFamily',\r\n      'fontSize',\r\n      'fontStyle',\r\n      'textAlign',\r\n      'textDecoration',\r\n      'fontWeight',\r\n    ];\r\n    const props = {};\r\n    extend(props, getProperties(obj, predefinedKeys));\r\n\r\n    return props;\r\n  }\r\n\r\n  /**\r\n   * Add object array by id\r\n   * @param {fabric.Object} obj - fabric object\r\n   * @returns {number} object id\r\n   */\r\n  _addFabricObject(obj) {\r\n    const objId = stamp(obj);\r\n    this._objects[objId] = obj;\r\n\r\n    return objId;\r\n  }\r\n\r\n  /**\r\n   * Remove an object in array yb id\r\n   * @param {number} objId -  object id\r\n   */\r\n  _removeFabricObject(objId) {\r\n    delete this._objects[objId];\r\n  }\r\n\r\n  /**\r\n   * Reset targetObjectForCopyPaste value from activeObject\r\n   */\r\n  resetTargetObjectForCopyPaste() {\r\n    const activeObject = this.getActiveObject();\r\n\r\n    if (activeObject) {\r\n      this.targetObjectForCopyPaste = activeObject;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Paste fabric object\r\n   * @returns {Promise}\r\n   */\r\n  pasteObject() {\r\n    if (!this.targetObjectForCopyPaste) {\r\n      return Promise.resolve([]);\r\n    }\r\n\r\n    const targetObject = this.targetObjectForCopyPaste;\r\n    const isGroupSelect = targetObject.type === 'activeSelection';\r\n    const targetObjects = isGroupSelect ? targetObject.getObjects() : [targetObject];\r\n    let newTargetObject = null;\r\n\r\n    this.discardSelection();\r\n\r\n    return this._cloneObject(targetObjects).then((addedObjects) => {\r\n      if (addedObjects.length > 1) {\r\n        newTargetObject = this.getActiveSelectionFromObjects(addedObjects);\r\n      } else {\r\n        [newTargetObject] = addedObjects;\r\n      }\r\n      this.targetObjectForCopyPaste = newTargetObject;\r\n      this.setActiveObject(newTargetObject);\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Clone object\r\n   * @param {fabric.Object} targetObjects - fabric object\r\n   * @returns {Promise}\r\n   * @private\r\n   */\r\n  _cloneObject(targetObjects) {\r\n    const addedObjects = snippet.map(targetObjects, (targetObject) =>\r\n      this._cloneObjectItem(targetObject)\r\n    );\r\n\r\n    return Promise.all(addedObjects);\r\n  }\r\n\r\n  /**\r\n   * Clone object one item\r\n   * @param {fabric.Object} targetObject - fabric object\r\n   * @returns {Promise}\r\n   * @private\r\n   */\r\n  _cloneObjectItem(targetObject) {\r\n    return this._copyFabricObjectForPaste(targetObject).then((clonedObject) => {\r\n      const objectProperties = this.createObjectProperties(clonedObject);\r\n      this.add(clonedObject);\r\n\r\n      this.fire(events.ADD_OBJECT, objectProperties);\r\n\r\n      return clonedObject;\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Copy fabric object with Changed position for copy and paste\r\n   * @param {fabric.Object} targetObject - fabric object\r\n   * @returns {Promise}\r\n   * @private\r\n   */\r\n  _copyFabricObjectForPaste(targetObject) {\r\n    const addExtraPx = (value, isReverse) =>\r\n      isReverse ? value - EXTRA_PX_FOR_PASTE : value + EXTRA_PX_FOR_PASTE;\r\n\r\n    return this._copyFabricObject(targetObject).then((clonedObject) => {\r\n      const { left, top, width, height } = clonedObject;\r\n      const { width: canvasWidth, height: canvasHeight } = this.getCanvasSize();\r\n      const rightEdge = left + width / 2;\r\n      const bottomEdge = top + height / 2;\r\n\r\n      clonedObject.set(\r\n        snippet.extend(\r\n          {\r\n            left: addExtraPx(left, rightEdge + EXTRA_PX_FOR_PASTE > canvasWidth),\r\n            top: addExtraPx(top, bottomEdge + EXTRA_PX_FOR_PASTE > canvasHeight),\r\n          },\r\n          fObjectOptions.SELECTION_STYLE\r\n        )\r\n      );\r\n\r\n      return clonedObject;\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Copy fabric object\r\n   * @param {fabric.Object} targetObject - fabric object\r\n   * @returns {Promise}\r\n   * @private\r\n   */\r\n  _copyFabricObject(targetObject) {\r\n    return new Promise((resolve) => {\r\n      targetObject.clone((cloned) => {\r\n        const shapeComp = this.getComponent(components.SHAPE);\r\n        if (isShape(cloned)) {\r\n          shapeComp.processForCopiedObject(cloned, targetObject);\r\n        }\r\n\r\n        resolve(cloned);\r\n      });\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Get current dimensions\r\n   * @returns {object}\r\n   */\r\n  getCurrentDimensions() {\r\n    const resize = this.getComponent(components.RESIZE);\r\n\r\n    return resize.getCurrentDimensions();\r\n  }\r\n\r\n  /**\r\n   * Get original dimensions\r\n   * @returns {object}\r\n   */\r\n  getOriginalDimensions() {\r\n    const resize = this.getComponent(components.RESIZE);\r\n\r\n    return resize.getOriginalDimensions();\r\n  }\r\n\r\n  /**\r\n   * Set original dimensions\r\n   * @param {object} dimensions - Dimensions\r\n   */\r\n  setOriginalDimensions(dimensions) {\r\n    const resize = this.getComponent(components.RESIZE);\r\n    resize.setOriginalDimensions(dimensions);\r\n  }\r\n\r\n  /**\r\n   * Resize Image\r\n   * @param {Object} dimensions - Resize dimensions\r\n   * @returns {Promise}\r\n   */\r\n  resize(dimensions) {\r\n    const resize = this.getComponent(components.RESIZE);\r\n\r\n    return resize.resize(dimensions);\r\n  }\r\n\r\n  /**\r\n   * @param {Array} [propertiesToInclude] Any properties that you might want to additionally include in the output\r\n   * @returns {Object} Object representation of an instance\r\n   */\r\n  toJSON(propertiesToInclude) {\r\n    return this._canvas.toJSON(propertiesToInclude);\r\n  }\r\n\r\n  loadFromJSON(json) {\r\n    return new Promise((resolve) => {\r\n      this._canvas.loadFromJSON(json, () => {\r\n        this._canvas.renderAll();\r\n        resolve();\r\n      });\r\n    });\r\n  }\r\n\r\n  setBackgroundColor(color) {\r\n    return new Promise((resolve) => {\r\n      this._canvas.setBackgroundColor(color, () => {\r\n        this._canvas.renderAll();\r\n        resolve();\r\n      });\r\n    });\r\n  }\r\n}\r\n\r\nCustomEvents.mixin(Graphics);\r\n\r\nexport default Graphics;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Image loader\r\n */\r\nimport Component from '@/interface/component';\r\nimport { Promise } from '@/util';\r\nimport { componentNames, rejectMessages } from '@/consts';\r\n\r\nconst imageOption = {\r\n  padding: 0,\r\n  crossOrigin: 'Anonymous',\r\n};\r\n\r\n/**\r\n * ImageLoader components\r\n * @extends {Component}\r\n * @class ImageLoader\r\n * @param {Graphics} graphics - Graphics instance\r\n * @ignore\r\n */\r\nclass ImageLoader extends Component {\r\n  constructor(graphics) {\r\n    super(componentNames.IMAGE_LOADER, graphics);\r\n  }\r\n\r\n  /**\r\n   * Load image from url\r\n   * @param {?string} imageName - File name\r\n   * @param {?(fabric.Image|string)} img - fabric.Image instance or URL of an image\r\n   * @returns {Promise}\r\n   */\r\n  load(imageName, img) {\r\n    let promise;\r\n\r\n    if (!imageName && !img) {\r\n      // Back to the initial state, not error.\r\n      const canvas = this.getCanvas();\r\n\r\n      canvas.backgroundImage = null;\r\n      canvas.renderAll();\r\n\r\n      promise = new Promise((resolve) => {\r\n        this.setCanvasImage('', null);\r\n        resolve();\r\n      });\r\n    } else {\r\n      promise = this._setBackgroundImage(img).then((oImage) => {\r\n        this.setCanvasImage(imageName, oImage);\r\n        this.adjustCanvasDimension();\r\n\r\n        return oImage;\r\n      });\r\n    }\r\n\r\n    return promise;\r\n  }\r\n\r\n  /**\r\n   * Set background image\r\n   * @param {?(fabric.Image|String)} img fabric.Image instance or URL of an image to set background to\r\n   * @returns {Promise}\r\n   * @private\r\n   */\r\n  _setBackgroundImage(img) {\r\n    if (!img) {\r\n      return Promise.reject(rejectMessages.loadImage);\r\n    }\r\n\r\n    return new Promise((resolve, reject) => {\r\n      const canvas = this.getCanvas();\r\n\r\n      canvas.setBackgroundImage(\r\n        img,\r\n        () => {\r\n          const oImage = canvas.backgroundImage;\r\n\r\n          if (oImage && oImage.getElement()) {\r\n            resolve(oImage);\r\n          } else {\r\n            reject(rejectMessages.loadingImageFailed);\r\n          }\r\n        },\r\n        imageOption\r\n      );\r\n    });\r\n  }\r\n}\r\n\r\nexport default ImageLoader;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Image crop module (start cropping, end cropping)\r\n */\r\nimport snippet from 'tui-code-snippet';\r\nimport fabric from 'fabric';\r\nimport Component from '@/interface/component';\r\nimport Cropzone from '@/extension/cropzone';\r\nimport { keyCodes, componentNames, CROPZONE_DEFAULT_OPTIONS } from '@/consts';\r\nimport { clamp, fixFloatingPoint } from '@/util';\r\n\r\nconst MOUSE_MOVE_THRESHOLD = 10;\r\nconst DEFAULT_OPTION = {\r\n  presetRatio: null,\r\n  top: -10,\r\n  left: -10,\r\n  height: 1,\r\n  width: 1,\r\n};\r\n\r\n/**\r\n * Cropper components\r\n * @param {Graphics} graphics - Graphics instance\r\n * @extends {Component}\r\n * @class Cropper\r\n * @ignore\r\n */\r\nclass Cropper extends Component {\r\n  constructor(graphics) {\r\n    super(componentNames.CROPPER, graphics);\r\n\r\n    /**\r\n     * Cropzone\r\n     * @type {Cropzone}\r\n     * @private\r\n     */\r\n    this._cropzone = null;\r\n\r\n    /**\r\n     * StartX of Cropzone\r\n     * @type {number}\r\n     * @private\r\n     */\r\n    this._startX = null;\r\n\r\n    /**\r\n     * StartY of Cropzone\r\n     * @type {number}\r\n     * @private\r\n     */\r\n    this._startY = null;\r\n\r\n    /**\r\n     * State whether shortcut key is pressed or not\r\n     * @type {boolean}\r\n     * @private\r\n     */\r\n    this._withShiftKey = false;\r\n\r\n    /**\r\n     * Listeners\r\n     * @type {object.<string, function>}\r\n     * @private\r\n     */\r\n    this._listeners = {\r\n      keydown: this._onKeyDown.bind(this),\r\n      keyup: this._onKeyUp.bind(this),\r\n      mousedown: this._onFabricMouseDown.bind(this),\r\n      mousemove: this._onFabricMouseMove.bind(this),\r\n      mouseup: this._onFabricMouseUp.bind(this),\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Start cropping\r\n   */\r\n  start() {\r\n    if (this._cropzone) {\r\n      return;\r\n    }\r\n    const canvas = this.getCanvas();\r\n\r\n    canvas.forEachObject((obj) => {\r\n      // {@link http://fabricjs.com/docs/fabric.Object.html#evented}\r\n      obj.evented = false;\r\n    });\r\n\r\n    this._cropzone = new Cropzone(\r\n      canvas,\r\n      snippet.extend(\r\n        {\r\n          left: 0,\r\n          top: 0,\r\n          width: 0.5,\r\n          height: 0.5,\r\n          strokeWidth: 0, // {@link https://github.com/kangax/fabric.js/issues/2860}\r\n          cornerSize: 10,\r\n          cornerColor: 'black',\r\n          fill: 'transparent',\r\n        },\r\n        CROPZONE_DEFAULT_OPTIONS,\r\n        this.graphics.cropSelectionStyle\r\n      )\r\n    );\r\n\r\n    canvas.discardActiveObject();\r\n    canvas.add(this._cropzone);\r\n    canvas.on('mouse:down', this._listeners.mousedown);\r\n    canvas.selection = false;\r\n    canvas.defaultCursor = 'crosshair';\r\n\r\n    fabric.util.addListener(document, 'keydown', this._listeners.keydown);\r\n    fabric.util.addListener(document, 'keyup', this._listeners.keyup);\r\n  }\r\n\r\n  /**\r\n   * End cropping\r\n   */\r\n  end() {\r\n    const canvas = this.getCanvas();\r\n    const cropzone = this._cropzone;\r\n\r\n    if (!cropzone) {\r\n      return;\r\n    }\r\n    canvas.remove(cropzone);\r\n    canvas.selection = true;\r\n    canvas.defaultCursor = 'default';\r\n    canvas.off('mouse:down', this._listeners.mousedown);\r\n    canvas.forEachObject((obj) => {\r\n      obj.evented = true;\r\n    });\r\n\r\n    this._cropzone = null;\r\n\r\n    fabric.util.removeListener(document, 'keydown', this._listeners.keydown);\r\n    fabric.util.removeListener(document, 'keyup', this._listeners.keyup);\r\n  }\r\n\r\n  /**\r\n   * Change cropzone visible\r\n   * @param {boolean} visible - cropzone visible state\r\n   */\r\n  changeVisibility(visible) {\r\n    if (this._cropzone) {\r\n      this._cropzone.set({ visible });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * onMousedown handler in fabric canvas\r\n   * @param {{target: fabric.Object, e: MouseEvent}} fEvent - Fabric event\r\n   * @private\r\n   */\r\n  _onFabricMouseDown(fEvent) {\r\n    const canvas = this.getCanvas();\r\n\r\n    if (fEvent.target) {\r\n      return;\r\n    }\r\n\r\n    canvas.selection = false;\r\n    const coord = canvas.getPointer(fEvent.e);\r\n\r\n    this._startX = coord.x;\r\n    this._startY = coord.y;\r\n\r\n    canvas.on({\r\n      'mouse:move': this._listeners.mousemove,\r\n      'mouse:up': this._listeners.mouseup,\r\n    });\r\n  }\r\n\r\n  /**\r\n   * onMousemove handler in fabric canvas\r\n   * @param {{target: fabric.Object, e: MouseEvent}} fEvent - Fabric event\r\n   * @private\r\n   */\r\n  _onFabricMouseMove(fEvent) {\r\n    const canvas = this.getCanvas();\r\n    const pointer = canvas.getPointer(fEvent.e);\r\n    const { x, y } = pointer;\r\n    const cropzone = this._cropzone;\r\n\r\n    if (Math.abs(x - this._startX) + Math.abs(y - this._startY) > MOUSE_MOVE_THRESHOLD) {\r\n      canvas.remove(cropzone);\r\n      cropzone.set(this._calcRectDimensionFromPoint(x, y));\r\n\r\n      canvas.add(cropzone);\r\n      canvas.setActiveObject(cropzone);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get rect dimension setting from Canvas-Mouse-Position(x, y)\r\n   * @param {number} x - Canvas-Mouse-Position x\r\n   * @param {number} y - Canvas-Mouse-Position Y\r\n   * @returns {{left: number, top: number, width: number, height: number}}\r\n   * @private\r\n   */\r\n  _calcRectDimensionFromPoint(x, y) {\r\n    const canvas = this.getCanvas();\r\n    const canvasWidth = canvas.getWidth();\r\n    const canvasHeight = canvas.getHeight();\r\n    const startX = this._startX;\r\n    const startY = this._startY;\r\n    let left = clamp(x, 0, startX);\r\n    let top = clamp(y, 0, startY);\r\n    let width = clamp(x, startX, canvasWidth) - left; // (startX <= x(mouse) <= canvasWidth) - left\r\n    let height = clamp(y, startY, canvasHeight) - top; // (startY <= y(mouse) <= canvasHeight) - top\r\n\r\n    if (this._withShiftKey) {\r\n      // make fixed ratio cropzone\r\n      if (width > height) {\r\n        height = width;\r\n      } else if (height > width) {\r\n        width = height;\r\n      }\r\n\r\n      if (startX >= x) {\r\n        left = startX - width;\r\n      }\r\n\r\n      if (startY >= y) {\r\n        top = startY - height;\r\n      }\r\n    }\r\n\r\n    return {\r\n      left,\r\n      top,\r\n      width,\r\n      height,\r\n    };\r\n  }\r\n\r\n  /**\r\n   * onMouseup handler in fabric canvas\r\n   * @private\r\n   */\r\n  _onFabricMouseUp() {\r\n    const cropzone = this._cropzone;\r\n    const listeners = this._listeners;\r\n    const canvas = this.getCanvas();\r\n\r\n    canvas.setActiveObject(cropzone);\r\n    canvas.off({\r\n      'mouse:move': listeners.mousemove,\r\n      'mouse:up': listeners.mouseup,\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Get cropped image data\r\n   * @param {Object} cropRect cropzone rect\r\n   *  @param {Number} cropRect.left left position\r\n   *  @param {Number} cropRect.top top position\r\n   *  @param {Number} cropRect.width width\r\n   *  @param {Number} cropRect.height height\r\n   * @returns {?{imageName: string, url: string}} cropped Image data\r\n   */\r\n  getCroppedImageData(cropRect) {\r\n    const canvas = this.getCanvas();\r\n    const containsCropzone = canvas.contains(this._cropzone);\r\n    if (!cropRect) {\r\n      return null;\r\n    }\r\n\r\n    if (containsCropzone) {\r\n      canvas.remove(this._cropzone);\r\n    }\r\n\r\n    const imageData = {\r\n      imageName: this.getImageName(),\r\n      url: canvas.toDataURL(cropRect),\r\n    };\r\n\r\n    if (containsCropzone) {\r\n      canvas.add(this._cropzone);\r\n    }\r\n\r\n    return imageData;\r\n  }\r\n\r\n  /**\r\n   * Get cropped rect\r\n   * @returns {Object} rect\r\n   */\r\n  getCropzoneRect() {\r\n    const cropzone = this._cropzone;\r\n\r\n    if (!cropzone.isValid()) {\r\n      return null;\r\n    }\r\n\r\n    return {\r\n      left: cropzone.left,\r\n      top: cropzone.top,\r\n      width: cropzone.width,\r\n      height: cropzone.height,\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Set a cropzone square\r\n   * @param {number} [presetRatio] - preset ratio\r\n   */\r\n  setCropzoneRect(presetRatio) {\r\n    const canvas = this.getCanvas();\r\n    const cropzone = this._cropzone;\r\n\r\n    canvas.discardActiveObject();\r\n    canvas.selection = false;\r\n    canvas.remove(cropzone);\r\n\r\n    cropzone.set(presetRatio ? this._getPresetPropertiesForCropSize(presetRatio) : DEFAULT_OPTION);\r\n\r\n    canvas.add(cropzone);\r\n    canvas.selection = true;\r\n\r\n    if (presetRatio) {\r\n      canvas.setActiveObject(cropzone);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * get a cropzone square info\r\n   * @param {number} presetRatio - preset ratio\r\n   * @returns {{presetRatio: number, left: number, top: number, width: number, height: number}}\r\n   * @private\r\n   */\r\n  _getPresetPropertiesForCropSize(presetRatio) {\r\n    const canvas = this.getCanvas();\r\n    const originalWidth = canvas.getWidth();\r\n    const originalHeight = canvas.getHeight();\r\n\r\n    const standardSize = originalWidth >= originalHeight ? originalWidth : originalHeight;\r\n    const getScale = (value, orignalValue) => (value > orignalValue ? orignalValue / value : 1);\r\n\r\n    let width = standardSize * presetRatio;\r\n    let height = standardSize;\r\n\r\n    const scaleWidth = getScale(width, originalWidth);\r\n    [width, height] = snippet.map([width, height], (sizeValue) => sizeValue * scaleWidth);\r\n\r\n    const scaleHeight = getScale(height, originalHeight);\r\n    [width, height] = snippet.map([width, height], (sizeValue) =>\r\n      fixFloatingPoint(sizeValue * scaleHeight)\r\n    );\r\n\r\n    return {\r\n      presetRatio,\r\n      top: (originalHeight - height) / 2,\r\n      left: (originalWidth - width) / 2,\r\n      width,\r\n      height,\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Keydown event handler\r\n   * @param {KeyboardEvent} e - Event object\r\n   * @private\r\n   */\r\n  _onKeyDown(e) {\r\n    if (e.keyCode === keyCodes.SHIFT) {\r\n      this._withShiftKey = true;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Keyup event handler\r\n   * @param {KeyboardEvent} e - Event object\r\n   * @private\r\n   */\r\n  _onKeyUp(e) {\r\n    if (e.keyCode === keyCodes.SHIFT) {\r\n      this._withShiftKey = false;\r\n    }\r\n  }\r\n}\r\n\r\nexport default Cropper;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Cropzone extending fabric.Rect\r\n */\r\nimport snippet from 'tui-code-snippet';\r\nimport fabric from 'fabric';\r\nimport { clamp } from '@/util';\r\nimport { eventNames as events, keyCodes } from '@/consts';\r\n\r\nconst CORNER_TYPE_TOP_LEFT = 'tl';\r\nconst CORNER_TYPE_TOP_RIGHT = 'tr';\r\nconst CORNER_TYPE_MIDDLE_TOP = 'mt';\r\nconst CORNER_TYPE_MIDDLE_LEFT = 'ml';\r\nconst CORNER_TYPE_MIDDLE_RIGHT = 'mr';\r\nconst CORNER_TYPE_MIDDLE_BOTTOM = 'mb';\r\nconst CORNER_TYPE_BOTTOM_LEFT = 'bl';\r\nconst CORNER_TYPE_BOTTOM_RIGHT = 'br';\r\nconst CORNER_TYPE_LIST = [\r\n  CORNER_TYPE_TOP_LEFT,\r\n  CORNER_TYPE_TOP_RIGHT,\r\n  CORNER_TYPE_MIDDLE_TOP,\r\n  CORNER_TYPE_MIDDLE_LEFT,\r\n  CORNER_TYPE_MIDDLE_RIGHT,\r\n  CORNER_TYPE_MIDDLE_BOTTOM,\r\n  CORNER_TYPE_BOTTOM_LEFT,\r\n  CORNER_TYPE_BOTTOM_RIGHT,\r\n];\r\nconst NOOP_FUNCTION = () => {};\r\n\r\n/**\r\n * Align with cropzone ratio\r\n * @param {string} selectedCorner - selected corner type\r\n * @returns {{width: number, height: number}}\r\n * @private\r\n */\r\nfunction cornerTypeValid(selectedCorner) {\r\n  return CORNER_TYPE_LIST.indexOf(selectedCorner) >= 0;\r\n}\r\n\r\n/**\r\n * return scale basis type\r\n * @param {number} diffX - X distance of the cursor and corner.\r\n * @param {number} diffY - Y distance of the cursor and corner.\r\n * @returns {string}\r\n * @private\r\n */\r\nfunction getScaleBasis(diffX, diffY) {\r\n  return diffX > diffY ? 'width' : 'height';\r\n}\r\n\r\n/**\r\n * Cropzone object\r\n * Issue: IE7, 8(with excanvas)\r\n *  - Cropzone is a black zone without transparency.\r\n * @class Cropzone\r\n * @extends {fabric.Rect}\r\n * @ignore\r\n */\r\nconst Cropzone = fabric.util.createClass(\r\n  fabric.Rect,\r\n  /** @lends Cropzone.prototype */ {\r\n    /**\r\n     * Constructor\r\n     * @param {Object} canvas canvas\r\n     * @param {Object} options Options object\r\n     * @param {Object} extendsOptions object for extends \"options\"\r\n     * @override\r\n     */\r\n    initialize(canvas, options, extendsOptions) {\r\n      options = snippet.extend(options, extendsOptions);\r\n      options.type = 'cropzone';\r\n\r\n      this.callSuper('initialize', options);\r\n      this._addEventHandler();\r\n\r\n      this.canvas = canvas;\r\n      this.options = options;\r\n    },\r\n    canvasEventDelegation(eventName) {\r\n      let delegationState = 'unregistered';\r\n      const isRegistered = this.canvasEventTrigger[eventName] !== NOOP_FUNCTION;\r\n      if (isRegistered) {\r\n        delegationState = 'registered';\r\n      } else if ([events.OBJECT_MOVED, events.OBJECT_SCALED].indexOf(eventName) < 0) {\r\n        delegationState = 'none';\r\n      }\r\n\r\n      return delegationState;\r\n    },\r\n    canvasEventRegister(eventName, eventTrigger) {\r\n      this.canvasEventTrigger[eventName] = eventTrigger;\r\n    },\r\n    _addEventHandler() {\r\n      this.canvasEventTrigger = {\r\n        [events.OBJECT_MOVED]: NOOP_FUNCTION,\r\n        [events.OBJECT_SCALED]: NOOP_FUNCTION,\r\n      };\r\n      this.on({\r\n        moving: this._onMoving.bind(this),\r\n        scaling: this._onScaling.bind(this),\r\n      });\r\n      fabric.util.addListener(document, 'keydown', this._onKeyDown.bind(this));\r\n      fabric.util.addListener(document, 'keyup', this._onKeyUp.bind(this));\r\n    },\r\n    _renderCropzone(ctx) {\r\n      const cropzoneDashLineWidth = 7;\r\n      const cropzoneDashLineOffset = 7;\r\n\r\n      // Calc original scale\r\n      const originalFlipX = this.flipX ? -1 : 1;\r\n      const originalFlipY = this.flipY ? -1 : 1;\r\n      const originalScaleX = originalFlipX / this.scaleX;\r\n      const originalScaleY = originalFlipY / this.scaleY;\r\n\r\n      // Set original scale\r\n      ctx.scale(originalScaleX, originalScaleY);\r\n\r\n      // Render outer rect\r\n      this._fillOuterRect(ctx, 'rgba(0, 0, 0, 0.5)');\r\n\r\n      if (this.options.lineWidth) {\r\n        this._fillInnerRect(ctx);\r\n        this._strokeBorder(ctx, 'rgb(255, 255, 255)', {\r\n          lineWidth: this.options.lineWidth,\r\n        });\r\n      } else {\r\n        // Black dash line\r\n        this._strokeBorder(ctx, 'rgb(0, 0, 0)', {\r\n          lineDashWidth: cropzoneDashLineWidth,\r\n        });\r\n\r\n        // White dash line\r\n        this._strokeBorder(ctx, 'rgb(255, 255, 255)', {\r\n          lineDashWidth: cropzoneDashLineWidth,\r\n          lineDashOffset: cropzoneDashLineOffset,\r\n        });\r\n      }\r\n\r\n      // Reset scale\r\n      ctx.scale(1 / originalScaleX, 1 / originalScaleY);\r\n    },\r\n\r\n    /**\r\n     * Render Crop-zone\r\n     * @private\r\n     * @override\r\n     */\r\n    _render(ctx) {\r\n      this.callSuper('_render', ctx);\r\n\r\n      this._renderCropzone(ctx);\r\n    },\r\n\r\n    /**\r\n     * Cropzone-coordinates with outer rectangle\r\n     *\r\n     *     x0     x1         x2      x3\r\n     *  y0 +--------------------------+\r\n     *     |///////|//////////|///////|    // <--- \"Outer-rectangle\"\r\n     *     |///////|//////////|///////|\r\n     *  y1 +-------+----------+-------+\r\n     *     |///////| Cropzone |///////|    Cropzone is the \"Inner-rectangle\"\r\n     *     |///////|  (0, 0)  |///////|    Center point (0, 0)\r\n     *  y2 +-------+----------+-------+\r\n     *     |///////|//////////|///////|\r\n     *     |///////|//////////|///////|\r\n     *  y3 +--------------------------+\r\n     *\r\n     * @typedef {{x: Array<number>, y: Array<number>}} cropzoneCoordinates\r\n     * @ignore\r\n     */\r\n\r\n    /**\r\n     * Fill outer rectangle\r\n     * @param {CanvasRenderingContext2D} ctx - Context\r\n     * @param {string|CanvasGradient|CanvasPattern} fillStyle - Fill-style\r\n     * @private\r\n     */\r\n    _fillOuterRect(ctx, fillStyle) {\r\n      const { x, y } = this._getCoordinates();\r\n\r\n      ctx.save();\r\n      ctx.fillStyle = fillStyle;\r\n      ctx.beginPath();\r\n\r\n      // Outer rectangle\r\n      // Numbers are +/-1 so that overlay edges don't get blurry.\r\n      ctx.moveTo(x[0] - 1, y[0] - 1);\r\n      ctx.lineTo(x[3] + 1, y[0] - 1);\r\n      ctx.lineTo(x[3] + 1, y[3] + 1);\r\n      ctx.lineTo(x[0] - 1, y[3] + 1);\r\n      ctx.lineTo(x[0] - 1, y[0] - 1);\r\n      ctx.closePath();\r\n\r\n      // Inner rectangle\r\n      ctx.moveTo(x[1], y[1]);\r\n      ctx.lineTo(x[1], y[2]);\r\n      ctx.lineTo(x[2], y[2]);\r\n      ctx.lineTo(x[2], y[1]);\r\n      ctx.lineTo(x[1], y[1]);\r\n      ctx.closePath();\r\n\r\n      ctx.fill();\r\n      ctx.restore();\r\n    },\r\n\r\n    /**\r\n     * Draw Inner grid line\r\n     * @param {CanvasRenderingContext2D} ctx - Context\r\n     * @private\r\n     */\r\n    _fillInnerRect(ctx) {\r\n      const { x: outerX, y: outerY } = this._getCoordinates();\r\n      const x = this._caculateInnerPosition(outerX, (outerX[2] - outerX[1]) / 3);\r\n      const y = this._caculateInnerPosition(outerY, (outerY[2] - outerY[1]) / 3);\r\n\r\n      ctx.save();\r\n      ctx.strokeStyle = 'rgba(255, 255, 255, 0.7)';\r\n      ctx.lineWidth = this.options.lineWidth;\r\n      ctx.beginPath();\r\n\r\n      ctx.moveTo(x[0], y[1]);\r\n      ctx.lineTo(x[3], y[1]);\r\n\r\n      ctx.moveTo(x[0], y[2]);\r\n      ctx.lineTo(x[3], y[2]);\r\n\r\n      ctx.moveTo(x[1], y[0]);\r\n      ctx.lineTo(x[1], y[3]);\r\n\r\n      ctx.moveTo(x[2], y[0]);\r\n      ctx.lineTo(x[2], y[3]);\r\n      ctx.stroke();\r\n      ctx.closePath();\r\n\r\n      ctx.restore();\r\n    },\r\n\r\n    /**\r\n     * Calculate Inner Position\r\n     * @param {Array} outer - outer position\r\n     * @param {number} size - interval for calculate\r\n     * @returns {Array} - inner position\r\n     * @private\r\n     */\r\n    _caculateInnerPosition(outer, size) {\r\n      const position = [];\r\n      position[0] = outer[1];\r\n      position[1] = outer[1] + size;\r\n      position[2] = outer[1] + size * 2;\r\n      position[3] = outer[2];\r\n\r\n      return position;\r\n    },\r\n\r\n    /**\r\n     * Get coordinates\r\n     * @returns {cropzoneCoordinates} - {@link cropzoneCoordinates}\r\n     * @private\r\n     */\r\n    _getCoordinates() {\r\n      const { canvas, width, height, left, top } = this;\r\n      const halfWidth = width / 2;\r\n      const halfHeight = height / 2;\r\n      const canvasHeight = canvas.getHeight(); // fabric object\r\n      const canvasWidth = canvas.getWidth(); // fabric object\r\n\r\n      return {\r\n        x: snippet.map(\r\n          [\r\n            -(halfWidth + left), // x0\r\n            -halfWidth, // x1\r\n            halfWidth, // x2\r\n            halfWidth + (canvasWidth - left - width), // x3\r\n          ],\r\n          Math.ceil\r\n        ),\r\n        y: snippet.map(\r\n          [\r\n            -(halfHeight + top), // y0\r\n            -halfHeight, // y1\r\n            halfHeight, // y2\r\n            halfHeight + (canvasHeight - top - height), // y3\r\n          ],\r\n          Math.ceil\r\n        ),\r\n      };\r\n    },\r\n\r\n    /**\r\n     * Stroke border\r\n     * @param {CanvasRenderingContext2D} ctx - Context\r\n     * @param {string|CanvasGradient|CanvasPattern} strokeStyle - Stroke-style\r\n     * @param {number} lineDashWidth - Dash width\r\n     * @param {number} [lineDashOffset] - Dash offset\r\n     * @param {number} [lineWidth] - line width\r\n     * @private\r\n     */\r\n    _strokeBorder(ctx, strokeStyle, { lineDashWidth, lineDashOffset, lineWidth }) {\r\n      const halfWidth = this.width / 2;\r\n      const halfHeight = this.height / 2;\r\n\r\n      ctx.save();\r\n      ctx.strokeStyle = strokeStyle;\r\n\r\n      if (ctx.setLineDash) {\r\n        ctx.setLineDash([lineDashWidth, lineDashWidth]);\r\n      }\r\n      if (lineDashOffset) {\r\n        ctx.lineDashOffset = lineDashOffset;\r\n      }\r\n      if (lineWidth) {\r\n        ctx.lineWidth = lineWidth;\r\n      }\r\n\r\n      ctx.beginPath();\r\n      ctx.moveTo(-halfWidth, -halfHeight);\r\n      ctx.lineTo(halfWidth, -halfHeight);\r\n      ctx.lineTo(halfWidth, halfHeight);\r\n      ctx.lineTo(-halfWidth, halfHeight);\r\n      ctx.lineTo(-halfWidth, -halfHeight);\r\n      ctx.stroke();\r\n\r\n      ctx.restore();\r\n    },\r\n\r\n    /**\r\n     * onMoving event listener\r\n     * @private\r\n     */\r\n    _onMoving() {\r\n      const { height, width, left, top } = this;\r\n      const maxLeft = this.canvas.getWidth() - width;\r\n      const maxTop = this.canvas.getHeight() - height;\r\n\r\n      this.left = clamp(left, 0, maxLeft);\r\n      this.top = clamp(top, 0, maxTop);\r\n\r\n      this.canvasEventTrigger[events.OBJECT_MOVED](this);\r\n    },\r\n\r\n    /**\r\n     * onScaling event listener\r\n     * @param {{e: MouseEvent}} fEvent - Fabric event\r\n     * @private\r\n     */\r\n    _onScaling(fEvent) {\r\n      const selectedCorner = fEvent.transform.corner;\r\n      const pointer = this.canvas.getPointer(fEvent.e);\r\n      const settings = this._calcScalingSizeFromPointer(pointer, selectedCorner);\r\n\r\n      // On scaling cropzone,\r\n      // change real width and height and fix scaleFactor to 1\r\n      this.scale(1).set(settings);\r\n\r\n      this.canvasEventTrigger[events.OBJECT_SCALED](this);\r\n    },\r\n\r\n    /**\r\n     * Calc scaled size from mouse pointer with selected corner\r\n     * @param {{x: number, y: number}} pointer - Mouse position\r\n     * @param {string} selectedCorner - selected corner type\r\n     * @returns {Object} Having left or(and) top or(and) width or(and) height.\r\n     * @private\r\n     */\r\n    _calcScalingSizeFromPointer(pointer, selectedCorner) {\r\n      const isCornerTypeValid = cornerTypeValid(selectedCorner);\r\n\r\n      return isCornerTypeValid && this._resizeCropZone(pointer, selectedCorner);\r\n    },\r\n\r\n    /**\r\n     * Align with cropzone ratio\r\n     * @param {number} width - cropzone width\r\n     * @param {number} height - cropzone height\r\n     * @param {number} maxWidth - limit max width\r\n     * @param {number} maxHeight - limit max height\r\n     * @param {number} scaleTo - cropzone ratio\r\n     * @returns {{width: number, height: number}}\r\n     * @private\r\n     */\r\n    adjustRatioCropzoneSize({ width, height, leftMaker, topMaker, maxWidth, maxHeight, scaleTo }) {\r\n      width = maxWidth ? clamp(width, 1, maxWidth) : width;\r\n      height = maxHeight ? clamp(height, 1, maxHeight) : height;\r\n\r\n      if (!this.presetRatio) {\r\n        if (this._withShiftKey) {\r\n          // make fixed ratio cropzone\r\n          if (width > height) {\r\n            height = width;\r\n          } else if (height > width) {\r\n            width = height;\r\n          }\r\n        }\r\n\r\n        return {\r\n          width,\r\n          height,\r\n          left: leftMaker(width),\r\n          top: topMaker(height),\r\n        };\r\n      }\r\n\r\n      if (scaleTo === 'width') {\r\n        height = width / this.presetRatio;\r\n      } else {\r\n        width = height * this.presetRatio;\r\n      }\r\n\r\n      const maxScaleFactor = Math.min(maxWidth / width, maxHeight / height);\r\n      if (maxScaleFactor <= 1) {\r\n        [width, height] = [width, height].map((v) => v * maxScaleFactor);\r\n      }\r\n\r\n      return {\r\n        width,\r\n        height,\r\n        left: leftMaker(width),\r\n        top: topMaker(height),\r\n      };\r\n    },\r\n\r\n    /**\r\n     * Get dimension last state cropzone\r\n     * @returns {{rectTop: number, rectLeft: number, rectWidth: number, rectHeight: number}}\r\n     * @private\r\n     */\r\n    _getCropzoneRectInfo() {\r\n      const { width: canvasWidth, height: canvasHeight } = this.canvas;\r\n      const {\r\n        top: rectTop,\r\n        left: rectLeft,\r\n        width: rectWidth,\r\n        height: rectHeight,\r\n      } = this.getBoundingRect(false, true);\r\n\r\n      return {\r\n        rectTop,\r\n        rectLeft,\r\n        rectWidth,\r\n        rectHeight,\r\n        rectRight: rectLeft + rectWidth,\r\n        rectBottom: rectTop + rectHeight,\r\n        canvasWidth,\r\n        canvasHeight,\r\n      };\r\n    },\r\n\r\n    /**\r\n     * Calc scaling dimension\r\n     * @param {Object} position - Mouse position\r\n     * @param {string} corner - corner type\r\n     * @returns {{left: number, top: number, width: number, height: number}}\r\n     * @private\r\n     */\r\n    _resizeCropZone({ x, y }, corner) {\r\n      const {\r\n        rectWidth,\r\n        rectHeight,\r\n        rectTop,\r\n        rectLeft,\r\n        rectBottom,\r\n        rectRight,\r\n        canvasWidth,\r\n        canvasHeight,\r\n      } = this._getCropzoneRectInfo();\r\n\r\n      const resizeInfoMap = {\r\n        tl: {\r\n          width: rectRight - x,\r\n          height: rectBottom - y,\r\n          leftMaker: (newWidth) => rectRight - newWidth,\r\n          topMaker: (newHeight) => rectBottom - newHeight,\r\n          maxWidth: rectRight,\r\n          maxHeight: rectBottom,\r\n          scaleTo: getScaleBasis(rectLeft - x, rectTop - y),\r\n        },\r\n        tr: {\r\n          width: x - rectLeft,\r\n          height: rectBottom - y,\r\n          leftMaker: () => rectLeft,\r\n          topMaker: (newHeight) => rectBottom - newHeight,\r\n          maxWidth: canvasWidth - rectLeft,\r\n          maxHeight: rectBottom,\r\n          scaleTo: getScaleBasis(x - rectRight, rectTop - y),\r\n        },\r\n        mt: {\r\n          width: rectWidth,\r\n          height: rectBottom - y,\r\n          leftMaker: () => rectLeft,\r\n          topMaker: (newHeight) => rectBottom - newHeight,\r\n          maxWidth: canvasWidth - rectLeft,\r\n          maxHeight: rectBottom,\r\n          scaleTo: 'height',\r\n        },\r\n        ml: {\r\n          width: rectRight - x,\r\n          height: rectHeight,\r\n          leftMaker: (newWidth) => rectRight - newWidth,\r\n          topMaker: () => rectTop,\r\n          maxWidth: rectRight,\r\n          maxHeight: canvasHeight - rectTop,\r\n          scaleTo: 'width',\r\n        },\r\n        mr: {\r\n          width: x - rectLeft,\r\n          height: rectHeight,\r\n          leftMaker: () => rectLeft,\r\n          topMaker: () => rectTop,\r\n          maxWidth: canvasWidth - rectLeft,\r\n          maxHeight: canvasHeight - rectTop,\r\n          scaleTo: 'width',\r\n        },\r\n        mb: {\r\n          width: rectWidth,\r\n          height: y - rectTop,\r\n          leftMaker: () => rectLeft,\r\n          topMaker: () => rectTop,\r\n          maxWidth: canvasWidth - rectLeft,\r\n          maxHeight: canvasHeight - rectTop,\r\n          scaleTo: 'height',\r\n        },\r\n        bl: {\r\n          width: rectRight - x,\r\n          height: y - rectTop,\r\n          leftMaker: (newWidth) => rectRight - newWidth,\r\n          topMaker: () => rectTop,\r\n          maxWidth: rectRight,\r\n          maxHeight: canvasHeight - rectTop,\r\n          scaleTo: getScaleBasis(rectLeft - x, y - rectBottom),\r\n        },\r\n        br: {\r\n          width: x - rectLeft,\r\n          height: y - rectTop,\r\n          leftMaker: () => rectLeft,\r\n          topMaker: () => rectTop,\r\n          maxWidth: canvasWidth - rectLeft,\r\n          maxHeight: canvasHeight - rectTop,\r\n          scaleTo: getScaleBasis(x - rectRight, y - rectBottom),\r\n        },\r\n      };\r\n\r\n      return this.adjustRatioCropzoneSize(resizeInfoMap[corner]);\r\n    },\r\n\r\n    /**\r\n     * Return the whether this cropzone is valid\r\n     * @returns {boolean}\r\n     */\r\n    isValid() {\r\n      return this.left >= 0 && this.top >= 0 && this.width > 0 && this.height > 0;\r\n    },\r\n\r\n    /**\r\n     * Keydown event handler\r\n     * @param {{number}} keyCode - Event keyCode\r\n     * @private\r\n     */\r\n    _onKeyDown({ keyCode }) {\r\n      if (keyCode === keyCodes.SHIFT) {\r\n        this._withShiftKey = true;\r\n      }\r\n    },\r\n\r\n    /**\r\n     * Keyup event handler\r\n     * @param {{number}} keyCode - Event keyCode\r\n     * @private\r\n     */\r\n    _onKeyUp({ keyCode }) {\r\n      if (keyCode === keyCodes.SHIFT) {\r\n        this._withShiftKey = false;\r\n      }\r\n    },\r\n  }\r\n);\r\n\r\nexport default Cropzone;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Image flip module\r\n */\r\nimport snippet from 'tui-code-snippet';\r\nimport Component from '@/interface/component';\r\nimport { Promise } from '@/util';\r\nimport { componentNames, rejectMessages } from '@/consts';\r\n\r\n/**\r\n * Flip\r\n * @class Flip\r\n * @param {Graphics} graphics - Graphics instance\r\n * @extends {Component}\r\n * @ignore\r\n */\r\nclass Flip extends Component {\r\n  constructor(graphics) {\r\n    super(componentNames.FLIP, graphics);\r\n  }\r\n\r\n  /**\r\n   * Get current flip settings\r\n   * @returns {{flipX: Boolean, flipY: Boolean}}\r\n   */\r\n  getCurrentSetting() {\r\n    const canvasImage = this.getCanvasImage();\r\n\r\n    return {\r\n      flipX: canvasImage.flipX,\r\n      flipY: canvasImage.flipY,\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Set flipX, flipY\r\n   * @param {{flipX: Boolean, flipY: Boolean}} newSetting - Flip setting\r\n   * @returns {Promise}\r\n   */\r\n  set(newSetting) {\r\n    const setting = this.getCurrentSetting();\r\n    const isChangingFlipX = setting.flipX !== newSetting.flipX;\r\n    const isChangingFlipY = setting.flipY !== newSetting.flipY;\r\n\r\n    if (!isChangingFlipX && !isChangingFlipY) {\r\n      return Promise.reject(rejectMessages.flip);\r\n    }\r\n\r\n    snippet.extend(setting, newSetting);\r\n    this.setImageProperties(setting, true);\r\n    this._invertAngle(isChangingFlipX, isChangingFlipY);\r\n    this._flipObjects(isChangingFlipX, isChangingFlipY);\r\n\r\n    return Promise.resolve({\r\n      flipX: setting.flipX,\r\n      flipY: setting.flipY,\r\n      angle: this.getCanvasImage().angle,\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Invert image angle for flip\r\n   * @param {boolean} isChangingFlipX - Change flipX\r\n   * @param {boolean} isChangingFlipY - Change flipY\r\n   */\r\n  _invertAngle(isChangingFlipX, isChangingFlipY) {\r\n    const canvasImage = this.getCanvasImage();\r\n    let { angle } = canvasImage;\r\n\r\n    if (isChangingFlipX) {\r\n      angle *= -1;\r\n    }\r\n    if (isChangingFlipY) {\r\n      angle *= -1;\r\n    }\r\n    canvasImage.rotate(parseFloat(angle)).setCoords(); // parseFloat for -0 to 0\r\n  }\r\n\r\n  /**\r\n   * Flip objects\r\n   * @param {boolean} isChangingFlipX - Change flipX\r\n   * @param {boolean} isChangingFlipY - Change flipY\r\n   * @private\r\n   */\r\n  _flipObjects(isChangingFlipX, isChangingFlipY) {\r\n    const canvas = this.getCanvas();\r\n\r\n    if (isChangingFlipX) {\r\n      canvas.forEachObject((obj) => {\r\n        obj\r\n          .set({\r\n            angle: parseFloat(obj.angle * -1), // parseFloat for -0 to 0\r\n            flipX: !obj.flipX,\r\n            left: canvas.width - obj.left,\r\n          })\r\n          .setCoords();\r\n      });\r\n    }\r\n    if (isChangingFlipY) {\r\n      canvas.forEachObject((obj) => {\r\n        obj\r\n          .set({\r\n            angle: parseFloat(obj.angle * -1), // parseFloat for -0 to 0\r\n            flipY: !obj.flipY,\r\n            top: canvas.height - obj.top,\r\n          })\r\n          .setCoords();\r\n      });\r\n    }\r\n    canvas.renderAll();\r\n  }\r\n\r\n  /**\r\n   * Reset flip settings\r\n   * @returns {Promise}\r\n   */\r\n  reset() {\r\n    return this.set({\r\n      flipX: false,\r\n      flipY: false,\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Flip x\r\n   * @returns {Promise}\r\n   */\r\n  flipX() {\r\n    const current = this.getCurrentSetting();\r\n\r\n    return this.set({\r\n      flipX: !current.flipX,\r\n      flipY: current.flipY,\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Flip y\r\n   * @returns {Promise}\r\n   */\r\n  flipY() {\r\n    const current = this.getCurrentSetting();\r\n\r\n    return this.set({\r\n      flipX: current.flipX,\r\n      flipY: !current.flipY,\r\n    });\r\n  }\r\n}\r\n\r\nexport default Flip;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Image rotation module\r\n */\r\nimport fabric from 'fabric';\r\nimport Component from '@/interface/component';\r\nimport { Promise } from '@/util';\r\nimport { componentNames } from '@/consts';\r\n\r\n/**\r\n * Image Rotation component\r\n * @class Rotation\r\n * @extends {Component}\r\n * @param {Graphics} graphics - Graphics instance\r\n * @ignore\r\n */\r\nclass Rotation extends Component {\r\n  constructor(graphics) {\r\n    super(componentNames.ROTATION, graphics);\r\n  }\r\n\r\n  /**\r\n   * Get current angle\r\n   * @returns {Number}\r\n   */\r\n  getCurrentAngle() {\r\n    return this.getCanvasImage().angle;\r\n  }\r\n\r\n  /**\r\n   * Set angle of the image\r\n   *\r\n   *  Do not call \"this.setImageProperties\" for setting angle directly.\r\n   *  Before setting angle, The originX,Y of image should be set to center.\r\n   *      See \"http://fabricjs.com/docs/fabric.Object.html#setAngle\"\r\n   *\r\n   * @param {number} angle - Angle value\r\n   * @returns {Promise}\r\n   */\r\n  setAngle(angle) {\r\n    const oldAngle = this.getCurrentAngle() % 360; // The angle is lower than 2*PI(===360 degrees)\r\n\r\n    angle %= 360;\r\n\r\n    const canvasImage = this.getCanvasImage();\r\n    const oldImageCenter = canvasImage.getCenterPoint();\r\n    canvasImage.set({ angle }).setCoords();\r\n    this.adjustCanvasDimension();\r\n    const newImageCenter = canvasImage.getCenterPoint();\r\n    this._rotateForEachObject(oldImageCenter, newImageCenter, angle - oldAngle);\r\n\r\n    return Promise.resolve(angle);\r\n  }\r\n\r\n  /**\r\n   * Rotate for each object\r\n   * @param {fabric.Point} oldImageCenter - Image center point before rotation\r\n   * @param {fabric.Point} newImageCenter - Image center point after rotation\r\n   * @param {number} angleDiff - Image angle difference after rotation\r\n   * @private\r\n   */\r\n  _rotateForEachObject(oldImageCenter, newImageCenter, angleDiff) {\r\n    const canvas = this.getCanvas();\r\n    const centerDiff = {\r\n      x: oldImageCenter.x - newImageCenter.x,\r\n      y: oldImageCenter.y - newImageCenter.y,\r\n    };\r\n\r\n    canvas.forEachObject((obj) => {\r\n      const objCenter = obj.getCenterPoint();\r\n      const radian = fabric.util.degreesToRadians(angleDiff);\r\n      const newObjCenter = fabric.util.rotatePoint(objCenter, oldImageCenter, radian);\r\n\r\n      obj.set({\r\n        left: newObjCenter.x - centerDiff.x,\r\n        top: newObjCenter.y - centerDiff.y,\r\n        angle: (obj.angle + angleDiff) % 360,\r\n      });\r\n      obj.setCoords();\r\n    });\r\n    canvas.renderAll();\r\n  }\r\n\r\n  /**\r\n   * Rotate the image\r\n   * @param {number} additionalAngle - Additional angle\r\n   * @returns {Promise}\r\n   */\r\n  rotate(additionalAngle) {\r\n    const current = this.getCurrentAngle();\r\n\r\n    return this.setAngle(current + additionalAngle);\r\n  }\r\n}\r\n\r\nexport default Rotation;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Free drawing module, Set brush\r\n */\r\nimport fabric from 'fabric';\r\nimport Component from '@/interface/component';\r\nimport { componentNames } from '@/consts';\r\n\r\n/**\r\n * FreeDrawing\r\n * @class FreeDrawing\r\n * @param {Graphics} graphics - Graphics instance\r\n * @extends {Component}\r\n * @ignore\r\n */\r\nclass FreeDrawing extends Component {\r\n  constructor(graphics) {\r\n    super(componentNames.FREE_DRAWING, graphics);\r\n\r\n    /**\r\n     * Brush width\r\n     * @type {number}\r\n     */\r\n    this.width = 12;\r\n\r\n    /**\r\n     * fabric.Color instance for brush color\r\n     * @type {fabric.Color}\r\n     */\r\n    this.oColor = new fabric.Color('rgba(0, 0, 0, 0.5)');\r\n  }\r\n\r\n  /**\r\n   * Start free drawing mode\r\n   * @param {{width: ?number, color: ?string}} [setting] - Brush width & color\r\n   */\r\n  start(setting) {\r\n    const canvas = this.getCanvas();\r\n\r\n    canvas.isDrawingMode = true;\r\n    this.setBrush(setting);\r\n  }\r\n\r\n  /**\r\n   * Set brush\r\n   * @param {{width: ?number, color: ?string}} [setting] - Brush width & color\r\n   */\r\n  setBrush(setting) {\r\n    const brush = this.getCanvas().freeDrawingBrush;\r\n\r\n    setting = setting || {};\r\n    this.width = setting.width || this.width;\r\n    if (setting.color) {\r\n      this.oColor = new fabric.Color(setting.color);\r\n    }\r\n    brush.width = this.width;\r\n    brush.color = this.oColor.toRgba();\r\n  }\r\n\r\n  /**\r\n   * End free drawing mode\r\n   */\r\n  end() {\r\n    const canvas = this.getCanvas();\r\n\r\n    canvas.isDrawingMode = false;\r\n  }\r\n}\r\n\r\nexport default FreeDrawing;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Free drawing module, Set brush\r\n */\r\nimport snippet from 'tui-code-snippet';\r\nimport fabric from 'fabric';\r\nimport Component from '@/interface/component';\r\nimport ArrowLine from '@/extension/arrowLine';\r\nimport { eventNames, componentNames, fObjectOptions } from '@/consts';\r\n\r\n/**\r\n * Line\r\n * @class Line\r\n * @param {Graphics} graphics - Graphics instance\r\n * @extends {Component}\r\n * @ignore\r\n */\r\nclass Line extends Component {\r\n  constructor(graphics) {\r\n    super(componentNames.LINE, graphics);\r\n\r\n    /**\r\n     * Brush width\r\n     * @type {number}\r\n     * @private\r\n     */\r\n    this._width = 12;\r\n\r\n    /**\r\n     * fabric.Color instance for brush color\r\n     * @type {fabric.Color}\r\n     * @private\r\n     */\r\n    this._oColor = new fabric.Color('rgba(0, 0, 0, 0.5)');\r\n\r\n    /**\r\n     * Listeners\r\n     * @type {object.<string, function>}\r\n     * @private\r\n     */\r\n    this._listeners = {\r\n      mousedown: this._onFabricMouseDown.bind(this),\r\n      mousemove: this._onFabricMouseMove.bind(this),\r\n      mouseup: this._onFabricMouseUp.bind(this),\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Start drawing line mode\r\n   * @param {{width: ?number, color: ?string}} [setting] - Brush width & color\r\n   */\r\n  setHeadOption(setting) {\r\n    const {\r\n      arrowType = {\r\n        head: null,\r\n        tail: null,\r\n      },\r\n    } = setting;\r\n\r\n    this._arrowType = arrowType;\r\n  }\r\n\r\n  /**\r\n   * Start drawing line mode\r\n   * @param {{width: ?number, color: ?string}} [setting] - Brush width & color\r\n   */\r\n  start(setting = {}) {\r\n    const canvas = this.getCanvas();\r\n\r\n    canvas.defaultCursor = 'crosshair';\r\n    canvas.selection = false;\r\n\r\n    this.setHeadOption(setting);\r\n    this.setBrush(setting);\r\n\r\n    canvas.forEachObject((obj) => {\r\n      obj.set({\r\n        evented: false,\r\n      });\r\n    });\r\n\r\n    canvas.on({\r\n      'mouse:down': this._listeners.mousedown,\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Set brush\r\n   * @param {{width: ?number, color: ?string}} [setting] - Brush width & color\r\n   */\r\n  setBrush(setting) {\r\n    const brush = this.getCanvas().freeDrawingBrush;\r\n\r\n    setting = setting || {};\r\n    this._width = setting.width || this._width;\r\n\r\n    if (setting.color) {\r\n      this._oColor = new fabric.Color(setting.color);\r\n    }\r\n    brush.width = this._width;\r\n    brush.color = this._oColor.toRgba();\r\n  }\r\n\r\n  /**\r\n   * End drawing line mode\r\n   */\r\n  end() {\r\n    const canvas = this.getCanvas();\r\n\r\n    canvas.defaultCursor = 'default';\r\n    canvas.selection = true;\r\n\r\n    canvas.forEachObject((obj) => {\r\n      obj.set({\r\n        evented: true,\r\n      });\r\n    });\r\n\r\n    canvas.off('mouse:down', this._listeners.mousedown);\r\n  }\r\n\r\n  /**\r\n   * Mousedown event handler in fabric canvas\r\n   * @param {{target: fabric.Object, e: MouseEvent}} fEvent - Fabric event object\r\n   * @private\r\n   */\r\n  _onFabricMouseDown(fEvent) {\r\n    const canvas = this.getCanvas();\r\n    const { x, y } = canvas.getPointer(fEvent.e);\r\n    const points = [x, y, x, y];\r\n\r\n    this._line = new ArrowLine(points, {\r\n      stroke: this._oColor.toRgba(),\r\n      strokeWidth: this._width,\r\n      arrowType: this._arrowType,\r\n      evented: false,\r\n    });\r\n\r\n    this._line.set(fObjectOptions.SELECTION_STYLE);\r\n\r\n    canvas.add(this._line);\r\n\r\n    canvas.on({\r\n      'mouse:move': this._listeners.mousemove,\r\n      'mouse:up': this._listeners.mouseup,\r\n    });\r\n\r\n    this.fire(eventNames.ADD_OBJECT, this._createLineEventObjectProperties());\r\n  }\r\n\r\n  /**\r\n   * Mousemove event handler in fabric canvas\r\n   * @param {{target: fabric.Object, e: MouseEvent}} fEvent - Fabric event object\r\n   * @private\r\n   */\r\n  _onFabricMouseMove(fEvent) {\r\n    const canvas = this.getCanvas();\r\n    const pointer = canvas.getPointer(fEvent.e);\r\n\r\n    this._line.set({\r\n      x2: pointer.x,\r\n      y2: pointer.y,\r\n    });\r\n\r\n    this._line.setCoords();\r\n\r\n    canvas.renderAll();\r\n  }\r\n\r\n  /**\r\n   * Mouseup event handler in fabric canvas\r\n   * @private\r\n   */\r\n  _onFabricMouseUp() {\r\n    const canvas = this.getCanvas();\r\n\r\n    this.fire(eventNames.OBJECT_ADDED, this._createLineEventObjectProperties());\r\n\r\n    this._line = null;\r\n\r\n    canvas.off({\r\n      'mouse:move': this._listeners.mousemove,\r\n      'mouse:up': this._listeners.mouseup,\r\n    });\r\n  }\r\n\r\n  /**\r\n   * create line event object properties\r\n   * @returns {Object} properties line object\r\n   * @private\r\n   */\r\n  _createLineEventObjectProperties() {\r\n    const params = this.graphics.createObjectProperties(this._line);\r\n    const { x1, x2, y1, y2 } = this._line;\r\n\r\n    return snippet.extend({}, params, {\r\n      startPosition: {\r\n        x: x1,\r\n        y: y1,\r\n      },\r\n      endPosition: {\r\n        x: x2,\r\n        y: y2,\r\n      },\r\n    });\r\n  }\r\n}\r\n\r\nexport default Line;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Blur extending fabric.Image.filters.Convolute\r\n */\r\nimport fabric from 'fabric';\r\n\r\nconst ARROW_ANGLE = 30;\r\nconst CHEVRON_SIZE_RATIO = 2.7;\r\nconst TRIANGLE_SIZE_RATIO = 1.7;\r\nconst RADIAN_CONVERSION_VALUE = 180;\r\n\r\nconst ArrowLine = fabric.util.createClass(\r\n  fabric.Line,\r\n  /** @lends Convolute.prototype */ {\r\n    /**\r\n     * Line type\r\n     * @param {String} type\r\n     * @default\r\n     */\r\n    type: 'line',\r\n\r\n    /**\r\n     * Constructor\r\n     * @param {Array} [points] Array of points\r\n     * @param {Object} [options] Options object\r\n     * @override\r\n     */\r\n    initialize(points, options = {}) {\r\n      this.callSuper('initialize', points, options);\r\n\r\n      this.arrowType = options.arrowType;\r\n    },\r\n\r\n    /**\r\n     * Render ArrowLine\r\n     * @private\r\n     * @override\r\n     */\r\n    _render(ctx) {\r\n      const { x1: fromX, y1: fromY, x2: toX, y2: toY } = this.calcLinePoints();\r\n      const linePosition = {\r\n        fromX,\r\n        fromY,\r\n        toX,\r\n        toY,\r\n      };\r\n      this.ctx = ctx;\r\n      ctx.lineWidth = this.strokeWidth;\r\n\r\n      this._renderBasicLinePath(linePosition);\r\n      this._drawDecoratorPath(linePosition);\r\n\r\n      this._renderStroke(ctx);\r\n    },\r\n\r\n    /**\r\n     * Render Basic line path\r\n     * @param {Object} linePosition - line position\r\n     *  @param {number} option.fromX - line start position x\r\n     *  @param {number} option.fromY - line start position y\r\n     *  @param {number} option.toX - line end position x\r\n     *  @param {number} option.toY - line end position y\r\n     * @private\r\n     */\r\n    _renderBasicLinePath({ fromX, fromY, toX, toY }) {\r\n      this.ctx.beginPath();\r\n      this.ctx.moveTo(fromX, fromY);\r\n      this.ctx.lineTo(toX, toY);\r\n    },\r\n\r\n    /**\r\n     * Render Arrow Head\r\n     * @param {Object} linePosition - line position\r\n     *  @param {number} option.fromX - line start position x\r\n     *  @param {number} option.fromY - line start position y\r\n     *  @param {number} option.toX - line end position x\r\n     *  @param {number} option.toY - line end position y\r\n     * @private\r\n     */\r\n    _drawDecoratorPath(linePosition) {\r\n      this._drawDecoratorPathType('head', linePosition);\r\n      this._drawDecoratorPathType('tail', linePosition);\r\n    },\r\n\r\n    /**\r\n     * Render Arrow Head\r\n     * @param {string} type - 'head' or 'tail'\r\n     * @param {Object} linePosition - line position\r\n     *  @param {number} option.fromX - line start position x\r\n     *  @param {number} option.fromY - line start position y\r\n     *  @param {number} option.toX - line end position x\r\n     *  @param {number} option.toY - line end position y\r\n     * @private\r\n     */\r\n    _drawDecoratorPathType(type, linePosition) {\r\n      switch (this.arrowType[type]) {\r\n        case 'triangle':\r\n          this._drawTrianglePath(type, linePosition);\r\n          break;\r\n        case 'chevron':\r\n          this._drawChevronPath(type, linePosition);\r\n          break;\r\n        default:\r\n          break;\r\n      }\r\n    },\r\n\r\n    /**\r\n     * Render Triangle Head\r\n     * @param {string} type - 'head' or 'tail'\r\n     * @param {Object} linePosition - line position\r\n     *  @param {number} option.fromX - line start position x\r\n     *  @param {number} option.fromY - line start position y\r\n     *  @param {number} option.toX - line end position x\r\n     *  @param {number} option.toY - line end position y\r\n     * @private\r\n     */\r\n    _drawTrianglePath(type, linePosition) {\r\n      const decorateSize = this.ctx.lineWidth * TRIANGLE_SIZE_RATIO;\r\n\r\n      this._drawChevronPath(type, linePosition, decorateSize);\r\n      this.ctx.closePath();\r\n    },\r\n\r\n    /**\r\n     * Render Chevron Head\r\n     * @param {string} type - 'head' or 'tail'\r\n     * @param {Object} linePosition - line position\r\n     *  @param {number} option.fromX - line start position x\r\n     *  @param {number} option.fromY - line start position y\r\n     *  @param {number} option.toX - line end position x\r\n     *  @param {number} option.toY - line end position y\r\n     * @param {number} decorateSize - decorate size\r\n     * @private\r\n     */\r\n    _drawChevronPath(type, { fromX, fromY, toX, toY }, decorateSize) {\r\n      const { ctx } = this;\r\n      if (!decorateSize) {\r\n        decorateSize = this.ctx.lineWidth * CHEVRON_SIZE_RATIO;\r\n      }\r\n\r\n      const [standardX, standardY] = type === 'head' ? [fromX, fromY] : [toX, toY];\r\n      const [compareX, compareY] = type === 'head' ? [toX, toY] : [fromX, fromY];\r\n\r\n      const angle =\r\n        (Math.atan2(compareY - standardY, compareX - standardX) * RADIAN_CONVERSION_VALUE) /\r\n        Math.PI;\r\n      const rotatedPosition = (changeAngle) =>\r\n        this.getRotatePosition(decorateSize, changeAngle, {\r\n          x: standardX,\r\n          y: standardY,\r\n        });\r\n\r\n      ctx.moveTo(...rotatedPosition(angle + ARROW_ANGLE));\r\n      ctx.lineTo(standardX, standardY);\r\n      ctx.lineTo(...rotatedPosition(angle - ARROW_ANGLE));\r\n    },\r\n\r\n    /**\r\n     * return position from change angle.\r\n     * @param {number} distance - change distance\r\n     * @param {number} angle - change angle\r\n     * @param {Object} referencePosition - reference position\r\n     * @returns {Array}\r\n     * @private\r\n     */\r\n    getRotatePosition(distance, angle, referencePosition) {\r\n      const radian = (angle * Math.PI) / RADIAN_CONVERSION_VALUE;\r\n      const { x, y } = referencePosition;\r\n\r\n      return [distance * Math.cos(radian) + x, distance * Math.sin(radian) + y];\r\n    },\r\n  }\r\n);\r\n\r\nexport default ArrowLine;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Text module\r\n */\r\nimport snippet from 'tui-code-snippet';\r\nimport fabric from 'fabric';\r\nimport Component from '@/interface/component';\r\nimport { Promise } from '@/util';\r\nimport { componentNames, eventNames as events, fObjectOptions } from '@/consts';\r\n\r\nconst defaultStyles = {\r\n  fill: '#000000',\r\n  left: 0,\r\n  top: 0,\r\n};\r\nconst resetStyles = {\r\n  fill: '#000000',\r\n  fontStyle: 'normal',\r\n  fontWeight: 'normal',\r\n  textAlign: 'tie-text-align-left',\r\n  underline: false,\r\n};\r\nconst DBCLICK_TIME = 500;\r\n\r\n/**\r\n * Text\r\n * @class Text\r\n * @param {Graphics} graphics - Graphics instance\r\n * @extends {Component}\r\n * @ignore\r\n */\r\nclass Text extends Component {\r\n  constructor(graphics) {\r\n    super(componentNames.TEXT, graphics);\r\n\r\n    /**\r\n     * Default text style\r\n     * @type {Object}\r\n     */\r\n    this._defaultStyles = defaultStyles;\r\n\r\n    /**\r\n     * Selected state\r\n     * @type {boolean}\r\n     */\r\n    this._isSelected = false;\r\n\r\n    /**\r\n     * Selected text object\r\n     * @type {Object}\r\n     */\r\n    this._selectedObj = {};\r\n\r\n    /**\r\n     * Editing text object\r\n     * @type {Object}\r\n     */\r\n    this._editingObj = {};\r\n\r\n    /**\r\n     * Listeners for fabric event\r\n     * @type {Object}\r\n     */\r\n    this._listeners = {\r\n      mousedown: this._onFabricMouseDown.bind(this),\r\n      select: this._onFabricSelect.bind(this),\r\n      selectClear: this._onFabricSelectClear.bind(this),\r\n      scaling: this._onFabricScaling.bind(this),\r\n      textChanged: this._onFabricTextChanged.bind(this),\r\n    };\r\n\r\n    /**\r\n     * Textarea element for editing\r\n     * @type {HTMLElement}\r\n     */\r\n    this._textarea = null;\r\n\r\n    /**\r\n     * Ratio of current canvas\r\n     * @type {number}\r\n     */\r\n    this._ratio = 1;\r\n\r\n    /**\r\n     * Last click time\r\n     * @type {Date}\r\n     */\r\n    this._lastClickTime = new Date().getTime();\r\n\r\n    /**\r\n     * Text object infos before editing\r\n     * @type {Object}\r\n     */\r\n    this._editingObjInfos = {};\r\n\r\n    /**\r\n     * Previous state of editing\r\n     * @type {boolean}\r\n     */\r\n    this.isPrevEditing = false;\r\n  }\r\n\r\n  /**\r\n   * Start input text mode\r\n   */\r\n  start() {\r\n    const canvas = this.getCanvas();\r\n\r\n    canvas.selection = false;\r\n    canvas.defaultCursor = 'text';\r\n    canvas.on({\r\n      'mouse:down': this._listeners.mousedown,\r\n      'selection:created': this._listeners.select,\r\n      'selection:updated': this._listeners.select,\r\n      'before:selection:cleared': this._listeners.selectClear,\r\n      'object:scaling': this._listeners.scaling,\r\n      'text:changed': this._listeners.textChanged,\r\n    });\r\n\r\n    canvas.forEachObject((obj) => {\r\n      if (obj.type === 'i-text') {\r\n        this.adjustOriginPosition(obj, 'start');\r\n      }\r\n    });\r\n\r\n    this.setCanvasRatio();\r\n  }\r\n\r\n  /**\r\n   * End input text mode\r\n   */\r\n  end() {\r\n    const canvas = this.getCanvas();\r\n\r\n    canvas.selection = true;\r\n    canvas.defaultCursor = 'default';\r\n\r\n    canvas.forEachObject((obj) => {\r\n      if (obj.type === 'i-text') {\r\n        if (obj.text === '') {\r\n          canvas.remove(obj);\r\n        } else {\r\n          this.adjustOriginPosition(obj, 'end');\r\n        }\r\n      }\r\n    });\r\n\r\n    canvas.off({\r\n      'mouse:down': this._listeners.mousedown,\r\n      'selection:created': this._listeners.select,\r\n      'selection:updated': this._listeners.select,\r\n      'before:selection:cleared': this._listeners.selectClear,\r\n      'object:selected': this._listeners.select,\r\n      'object:scaling': this._listeners.scaling,\r\n      'text:changed': this._listeners.textChanged,\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Adjust the origin position\r\n   * @param {fabric.Object} text - text object\r\n   * @param {string} editStatus - 'start' or 'end'\r\n   */\r\n  adjustOriginPosition(text, editStatus) {\r\n    let [originX, originY] = ['center', 'center'];\r\n    if (editStatus === 'start') {\r\n      [originX, originY] = ['left', 'top'];\r\n    }\r\n\r\n    const { x: left, y: top } = text.getPointByOrigin(originX, originY);\r\n    text.set({\r\n      left,\r\n      top,\r\n      originX,\r\n      originY,\r\n    });\r\n    text.setCoords();\r\n  }\r\n\r\n  /**\r\n   * Add new text on canvas image\r\n   * @param {string} text - Initial input text\r\n   * @param {Object} options - Options for generating text\r\n   *     @param {Object} [options.styles] Initial styles\r\n   *         @param {string} [options.styles.fill] Color\r\n   *         @param {string} [options.styles.fontFamily] Font type for text\r\n   *         @param {number} [options.styles.fontSize] Size\r\n   *         @param {string} [options.styles.fontStyle] Type of inclination (normal / italic)\r\n   *         @param {string} [options.styles.fontWeight] Type of thicker or thinner looking (normal / bold)\r\n   *         @param {string} [options.styles.textAlign] Type of text align (left / center / right)\r\n   *         @param {string} [options.styles.textDecoration] Type of line (underline / line-through / overline)\r\n   *     @param {{x: number, y: number}} [options.position] - Initial position\r\n   * @returns {Promise}\r\n   */\r\n  add(text, options) {\r\n    return new Promise((resolve) => {\r\n      const canvas = this.getCanvas();\r\n      let newText = null;\r\n      let styles = this._defaultStyles;\r\n\r\n      this._setInitPos(options.position);\r\n\r\n      if (options.styles) {\r\n        styles = snippet.extend(styles, options.styles);\r\n      }\r\n\r\n      if (!snippet.isExisty(options.autofocus)) {\r\n        options.autofocus = true;\r\n      }\r\n\r\n      newText = new fabric.IText(text, styles);\r\n      let selectionStyle = fObjectOptions.SELECTION_STYLE;\r\n      selectionStyle = snippet.extend({}, selectionStyle, {\r\n        originX: 'left',\r\n        originY: 'top',\r\n      });\r\n\r\n      newText.set(selectionStyle);\r\n      this.initialize(newText);\r\n\r\n      canvas.add(newText);\r\n\r\n      if (options.autofocus) {\r\n        newText.enterEditing();\r\n        newText.selectAll();\r\n      }\r\n\r\n      if (!canvas.getActiveObject()) {\r\n        canvas.setActiveObject(newText);\r\n      }\r\n\r\n      this.isPrevEditing = true;\r\n      resolve(this.graphics.createObjectProperties(newText));\r\n    });\r\n  }\r\n\r\n  initialize(text) {\r\n    text.on({\r\n      mouseup: this._onFabricMouseUp.bind(this),\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Change text of activate object on canvas image\r\n   * @param {Object} activeObj - Current selected text object\r\n   * @param {string} text - Changed text\r\n   * @returns {Promise}\r\n   */\r\n  change(activeObj, text) {\r\n    return new Promise((resolve) => {\r\n      activeObj.set('text', text);\r\n\r\n      this.getCanvas().renderAll();\r\n      resolve();\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Set style\r\n   * @param {Object} activeObj - Current selected text object\r\n   * @param {Object} styleObj - Initial styles\r\n   *     @param {string} [styleObj.fill] Color\r\n   *     @param {string} [styleObj.fontFamily] Font type for text\r\n   *     @param {number} [styleObj.fontSize] Size\r\n   *     @param {string} [styleObj.fontStyle] Type of inclination (normal / italic)\r\n   *     @param {string} [styleObj.fontWeight] Type of thicker or thinner looking (normal / bold)\r\n   *     @param {string} [styleObj.textAlign] Type of text align (left / center / right)\r\n   *     @param {string} [styleObj.textDecoration] Type of line (underline / line-through / overline)\r\n   * @returns {Promise}\r\n   */\r\n  setStyle(activeObj, styleObj) {\r\n    return new Promise((resolve) => {\r\n      snippet.forEach(\r\n        styleObj,\r\n        (val, key) => {\r\n          if (activeObj[key] === val && key !== 'fontSize') {\r\n            styleObj[key] = resetStyles[key] || '';\r\n          }\r\n        },\r\n        this\r\n      );\r\n\r\n      if ('textDecoration' in styleObj) {\r\n        snippet.extend(styleObj, this._getTextDecorationAdaptObject(styleObj.textDecoration));\r\n      }\r\n\r\n      activeObj.set(styleObj);\r\n\r\n      this.getCanvas().renderAll();\r\n      resolve();\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Get the text\r\n   * @param {Object} activeObj - Current selected text object\r\n   * @returns {String} text\r\n   */\r\n  getText(activeObj) {\r\n    return activeObj.text;\r\n  }\r\n\r\n  /**\r\n   * Set infos of the current selected object\r\n   * @param {fabric.Text} obj - Current selected text object\r\n   * @param {boolean} state - State of selecting\r\n   */\r\n  setSelectedInfo(obj, state) {\r\n    this._selectedObj = obj;\r\n    this._isSelected = state;\r\n  }\r\n\r\n  /**\r\n   * Whether object is selected or not\r\n   * @returns {boolean} State of selecting\r\n   */\r\n  isSelected() {\r\n    return this._isSelected;\r\n  }\r\n\r\n  /**\r\n   * Get current selected text object\r\n   * @returns {fabric.Text} Current selected text object\r\n   */\r\n  getSelectedObj() {\r\n    return this._selectedObj;\r\n  }\r\n\r\n  /**\r\n   * Set ratio value of canvas\r\n   */\r\n  setCanvasRatio() {\r\n    const canvasElement = this.getCanvasElement();\r\n    const cssWidth = parseInt(canvasElement.style.maxWidth, 10);\r\n    const originWidth = canvasElement.width;\r\n\r\n    this._ratio = originWidth / cssWidth;\r\n  }\r\n\r\n  /**\r\n   * Get ratio value of canvas\r\n   * @returns {number} Ratio value\r\n   */\r\n  getCanvasRatio() {\r\n    return this._ratio;\r\n  }\r\n\r\n  /**\r\n   * Get text decoration adapt object\r\n   * @param {string} textDecoration - text decoration option string\r\n   * @returns {object} adapt object for override\r\n   */\r\n  _getTextDecorationAdaptObject(textDecoration) {\r\n    return {\r\n      underline: textDecoration === 'underline',\r\n      linethrough: textDecoration === 'line-through',\r\n      overline: textDecoration === 'overline',\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Set initial position on canvas image\r\n   * @param {{x: number, y: number}} [position] - Selected position\r\n   * @private\r\n   */\r\n  _setInitPos(position) {\r\n    position = position || this.getCanvasImage().getCenterPoint();\r\n\r\n    this._defaultStyles.left = position.x;\r\n    this._defaultStyles.top = position.y;\r\n  }\r\n\r\n  /**\r\n   * Input event handler\r\n   * @private\r\n   */\r\n  _onInput() {\r\n    const ratio = this.getCanvasRatio();\r\n    const obj = this._editingObj;\r\n    const textareaStyle = this._textarea.style;\r\n\r\n    textareaStyle.width = `${Math.ceil(obj.width / ratio)}px`;\r\n    textareaStyle.height = `${Math.ceil(obj.height / ratio)}px`;\r\n  }\r\n\r\n  /**\r\n   * Keydown event handler\r\n   * @private\r\n   */\r\n  _onKeyDown() {\r\n    const ratio = this.getCanvasRatio();\r\n    const obj = this._editingObj;\r\n    const textareaStyle = this._textarea.style;\r\n\r\n    setTimeout(() => {\r\n      obj.text(this._textarea.value);\r\n\r\n      textareaStyle.width = `${Math.ceil(obj.width / ratio)}px`;\r\n      textareaStyle.height = `${Math.ceil(obj.height / ratio)}px`;\r\n    }, 0);\r\n  }\r\n\r\n  /**\r\n   * Blur event handler\r\n   * @private\r\n   */\r\n  _onBlur() {\r\n    const ratio = this.getCanvasRatio();\r\n    const editingObj = this._editingObj;\r\n    const editingObjInfos = this._editingObjInfos;\r\n    const textContent = this._textarea.value;\r\n    let transWidth = editingObj.width / ratio - editingObjInfos.width / ratio;\r\n    let transHeight = editingObj.height / ratio - editingObjInfos.height / ratio;\r\n\r\n    if (ratio === 1) {\r\n      transWidth /= 2;\r\n      transHeight /= 2;\r\n    }\r\n\r\n    this._textarea.style.display = 'none';\r\n\r\n    editingObj.set({\r\n      left: editingObjInfos.left + transWidth,\r\n      top: editingObjInfos.top + transHeight,\r\n    });\r\n\r\n    if (textContent.length) {\r\n      this.getCanvas().add(editingObj);\r\n\r\n      const params = {\r\n        objId: snippet.stamp(editingObj),\r\n        type: editingObj.type,\r\n        text: textContent,\r\n      };\r\n\r\n      this.fire(events.TEXT_CHANGED, params);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Scroll event handler\r\n   * @private\r\n   */\r\n  _onScroll() {\r\n    this._textarea.scrollLeft = 0;\r\n    this._textarea.scrollTop = 0;\r\n  }\r\n\r\n  /**\r\n   * Fabric scaling event handler\r\n   * @param {fabric.Event} fEvent - Current scaling event on selected object\r\n   * @private\r\n   */\r\n  _onFabricScaling(fEvent) {\r\n    const obj = fEvent.target;\r\n\r\n    obj.fontSize = obj.fontSize * obj.scaleY;\r\n    obj.scaleX = 1;\r\n    obj.scaleY = 1;\r\n  }\r\n\r\n  /**\r\n   * textChanged event handler\r\n   * @param {{target: fabric.Object}} props - changed text object\r\n   * @private\r\n   */\r\n  _onFabricTextChanged(props) {\r\n    this.fire(events.TEXT_CHANGED, props.target);\r\n  }\r\n\r\n  /**\r\n   * onSelectClear handler in fabric canvas\r\n   * @param {{target: fabric.Object, e: MouseEvent}} fEvent - Fabric event\r\n   * @private\r\n   */\r\n  _onFabricSelectClear(fEvent) {\r\n    const obj = this.getSelectedObj();\r\n\r\n    this.isPrevEditing = true;\r\n\r\n    this.setSelectedInfo(fEvent.target, false);\r\n\r\n    if (obj) {\r\n      // obj is empty object at initial time, will be set fabric object\r\n      if (obj.text === '') {\r\n        this.getCanvas().remove(obj);\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * onSelect handler in fabric canvas\r\n   * @param {{target: fabric.Object, e: MouseEvent}} fEvent - Fabric event\r\n   * @private\r\n   */\r\n  _onFabricSelect(fEvent) {\r\n    this.isPrevEditing = true;\r\n\r\n    this.setSelectedInfo(fEvent.target, true);\r\n  }\r\n\r\n  /**\r\n   * Fabric 'mousedown' event handler\r\n   * @param {fabric.Event} fEvent - Current mousedown event on selected object\r\n   * @private\r\n   */\r\n  _onFabricMouseDown(fEvent) {\r\n    const obj = fEvent.target;\r\n\r\n    if (obj && !obj.isType('text')) {\r\n      return;\r\n    }\r\n\r\n    if (this.isPrevEditing) {\r\n      this.isPrevEditing = false;\r\n\r\n      return;\r\n    }\r\n\r\n    this._fireAddText(fEvent);\r\n  }\r\n\r\n  /**\r\n   * Fire 'addText' event if object is not selected.\r\n   * @param {fabric.Event} fEvent - Current mousedown event on selected object\r\n   * @private\r\n   */\r\n  _fireAddText(fEvent) {\r\n    const obj = fEvent.target;\r\n    const e = fEvent.e || {};\r\n    const originPointer = this.getCanvas().getPointer(e);\r\n\r\n    if (!obj) {\r\n      this.fire(events.ADD_TEXT, {\r\n        originPosition: {\r\n          x: originPointer.x,\r\n          y: originPointer.y,\r\n        },\r\n        clientPosition: {\r\n          x: e.clientX || 0,\r\n          y: e.clientY || 0,\r\n        },\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Fabric mouseup event handler\r\n   * @param {fabric.Event} fEvent - Current mousedown event on selected object\r\n   * @private\r\n   */\r\n  _onFabricMouseUp(fEvent) {\r\n    const { target } = fEvent;\r\n    const newClickTime = new Date().getTime();\r\n\r\n    if (this._isDoubleClick(newClickTime) && !target.isEditing) {\r\n      target.enterEditing();\r\n    }\r\n\r\n    if (target.isEditing) {\r\n      this.fire(events.TEXT_EDITING); // fire editing text event\r\n    }\r\n\r\n    this._lastClickTime = newClickTime;\r\n  }\r\n\r\n  /**\r\n   * Get state of firing double click event\r\n   * @param {Date} newClickTime - Current clicked time\r\n   * @returns {boolean} Whether double clicked or not\r\n   * @private\r\n   */\r\n  _isDoubleClick(newClickTime) {\r\n    return newClickTime - this._lastClickTime < DBCLICK_TIME;\r\n  }\r\n}\r\n\r\nexport default Text;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Add icon module\r\n */\r\nimport snippet from 'tui-code-snippet';\r\nimport fabric from 'fabric';\r\nimport Component from '@/interface/component';\r\nimport { Promise } from '@/util';\r\nimport { eventNames as events, rejectMessages, componentNames, fObjectOptions } from '@/consts';\r\n\r\nconst pathMap = {\r\n  arrow: 'M 0 90 H 105 V 120 L 160 60 L 105 0 V 30 H 0 Z',\r\n  cancel:\r\n    'M 0 30 L 30 60 L 0 90 L 30 120 L 60 90 L 90 120 L 120 90 ' +\r\n    'L 90 60 L 120 30 L 90 0 L 60 30 L 30 0 Z',\r\n};\r\n\r\n/**\r\n * Icon\r\n * @class Icon\r\n * @param {Graphics} graphics - Graphics instance\r\n * @extends {Component}\r\n * @ignore\r\n */\r\nclass Icon extends Component {\r\n  constructor(graphics) {\r\n    super(componentNames.ICON, graphics);\r\n\r\n    /**\r\n     * Default icon color\r\n     * @type {string}\r\n     */\r\n    this._oColor = '#000000';\r\n\r\n    /**\r\n     * Path value of each icon type\r\n     * @type {Object}\r\n     */\r\n    this._pathMap = pathMap;\r\n\r\n    /**\r\n     * Type of the drawing icon\r\n     * @type {string}\r\n     * @private\r\n     */\r\n    this._type = null;\r\n\r\n    /**\r\n     * Color of the drawing icon\r\n     * @type {string}\r\n     * @private\r\n     */\r\n    this._iconColor = null;\r\n\r\n    /**\r\n     * Event handler list\r\n     * @type {Object}\r\n     * @private\r\n     */\r\n    this._handlers = {\r\n      mousedown: this._onFabricMouseDown.bind(this),\r\n      mousemove: this._onFabricMouseMove.bind(this),\r\n      mouseup: this._onFabricMouseUp.bind(this),\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Set states of the current drawing shape\r\n   * @ignore\r\n   * @param {string} type - Icon type ('arrow', 'cancel', custom icon name)\r\n   * @param {string} iconColor - Icon foreground color\r\n   */\r\n  setStates(type, iconColor) {\r\n    this._type = type;\r\n    this._iconColor = iconColor;\r\n  }\r\n\r\n  /**\r\n   * Start to draw the icon on canvas\r\n   * @ignore\r\n   */\r\n  start() {\r\n    const canvas = this.getCanvas();\r\n    canvas.selection = false;\r\n    canvas.on('mouse:down', this._handlers.mousedown);\r\n  }\r\n\r\n  /**\r\n   * End to draw the icon on canvas\r\n   * @ignore\r\n   */\r\n  end() {\r\n    const canvas = this.getCanvas();\r\n\r\n    canvas.selection = true;\r\n    canvas.off({\r\n      'mouse:down': this._handlers.mousedown,\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Add icon\r\n   * @param {string} type - Icon type\r\n   * @param {Object} options - Icon options\r\n   *      @param {string} [options.fill] - Icon foreground color\r\n   *      @param {string} [options.left] - Icon x position\r\n   *      @param {string} [options.top] - Icon y position\r\n   * @returns {Promise}\r\n   */\r\n  add(type, options) {\r\n    return new Promise((resolve, reject) => {\r\n      const canvas = this.getCanvas();\r\n      const path = this._pathMap[type];\r\n      const selectionStyle = fObjectOptions.SELECTION_STYLE;\r\n      const icon = path ? this._createIcon(path) : null;\r\n      this._icon = icon;\r\n\r\n      if (!icon) {\r\n        reject(rejectMessages.invalidParameters);\r\n      }\r\n\r\n      icon.set(\r\n        snippet.extend(\r\n          {\r\n            type: 'icon',\r\n            fill: this._oColor,\r\n          },\r\n          selectionStyle,\r\n          options,\r\n          this.graphics.controlStyle\r\n        )\r\n      );\r\n\r\n      canvas.add(icon).setActiveObject(icon);\r\n\r\n      resolve(this.graphics.createObjectProperties(icon));\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Register icon paths\r\n   * @param {{key: string, value: string}} pathInfos - Path infos\r\n   */\r\n  registerPaths(pathInfos) {\r\n    snippet.forEach(\r\n      pathInfos,\r\n      (path, type) => {\r\n        this._pathMap[type] = path;\r\n      },\r\n      this\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Set icon object color\r\n   * @param {string} color - Color to set\r\n   * @param {fabric.Path}[obj] - Current activated path object\r\n   */\r\n  setColor(color, obj) {\r\n    this._oColor = color;\r\n\r\n    if (obj && obj.get('type') === 'icon') {\r\n      obj.set({ fill: this._oColor });\r\n      this.getCanvas().renderAll();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get icon color\r\n   * @param {fabric.Path}[obj] - Current activated path object\r\n   * @returns {string} color\r\n   */\r\n  getColor(obj) {\r\n    return obj.fill;\r\n  }\r\n\r\n  /**\r\n   * Create icon object\r\n   * @param {string} path - Path value to create icon\r\n   * @returns {fabric.Path} Path object\r\n   */\r\n  _createIcon(path) {\r\n    return new fabric.Path(path);\r\n  }\r\n\r\n  /**\r\n   * MouseDown event handler on canvas\r\n   * @param {{target: fabric.Object, e: MouseEvent}} fEvent - Fabric event object\r\n   * @private\r\n   */\r\n  _onFabricMouseDown(fEvent) {\r\n    const canvas = this.getCanvas();\r\n\r\n    this._startPoint = canvas.getPointer(fEvent.e);\r\n    const { x: left, y: top } = this._startPoint;\r\n\r\n    this.add(this._type, {\r\n      left,\r\n      top,\r\n      fill: this._iconColor,\r\n    }).then(() => {\r\n      this.fire(events.ADD_OBJECT, this.graphics.createObjectProperties(this._icon));\r\n      canvas.on('mouse:move', this._handlers.mousemove);\r\n      canvas.on('mouse:up', this._handlers.mouseup);\r\n    });\r\n  }\r\n\r\n  /**\r\n   * MouseMove event handler on canvas\r\n   * @param {{target: fabric.Object, e: MouseEvent}} fEvent - Fabric event object\r\n   * @private\r\n   */\r\n  _onFabricMouseMove(fEvent) {\r\n    const canvas = this.getCanvas();\r\n\r\n    if (!this._icon) {\r\n      return;\r\n    }\r\n    const moveOriginPointer = canvas.getPointer(fEvent.e);\r\n\r\n    const scaleX = (moveOriginPointer.x - this._startPoint.x) / this._icon.width;\r\n    const scaleY = (moveOriginPointer.y - this._startPoint.y) / this._icon.height;\r\n\r\n    this._icon.set({\r\n      scaleX: Math.abs(scaleX * 2),\r\n      scaleY: Math.abs(scaleY * 2),\r\n    });\r\n\r\n    this._icon.setCoords();\r\n    canvas.renderAll();\r\n  }\r\n\r\n  /**\r\n   * MouseUp event handler on canvas\r\n   * @private\r\n   */\r\n  _onFabricMouseUp() {\r\n    const canvas = this.getCanvas();\r\n\r\n    this.fire(events.OBJECT_ADDED, this.graphics.createObjectProperties(this._icon));\r\n\r\n    this._icon = null;\r\n\r\n    canvas.off('mouse:down', this._handlers.mousedown);\r\n    canvas.off('mouse:move', this._handlers.mousemove);\r\n    canvas.off('mouse:up', this._handlers.mouseup);\r\n  }\r\n}\r\n\r\nexport default Icon;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Add filter module\r\n */\r\nimport { isUndefined, extend, forEach, filter } from 'tui-code-snippet';\r\nimport fabric from 'fabric';\r\nimport Component from '@/interface/component';\r\nimport { Promise } from '@/util';\r\nimport { rejectMessages, componentNames } from '@/consts';\r\nimport Mask from '@/extension/mask';\r\nimport Sharpen from '@/extension/sharpen';\r\nimport Emboss from '@/extension/emboss';\r\nimport ColorFilter from '@/extension/colorFilter';\r\n\r\nconst { filters } = fabric.Image;\r\n\r\nfilters.Mask = Mask;\r\nfilters.Sharpen = Sharpen;\r\nfilters.Emboss = Emboss;\r\nfilters.ColorFilter = ColorFilter;\r\n\r\n/**\r\n * Filter\r\n * @class Filter\r\n * @param {Graphics} graphics - Graphics instance\r\n * @extends {Component}\r\n * @ignore\r\n */\r\nclass Filter extends Component {\r\n  constructor(graphics) {\r\n    super(componentNames.FILTER, graphics);\r\n  }\r\n\r\n  /**\r\n   * Add filter to source image (a specific filter is added on fabric.js)\r\n   * @param {string} type - Filter type\r\n   * @param {Object} [options] - Options of filter\r\n   * @returns {Promise}\r\n   */\r\n  add(type, options) {\r\n    return new Promise((resolve, reject) => {\r\n      const sourceImg = this._getSourceImage();\r\n      const canvas = this.getCanvas();\r\n      let imgFilter = this._getFilter(sourceImg, type);\r\n      if (!imgFilter) {\r\n        imgFilter = this._createFilter(sourceImg, type, options);\r\n      }\r\n\r\n      if (!imgFilter) {\r\n        reject(rejectMessages.invalidParameters);\r\n      }\r\n\r\n      this._changeFilterValues(imgFilter, options);\r\n\r\n      this._apply(sourceImg, () => {\r\n        canvas.renderAll();\r\n        resolve({\r\n          type,\r\n          action: 'add',\r\n          options,\r\n        });\r\n      });\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Remove filter to source image\r\n   * @param {string} type - Filter type\r\n   * @returns {Promise}\r\n   */\r\n  remove(type) {\r\n    return new Promise((resolve, reject) => {\r\n      const sourceImg = this._getSourceImage();\r\n      const canvas = this.getCanvas();\r\n      const options = this.getOptions(type);\r\n\r\n      if (!sourceImg.filters.length) {\r\n        reject(rejectMessages.unsupportedOperation);\r\n      }\r\n\r\n      this._removeFilter(sourceImg, type);\r\n\r\n      this._apply(sourceImg, () => {\r\n        canvas.renderAll();\r\n        resolve({\r\n          type,\r\n          action: 'remove',\r\n          options,\r\n        });\r\n      });\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Whether this has the filter or not\r\n   * @param {string} type - Filter type\r\n   * @returns {boolean} true if it has the filter\r\n   */\r\n  hasFilter(type) {\r\n    return !!this._getFilter(this._getSourceImage(), type);\r\n  }\r\n\r\n  /**\r\n   * Get a filter options\r\n   * @param {string} type - Filter type\r\n   * @returns {Object} filter options or null if there is no that filter\r\n   */\r\n  getOptions(type) {\r\n    const sourceImg = this._getSourceImage();\r\n    const imgFilter = this._getFilter(sourceImg, type);\r\n    if (!imgFilter) {\r\n      return null;\r\n    }\r\n\r\n    return extend({}, imgFilter.options);\r\n  }\r\n\r\n  /**\r\n   * Change filter values\r\n   * @param {Object} imgFilter object of filter\r\n   * @param {Object} options object\r\n   * @private\r\n   */\r\n  _changeFilterValues(imgFilter, options) {\r\n    forEach(options, (value, key) => {\r\n      if (!isUndefined(imgFilter[key])) {\r\n        imgFilter[key] = value;\r\n      }\r\n    });\r\n    forEach(imgFilter.options, (value, key) => {\r\n      if (!isUndefined(options[key])) {\r\n        imgFilter.options[key] = options[key];\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Apply filter\r\n   * @param {fabric.Image} sourceImg - Source image to apply filter\r\n   * @param {function} callback - Executed function after applying filter\r\n   * @private\r\n   */\r\n  _apply(sourceImg, callback) {\r\n    sourceImg.filters.push();\r\n    const result = sourceImg.applyFilters();\r\n    if (result) {\r\n      callback();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get source image on canvas\r\n   * @returns {fabric.Image} Current source image on canvas\r\n   * @private\r\n   */\r\n  _getSourceImage() {\r\n    return this.getCanvasImage();\r\n  }\r\n\r\n  /**\r\n   * Create filter instance\r\n   * @param {fabric.Image} sourceImg - Source image to apply filter\r\n   * @param {string} type - Filter type\r\n   * @param {Object} [options] - Options of filter\r\n   * @returns {Object} Fabric object of filter\r\n   * @private\r\n   */\r\n  _createFilter(sourceImg, type, options) {\r\n    let filterObj;\r\n    // capitalize first letter for matching with fabric image filter name\r\n    const fabricType = this._getFabricFilterType(type);\r\n    const ImageFilter = fabric.Image.filters[fabricType];\r\n    if (ImageFilter) {\r\n      filterObj = new ImageFilter(options);\r\n      filterObj.options = options;\r\n      sourceImg.filters.push(filterObj);\r\n    }\r\n\r\n    return filterObj;\r\n  }\r\n\r\n  /**\r\n   * Get applied filter instance\r\n   * @param {fabric.Image} sourceImg - Source image to apply filter\r\n   * @param {string} type - Filter type\r\n   * @returns {Object} Fabric object of filter\r\n   * @private\r\n   */\r\n  _getFilter(sourceImg, type) {\r\n    let imgFilter = null;\r\n\r\n    if (sourceImg) {\r\n      const fabricType = this._getFabricFilterType(type);\r\n      const { length } = sourceImg.filters;\r\n      let item, i;\r\n\r\n      for (i = 0; i < length; i += 1) {\r\n        item = sourceImg.filters[i];\r\n        if (item.type === fabricType) {\r\n          imgFilter = item;\r\n          break;\r\n        }\r\n      }\r\n    }\r\n\r\n    return imgFilter;\r\n  }\r\n\r\n  /**\r\n   * Remove applied filter instance\r\n   * @param {fabric.Image} sourceImg - Source image to apply filter\r\n   * @param {string} type - Filter type\r\n   * @private\r\n   */\r\n  _removeFilter(sourceImg, type) {\r\n    const fabricType = this._getFabricFilterType(type);\r\n    sourceImg.filters = filter(sourceImg.filters, (value) => value.type !== fabricType);\r\n  }\r\n\r\n  /**\r\n   * Change filter class name to fabric's, especially capitalizing first letter\r\n   * @param {string} type - Filter type\r\n   * @example\r\n   * 'grayscale' -> 'Grayscale'\r\n   * @returns {string} Fabric filter class name\r\n   */\r\n  _getFabricFilterType(type) {\r\n    return type.charAt(0).toUpperCase() + type.slice(1);\r\n  }\r\n}\r\n\r\nexport default Filter;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Mask extending fabric.Image.filters.Mask\r\n */\r\nimport fabric from 'fabric';\r\n\r\n/**\r\n * Mask object\r\n * @class Mask\r\n * @extends {fabric.Image.filters.BlendImage}\r\n * @ignore\r\n */\r\nconst Mask = fabric.util.createClass(\r\n  fabric.Image.filters.BlendImage,\r\n  /** @lends Mask.prototype */ {\r\n    /**\r\n     * Apply filter to canvas element\r\n     * @param {Object} pipelineState - Canvas element to apply filter\r\n     * @override\r\n     */\r\n    applyTo(pipelineState) {\r\n      if (!this.mask) {\r\n        return;\r\n      }\r\n\r\n      const canvas = pipelineState.canvasEl;\r\n      const { width, height } = canvas;\r\n      const maskCanvasEl = this._createCanvasOfMask(width, height);\r\n      const ctx = canvas.getContext('2d');\r\n      const maskCtx = maskCanvasEl.getContext('2d');\r\n      const imageData = ctx.getImageData(0, 0, width, height);\r\n\r\n      this._drawMask(maskCtx, canvas, ctx);\r\n      this._mapData(maskCtx, imageData, width, height);\r\n\r\n      pipelineState.imageData = imageData;\r\n    },\r\n\r\n    /**\r\n     * Create canvas of mask image\r\n     * @param {number} width - Width of main canvas\r\n     * @param {number} height - Height of main canvas\r\n     * @returns {HTMLElement} Canvas element\r\n     * @private\r\n     */\r\n    _createCanvasOfMask(width, height) {\r\n      const maskCanvasEl = fabric.util.createCanvasElement();\r\n\r\n      maskCanvasEl.width = width;\r\n      maskCanvasEl.height = height;\r\n\r\n      return maskCanvasEl;\r\n    },\r\n\r\n    /**\r\n     * Draw mask image on canvas element\r\n     * @param {Object} maskCtx - Context of mask canvas\r\n     * @private\r\n     */\r\n    _drawMask(maskCtx) {\r\n      const { mask } = this;\r\n      const maskImg = mask.getElement();\r\n      const { angle, left, scaleX, scaleY, top } = mask;\r\n\r\n      maskCtx.save();\r\n      maskCtx.translate(left, top);\r\n      maskCtx.rotate((angle * Math.PI) / 180);\r\n      maskCtx.scale(scaleX, scaleY);\r\n      maskCtx.drawImage(maskImg, -maskImg.width / 2, -maskImg.height / 2);\r\n      maskCtx.restore();\r\n    },\r\n\r\n    /**\r\n     * Map mask image data to source image data\r\n     * @param {Object} maskCtx - Context of mask canvas\r\n     * @param {Object} imageData - Data of source image\r\n     * @param {number} width - Width of main canvas\r\n     * @param {number} height - Height of main canvas\r\n     * @private\r\n     */\r\n    _mapData(maskCtx, imageData, width, height) {\r\n      const { data, height: imgHeight, width: imgWidth } = imageData;\r\n      const sourceData = data;\r\n      const len = imgWidth * imgHeight * 4;\r\n      const maskData = maskCtx.getImageData(0, 0, width, height).data;\r\n\r\n      for (let i = 0; i < len; i += 4) {\r\n        sourceData[i + 3] = maskData[i]; // adjust value of alpha data\r\n      }\r\n    },\r\n  }\r\n);\r\n\r\nexport default Mask;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Sharpen extending fabric.Image.filters.Convolute\r\n */\r\nimport fabric from 'fabric';\r\n\r\n/**\r\n * Sharpen object\r\n * @class Sharpen\r\n * @extends {fabric.Image.filters.Convolute}\r\n * @ignore\r\n */\r\nconst Sharpen = fabric.util.createClass(\r\n  fabric.Image.filters.Convolute,\r\n  /** @lends Convolute.prototype */ {\r\n    /**\r\n     * Filter type\r\n     * @param {String} type\r\n     * @default\r\n     */\r\n    type: 'Sharpen',\r\n\r\n    /**\r\n     * constructor\r\n     * @override\r\n     */\r\n    initialize() {\r\n      this.matrix = [0, -1, 0, -1, 5, -1, 0, -1, 0];\r\n    },\r\n  }\r\n);\r\n\r\nexport default Sharpen;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Emboss extending fabric.Image.filters.Convolute\r\n */\r\nimport fabric from 'fabric';\r\n\r\n/**\r\n * Emboss object\r\n * @class Emboss\r\n * @extends {fabric.Image.filters.Convolute}\r\n * @ignore\r\n */\r\nconst Emboss = fabric.util.createClass(\r\n  fabric.Image.filters.Convolute,\r\n  /** @lends Convolute.prototype */ {\r\n    /**\r\n     * Filter type\r\n     * @param {String} type\r\n     * @default\r\n     */\r\n    type: 'Emboss',\r\n\r\n    /**\r\n     * constructor\r\n     * @override\r\n     */\r\n    initialize() {\r\n      this.matrix = [1, 1, 1, 1, 0.7, -1, -1, -1, -1];\r\n    },\r\n  }\r\n);\r\n\r\nexport default Emboss;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview ColorFilter extending fabric.Image.filters.BaseFilter\r\n */\r\nimport fabric from 'fabric';\r\n\r\n/**\r\n * ColorFilter object\r\n * @class ColorFilter\r\n * @extends {fabric.Image.filters.BaseFilter}\r\n * @ignore\r\n */\r\nconst ColorFilter = fabric.util.createClass(\r\n  fabric.Image.filters.BaseFilter,\r\n  /** @lends BaseFilter.prototype */ {\r\n    /**\r\n     * Filter type\r\n     * @param {String} type\r\n     * @default\r\n     */\r\n    type: 'ColorFilter',\r\n\r\n    /**\r\n     * Constructor\r\n     * @member fabric.Image.filters.ColorFilter.prototype\r\n     * @param {Object} [options] Options object\r\n     * @param {Number} [options.color='#FFFFFF'] Value of color (0...255)\r\n     * @param {Number} [options.threshold=45] Value of threshold (0...255)\r\n     * @override\r\n     */\r\n    initialize(options) {\r\n      if (!options) {\r\n        options = {};\r\n      }\r\n      this.color = options.color || '#FFFFFF';\r\n      this.threshold = options.threshold || 45;\r\n      this.x = options.x || null;\r\n      this.y = options.y || null;\r\n    },\r\n\r\n    /**\r\n     * Applies filter to canvas element\r\n     * @param {Object} canvas Canvas object passed by fabric\r\n     */\r\n    // eslint-disable-next-line complexity\r\n    applyTo(canvas) {\r\n      const { canvasEl } = canvas;\r\n      const context = canvasEl.getContext('2d');\r\n      const imageData = context.getImageData(0, 0, canvasEl.width, canvasEl.height);\r\n      const { data } = imageData;\r\n      const { threshold } = this;\r\n      let filterColor = fabric.Color.sourceFromHex(this.color);\r\n      let i, len;\r\n\r\n      if (this.x && this.y) {\r\n        filterColor = this._getColor(imageData, this.x, this.y);\r\n      }\r\n\r\n      for (i = 0, len = data.length; i < len; i += 4) {\r\n        if (\r\n          this._isOutsideThreshold(data[i], filterColor[0], threshold) ||\r\n          this._isOutsideThreshold(data[i + 1], filterColor[1], threshold) ||\r\n          this._isOutsideThreshold(data[i + 2], filterColor[2], threshold)\r\n        ) {\r\n          continue;\r\n        }\r\n        data[i] = data[i + 1] = data[i + 2] = data[i + 3] = 0;\r\n      }\r\n      context.putImageData(imageData, 0, 0);\r\n    },\r\n\r\n    /**\r\n     * Check color if it is within threshold\r\n     * @param {Number} color1 source color\r\n     * @param {Number} color2 filtering color\r\n     * @param {Number} threshold threshold\r\n     * @returns {boolean} true if within threshold or false\r\n     */\r\n    _isOutsideThreshold(color1, color2, threshold) {\r\n      const diff = color1 - color2;\r\n\r\n      return Math.abs(diff) > threshold;\r\n    },\r\n\r\n    /**\r\n     * Get color at (x, y)\r\n     * @param {Object} imageData of canvas\r\n     * @param {Number} x left position\r\n     * @param {Number} y top position\r\n     * @returns {Array} color array\r\n     */\r\n    _getColor(imageData, x, y) {\r\n      const color = [0, 0, 0, 0];\r\n      const { data, width } = imageData;\r\n      const bytes = 4;\r\n      const position = (width * y + x) * bytes;\r\n\r\n      color[0] = data[position];\r\n      color[1] = data[position + 1];\r\n      color[2] = data[position + 2];\r\n      color[3] = data[position + 3];\r\n\r\n      return color;\r\n    },\r\n  }\r\n);\r\n\r\nexport default ColorFilter;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Shape component\r\n */\r\nimport { extend } from 'tui-code-snippet';\r\nimport fabric from 'fabric';\r\nimport Component from '@/interface/component';\r\nimport resizeHelper from '@/helper/shapeResizeHelper';\r\nimport {\r\n  getFillImageFromShape,\r\n  rePositionFilterTypeFillImage,\r\n  reMakePatternImageSource,\r\n  makeFillPatternForFilter,\r\n  makeFilterOptionFromFabricImage,\r\n  resetFillPatternCanvas,\r\n} from '@/helper/shapeFilterFillHelper';\r\nimport {\r\n  Promise,\r\n  changeOrigin,\r\n  getCustomProperty,\r\n  getFillTypeFromOption,\r\n  getFillTypeFromObject,\r\n  isShape,\r\n} from '@/util';\r\nimport {\r\n  rejectMessages,\r\n  eventNames,\r\n  keyCodes as KEY_CODES,\r\n  componentNames,\r\n  fObjectOptions,\r\n  SHAPE_DEFAULT_OPTIONS,\r\n  SHAPE_FILL_TYPE,\r\n} from '@/consts';\r\n\r\nconst SHAPE_INIT_OPTIONS = extend(\r\n  {\r\n    strokeWidth: 1,\r\n    stroke: '#000000',\r\n    fill: '#ffffff',\r\n    width: 1,\r\n    height: 1,\r\n    rx: 0,\r\n    ry: 0,\r\n  },\r\n  SHAPE_DEFAULT_OPTIONS\r\n);\r\nconst DEFAULT_TYPE = 'rect';\r\nconst DEFAULT_WIDTH = 20;\r\nconst DEFAULT_HEIGHT = 20;\r\n\r\n/**\r\n * Make fill option\r\n * @param {Object} options - Options to create the shape\r\n * @param {Object.Image} canvasImage - canvas background image\r\n * @param {Function} createStaticCanvas - static canvas creater\r\n * @returns {Object} - shape option\r\n * @private\r\n */\r\nfunction makeFabricFillOption(options, canvasImage, createStaticCanvas) {\r\n  const fillOption = options.fill;\r\n  const fillType = getFillTypeFromOption(options.fill);\r\n  let fill = fillOption;\r\n\r\n  if (fillOption.color) {\r\n    fill = fillOption.color;\r\n  }\r\n\r\n  let extOption = null;\r\n  if (fillType === 'filter') {\r\n    const newStaticCanvas = createStaticCanvas();\r\n    extOption = makeFillPatternForFilter(canvasImage, fillOption.filter, newStaticCanvas);\r\n  } else {\r\n    extOption = { fill };\r\n  }\r\n\r\n  return extend({}, options, extOption);\r\n}\r\n\r\n/**\r\n * Shape\r\n * @class Shape\r\n * @param {Graphics} graphics - Graphics instance\r\n * @extends {Component}\r\n * @ignore\r\n */\r\nexport default class Shape extends Component {\r\n  constructor(graphics) {\r\n    super(componentNames.SHAPE, graphics);\r\n\r\n    /**\r\n     * Object of The drawing shape\r\n     * @type {fabric.Object}\r\n     * @private\r\n     */\r\n    this._shapeObj = null;\r\n\r\n    /**\r\n     * Type of the drawing shape\r\n     * @type {string}\r\n     * @private\r\n     */\r\n    this._type = DEFAULT_TYPE;\r\n\r\n    /**\r\n     * Options to draw the shape\r\n     * @type {Object}\r\n     * @private\r\n     */\r\n    this._options = extend({}, SHAPE_INIT_OPTIONS);\r\n\r\n    /**\r\n     * Whether the shape object is selected or not\r\n     * @type {boolean}\r\n     * @private\r\n     */\r\n    this._isSelected = false;\r\n\r\n    /**\r\n     * Pointer for drawing shape (x, y)\r\n     * @type {Object}\r\n     * @private\r\n     */\r\n    this._startPoint = {};\r\n\r\n    /**\r\n     * Using shortcut on drawing shape\r\n     * @type {boolean}\r\n     * @private\r\n     */\r\n    this._withShiftKey = false;\r\n\r\n    /**\r\n     * Event handler list\r\n     * @type {Object}\r\n     * @private\r\n     */\r\n    this._handlers = {\r\n      mousedown: this._onFabricMouseDown.bind(this),\r\n      mousemove: this._onFabricMouseMove.bind(this),\r\n      mouseup: this._onFabricMouseUp.bind(this),\r\n      keydown: this._onKeyDown.bind(this),\r\n      keyup: this._onKeyUp.bind(this),\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Start to draw the shape on canvas\r\n   * @ignore\r\n   */\r\n  start() {\r\n    const canvas = this.getCanvas();\r\n\r\n    this._isSelected = false;\r\n\r\n    canvas.defaultCursor = 'crosshair';\r\n    canvas.selection = false;\r\n    canvas.uniformScaling = true;\r\n    canvas.on({\r\n      'mouse:down': this._handlers.mousedown,\r\n    });\r\n\r\n    fabric.util.addListener(document, 'keydown', this._handlers.keydown);\r\n    fabric.util.addListener(document, 'keyup', this._handlers.keyup);\r\n  }\r\n\r\n  /**\r\n   * End to draw the shape on canvas\r\n   * @ignore\r\n   */\r\n  end() {\r\n    const canvas = this.getCanvas();\r\n\r\n    this._isSelected = false;\r\n\r\n    canvas.defaultCursor = 'default';\r\n\r\n    canvas.selection = true;\r\n    canvas.uniformScaling = false;\r\n    canvas.off({\r\n      'mouse:down': this._handlers.mousedown,\r\n    });\r\n\r\n    fabric.util.removeListener(document, 'keydown', this._handlers.keydown);\r\n    fabric.util.removeListener(document, 'keyup', this._handlers.keyup);\r\n  }\r\n\r\n  /**\r\n   * Set states of the current drawing shape\r\n   * @ignore\r\n   * @param {string} type - Shape type (ex: 'rect', 'circle')\r\n   * @param {Object} [options] - Shape options\r\n   *      @param {(ShapeFillOption | string)} [options.fill] - {@link ShapeFillOption} or\r\n   *        Shape foreground color (ex: '#fff', 'transparent')\r\n   *      @param {string} [options.stoke] - Shape outline color\r\n   *      @param {number} [options.strokeWidth] - Shape outline width\r\n   *      @param {number} [options.width] - Width value (When type option is 'rect', this options can use)\r\n   *      @param {number} [options.height] - Height value (When type option is 'rect', this options can use)\r\n   *      @param {number} [options.rx] - Radius x value (When type option is 'circle', this options can use)\r\n   *      @param {number} [options.ry] - Radius y value (When type option is 'circle', this options can use)\r\n   */\r\n  setStates(type, options) {\r\n    this._type = type;\r\n\r\n    if (options) {\r\n      this._options = extend(this._options, options);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Add the shape\r\n   * @ignore\r\n   * @param {string} type - Shape type (ex: 'rect', 'circle')\r\n   * @param {Object} options - Shape options\r\n   *      @param {(ShapeFillOption | string)} [options.fill] - ShapeFillOption or Shape foreground color (ex: '#fff', 'transparent') or ShapeFillOption object\r\n   *      @param {string} [options.stroke] - Shape outline color\r\n   *      @param {number} [options.strokeWidth] - Shape outline width\r\n   *      @param {number} [options.width] - Width value (When type option is 'rect', this options can use)\r\n   *      @param {number} [options.height] - Height value (When type option is 'rect', this options can use)\r\n   *      @param {number} [options.rx] - Radius x value (When type option is 'circle', this options can use)\r\n   *      @param {number} [options.ry] - Radius y value (When type option is 'circle', this options can use)\r\n   *      @param {number} [options.isRegular] - Whether scaling shape has 1:1 ratio or not\r\n   * @returns {Promise}\r\n   */\r\n  add(type, options) {\r\n    return new Promise((resolve) => {\r\n      const canvas = this.getCanvas();\r\n      const extendOption = this._extendOptions(options);\r\n\r\n      const shapeObj = this._createInstance(type, extendOption);\r\n      const objectProperties = this.graphics.createObjectProperties(shapeObj);\r\n\r\n      this._bindEventOnShape(shapeObj);\r\n\r\n      canvas.add(shapeObj).setActiveObject(shapeObj);\r\n\r\n      this._resetPositionFillFilter(shapeObj);\r\n\r\n      resolve(objectProperties);\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Change the shape\r\n   * @ignore\r\n   * @param {fabric.Object} shapeObj - Selected shape object on canvas\r\n   * @param {Object} options - Shape options\r\n   *      @param {(ShapeFillOption | string)} [options.fill] - {@link ShapeFillOption} or\r\n   *        Shape foreground color (ex: '#fff', 'transparent')\r\n   *      @param {string} [options.stroke] - Shape outline color\r\n   *      @param {number} [options.strokeWidth] - Shape outline width\r\n   *      @param {number} [options.width] - Width value (When type option is 'rect', this options can use)\r\n   *      @param {number} [options.height] - Height value (When type option is 'rect', this options can use)\r\n   *      @param {number} [options.rx] - Radius x value (When type option is 'circle', this options can use)\r\n   *      @param {number} [options.ry] - Radius y value (When type option is 'circle', this options can use)\r\n   *      @param {number} [options.isRegular] - Whether scaling shape has 1:1 ratio or not\r\n   * @returns {Promise}\r\n   */\r\n  change(shapeObj, options) {\r\n    return new Promise((resolve, reject) => {\r\n      if (!isShape(shapeObj)) {\r\n        reject(rejectMessages.unsupportedType);\r\n      }\r\n      const hasFillOption = getFillTypeFromOption(options.fill) === 'filter';\r\n      const { canvasImage, createStaticCanvas } = this.graphics;\r\n\r\n      shapeObj.set(\r\n        hasFillOption ? makeFabricFillOption(options, canvasImage, createStaticCanvas) : options\r\n      );\r\n\r\n      if (hasFillOption) {\r\n        this._resetPositionFillFilter(shapeObj);\r\n      }\r\n\r\n      this.getCanvas().renderAll();\r\n      resolve();\r\n    });\r\n  }\r\n\r\n  /**\r\n   * make fill property for user event\r\n   * @param {fabric.Object} shapeObj - fabric object\r\n   * @returns {Object}\r\n   */\r\n  makeFillPropertyForUserEvent(shapeObj) {\r\n    const fillType = getFillTypeFromObject(shapeObj);\r\n    const fillProp = {};\r\n\r\n    if (fillType === SHAPE_FILL_TYPE.FILTER) {\r\n      const fillImage = getFillImageFromShape(shapeObj);\r\n      const filterOption = makeFilterOptionFromFabricImage(fillImage);\r\n\r\n      fillProp.type = fillType;\r\n      fillProp.filter = filterOption;\r\n    } else {\r\n      fillProp.type = SHAPE_FILL_TYPE.COLOR;\r\n      fillProp.color = shapeObj.fill || 'transparent';\r\n    }\r\n\r\n    return fillProp;\r\n  }\r\n\r\n  /**\r\n   * Copy object handling.\r\n   * @param {fabric.Object} shapeObj - Shape object\r\n   * @param {fabric.Object} originalShapeObj - Shape object\r\n   */\r\n  processForCopiedObject(shapeObj, originalShapeObj) {\r\n    this._bindEventOnShape(shapeObj);\r\n\r\n    if (getFillTypeFromObject(shapeObj) === 'filter') {\r\n      const fillImage = getFillImageFromShape(originalShapeObj);\r\n      const filterOption = makeFilterOptionFromFabricImage(fillImage);\r\n      const newStaticCanvas = this.graphics.createStaticCanvas();\r\n\r\n      shapeObj.set(\r\n        makeFillPatternForFilter(this.graphics.canvasImage, filterOption, newStaticCanvas)\r\n      );\r\n      this._resetPositionFillFilter(shapeObj);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Create the instance of shape\r\n   * @param {string} type - Shape type\r\n   * @param {Object} options - Options to creat the shape\r\n   * @returns {fabric.Object} Shape instance\r\n   * @private\r\n   */\r\n  _createInstance(type, options) {\r\n    let instance;\r\n\r\n    switch (type) {\r\n      case 'rect':\r\n        instance = new fabric.Rect(options);\r\n        break;\r\n      case 'circle':\r\n        instance = new fabric.Ellipse(\r\n          extend(\r\n            {\r\n              type: 'circle',\r\n            },\r\n            options\r\n          )\r\n        );\r\n        break;\r\n      case 'triangle':\r\n        instance = new fabric.Triangle(options);\r\n        break;\r\n      default:\r\n        instance = {};\r\n    }\r\n\r\n    return instance;\r\n  }\r\n\r\n  /**\r\n   * Get the options to create the shape\r\n   * @param {Object} options - Options to creat the shape\r\n   * @returns {Object} Shape options\r\n   * @private\r\n   */\r\n  _extendOptions(options) {\r\n    const selectionStyles = fObjectOptions.SELECTION_STYLE;\r\n    const { canvasImage, createStaticCanvas } = this.graphics;\r\n\r\n    options = extend({}, SHAPE_INIT_OPTIONS, this._options, selectionStyles, options);\r\n\r\n    return makeFabricFillOption(options, canvasImage, createStaticCanvas);\r\n  }\r\n\r\n  /**\r\n   * Bind fabric events on the creating shape object\r\n   * @param {fabric.Object} shapeObj - Shape object\r\n   * @private\r\n   */\r\n  _bindEventOnShape(shapeObj) {\r\n    const self = this;\r\n    const canvas = this.getCanvas();\r\n\r\n    shapeObj.on({\r\n      added() {\r\n        self._shapeObj = this;\r\n        resizeHelper.setOrigins(self._shapeObj);\r\n      },\r\n      selected() {\r\n        self._isSelected = true;\r\n        self._shapeObj = this;\r\n        canvas.uniformScaling = true;\r\n        canvas.defaultCursor = 'default';\r\n        resizeHelper.setOrigins(self._shapeObj);\r\n      },\r\n      deselected() {\r\n        self._isSelected = false;\r\n        self._shapeObj = null;\r\n        canvas.defaultCursor = 'crosshair';\r\n        canvas.uniformScaling = false;\r\n      },\r\n      modified() {\r\n        const currentObj = self._shapeObj;\r\n\r\n        resizeHelper.adjustOriginToCenter(currentObj);\r\n        resizeHelper.setOrigins(currentObj);\r\n      },\r\n      modifiedInGroup(activeSelection) {\r\n        self._fillFilterRePositionInGroupSelection(shapeObj, activeSelection);\r\n      },\r\n      moving() {\r\n        self._resetPositionFillFilter(this);\r\n      },\r\n      rotating() {\r\n        self._resetPositionFillFilter(this);\r\n      },\r\n      scaling(fEvent) {\r\n        const pointer = canvas.getPointer(fEvent.e);\r\n        const currentObj = self._shapeObj;\r\n\r\n        canvas.setCursor('crosshair');\r\n        resizeHelper.resize(currentObj, pointer, true);\r\n\r\n        self._resetPositionFillFilter(this);\r\n      },\r\n    });\r\n  }\r\n\r\n  /**\r\n   * MouseDown event handler on canvas\r\n   * @param {{target: fabric.Object, e: MouseEvent}} fEvent - Fabric event object\r\n   * @private\r\n   */\r\n  _onFabricMouseDown(fEvent) {\r\n    if (!fEvent.target) {\r\n      this._isSelected = false;\r\n      this._shapeObj = false;\r\n    }\r\n\r\n    if (!this._isSelected && !this._shapeObj) {\r\n      const canvas = this.getCanvas();\r\n      this._startPoint = canvas.getPointer(fEvent.e);\r\n\r\n      canvas.on({\r\n        'mouse:move': this._handlers.mousemove,\r\n        'mouse:up': this._handlers.mouseup,\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * MouseDown event handler on canvas\r\n   * @param {{target: fabric.Object, e: MouseEvent}} fEvent - Fabric event object\r\n   * @private\r\n   */\r\n  _onFabricMouseMove(fEvent) {\r\n    const canvas = this.getCanvas();\r\n    const pointer = canvas.getPointer(fEvent.e);\r\n    const startPointX = this._startPoint.x;\r\n    const startPointY = this._startPoint.y;\r\n    const width = startPointX - pointer.x;\r\n    const height = startPointY - pointer.y;\r\n    const shape = this._shapeObj;\r\n\r\n    if (!shape) {\r\n      this.add(this._type, {\r\n        left: startPointX,\r\n        top: startPointY,\r\n        width,\r\n        height,\r\n      }).then((objectProps) => {\r\n        this.fire(eventNames.ADD_OBJECT, objectProps);\r\n      });\r\n    } else {\r\n      this._shapeObj.set({\r\n        isRegular: this._withShiftKey,\r\n      });\r\n\r\n      resizeHelper.resize(shape, pointer);\r\n      canvas.renderAll();\r\n\r\n      this._resetPositionFillFilter(shape);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * MouseUp event handler on canvas\r\n   * @private\r\n   */\r\n  _onFabricMouseUp() {\r\n    const canvas = this.getCanvas();\r\n    const startPointX = this._startPoint.x;\r\n    const startPointY = this._startPoint.y;\r\n    const shape = this._shapeObj;\r\n\r\n    if (!shape) {\r\n      this.add(this._type, {\r\n        left: startPointX,\r\n        top: startPointY,\r\n        width: DEFAULT_WIDTH,\r\n        height: DEFAULT_HEIGHT,\r\n      }).then((objectProps) => {\r\n        this.fire(eventNames.ADD_OBJECT, objectProps);\r\n      });\r\n    } else if (shape) {\r\n      resizeHelper.adjustOriginToCenter(shape);\r\n      this.fire(eventNames.OBJECT_ADDED, this.graphics.createObjectProperties(shape));\r\n    }\r\n\r\n    canvas.off({\r\n      'mouse:move': this._handlers.mousemove,\r\n      'mouse:up': this._handlers.mouseup,\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Keydown event handler on document\r\n   * @param {KeyboardEvent} e - Event object\r\n   * @private\r\n   */\r\n  _onKeyDown(e) {\r\n    if (e.keyCode === KEY_CODES.SHIFT) {\r\n      this._withShiftKey = true;\r\n\r\n      if (this._shapeObj) {\r\n        this._shapeObj.isRegular = true;\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Keyup event handler on document\r\n   * @param {KeyboardEvent} e - Event object\r\n   * @private\r\n   */\r\n  _onKeyUp(e) {\r\n    if (e.keyCode === KEY_CODES.SHIFT) {\r\n      this._withShiftKey = false;\r\n\r\n      if (this._shapeObj) {\r\n        this._shapeObj.isRegular = false;\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Reset shape position and internal proportions in the filter type fill area.\r\n   * @param {fabric.Object} shapeObj - Shape object\r\n   * @private\r\n   */\r\n  _resetPositionFillFilter(shapeObj) {\r\n    if (getFillTypeFromObject(shapeObj) !== 'filter') {\r\n      return;\r\n    }\r\n\r\n    const { patternSourceCanvas } = getCustomProperty(shapeObj, 'patternSourceCanvas');\r\n\r\n    const fillImage = getFillImageFromShape(shapeObj);\r\n    const { originalAngle } = getCustomProperty(fillImage, 'originalAngle');\r\n\r\n    if (this.graphics.canvasImage.angle !== originalAngle) {\r\n      reMakePatternImageSource(shapeObj, this.graphics.canvasImage);\r\n    }\r\n    const { originX, originY } = shapeObj;\r\n\r\n    resizeHelper.adjustOriginToCenter(shapeObj);\r\n\r\n    shapeObj.width *= shapeObj.scaleX;\r\n    shapeObj.height *= shapeObj.scaleY;\r\n    shapeObj.rx *= shapeObj.scaleX;\r\n    shapeObj.ry *= shapeObj.scaleY;\r\n    shapeObj.scaleX = 1;\r\n    shapeObj.scaleY = 1;\r\n\r\n    rePositionFilterTypeFillImage(shapeObj);\r\n\r\n    changeOrigin(shapeObj, {\r\n      originX,\r\n      originY,\r\n    });\r\n\r\n    resetFillPatternCanvas(patternSourceCanvas);\r\n  }\r\n\r\n  /**\r\n   * Reset filter area position within group selection.\r\n   * @param {fabric.Object} shapeObj - Shape object\r\n   * @param {fabric.ActiveSelection} activeSelection - Shape object\r\n   * @private\r\n   */\r\n  _fillFilterRePositionInGroupSelection(shapeObj, activeSelection) {\r\n    if (activeSelection.scaleX !== 1 || activeSelection.scaleY !== 1) {\r\n      // This is necessary because the group's scale transition state affects the relative size of the fill area.\r\n      // The only way to reset the object transformation scale state to neutral.\r\n      // {@link https://github.com/fabricjs/fabric.js/issues/5372}\r\n      activeSelection.addWithUpdate();\r\n    }\r\n\r\n    const { angle, left, top } = shapeObj;\r\n\r\n    fabric.util.addTransformToObject(shapeObj, activeSelection.calcTransformMatrix());\r\n    this._resetPositionFillFilter(shapeObj);\r\n\r\n    shapeObj.set({\r\n      angle,\r\n      left,\r\n      top,\r\n    });\r\n  }\r\n}\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Shape resize helper\r\n */\r\nimport { forEach, map, extend } from 'tui-code-snippet';\r\nimport resizeHelper from '@/helper/shapeResizeHelper';\r\nimport { capitalizeString, flipObject, setCustomProperty, getCustomProperty } from '@/util';\r\n\r\nconst FILTER_OPTION_MAP = {\r\n  pixelate: 'blocksize',\r\n  blur: 'blur',\r\n};\r\nconst POSITION_DIMENSION_MAP = {\r\n  x: 'width',\r\n  y: 'height',\r\n};\r\n\r\nconst FILTER_NAME_VALUE_MAP = flipObject(FILTER_OPTION_MAP);\r\n\r\n/**\r\n * Cached canvas image element for fill image\r\n * @type {boolean}\r\n * @private\r\n */\r\nlet cachedCanvasImageElement = null;\r\n\r\n/**\r\n * Get background image of fill\r\n * @param {fabric.Object} shapeObj - Shape object\r\n * @returns {fabric.Image}\r\n * @private\r\n */\r\nexport function getFillImageFromShape(shapeObj) {\r\n  const { patternSourceCanvas } = getCustomProperty(shapeObj, 'patternSourceCanvas');\r\n  const [fillImage] = patternSourceCanvas.getObjects();\r\n\r\n  return fillImage;\r\n}\r\n\r\n/**\r\n * Reset the image position in the filter type fill area.\r\n * @param {fabric.Object} shapeObj - Shape object\r\n * @private\r\n */\r\nexport function rePositionFilterTypeFillImage(shapeObj) {\r\n  const { angle, flipX, flipY } = shapeObj;\r\n  const fillImage = getFillImageFromShape(shapeObj);\r\n  const rotatedShapeCornerDimension = getRotatedDimension(shapeObj);\r\n  const { right, bottom } = rotatedShapeCornerDimension;\r\n  let { width, height } = rotatedShapeCornerDimension;\r\n  const diffLeft = (width - shapeObj.width) / 2;\r\n  const diffTop = (height - shapeObj.height) / 2;\r\n  const cropX = shapeObj.left - shapeObj.width / 2 - diffLeft;\r\n  const cropY = shapeObj.top - shapeObj.height / 2 - diffTop;\r\n  let left = width / 2 - diffLeft;\r\n  let top = height / 2 - diffTop;\r\n  const fillImageMaxSize = Math.max(width, height) + Math.max(diffLeft, diffTop);\r\n\r\n  [left, top, width, height] = calculateFillImageDimensionOutsideCanvas({\r\n    shapeObj,\r\n    left,\r\n    top,\r\n    width,\r\n    height,\r\n    cropX,\r\n    cropY,\r\n    flipX,\r\n    flipY,\r\n    right,\r\n    bottom,\r\n  });\r\n\r\n  fillImage.set({\r\n    angle: flipX === flipY ? -angle : angle,\r\n    left,\r\n    top,\r\n    width,\r\n    height,\r\n    cropX,\r\n    cropY,\r\n    flipX,\r\n    flipY,\r\n  });\r\n\r\n  setCustomProperty(fillImage, { fillImageMaxSize });\r\n}\r\n\r\n/**\r\n * Make filter option from fabric image\r\n * @param {fabric.Image} imageObject - fabric image object\r\n * @returns {object}\r\n */\r\nexport function makeFilterOptionFromFabricImage(imageObject) {\r\n  return map(imageObject.filters, (filter) => {\r\n    const [key] = Object.keys(filter);\r\n\r\n    return {\r\n      [FILTER_NAME_VALUE_MAP[key]]: filter[key],\r\n    };\r\n  });\r\n}\r\n\r\n/**\r\n * Calculate fill image position and size for out of Canvas\r\n * @param {Object} options - options for position dimension calculate\r\n *   @param {fabric.Object} shapeObj - shape object\r\n *   @param {number} left - original left position\r\n *   @param {number} top - original top position\r\n *   @param {number} width - image width\r\n *   @param {number} height - image height\r\n *   @param {number} cropX - image cropX\r\n *   @param {number} cropY - image cropY\r\n *   @param {boolean} flipX - shape flipX\r\n *   @param {boolean} flipY - shape flipY\r\n * @returns {Object}\r\n */\r\nfunction calculateFillImageDimensionOutsideCanvas({\r\n  shapeObj,\r\n  left,\r\n  top,\r\n  width,\r\n  height,\r\n  cropX,\r\n  cropY,\r\n  flipX,\r\n  flipY,\r\n  right,\r\n  bottom,\r\n}) {\r\n  const overflowAreaPositionFixer = (type, outDistance, imageLeft, imageTop) =>\r\n    calculateDistanceOverflowPart({\r\n      type,\r\n      outDistance,\r\n      shapeObj,\r\n      flipX,\r\n      flipY,\r\n      left: imageLeft,\r\n      top: imageTop,\r\n    });\r\n  const [originalWidth, originalHeight] = [width, height];\r\n\r\n  [left, top, width, height] = calculateDimensionLeftTopEdge(overflowAreaPositionFixer, {\r\n    left,\r\n    top,\r\n    width,\r\n    height,\r\n    cropX,\r\n    cropY,\r\n  });\r\n\r\n  [left, top, width, height] = calculateDimensionRightBottomEdge(overflowAreaPositionFixer, {\r\n    left,\r\n    top,\r\n    insideCanvasRealImageWidth: width,\r\n    insideCanvasRealImageHeight: height,\r\n    right,\r\n    bottom,\r\n    cropX,\r\n    cropY,\r\n    originalWidth,\r\n    originalHeight,\r\n  });\r\n\r\n  return [left, top, width, height];\r\n}\r\n\r\n/**\r\n * Calculate fill image position and size for for right bottom edge\r\n * @param {Function} overflowAreaPositionFixer - position fixer\r\n * @param {Object} options - options for position dimension calculate\r\n *   @param {fabric.Object} shapeObj - shape object\r\n *   @param {number} left - original left position\r\n *   @param {number} top - original top position\r\n *   @param {number} width - image width\r\n *   @param {number} height - image height\r\n *   @param {number} right - image right\r\n *   @param {number} bottom - image bottom\r\n *   @param {number} cropX - image cropX\r\n *   @param {number} cropY - image cropY\r\n *   @param {boolean} originalWidth - image original width\r\n *   @param {boolean} originalHeight - image original height\r\n * @returns {Object}\r\n */\r\nfunction calculateDimensionRightBottomEdge(\r\n  overflowAreaPositionFixer,\r\n  {\r\n    left,\r\n    top,\r\n    insideCanvasRealImageWidth,\r\n    insideCanvasRealImageHeight,\r\n    right,\r\n    bottom,\r\n    cropX,\r\n    cropY,\r\n    originalWidth,\r\n    originalHeight,\r\n  }\r\n) {\r\n  let [width, height] = [insideCanvasRealImageWidth, insideCanvasRealImageHeight];\r\n  const { width: canvasWidth, height: canvasHeight } = cachedCanvasImageElement;\r\n\r\n  if (right > canvasWidth && cropX > 0) {\r\n    width = originalWidth - Math.abs(right - canvasWidth);\r\n  }\r\n  if (bottom > canvasHeight && cropY > 0) {\r\n    height = originalHeight - Math.abs(bottom - canvasHeight);\r\n  }\r\n\r\n  const diff = {\r\n    x: (insideCanvasRealImageWidth - width) / 2,\r\n    y: (insideCanvasRealImageHeight - height) / 2,\r\n  };\r\n\r\n  forEach(['x', 'y'], (type) => {\r\n    const cropDistance2 = diff[type];\r\n    if (cropDistance2 > 0) {\r\n      [left, top] = overflowAreaPositionFixer(type, cropDistance2, left, top);\r\n    }\r\n  });\r\n\r\n  return [left, top, width, height];\r\n}\r\n\r\n/**\r\n * Calculate fill image position and size for for left top\r\n * @param {Function} overflowAreaPositionFixer - position fixer\r\n * @param {Object} options - options for position dimension calculate\r\n *   @param {fabric.Object} shapeObj - shape object\r\n *   @param {number} left - original left position\r\n *   @param {number} top - original top position\r\n *   @param {number} width - image width\r\n *   @param {number} height - image height\r\n *   @param {number} cropX - image cropX\r\n *   @param {number} cropY - image cropY\r\n * @returns {Object}\r\n */\r\nfunction calculateDimensionLeftTopEdge(\r\n  overflowAreaPositionFixer,\r\n  { left, top, width, height, cropX, cropY }\r\n) {\r\n  const dimension = {\r\n    width,\r\n    height,\r\n  };\r\n\r\n  forEach(['x', 'y'], (type) => {\r\n    const cropDistance = type === 'x' ? cropX : cropY;\r\n    const compareSize = dimension[POSITION_DIMENSION_MAP[type]];\r\n    const standardSize = cachedCanvasImageElement[POSITION_DIMENSION_MAP[type]];\r\n\r\n    if (compareSize > standardSize) {\r\n      const outDistance = (compareSize - standardSize) / 2;\r\n\r\n      dimension[POSITION_DIMENSION_MAP[type]] = standardSize;\r\n      [left, top] = overflowAreaPositionFixer(type, outDistance, left, top);\r\n    }\r\n    if (cropDistance < 0) {\r\n      [left, top] = overflowAreaPositionFixer(type, cropDistance, left, top);\r\n    }\r\n  });\r\n\r\n  return [left, top, dimension.width, dimension.height];\r\n}\r\n\r\n/**\r\n * Make fill property of dynamic pattern type\r\n * @param {fabric.Image} canvasImage - canvas background image\r\n * @param {Array} filterOption - filter option\r\n * @param {fabric.StaticCanvas} patternSourceCanvas - fabric static canvas\r\n * @returns {Object}\r\n */\r\nexport function makeFillPatternForFilter(canvasImage, filterOption, patternSourceCanvas) {\r\n  const copiedCanvasElement = getCachedCanvasImageElement(canvasImage);\r\n  const fillImage = makeFillImage(copiedCanvasElement, canvasImage.angle, filterOption);\r\n  patternSourceCanvas.add(fillImage);\r\n\r\n  const fabricProperty = {\r\n    fill: new fabric.Pattern({\r\n      source: patternSourceCanvas.getElement(),\r\n      repeat: 'no-repeat',\r\n    }),\r\n  };\r\n\r\n  setCustomProperty(fabricProperty, { patternSourceCanvas });\r\n\r\n  return fabricProperty;\r\n}\r\n\r\n/**\r\n * Reset fill pattern canvas\r\n * @param {fabric.StaticCanvas} patternSourceCanvas - fabric static canvas\r\n */\r\nexport function resetFillPatternCanvas(patternSourceCanvas) {\r\n  const [innerImage] = patternSourceCanvas.getObjects();\r\n  let { fillImageMaxSize } = getCustomProperty(innerImage, 'fillImageMaxSize');\r\n  fillImageMaxSize = Math.max(1, fillImageMaxSize);\r\n\r\n  patternSourceCanvas.setDimensions({\r\n    width: fillImageMaxSize,\r\n    height: fillImageMaxSize,\r\n  });\r\n  patternSourceCanvas.renderAll();\r\n}\r\n\r\n/**\r\n * Remake filter pattern image source\r\n * @param {fabric.Object} shapeObj - Shape object\r\n * @param {fabric.Image} canvasImage - canvas background image\r\n */\r\nexport function reMakePatternImageSource(shapeObj, canvasImage) {\r\n  const { patternSourceCanvas } = getCustomProperty(shapeObj, 'patternSourceCanvas');\r\n  const [fillImage] = patternSourceCanvas.getObjects();\r\n  const filterOption = makeFilterOptionFromFabricImage(fillImage);\r\n\r\n  patternSourceCanvas.remove(fillImage);\r\n\r\n  const copiedCanvasElement = getCachedCanvasImageElement(canvasImage, true);\r\n  const newFillImage = makeFillImage(copiedCanvasElement, canvasImage.angle, filterOption);\r\n\r\n  patternSourceCanvas.add(newFillImage);\r\n}\r\n\r\n/**\r\n * Calculate a point line outside the canvas.\r\n * @param {fabric.Image} canvasImage - canvas background image\r\n * @param {boolean} reset - default is false\r\n * @returns {HTMLImageElement}\r\n */\r\nexport function getCachedCanvasImageElement(canvasImage, reset = false) {\r\n  if (!cachedCanvasImageElement || reset) {\r\n    cachedCanvasImageElement = canvasImage.toCanvasElement();\r\n  }\r\n\r\n  return cachedCanvasImageElement;\r\n}\r\n\r\n/**\r\n * Calculate fill image position for out of Canvas\r\n * @param {string} type - 'x' or 'y'\r\n * @param {fabric.Object} shapeObj - shape object\r\n * @param {number} outDistance - distance away\r\n * @param {number} left - original left position\r\n * @param {number} top - original top position\r\n * @returns {Array}\r\n */\r\nfunction calculateDistanceOverflowPart({ type, shapeObj, outDistance, left, top, flipX, flipY }) {\r\n  const shapePointNavigation = getShapeEdgePoint(shapeObj);\r\n  const shapeNeighborPointNavigation = [\r\n    [1, 2],\r\n    [0, 3],\r\n    [0, 3],\r\n    [1, 2],\r\n  ];\r\n  const linePointsOutsideCanvas = calculateLinePointsOutsideCanvas(\r\n    type,\r\n    shapePointNavigation,\r\n    shapeNeighborPointNavigation\r\n  );\r\n  const reatAngles = calculateLineAngleOfOutsideCanvas(\r\n    type,\r\n    shapePointNavigation,\r\n    linePointsOutsideCanvas\r\n  );\r\n  const { startPointIndex } = linePointsOutsideCanvas;\r\n  const diffPosition = getReversePositionForFlip({\r\n    outDistance,\r\n    startPointIndex,\r\n    flipX,\r\n    flipY,\r\n    reatAngles,\r\n  });\r\n\r\n  return [left + diffPosition.left, top + diffPosition.top];\r\n}\r\n\r\n/**\r\n * Calculate fill image position for out of Canvas\r\n * @param {number} outDistance - distance away\r\n * @param {boolean} flipX - flip x statux\r\n * @param {boolean} flipY - flip y statux\r\n * @param {Array} reatAngles - Line angle of the rectangle vertex.\r\n * @returns {Object} diffPosition\r\n */\r\nfunction getReversePositionForFlip({ outDistance, startPointIndex, flipX, flipY, reatAngles }) {\r\n  const rotationChangePoint1 = outDistance * Math.cos((reatAngles[0] * Math.PI) / 180);\r\n  const rotationChangePoint2 = outDistance * Math.cos((reatAngles[1] * Math.PI) / 180);\r\n  const isForward = startPointIndex === 2 || startPointIndex === 3;\r\n  const diffPosition = {\r\n    top: isForward ? rotationChangePoint1 : rotationChangePoint2,\r\n    left: isForward ? rotationChangePoint2 : rotationChangePoint1,\r\n  };\r\n\r\n  if (isReverseLeftPositionForFlip(startPointIndex, flipX, flipY)) {\r\n    diffPosition.left = diffPosition.left * -1;\r\n  }\r\n  if (isReverseTopPositionForFlip(startPointIndex, flipX, flipY)) {\r\n    diffPosition.top = diffPosition.top * -1;\r\n  }\r\n\r\n  return diffPosition;\r\n}\r\n\r\n/**\r\n * Calculate a point line outside the canvas.\r\n * @param {string} type - 'x' or 'y'\r\n * @param {Array} shapePointNavigation - shape edge positions\r\n *   @param {Object} shapePointNavigation.lefttop - left top position\r\n *   @param {Object} shapePointNavigation.righttop - right top position\r\n *   @param {Object} shapePointNavigation.leftbottom - lefttop position\r\n *   @param {Object} shapePointNavigation.rightbottom - rightbottom position\r\n * @param {Array} shapeNeighborPointNavigation - Array to find adjacent edges.\r\n * @returns {Object}\r\n */\r\nfunction calculateLinePointsOutsideCanvas(\r\n  type,\r\n  shapePointNavigation,\r\n  shapeNeighborPointNavigation\r\n) {\r\n  let minimumPoint = 0;\r\n  let minimumPointIndex = 0;\r\n  forEach(shapePointNavigation, (point, index) => {\r\n    if (point[type] < minimumPoint) {\r\n      minimumPoint = point[type];\r\n      minimumPointIndex = index;\r\n    }\r\n  });\r\n\r\n  const [endPointIndex1, endPointIndex2] = shapeNeighborPointNavigation[minimumPointIndex];\r\n\r\n  return {\r\n    startPointIndex: minimumPointIndex,\r\n    endPointIndex1,\r\n    endPointIndex2,\r\n  };\r\n}\r\n\r\n/**\r\n * Calculate a point line outside the canvas.\r\n * @param {string} type - 'x' or 'y'\r\n * @param {Array} shapePointNavigation - shape edge positions\r\n *   @param {object} shapePointNavigation.lefttop - left top position\r\n *   @param {object} shapePointNavigation.righttop - right top position\r\n *   @param {object} shapePointNavigation.leftbottom - lefttop position\r\n *   @param {object} shapePointNavigation.rightbottom - rightbottom position\r\n * @param {Object} linePointsOfOneVertexIndex - Line point of one vertex\r\n *   @param {Object} linePointsOfOneVertexIndex.startPoint - start point index\r\n *   @param {Object} linePointsOfOneVertexIndex.endPointIndex1 - end point index\r\n *   @param {Object} linePointsOfOneVertexIndex.endPointIndex2 - end point index\r\n * @returns {Object}\r\n */\r\nfunction calculateLineAngleOfOutsideCanvas(type, shapePointNavigation, linePointsOfOneVertexIndex) {\r\n  const { startPointIndex, endPointIndex1, endPointIndex2 } = linePointsOfOneVertexIndex;\r\n  const horizontalVerticalAngle = type === 'x' ? 180 : 270;\r\n\r\n  return map([endPointIndex1, endPointIndex2], (pointIndex) => {\r\n    const startPoint = shapePointNavigation[startPointIndex];\r\n    const endPoint = shapePointNavigation[pointIndex];\r\n    const diffY = startPoint.y - endPoint.y;\r\n    const diffX = startPoint.x - endPoint.x;\r\n\r\n    return (Math.atan2(diffY, diffX) * 180) / Math.PI - horizontalVerticalAngle;\r\n  });\r\n}\r\n\r\n/* eslint-disable complexity */\r\n/**\r\n * Calculate a point line outside the canvas for horizontal.\r\n * @param {number} startPointIndex - start point index\r\n * @param {boolean} flipX - flip x statux\r\n * @param {boolean} flipY - flip y statux\r\n * @returns {boolean} flipY - flip y statux\r\n */\r\nfunction isReverseLeftPositionForFlip(startPointIndex, flipX, flipY) {\r\n  return (\r\n    (((!flipX && flipY) || (!flipX && !flipY)) && startPointIndex === 0) ||\r\n    (((flipX && flipY) || (flipX && !flipY)) && startPointIndex === 1) ||\r\n    (((!flipX && !flipY) || (!flipX && flipY)) && startPointIndex === 2) ||\r\n    (((flipX && !flipY) || (flipX && flipY)) && startPointIndex === 3)\r\n  );\r\n}\r\n/* eslint-enable complexity */\r\n\r\n/* eslint-disable complexity */\r\n/**\r\n * Calculate a point line outside the canvas for vertical.\r\n * @param {number} startPointIndex - start point index\r\n * @param {boolean} flipX - flip x statux\r\n * @param {boolean} flipY - flip y statux\r\n * @returns {boolean} flipY - flip y statux\r\n */\r\nfunction isReverseTopPositionForFlip(startPointIndex, flipX, flipY) {\r\n  return (\r\n    (((flipX && !flipY) || (!flipX && !flipY)) && startPointIndex === 0) ||\r\n    (((!flipX && !flipY) || (flipX && !flipY)) && startPointIndex === 1) ||\r\n    (((flipX && flipY) || (!flipX && flipY)) && startPointIndex === 2) ||\r\n    (((!flipX && flipY) || (flipX && flipY)) && startPointIndex === 3)\r\n  );\r\n}\r\n/* eslint-enable complexity */\r\n\r\n/**\r\n * Shape edge points\r\n * @param {fabric.Object} shapeObj - Selected shape object on canvas\r\n * @returns {Array} shapeEdgePoint - shape edge positions\r\n */\r\nfunction getShapeEdgePoint(shapeObj) {\r\n  return [\r\n    shapeObj.getPointByOrigin('left', 'top'),\r\n    shapeObj.getPointByOrigin('right', 'top'),\r\n    shapeObj.getPointByOrigin('left', 'bottom'),\r\n    shapeObj.getPointByOrigin('right', 'bottom'),\r\n  ];\r\n}\r\n\r\n/**\r\n * Rotated shape dimension\r\n * @param {fabric.Object} shapeObj - Shape object\r\n * @returns {Object} Rotated shape dimension\r\n */\r\nfunction getRotatedDimension(shapeObj) {\r\n  const [{ x: ax, y: ay }, { x: bx, y: by }, { x: cx, y: cy }, { x: dx, y: dy }] =\r\n    getShapeEdgePoint(shapeObj);\r\n\r\n  const left = Math.min(ax, bx, cx, dx);\r\n  const top = Math.min(ay, by, cy, dy);\r\n  const right = Math.max(ax, bx, cx, dx);\r\n  const bottom = Math.max(ay, by, cy, dy);\r\n\r\n  return {\r\n    left,\r\n    top,\r\n    right,\r\n    bottom,\r\n    width: right - left,\r\n    height: bottom - top,\r\n  };\r\n}\r\n\r\n/**\r\n * Make fill image\r\n * @param {HTMLImageElement} copiedCanvasElement - html image element\r\n * @param {number} currentCanvasImageAngle - current canvas angle\r\n * @param {Array} filterOption - filter option\r\n * @returns {fabric.Image}\r\n * @private\r\n */\r\nfunction makeFillImage(copiedCanvasElement, currentCanvasImageAngle, filterOption) {\r\n  const fillImage = new fabric.Image(copiedCanvasElement);\r\n\r\n  forEach(extend({}, ...filterOption), (value, key) => {\r\n    const fabricFilterClassName = capitalizeString(key);\r\n    const filter = new fabric.Image.filters[fabricFilterClassName]({\r\n      [FILTER_OPTION_MAP[key]]: value,\r\n    });\r\n    fillImage.filters.push(filter);\r\n  });\r\n  fillImage.applyFilters();\r\n\r\n  setCustomProperty(fillImage, {\r\n    originalAngle: currentCanvasImageAngle,\r\n    fillImageMaxSize: Math.max(fillImage.width, fillImage.height),\r\n  });\r\n  resizeHelper.adjustOriginToCenter(fillImage);\r\n\r\n  return fillImage;\r\n}\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Image zoom module (start zoom, end zoom)\r\n */\r\nimport fabric from 'fabric';\r\nimport Component from '@/interface/component';\r\nimport { clamp } from '@/util';\r\nimport { componentNames, eventNames, keyCodes, zoomModes } from '@/consts';\r\n\r\nconst MOUSE_MOVE_THRESHOLD = 10;\r\nconst DEFAULT_SCROLL_OPTION = {\r\n  left: 0,\r\n  top: 0,\r\n  width: 0,\r\n  height: 0,\r\n  stroke: '#000000',\r\n  strokeWidth: 0,\r\n  fill: '#000000',\r\n  opacity: 0.4,\r\n  evented: false,\r\n  selectable: false,\r\n  hoverCursor: 'auto',\r\n};\r\nconst DEFAULT_VERTICAL_SCROLL_RATIO = {\r\n  SIZE: 0.0045,\r\n  MARGIN: 0.003,\r\n  BORDER_RADIUS: 0.003,\r\n};\r\nconst DEFAULT_HORIZONTAL_SCROLL_RATIO = {\r\n  SIZE: 0.0066,\r\n  MARGIN: 0.0044,\r\n  BORDER_RADIUS: 0.003,\r\n};\r\nconst DEFAULT_ZOOM_LEVEL = 1.0;\r\nconst {\r\n  ZOOM_CHANGED,\r\n  ADD_TEXT,\r\n  TEXT_EDITING,\r\n  OBJECT_MODIFIED,\r\n  KEY_DOWN,\r\n  KEY_UP,\r\n  HAND_STARTED,\r\n  HAND_STOPPED,\r\n} = eventNames;\r\n\r\n/**\r\n * Zoom components\r\n * @param {Graphics} graphics - Graphics instance\r\n * @extends {Component}\r\n * @class Zoom\r\n * @ignore\r\n */\r\nclass Zoom extends Component {\r\n  constructor(graphics) {\r\n    super(componentNames.ZOOM, graphics);\r\n\r\n    /**\r\n     * zoomArea\r\n     * @type {?fabric.Rect}\r\n     * @private\r\n     */\r\n    this.zoomArea = null;\r\n\r\n    /**\r\n     * Start point of zoom area\r\n     * @type {?{x: number, y: number}}\r\n     */\r\n    this._startPoint = null;\r\n\r\n    /**\r\n     * Center point of every zoom\r\n     * @type {Array.<{prevZoomLevel: number, zoomLevel: number, x: number, y: number}>}\r\n     */\r\n    this._centerPoints = [];\r\n\r\n    /**\r\n     * Zoom level (default: 100%(1.0), max: 400%(4.0))\r\n     * @type {number}\r\n     */\r\n    this.zoomLevel = DEFAULT_ZOOM_LEVEL;\r\n\r\n    /**\r\n     * Zoom mode ('normal', 'zoom', 'hand')\r\n     * @type {string}\r\n     */\r\n    this.zoomMode = zoomModes.DEFAULT;\r\n\r\n    /**\r\n     * Listeners\r\n     * @type {Object.<string, Function>}\r\n     * @private\r\n     */\r\n    this._listeners = {\r\n      startZoom: this._onMouseDownWithZoomMode.bind(this),\r\n      moveZoom: this._onMouseMoveWithZoomMode.bind(this),\r\n      stopZoom: this._onMouseUpWithZoomMode.bind(this),\r\n      startHand: this._onMouseDownWithHandMode.bind(this),\r\n      moveHand: this._onMouseMoveWithHandMode.bind(this),\r\n      stopHand: this._onMouseUpWithHandMode.bind(this),\r\n      zoomChanged: this._changeScrollState.bind(this),\r\n      keydown: this._startHandModeWithSpaceBar.bind(this),\r\n      keyup: this._endHandModeWithSpaceBar.bind(this),\r\n    };\r\n\r\n    const canvas = this.getCanvas();\r\n\r\n    /**\r\n     * Width:Height ratio (ex. width=1.5, height=1 -> aspectRatio=1.5)\r\n     * @private\r\n     */\r\n    this.aspectRatio = canvas.width / canvas.height;\r\n\r\n    /**\r\n     * vertical scroll bar\r\n     * @type {fabric.Rect}\r\n     * @private\r\n     */\r\n    this._verticalScroll = new fabric.Rect(DEFAULT_SCROLL_OPTION);\r\n\r\n    /**\r\n     * horizontal scroll bar\r\n     * @type {fabric.Rect}\r\n     * @private\r\n     */\r\n    this._horizontalScroll = new fabric.Rect(DEFAULT_SCROLL_OPTION);\r\n\r\n    canvas.on(ZOOM_CHANGED, this._listeners.zoomChanged);\r\n\r\n    this.graphics.on(ADD_TEXT, this._startTextEditingHandler.bind(this));\r\n    this.graphics.on(TEXT_EDITING, this._startTextEditingHandler.bind(this));\r\n    this.graphics.on(OBJECT_MODIFIED, this._stopTextEditingHandler.bind(this));\r\n  }\r\n\r\n  /**\r\n   * Attach zoom keyboard events\r\n   */\r\n  attachKeyboardZoomEvents() {\r\n    fabric.util.addListener(document, KEY_DOWN, this._listeners.keydown);\r\n    fabric.util.addListener(document, KEY_UP, this._listeners.keyup);\r\n  }\r\n\r\n  /**\r\n   * Detach zoom keyboard events\r\n   */\r\n  detachKeyboardZoomEvents() {\r\n    fabric.util.removeListener(document, KEY_DOWN, this._listeners.keydown);\r\n    fabric.util.removeListener(document, KEY_UP, this._listeners.keyup);\r\n  }\r\n\r\n  /**\r\n   * Handler when you started editing text\r\n   * @private\r\n   */\r\n  _startTextEditingHandler() {\r\n    this.isTextEditing = true;\r\n  }\r\n\r\n  /**\r\n   * Handler when you stopped editing text\r\n   * @private\r\n   */\r\n  _stopTextEditingHandler() {\r\n    this.isTextEditing = false;\r\n  }\r\n\r\n  /**\r\n   * Handler who turns on hand mode when the space bar is down\r\n   * @param {KeyboardEvent} e - Event object\r\n   * @private\r\n   */\r\n  _startHandModeWithSpaceBar(e) {\r\n    if (this.withSpace || this.isTextEditing) {\r\n      return;\r\n    }\r\n\r\n    if (e.keyCode === keyCodes.SPACE) {\r\n      this.withSpace = true;\r\n      this.startHandMode();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Handler who turns off hand mode when space bar is up\r\n   * @param {KeyboardEvent} e - Event object\r\n   * @private\r\n   */\r\n  _endHandModeWithSpaceBar(e) {\r\n    if (e.keyCode === keyCodes.SPACE) {\r\n      this.withSpace = false;\r\n      this.endHandMode();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Start zoom-in mode\r\n   */\r\n  startZoomInMode() {\r\n    if (this.zoomArea) {\r\n      return;\r\n    }\r\n    this.endHandMode();\r\n    this.zoomMode = zoomModes.ZOOM;\r\n\r\n    const canvas = this.getCanvas();\r\n\r\n    this._changeObjectsEventedState(false);\r\n\r\n    this.zoomArea = new fabric.Rect({\r\n      left: 0,\r\n      top: 0,\r\n      width: 0.5,\r\n      height: 0.5,\r\n      stroke: 'black',\r\n      strokeWidth: 1,\r\n      fill: 'transparent',\r\n      hoverCursor: 'zoom-in',\r\n    });\r\n\r\n    canvas.discardActiveObject();\r\n    canvas.add(this.zoomArea);\r\n    canvas.on('mouse:down', this._listeners.startZoom);\r\n    canvas.selection = false;\r\n    canvas.defaultCursor = 'zoom-in';\r\n  }\r\n\r\n  /**\r\n   * End zoom-in mode\r\n   */\r\n  endZoomInMode() {\r\n    this.zoomMode = zoomModes.DEFAULT;\r\n\r\n    const canvas = this.getCanvas();\r\n    const { startZoom, moveZoom, stopZoom } = this._listeners;\r\n\r\n    canvas.selection = true;\r\n    canvas.defaultCursor = 'auto';\r\n    canvas.off({\r\n      'mouse:down': startZoom,\r\n      'mouse:move': moveZoom,\r\n      'mouse:up': stopZoom,\r\n    });\r\n\r\n    this._changeObjectsEventedState(true);\r\n\r\n    canvas.remove(this.zoomArea);\r\n    this.zoomArea = null;\r\n  }\r\n\r\n  /**\r\n   * Start zoom drawing mode\r\n   */\r\n  start() {\r\n    this.zoomArea = null;\r\n    this._startPoint = null;\r\n    this._startHandPoint = null;\r\n  }\r\n\r\n  /**\r\n   * Stop zoom drawing mode\r\n   */\r\n  end() {\r\n    this.endZoomInMode();\r\n    this.endHandMode();\r\n  }\r\n\r\n  /**\r\n   * Start hand mode\r\n   */\r\n  startHandMode() {\r\n    this.endZoomInMode();\r\n    this.zoomMode = zoomModes.HAND;\r\n\r\n    const canvas = this.getCanvas();\r\n\r\n    this._changeObjectsEventedState(false);\r\n\r\n    canvas.discardActiveObject();\r\n    canvas.off('mouse:down', this._listeners.startHand);\r\n    canvas.on('mouse:down', this._listeners.startHand);\r\n    canvas.selection = false;\r\n    canvas.defaultCursor = 'grab';\r\n\r\n    canvas.fire(HAND_STARTED);\r\n  }\r\n\r\n  /**\r\n   * Stop hand mode\r\n   */\r\n  endHandMode() {\r\n    this.zoomMode = zoomModes.DEFAULT;\r\n    const canvas = this.getCanvas();\r\n\r\n    this._changeObjectsEventedState(true);\r\n\r\n    canvas.off('mouse:down', this._listeners.startHand);\r\n    canvas.selection = true;\r\n    canvas.defaultCursor = 'auto';\r\n\r\n    this._startHandPoint = null;\r\n\r\n    canvas.fire(HAND_STOPPED);\r\n  }\r\n\r\n  /**\r\n   * onMousedown handler in fabric canvas\r\n   * @param {{target: fabric.Object, e: MouseEvent}} fEvent - Fabric event\r\n   * @private\r\n   */\r\n  _onMouseDownWithZoomMode({ target, e }) {\r\n    if (target) {\r\n      return;\r\n    }\r\n\r\n    const canvas = this.getCanvas();\r\n\r\n    canvas.selection = false;\r\n\r\n    this._startPoint = canvas.getPointer(e);\r\n    this.zoomArea.set({ width: 0, height: 0 });\r\n\r\n    const { moveZoom, stopZoom } = this._listeners;\r\n    canvas.on({\r\n      'mouse:move': moveZoom,\r\n      'mouse:up': stopZoom,\r\n    });\r\n  }\r\n\r\n  /**\r\n   * onMousemove handler in fabric canvas\r\n   * @param {{e: MouseEvent}} fEvent - Fabric event\r\n   * @private\r\n   */\r\n  _onMouseMoveWithZoomMode({ e }) {\r\n    const canvas = this.getCanvas();\r\n    const pointer = canvas.getPointer(e);\r\n    const { x, y } = pointer;\r\n    const { zoomArea, _startPoint } = this;\r\n    const deltaX = Math.abs(x - _startPoint.x);\r\n    const deltaY = Math.abs(y - _startPoint.y);\r\n\r\n    if (deltaX + deltaY > MOUSE_MOVE_THRESHOLD) {\r\n      canvas.remove(zoomArea);\r\n      zoomArea.set(this._calcRectDimensionFromPoint(x, y));\r\n      canvas.add(zoomArea);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get rect dimension setting from Canvas-Mouse-Position(x, y)\r\n   * @param {number} x - Canvas-Mouse-Position x\r\n   * @param {number} y - Canvas-Mouse-Position Y\r\n   * @returns {{left: number, top: number, width: number, height: number}}\r\n   * @private\r\n   */\r\n  _calcRectDimensionFromPoint(x, y) {\r\n    const canvas = this.getCanvas();\r\n    const canvasWidth = canvas.getWidth();\r\n    const canvasHeight = canvas.getHeight();\r\n    const { x: startX, y: startY } = this._startPoint;\r\n    const { min } = Math;\r\n\r\n    const left = min(startX, x);\r\n    const top = min(startY, y);\r\n    const width = clamp(x, startX, canvasWidth) - left; // (startX <= x(mouse) <= canvasWidth) - left\r\n    const height = clamp(y, startY, canvasHeight) - top; // (startY <= y(mouse) <= canvasHeight) - top\r\n\r\n    return { left, top, width, height };\r\n  }\r\n\r\n  /**\r\n   * onMouseup handler in fabric canvas\r\n   * @private\r\n   */\r\n  _onMouseUpWithZoomMode() {\r\n    let { zoomLevel } = this;\r\n    const { zoomArea } = this;\r\n    const { moveZoom, stopZoom } = this._listeners;\r\n    const canvas = this.getCanvas();\r\n    const center = this._getCenterPoint();\r\n    const { x, y } = center;\r\n\r\n    if (!this._isMaxZoomLevel()) {\r\n      this._centerPoints.push({\r\n        x,\r\n        y,\r\n        prevZoomLevel: zoomLevel,\r\n        zoomLevel: zoomLevel + 1,\r\n      });\r\n      zoomLevel += 1;\r\n      canvas.zoomToPoint({ x, y }, zoomLevel);\r\n\r\n      this._fireZoomChanged(canvas, zoomLevel);\r\n\r\n      this.zoomLevel = zoomLevel;\r\n    }\r\n\r\n    canvas.off({\r\n      'mouse:move': moveZoom,\r\n      'mouse:up': stopZoom,\r\n    });\r\n\r\n    canvas.remove(zoomArea);\r\n    this._startPoint = null;\r\n  }\r\n\r\n  /**\r\n   * Get center point\r\n   * @returns {{x: number, y: number}}\r\n   * @private\r\n   */\r\n  _getCenterPoint() {\r\n    const { left, top, width, height } = this.zoomArea;\r\n    const { x, y } = this._startPoint;\r\n    const { aspectRatio } = this;\r\n\r\n    if (width < MOUSE_MOVE_THRESHOLD && height < MOUSE_MOVE_THRESHOLD) {\r\n      return { x, y };\r\n    }\r\n\r\n    return width > height\r\n      ? { x: left + (aspectRatio * height) / 2, y: top + height / 2 }\r\n      : { x: left + width / 2, y: top + width / aspectRatio / 2 };\r\n  }\r\n\r\n  /**\r\n   * Zoom the canvas\r\n   * @param {{x: number, y: number}} center - center of zoom\r\n   * @param {?number} zoomLevel - zoom level\r\n   */\r\n  zoom({ x, y }, zoomLevel = this.zoomLevel) {\r\n    const canvas = this.getCanvas();\r\n    const centerPoints = this._centerPoints;\r\n\r\n    for (let i = centerPoints.length - 1; i >= 0; i -= 1) {\r\n      if (centerPoints[i].zoomLevel < zoomLevel) {\r\n        break;\r\n      }\r\n\r\n      const { x: prevX, y: prevY, prevZoomLevel } = centerPoints.pop();\r\n\r\n      canvas.zoomToPoint({ x: prevX, y: prevY }, prevZoomLevel);\r\n      this.zoomLevel = prevZoomLevel;\r\n    }\r\n\r\n    canvas.zoomToPoint({ x, y }, zoomLevel);\r\n    if (!this._isDefaultZoomLevel(zoomLevel)) {\r\n      this._centerPoints.push({\r\n        x,\r\n        y,\r\n        zoomLevel,\r\n        prevZoomLevel: this.zoomLevel,\r\n      });\r\n    }\r\n    this.zoomLevel = zoomLevel;\r\n\r\n    this._fireZoomChanged(canvas, zoomLevel);\r\n  }\r\n\r\n  /**\r\n   * Zoom out one step\r\n   */\r\n  zoomOut() {\r\n    const centerPoints = this._centerPoints;\r\n\r\n    if (!centerPoints.length) {\r\n      return;\r\n    }\r\n\r\n    const canvas = this.getCanvas();\r\n    const point = centerPoints.pop();\r\n    const { x, y, prevZoomLevel } = point;\r\n\r\n    if (this._isDefaultZoomLevel(prevZoomLevel)) {\r\n      canvas.setViewportTransform([1, 0, 0, 1, 0, 0]);\r\n    } else {\r\n      canvas.zoomToPoint({ x, y }, prevZoomLevel);\r\n    }\r\n\r\n    this.zoomLevel = prevZoomLevel;\r\n\r\n    this._fireZoomChanged(canvas, this.zoomLevel);\r\n  }\r\n\r\n  /**\r\n   * Zoom reset\r\n   */\r\n  resetZoom() {\r\n    const canvas = this.getCanvas();\r\n\r\n    canvas.setViewportTransform([1, 0, 0, 1, 0, 0]);\r\n\r\n    this.zoomLevel = DEFAULT_ZOOM_LEVEL;\r\n    this._centerPoints = [];\r\n\r\n    this._fireZoomChanged(canvas, this.zoomLevel);\r\n  }\r\n\r\n  /**\r\n   * Whether zoom level is max (5.0)\r\n   * @returns {boolean}\r\n   * @private\r\n   */\r\n  _isMaxZoomLevel() {\r\n    return this.zoomLevel >= 5.0;\r\n  }\r\n\r\n  /**\r\n   * Move point of zoom\r\n   * @param {{x: number, y: number}} delta - move amount\r\n   * @private\r\n   */\r\n  _movePointOfZoom({ x: deltaX, y: deltaY }) {\r\n    const centerPoints = this._centerPoints;\r\n\r\n    if (!centerPoints.length) {\r\n      return;\r\n    }\r\n\r\n    const canvas = this.getCanvas();\r\n    const { zoomLevel } = this;\r\n\r\n    const point = centerPoints.pop();\r\n    const { x: originX, y: originY, prevZoomLevel } = point;\r\n    const x = originX - deltaX;\r\n    const y = originY - deltaY;\r\n\r\n    canvas.zoomToPoint({ x: originX, y: originY }, prevZoomLevel);\r\n    canvas.zoomToPoint({ x, y }, zoomLevel);\r\n    centerPoints.push({ x, y, prevZoomLevel, zoomLevel });\r\n\r\n    this._fireZoomChanged(canvas, zoomLevel);\r\n  }\r\n\r\n  /**\r\n   * onMouseDown handler in fabric canvas\r\n   * @param {{target: fabric.Object, e: MouseEvent}} fEvent - Fabric event\r\n   * @private\r\n   */\r\n  _onMouseDownWithHandMode({ target, e }) {\r\n    if (target) {\r\n      return;\r\n    }\r\n\r\n    const canvas = this.getCanvas();\r\n\r\n    if (this.zoomLevel <= DEFAULT_ZOOM_LEVEL) {\r\n      return;\r\n    }\r\n\r\n    canvas.selection = false;\r\n\r\n    this._startHandPoint = canvas.getPointer(e);\r\n\r\n    const { moveHand, stopHand } = this._listeners;\r\n    canvas.on({\r\n      'mouse:move': moveHand,\r\n      'mouse:up': stopHand,\r\n    });\r\n  }\r\n\r\n  /**\r\n   * onMouseMove handler in fabric canvas\r\n   * @param {{e: MouseEvent}} fEvent - Fabric event\r\n   * @private\r\n   */\r\n  _onMouseMoveWithHandMode({ e }) {\r\n    const canvas = this.getCanvas();\r\n    const { x, y } = canvas.getPointer(e);\r\n    const deltaX = x - this._startHandPoint.x;\r\n    const deltaY = y - this._startHandPoint.y;\r\n\r\n    this._movePointOfZoom({ x: deltaX, y: deltaY });\r\n  }\r\n\r\n  /**\r\n   * onMouseUp handler in fabric canvas\r\n   * @private\r\n   */\r\n  _onMouseUpWithHandMode() {\r\n    const canvas = this.getCanvas();\r\n    const { moveHand, stopHand } = this._listeners;\r\n\r\n    canvas.off({\r\n      'mouse:move': moveHand,\r\n      'mouse:up': stopHand,\r\n    });\r\n\r\n    this._startHandPoint = null;\r\n  }\r\n\r\n  /**\r\n   * onChangeZoom handler in fabric canvas\r\n   * @private\r\n   */\r\n  _changeScrollState({ viewport, zoomLevel }) {\r\n    const canvas = this.getCanvas();\r\n\r\n    canvas.remove(this._verticalScroll);\r\n    canvas.remove(this._horizontalScroll);\r\n\r\n    if (this._isDefaultZoomLevel(zoomLevel)) {\r\n      return;\r\n    }\r\n\r\n    const canvasWidth = canvas.width;\r\n    const canvasHeight = canvas.height;\r\n\r\n    const { tl, tr, bl } = viewport;\r\n    const viewportWidth = tr.x - tl.x;\r\n    const viewportHeight = bl.y - tl.y;\r\n\r\n    const horizontalScrollWidth = (viewportWidth * viewportWidth) / canvasWidth;\r\n    const horizontalScrollHeight = viewportHeight * DEFAULT_HORIZONTAL_SCROLL_RATIO.SIZE;\r\n    const horizontalScrollLeft = clamp(\r\n      tl.x + (tl.x / canvasWidth) * viewportWidth,\r\n      tl.x,\r\n      tr.x - horizontalScrollWidth\r\n    );\r\n    const horizontalScrollMargin = viewportHeight * DEFAULT_HORIZONTAL_SCROLL_RATIO.MARGIN;\r\n    const horizontalScrollBorderRadius =\r\n      viewportHeight * DEFAULT_HORIZONTAL_SCROLL_RATIO.BORDER_RADIUS;\r\n\r\n    this._horizontalScroll.set({\r\n      left: horizontalScrollLeft,\r\n      top: bl.y - horizontalScrollHeight - horizontalScrollMargin,\r\n      width: horizontalScrollWidth,\r\n      height: horizontalScrollHeight,\r\n      rx: horizontalScrollBorderRadius,\r\n      ry: horizontalScrollBorderRadius,\r\n    });\r\n\r\n    const verticalScrollWidth = viewportWidth * DEFAULT_VERTICAL_SCROLL_RATIO.SIZE;\r\n    const verticalScrollHeight = (viewportHeight * viewportHeight) / canvasHeight;\r\n    const verticalScrollTop = clamp(\r\n      tl.y + (tl.y / canvasHeight) * viewportHeight,\r\n      tr.y,\r\n      bl.y - verticalScrollHeight\r\n    );\r\n    const verticalScrollMargin = viewportWidth * DEFAULT_VERTICAL_SCROLL_RATIO.MARGIN;\r\n    const verticalScrollBorderRadius = viewportWidth * DEFAULT_VERTICAL_SCROLL_RATIO.BORDER_RADIUS;\r\n\r\n    this._verticalScroll.set({\r\n      left: tr.x - verticalScrollWidth - verticalScrollMargin,\r\n      top: verticalScrollTop,\r\n      width: verticalScrollWidth,\r\n      height: verticalScrollHeight,\r\n      rx: verticalScrollBorderRadius,\r\n      ry: verticalScrollBorderRadius,\r\n    });\r\n\r\n    this._addScrollBar();\r\n  }\r\n\r\n  /**\r\n   * Change objects 'evented' state\r\n   * @param {boolean} [evented=true] - objects 'evented' state\r\n   */\r\n  _changeObjectsEventedState(evented = true) {\r\n    const canvas = this.getCanvas();\r\n\r\n    canvas.forEachObject((obj) => {\r\n      // {@link http://fabricjs.com/docs/fabric.Object.html#evented}\r\n      obj.evented = evented;\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Add scroll bar and set remove timer\r\n   */\r\n  _addScrollBar() {\r\n    const canvas = this.getCanvas();\r\n\r\n    canvas.add(this._horizontalScroll);\r\n    canvas.add(this._verticalScroll);\r\n\r\n    if (this.scrollBarTid) {\r\n      clearTimeout(this.scrollBarTid);\r\n    }\r\n\r\n    this.scrollBarTid = setTimeout(() => {\r\n      canvas.remove(this._horizontalScroll);\r\n      canvas.remove(this._verticalScroll);\r\n    }, 3000);\r\n  }\r\n\r\n  /**\r\n   * Check zoom level is default zoom level (1.0)\r\n   * @param {number} zoomLevel - zoom level\r\n   * @returns {boolean} - whether zoom level is 1.0\r\n   */\r\n  _isDefaultZoomLevel(zoomLevel) {\r\n    return zoomLevel === DEFAULT_ZOOM_LEVEL;\r\n  }\r\n\r\n  /**\r\n   * Fire 'zoomChanged' event\r\n   * @param {fabric.Canvas} canvas - fabric canvas\r\n   * @param {number} zoomLevel - 'zoomChanged' event params\r\n   */\r\n  _fireZoomChanged(canvas, zoomLevel) {\r\n    canvas.fire(ZOOM_CHANGED, { viewport: canvas.calcViewportBoundaries(), zoomLevel });\r\n  }\r\n\r\n  /**\r\n   * Get zoom mode\r\n   */\r\n  get mode() {\r\n    return this.zoomMode;\r\n  }\r\n}\r\n\r\nexport default Zoom;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview CropperDrawingMode class\r\n */\r\nimport DrawingMode from '@/interface/drawingMode';\r\nimport { drawingModes, componentNames as components } from '@/consts';\r\n\r\n/**\r\n * CropperDrawingMode class\r\n * @class\r\n * @ignore\r\n */\r\nclass CropperDrawingMode extends DrawingMode {\r\n  constructor() {\r\n    super(drawingModes.CROPPER);\r\n  }\r\n\r\n  /**\r\n   * start this drawing mode\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @override\r\n   */\r\n  start(graphics) {\r\n    const cropper = graphics.getComponent(components.CROPPER);\r\n    cropper.start();\r\n  }\r\n\r\n  /**\r\n   * stop this drawing mode\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @override\r\n   */\r\n  end(graphics) {\r\n    const cropper = graphics.getComponent(components.CROPPER);\r\n    cropper.end();\r\n  }\r\n}\r\n\r\nexport default CropperDrawingMode;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview FreeDrawingMode class\r\n */\r\nimport DrawingMode from '@/interface/drawingMode';\r\nimport { drawingModes, componentNames as components } from '@/consts';\r\n\r\n/**\r\n * FreeDrawingMode class\r\n * @class\r\n * @ignore\r\n */\r\nclass FreeDrawingMode extends DrawingMode {\r\n  constructor() {\r\n    super(drawingModes.FREE_DRAWING);\r\n  }\r\n\r\n  /**\r\n   * start this drawing mode\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @param {{width: ?number, color: ?string}} [options] - Brush width & color\r\n   * @override\r\n   */\r\n  start(graphics, options) {\r\n    const freeDrawing = graphics.getComponent(components.FREE_DRAWING);\r\n    freeDrawing.start(options);\r\n  }\r\n\r\n  /**\r\n   * stop this drawing mode\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @override\r\n   */\r\n  end(graphics) {\r\n    const freeDrawing = graphics.getComponent(components.FREE_DRAWING);\r\n    freeDrawing.end();\r\n  }\r\n}\r\n\r\nexport default FreeDrawingMode;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview LineDrawingMode class\r\n */\r\nimport DrawingMode from '@/interface/drawingMode';\r\nimport { drawingModes, componentNames as components } from '@/consts';\r\n\r\n/**\r\n * LineDrawingMode class\r\n * @class\r\n * @ignore\r\n */\r\nclass LineDrawingMode extends DrawingMode {\r\n  constructor() {\r\n    super(drawingModes.LINE_DRAWING);\r\n  }\r\n\r\n  /**\r\n   * start this drawing mode\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @param {{width: ?number, color: ?string}} [options] - Brush width & color\r\n   * @override\r\n   */\r\n  start(graphics, options) {\r\n    const lineDrawing = graphics.getComponent(components.LINE);\r\n    lineDrawing.start(options);\r\n  }\r\n\r\n  /**\r\n   * stop this drawing mode\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @override\r\n   */\r\n  end(graphics) {\r\n    const lineDrawing = graphics.getComponent(components.LINE);\r\n    lineDrawing.end();\r\n  }\r\n}\r\n\r\nexport default LineDrawingMode;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview ShapeDrawingMode class\r\n */\r\nimport DrawingMode from '@/interface/drawingMode';\r\nimport { drawingModes, componentNames as components } from '@/consts';\r\n\r\n/**\r\n * ShapeDrawingMode class\r\n * @class\r\n * @ignore\r\n */\r\nclass ShapeDrawingMode extends DrawingMode {\r\n  constructor() {\r\n    super(drawingModes.SHAPE);\r\n  }\r\n\r\n  /**\r\n   * start this drawing mode\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @override\r\n   */\r\n  start(graphics) {\r\n    const shape = graphics.getComponent(components.SHAPE);\r\n    shape.start();\r\n  }\r\n\r\n  /**\r\n   * stop this drawing mode\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @override\r\n   */\r\n  end(graphics) {\r\n    const shape = graphics.getComponent(components.SHAPE);\r\n    shape.end();\r\n  }\r\n}\r\n\r\nexport default ShapeDrawingMode;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview TextDrawingMode class\r\n */\r\nimport DrawingMode from '@/interface/drawingMode';\r\nimport { drawingModes, componentNames as components } from '@/consts';\r\n\r\n/**\r\n * TextDrawingMode class\r\n * @class\r\n * @ignore\r\n */\r\nclass TextDrawingMode extends DrawingMode {\r\n  constructor() {\r\n    super(drawingModes.TEXT);\r\n  }\r\n\r\n  /**\r\n   * start this drawing mode\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @override\r\n   */\r\n  start(graphics) {\r\n    const text = graphics.getComponent(components.TEXT);\r\n    text.start();\r\n  }\r\n\r\n  /**\r\n   * stop this drawing mode\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @override\r\n   */\r\n  end(graphics) {\r\n    const text = graphics.getComponent(components.TEXT);\r\n    text.end();\r\n  }\r\n}\r\n\r\nexport default TextDrawingMode;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview IconDrawingMode class\r\n */\r\nimport DrawingMode from '@/interface/drawingMode';\r\nimport { drawingModes, componentNames as components } from '@/consts';\r\n\r\n/**\r\n * IconDrawingMode class\r\n * @class\r\n * @ignore\r\n */\r\nclass IconDrawingMode extends DrawingMode {\r\n  constructor() {\r\n    super(drawingModes.ICON);\r\n  }\r\n\r\n  /**\r\n   * start this drawing mode\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @override\r\n   */\r\n  start(graphics) {\r\n    const icon = graphics.getComponent(components.ICON);\r\n    icon.start();\r\n  }\r\n\r\n  /**\r\n   * stop this drawing mode\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @override\r\n   */\r\n  end(graphics) {\r\n    const icon = graphics.getComponent(components.ICON);\r\n    icon.end();\r\n  }\r\n}\r\n\r\nexport default IconDrawingMode;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview ZoomDrawingMode class\r\n */\r\nimport DrawingMode from '@/interface/drawingMode';\r\nimport { drawingModes, componentNames as components } from '@/consts';\r\n\r\n/**\r\n * ZoomDrawingMode class\r\n * @class\r\n * @ignore\r\n */\r\nclass ZoomDrawingMode extends DrawingMode {\r\n  constructor() {\r\n    super(drawingModes.ZOOM);\r\n  }\r\n\r\n  /**\r\n   * start this drawing mode\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @override\r\n   */\r\n  start(graphics) {\r\n    const zoom = graphics.getComponent(components.ZOOM);\r\n\r\n    zoom.start();\r\n  }\r\n\r\n  /**\r\n   * stop this drawing mode\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @override\r\n   */\r\n  end(graphics) {\r\n    const zoom = graphics.getComponent(components.ZOOM);\r\n\r\n    zoom.end();\r\n  }\r\n}\r\n\r\nexport default ZoomDrawingMode;\r\n","import { Promise } from '@/util';\r\nimport Component from '@/interface/component';\r\nimport { componentNames } from '@/consts';\r\n\r\n/**\r\n * Resize components\r\n * @param {Graphics} graphics - Graphics instance\r\n * @extends {Component}\r\n * @class Resize\r\n * @ignore\r\n */\r\nclass Resize extends Component {\r\n  constructor(graphics) {\r\n    super(componentNames.RESIZE, graphics);\r\n\r\n    /**\r\n     * Current dimensions\r\n     * @type {Object}\r\n     * @private\r\n     */\r\n    this._dimensions = null;\r\n\r\n    /**\r\n     * Original dimensions\r\n     * @type {Object}\r\n     * @private\r\n     */\r\n    this._originalDimensions = null;\r\n  }\r\n\r\n  /**\r\n   * Get current dimensions\r\n   * @returns {object}\r\n   */\r\n  getCurrentDimensions() {\r\n    const canvasImage = this.getCanvasImage();\r\n    if (!this._dimensions && canvasImage) {\r\n      const { width, height } = canvasImage;\r\n      this._dimensions = { width, height };\r\n    }\r\n\r\n    return this._dimensions;\r\n  }\r\n\r\n  /**\r\n   * Get original dimensions\r\n   * @returns {object}\r\n   */\r\n  getOriginalDimensions() {\r\n    return this._originalDimensions;\r\n  }\r\n\r\n  /**\r\n   * Set original dimensions\r\n   * @param {object} dimensions - Dimensions\r\n   */\r\n  setOriginalDimensions(dimensions) {\r\n    this._originalDimensions = dimensions;\r\n  }\r\n\r\n  /**\r\n   * Resize Image\r\n   * @param {Object} dimensions - Resize dimensions\r\n   * @returns {Promise}\r\n   */\r\n  resize(dimensions) {\r\n    const canvasImage = this.getCanvasImage();\r\n    const { width, height, scaleX, scaleY } = canvasImage;\r\n    const { width: dimensionsWidth, height: dimensionsHeight } = dimensions;\r\n\r\n    const scaleValues = {\r\n      scaleX: dimensionsWidth ? dimensionsWidth / width : scaleX,\r\n      scaleY: dimensionsHeight ? dimensionsHeight / height : scaleY,\r\n    };\r\n\r\n    if (scaleX !== scaleValues.scaleX || scaleY !== scaleValues.scaleY) {\r\n      canvasImage.set(scaleValues).setCoords();\r\n\r\n      this._dimensions = {\r\n        width: canvasImage.width * canvasImage.scaleX,\r\n        height: canvasImage.height * canvasImage.scaleY,\r\n      };\r\n    }\r\n\r\n    this.adjustCanvasDimensionBase();\r\n\r\n    return Promise.resolve();\r\n  }\r\n\r\n  /**\r\n   * Start resizing\r\n   */\r\n  start() {\r\n    const dimensions = this.getCurrentDimensions();\r\n    this.setOriginalDimensions(dimensions);\r\n  }\r\n\r\n  /**\r\n   * End resizing\r\n   */\r\n  end() {}\r\n}\r\n\r\nexport default Resize;\r\n","import DrawingMode from '@/interface/drawingMode';\r\nimport { drawingModes, componentNames as components } from '@/consts';\r\n\r\n/**\r\n * ResizeDrawingMode class\r\n * @class\r\n * @ignore\r\n */\r\nclass ResizeDrawingMode extends DrawingMode {\r\n  constructor() {\r\n    super(drawingModes.RESIZE);\r\n  }\r\n\r\n  /**\r\n   * start this drawing mode\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @override\r\n   */\r\n  start(graphics) {\r\n    const resize = graphics.getComponent(components.RESIZE);\r\n    resize.start();\r\n  }\r\n\r\n  /**\r\n   * stop this drawing mode\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @override\r\n   */\r\n  end(graphics) {\r\n    const resize = graphics.getComponent(components.RESIZE);\r\n    resize.end();\r\n  }\r\n}\r\n\r\nexport default ResizeDrawingMode;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview JSON loader\r\n */\r\nimport Component from '@/interface/component';\r\nimport { Promise } from '@/util';\r\nimport { componentNames, rejectMessages } from '@/consts';\r\n\r\n/**\r\n * JsonLoader components\r\n * @extends {Component}\r\n * @class JsonLoader\r\n * @param {Graphics} graphics - Graphics instance\r\n * @ignore\r\n */\r\nclass JsonLoader extends Component {\r\n  constructor(graphics) {\r\n    super(componentNames.JSON_LOADER, graphics);\r\n  }\r\n\r\n  load(json) {\r\n    let promise;\r\n\r\n    if (!json) {\r\n      // Back to the initial state, not error.\r\n      const canvas = this.getCanvas();\r\n\r\n      canvas.renderAll();\r\n\r\n      promise = new Promise((resolve) => {\r\n        resolve();\r\n      });\r\n    } else {\r\n      promise = this._loadJson(json).then((objs) => {\r\n        return objs;\r\n      });\r\n    }\r\n\r\n    return promise;\r\n  }\r\n\r\n  _loadJson(json) {\r\n    if (!json) {\r\n      return Promise.reject(rejectMessages.loadJson);\r\n    }\r\n\r\n    return new Promise((resolve, reject) => {\r\n      const canvas = this.getCanvas();\r\n\r\n      canvas.loadFromJSON(json, () => {\r\n        const objs = canvas.getObjects();\r\n        if (objs) {\r\n          resolve(objs);\r\n        } else {\r\n          reject(rejectMessages.loadingJsonFailed);\r\n        }\r\n      });\r\n    });\r\n  }\r\n}\r\n\r\nexport default JsonLoader;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Add an icon\r\n */\r\nimport commandFactory from '@/factory/command';\r\nimport { Promise } from '@/util';\r\nimport { componentNames, commandNames } from '@/consts';\r\n\r\nconst { ICON } = componentNames;\r\n\r\nconst command = {\r\n  name: commandNames.ADD_ICON,\r\n\r\n  /**\r\n   * Add an icon\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @param {string} type - Icon type ('arrow', 'cancel', custom icon name)\r\n   * @param {Object} options - Icon options\r\n   *      @param {string} [options.fill] - Icon foreground color\r\n   *      @param {string} [options.left] - Icon x position\r\n   *      @param {string} [options.top] - Icon y position\r\n   * @returns {Promise}\r\n   */\r\n  execute(graphics, type, options) {\r\n    const iconComp = graphics.getComponent(ICON);\r\n\r\n    return iconComp.add(type, options).then((objectProps) => {\r\n      this.undoData.object = graphics.getObject(objectProps.objId);\r\n\r\n      return objectProps;\r\n    });\r\n  },\r\n\r\n  /**\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @returns {Promise}\r\n   */\r\n  undo(graphics) {\r\n    graphics.remove(this.undoData.object);\r\n\r\n    return Promise.resolve();\r\n  },\r\n};\r\n\r\ncommandFactory.register(command);\r\n\r\nexport default command;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Add an image object\r\n */\r\nimport commandFactory from '@/factory/command';\r\nimport { Promise } from '@/util';\r\nimport { commandNames } from '@/consts';\r\n\r\nconst command = {\r\n  name: commandNames.ADD_IMAGE_OBJECT,\r\n\r\n  /**\r\n   * Add an image object\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @param {string} imgUrl - Image url to make object\r\n   * @returns {Promise}\r\n   */\r\n  execute(graphics, imgUrl) {\r\n    return graphics.addImageObject(imgUrl).then((objectProps) => {\r\n      this.undoData.object = graphics.getObject(objectProps.objId);\r\n\r\n      return objectProps;\r\n    });\r\n  },\r\n\r\n  /**\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @returns {Promise}\r\n   */\r\n  undo(graphics) {\r\n    graphics.remove(this.undoData.object);\r\n\r\n    return Promise.resolve();\r\n  },\r\n};\r\n\r\ncommandFactory.register(command);\r\n\r\nexport default command;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Add an object\r\n */\r\nimport commandFactory from '@/factory/command';\r\nimport { Promise } from '@/util';\r\nimport { commandNames, rejectMessages } from '@/consts';\r\n\r\nconst command = {\r\n  name: commandNames.ADD_OBJECT,\r\n\r\n  /**\r\n   * Add an object\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @param {Object} object - Fabric object\r\n   * @returns {Promise}\r\n   */\r\n  execute(graphics, object) {\r\n    return new Promise((resolve, reject) => {\r\n      if (!graphics.contains(object)) {\r\n        graphics.add(object);\r\n        resolve(object);\r\n      } else {\r\n        reject(rejectMessages.addedObject);\r\n      }\r\n    });\r\n  },\r\n\r\n  /**\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @param {Object} object - Fabric object\r\n   * @returns {Promise}\r\n   */\r\n  undo(graphics, object) {\r\n    return new Promise((resolve, reject) => {\r\n      if (graphics.contains(object)) {\r\n        graphics.remove(object);\r\n        resolve(object);\r\n      } else {\r\n        reject(rejectMessages.noObject);\r\n      }\r\n    });\r\n  },\r\n};\r\n\r\ncommandFactory.register(command);\r\n\r\nexport default command;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Add a shape\r\n */\r\nimport commandFactory from '@/factory/command';\r\nimport { Promise } from '@/util';\r\nimport { componentNames, commandNames } from '@/consts';\r\n\r\nconst { SHAPE } = componentNames;\r\n\r\nconst command = {\r\n  name: commandNames.ADD_SHAPE,\r\n\r\n  /**\r\n   * Add a shape\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @param {string} type - Shape type (ex: 'rect', 'circle', 'triangle')\r\n   * @param {Object} options - Shape options\r\n   *      @param {string} [options.fill] - Shape foreground color (ex: '#fff', 'transparent')\r\n   *      @param {string} [options.stroke] - Shape outline color\r\n   *      @param {number} [options.strokeWidth] - Shape outline width\r\n   *      @param {number} [options.width] - Width value (When type option is 'rect', this options can use)\r\n   *      @param {number} [options.height] - Height value (When type option is 'rect', this options can use)\r\n   *      @param {number} [options.rx] - Radius x value (When type option is 'circle', this options can use)\r\n   *      @param {number} [options.ry] - Radius y value (When type option is 'circle', this options can use)\r\n   *      @param {number} [options.left] - Shape x position\r\n   *      @param {number} [options.top] - Shape y position\r\n   *      @param {number} [options.isRegular] - Whether resizing shape has 1:1 ratio or not\r\n   * @returns {Promise}\r\n   */\r\n  execute(graphics, type, options) {\r\n    const shapeComp = graphics.getComponent(SHAPE);\r\n\r\n    return shapeComp.add(type, options).then((objectProps) => {\r\n      const { objId } = objectProps;\r\n\r\n      this.undoData.object = graphics.getObject(objId);\r\n\r\n      return objectProps;\r\n    });\r\n  },\r\n\r\n  /**\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @returns {Promise}\r\n   */\r\n  undo(graphics) {\r\n    graphics.remove(this.undoData.object);\r\n\r\n    return Promise.resolve();\r\n  },\r\n};\r\n\r\ncommandFactory.register(command);\r\n\r\nexport default command;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Add a text object\r\n */\r\nimport commandFactory from '@/factory/command';\r\nimport { Promise } from '@/util';\r\nimport { componentNames, commandNames, rejectMessages } from '@/consts';\r\nimport {\r\n  setCachedUndoDataForDimension,\r\n  makeSelectionUndoData,\r\n  makeSelectionUndoDatum,\r\n} from '@/helper/selectionModifyHelper';\r\n\r\nconst { TEXT } = componentNames;\r\n\r\nconst command = {\r\n  name: commandNames.ADD_TEXT,\r\n\r\n  /**\r\n   * Add a text object\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @param {string} text - Initial input text\r\n   * @param {Object} [options] Options for text styles\r\n   *     @param {Object} [options.styles] Initial styles\r\n   *         @param {string} [options.styles.fill] Color\r\n   *         @param {string} [options.styles.fontFamily] Font type for text\r\n   *         @param {number} [options.styles.fontSize] Size\r\n   *         @param {string} [options.styles.fontStyle] Type of inclination (normal / italic)\r\n   *         @param {string} [options.styles.fontWeight] Type of thicker or thinner looking (normal / bold)\r\n   *         @param {string} [options.styles.textAlign] Type of text align (left / center / right)\r\n   *         @param {string} [options.styles.textDecoration] Type of line (underline / line-through / overline)\r\n   *     @param {{x: number, y: number}} [options.position] - Initial position\r\n   * @returns {Promise}\r\n   */\r\n  execute(graphics, text, options) {\r\n    const textComp = graphics.getComponent(TEXT);\r\n\r\n    if (this.undoData.object) {\r\n      const undoObject = this.undoData.object;\r\n\r\n      return new Promise((resolve, reject) => {\r\n        if (!graphics.contains(undoObject)) {\r\n          graphics.add(undoObject);\r\n          resolve(undoObject);\r\n        } else {\r\n          reject(rejectMessages.redo);\r\n        }\r\n      });\r\n    }\r\n\r\n    return textComp.add(text, options).then((objectProps) => {\r\n      const { objId } = objectProps;\r\n      const textObject = graphics.getObject(objId);\r\n\r\n      this.undoData.object = textObject;\r\n\r\n      setCachedUndoDataForDimension(\r\n        makeSelectionUndoData(textObject, () => makeSelectionUndoDatum(objId, textObject, false))\r\n      );\r\n\r\n      return objectProps;\r\n    });\r\n  },\r\n\r\n  /**\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @returns {Promise}\r\n   */\r\n  undo(graphics) {\r\n    graphics.remove(this.undoData.object);\r\n\r\n    return Promise.resolve();\r\n  },\r\n};\r\n\r\ncommandFactory.register(command);\r\n\r\nexport default command;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Apply a filter into an image\r\n */\r\nimport snippet from 'tui-code-snippet';\r\nimport commandFactory from '@/factory/command';\r\nimport { componentNames, rejectMessages, commandNames } from '@/consts';\r\n\r\nconst { FILTER } = componentNames;\r\n\r\n/**\r\n * Cached data for undo\r\n * @type {Object}\r\n */\r\nlet cachedUndoDataForSilent = null;\r\n\r\n/**\r\n * Make undoData\r\n * @param {string} type - Filter type\r\n * @param {Object} prevfilterOption - prev Filter options\r\n * @param {Object} options - Filter options\r\n * @returns {object} - undo data\r\n */\r\nfunction makeUndoData(type, prevfilterOption, options) {\r\n  const undoData = {};\r\n\r\n  if (type === 'mask') {\r\n    undoData.object = options.mask;\r\n  }\r\n\r\n  undoData.options = prevfilterOption;\r\n\r\n  return undoData;\r\n}\r\n\r\nconst command = {\r\n  name: commandNames.APPLY_FILTER,\r\n\r\n  /**\r\n   * Apply a filter into an image\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @param {string} type - Filter type\r\n   * @param {Object} options - Filter options\r\n   *  @param {number} options.maskObjId - masking image object id\r\n   * @param {boolean} isSilent - is silent execution or not\r\n   * @returns {Promise}\r\n   */\r\n  execute(graphics, type, options, isSilent) {\r\n    const filterComp = graphics.getComponent(FILTER);\r\n\r\n    if (type === 'mask') {\r\n      const maskObj = graphics.getObject(options.maskObjId);\r\n\r\n      if (!(maskObj && maskObj.isType('image'))) {\r\n        return Promise.reject(rejectMessages.invalidParameters);\r\n      }\r\n\r\n      snippet.extend(options, { mask: maskObj });\r\n      graphics.remove(options.mask);\r\n    }\r\n    if (!this.isRedo) {\r\n      const prevfilterOption = filterComp.getOptions(type);\r\n      const undoData = makeUndoData(type, prevfilterOption, options);\r\n\r\n      cachedUndoDataForSilent = this.setUndoData(undoData, cachedUndoDataForSilent, isSilent);\r\n    }\r\n\r\n    return filterComp.add(type, options);\r\n  },\r\n\r\n  /**\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @param {string} type - Filter type\r\n   * @returns {Promise}\r\n   */\r\n  undo(graphics, type) {\r\n    const filterComp = graphics.getComponent(FILTER);\r\n\r\n    if (type === 'mask') {\r\n      const mask = this.undoData.object;\r\n      graphics.add(mask);\r\n      graphics.setActiveObject(mask);\r\n\r\n      return filterComp.remove(type);\r\n    }\r\n\r\n    // options changed case\r\n    if (this.undoData.options) {\r\n      return filterComp.add(type, this.undoData.options);\r\n    }\r\n\r\n    // filter added case\r\n    return filterComp.remove(type);\r\n  },\r\n};\r\n\r\ncommandFactory.register(command);\r\n\r\nexport default command;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Change icon color\r\n */\r\nimport commandFactory from '@/factory/command';\r\nimport { Promise } from '@/util';\r\nimport { componentNames, rejectMessages, commandNames } from '@/consts';\r\n\r\nconst { ICON } = componentNames;\r\n\r\nconst command = {\r\n  name: commandNames.CHANGE_ICON_COLOR,\r\n\r\n  /**\r\n   * Change icon color\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @param {number} objId -  object id\r\n   * @param {string} color - Color for icon\r\n   * @returns {Promise}\r\n   */\r\n  execute(graphics, objId, color) {\r\n    return new Promise((resolve, reject) => {\r\n      const iconComp = graphics.getComponent(ICON);\r\n      const targetObj = graphics.getObject(objId);\r\n\r\n      if (!targetObj) {\r\n        reject(rejectMessages.noObject);\r\n      }\r\n\r\n      this.undoData.object = targetObj;\r\n      this.undoData.color = iconComp.getColor(targetObj);\r\n      iconComp.setColor(color, targetObj);\r\n      resolve();\r\n    });\r\n  },\r\n\r\n  /**\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @returns {Promise}\r\n   */\r\n  undo(graphics) {\r\n    const iconComp = graphics.getComponent(ICON);\r\n    const { object: icon, color } = this.undoData;\r\n\r\n    iconComp.setColor(color, icon);\r\n\r\n    return Promise.resolve();\r\n  },\r\n};\r\n\r\ncommandFactory.register(command);\r\n\r\nexport default command;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview change a shape\r\n */\r\nimport snippet from 'tui-code-snippet';\r\nimport commandFactory from '@/factory/command';\r\nimport { Promise } from '@/util';\r\nimport { componentNames, rejectMessages, commandNames } from '@/consts';\r\n\r\nconst { SHAPE } = componentNames;\r\n\r\n/**\r\n * Cached data for undo\r\n * @type {Object}\r\n */\r\nlet cachedUndoDataForSilent = null;\r\n\r\n/**\r\n * Make undoData\r\n * @param {object} options - shape options\r\n * @param {Component} targetObj - shape component\r\n * @returns {object} - undo data\r\n */\r\nfunction makeUndoData(options, targetObj) {\r\n  const undoData = {\r\n    object: targetObj,\r\n    options: {},\r\n  };\r\n\r\n  snippet.forEachOwnProperties(options, (value, key) => {\r\n    undoData.options[key] = targetObj[key];\r\n  });\r\n\r\n  return undoData;\r\n}\r\n\r\nconst command = {\r\n  name: commandNames.CHANGE_SHAPE,\r\n\r\n  /**\r\n   * Change a shape\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @param {number} objId -  object id\r\n   * @param {Object} options - Shape options\r\n   *      @param {string} [options.fill] - Shape foreground color (ex: '#fff', 'transparent')\r\n   *      @param {string} [options.stroke] - Shape outline color\r\n   *      @param {number} [options.strokeWidth] - Shape outline width\r\n   *      @param {number} [options.width] - Width value (When type option is 'rect', this options can use)\r\n   *      @param {number} [options.height] - Height value (When type option is 'rect', this options can use)\r\n   *      @param {number} [options.rx] - Radius x value (When type option is 'circle', this options can use)\r\n   *      @param {number} [options.ry] - Radius y value (When type option is 'circle', this options can use)\r\n   *      @param {number} [options.left] - Shape x position\r\n   *      @param {number} [options.top] - Shape y position\r\n   *      @param {number} [options.isRegular] - Whether resizing shape has 1:1 ratio or not\r\n   * @param {boolean} isSilent - is silent execution or not\r\n   * @returns {Promise}\r\n   */\r\n  execute(graphics, objId, options, isSilent) {\r\n    const shapeComp = graphics.getComponent(SHAPE);\r\n    const targetObj = graphics.getObject(objId);\r\n\r\n    if (!targetObj) {\r\n      return Promise.reject(rejectMessages.noObject);\r\n    }\r\n\r\n    if (!this.isRedo) {\r\n      const undoData = makeUndoData(options, targetObj);\r\n\r\n      cachedUndoDataForSilent = this.setUndoData(undoData, cachedUndoDataForSilent, isSilent);\r\n    }\r\n\r\n    return shapeComp.change(targetObj, options);\r\n  },\r\n\r\n  /**\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @returns {Promise}\r\n   */\r\n  undo(graphics) {\r\n    const shapeComp = graphics.getComponent(SHAPE);\r\n    const { object: shape, options } = this.undoData;\r\n\r\n    return shapeComp.change(shape, options);\r\n  },\r\n};\r\n\r\ncommandFactory.register(command);\r\n\r\nexport default command;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Change a text\r\n */\r\nimport commandFactory from '@/factory/command';\r\nimport { Promise } from '@/util';\r\nimport { componentNames, rejectMessages, commandNames } from '@/consts';\r\n\r\nconst { TEXT } = componentNames;\r\n\r\nconst command = {\r\n  name: commandNames.CHANGE_TEXT,\r\n\r\n  /**\r\n   * Change a text\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @param {number} objId -  object id\r\n   * @param {string} text - Changing text\r\n   * @returns {Promise}\r\n   */\r\n  execute(graphics, objId, text) {\r\n    const textComp = graphics.getComponent(TEXT);\r\n    const targetObj = graphics.getObject(objId);\r\n\r\n    if (!targetObj) {\r\n      return Promise.reject(rejectMessages.noObject);\r\n    }\r\n\r\n    this.undoData.object = targetObj;\r\n    this.undoData.text = textComp.getText(targetObj);\r\n\r\n    return textComp.change(targetObj, text);\r\n  },\r\n\r\n  /**\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @returns {Promise}\r\n   */\r\n  undo(graphics) {\r\n    const textComp = graphics.getComponent(TEXT);\r\n    const { object: textObj, text } = this.undoData;\r\n\r\n    return textComp.change(textObj, text);\r\n  },\r\n};\r\n\r\ncommandFactory.register(command);\r\n\r\nexport default command;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Change text styles\r\n */\r\nimport snippet from 'tui-code-snippet';\r\nimport commandFactory from '@/factory/command';\r\nimport { Promise } from '@/util';\r\nimport { componentNames, rejectMessages, commandNames } from '@/consts';\r\n\r\nconst { TEXT } = componentNames;\r\n\r\n/**\r\n * Cached data for undo\r\n * @type {Object}\r\n */\r\nlet cachedUndoDataForSilent = null;\r\n\r\n/**\r\n * Make undoData\r\n * @param {object} styles - text styles\r\n * @param {Component} targetObj - text component\r\n * @returns {object} - undo data\r\n */\r\nfunction makeUndoData(styles, targetObj) {\r\n  const undoData = {\r\n    object: targetObj,\r\n    styles: {},\r\n  };\r\n  snippet.forEachOwnProperties(styles, (value, key) => {\r\n    const undoValue = targetObj[key];\r\n    undoData.styles[key] = undoValue;\r\n  });\r\n\r\n  return undoData;\r\n}\r\n\r\nconst command = {\r\n  name: commandNames.CHANGE_TEXT_STYLE,\r\n\r\n  /**\r\n   * Change text styles\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @param {number} objId -  object id\r\n   * @param {Object} styles - text styles\r\n   *     @param {string} [styles.fill] Color\r\n   *     @param {string} [styles.fontFamily] Font type for text\r\n   *     @param {number} [styles.fontSize] Size\r\n   *     @param {string} [styles.fontStyle] Type of inclination (normal / italic)\r\n   *     @param {string} [styles.fontWeight] Type of thicker or thinner looking (normal / bold)\r\n   *     @param {string} [styles.textAlign] Type of text align (left / center / right)\r\n   *     @param {string} [styles.textDecoration] Type of line (underline / line-through / overline)\r\n   * @param {boolean} isSilent - is silent execution or not\r\n   * @returns {Promise}\r\n   */\r\n  execute(graphics, objId, styles, isSilent) {\r\n    const textComp = graphics.getComponent(TEXT);\r\n    const targetObj = graphics.getObject(objId);\r\n\r\n    if (!targetObj) {\r\n      return Promise.reject(rejectMessages.noObject);\r\n    }\r\n    if (!this.isRedo) {\r\n      const undoData = makeUndoData(styles, targetObj);\r\n\r\n      cachedUndoDataForSilent = this.setUndoData(undoData, cachedUndoDataForSilent, isSilent);\r\n    }\r\n\r\n    return textComp.setStyle(targetObj, styles);\r\n  },\r\n\r\n  /**\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @returns {Promise}\r\n   */\r\n  undo(graphics) {\r\n    const textComp = graphics.getComponent(TEXT);\r\n    const { object: textObj, styles } = this.undoData;\r\n\r\n    return textComp.setStyle(textObj, styles);\r\n  },\r\n};\r\n\r\ncommandFactory.register(command);\r\n\r\nexport default command;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Clear all objects\r\n */\r\nimport commandFactory from '@/factory/command';\r\nimport { Promise } from '@/util';\r\nimport { commandNames } from '@/consts';\r\n\r\nconst command = {\r\n  name: commandNames.CLEAR_OBJECTS,\r\n\r\n  /**\r\n   * Clear all objects without background (main) image\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @returns {Promise}\r\n   */\r\n  execute(graphics) {\r\n    return new Promise((resolve) => {\r\n      this.undoData.objects = graphics.removeAll();\r\n      resolve();\r\n    });\r\n  },\r\n\r\n  /**\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @returns {Promise}\r\n   * @ignore\r\n   */\r\n  undo(graphics) {\r\n    graphics.add(this.undoData.objects);\r\n\r\n    return Promise.resolve();\r\n  },\r\n};\r\n\r\ncommandFactory.register(command);\r\n\r\nexport default command;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Flip an image\r\n */\r\nimport commandFactory from '@/factory/command';\r\nimport { componentNames, commandNames } from '@/consts';\r\n\r\nconst { FLIP } = componentNames;\r\n\r\nconst command = {\r\n  name: commandNames.FLIP_IMAGE,\r\n\r\n  /**\r\n   * flip an image\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @param {string} type - 'flipX' or 'flipY' or 'reset'\r\n   * @returns {Promise}\r\n   */\r\n  execute(graphics, type) {\r\n    const flipComp = graphics.getComponent(FLIP);\r\n\r\n    this.undoData.setting = flipComp.getCurrentSetting();\r\n\r\n    return flipComp[type]();\r\n  },\r\n\r\n  /**\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @returns {Promise}\r\n   */\r\n  undo(graphics) {\r\n    const flipComp = graphics.getComponent(FLIP);\r\n\r\n    return flipComp.set(this.undoData.setting);\r\n  },\r\n};\r\n\r\ncommandFactory.register(command);\r\n\r\nexport default command;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Load a background (main) image\r\n */\r\nimport commandFactory from '@/factory/command';\r\nimport { componentNames, commandNames } from '@/consts';\r\n\r\nconst { IMAGE_LOADER } = componentNames;\r\n\r\nconst command = {\r\n  name: commandNames.LOAD_IMAGE,\r\n\r\n  /**\r\n   * Load a background (main) image\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @param {string} imageName - Image name\r\n   * @param {string} imgUrl - Image Url\r\n   * @returns {Promise}\r\n   */\r\n  execute(graphics, imageName, imgUrl) {\r\n    const loader = graphics.getComponent(IMAGE_LOADER);\r\n    const prevImage = loader.getCanvasImage();\r\n    const prevImageWidth = prevImage ? prevImage.width : 0;\r\n    const prevImageHeight = prevImage ? prevImage.height : 0;\r\n    const objects = graphics.removeAll(true).filter((objectItem) => objectItem.type !== 'cropzone');\r\n\r\n    objects.forEach((objectItem) => {\r\n      objectItem.evented = true;\r\n    });\r\n\r\n    this.undoData = {\r\n      name: loader.getImageName(),\r\n      image: prevImage,\r\n      objects,\r\n    };\r\n\r\n    return loader.load(imageName, imgUrl).then((newImage) => ({\r\n      oldWidth: prevImageWidth,\r\n      oldHeight: prevImageHeight,\r\n      newWidth: newImage.width,\r\n      newHeight: newImage.height,\r\n    }));\r\n  },\r\n\r\n  /**\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @returns {Promise}\r\n   */\r\n  undo(graphics) {\r\n    const loader = graphics.getComponent(IMAGE_LOADER);\r\n    const { objects, name, image } = this.undoData;\r\n\r\n    graphics.removeAll(true);\r\n    graphics.add(objects);\r\n\r\n    return loader.load(name, image);\r\n  },\r\n};\r\n\r\ncommandFactory.register(command);\r\n\r\nexport default command;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Load a background (main) image\r\n */\r\nimport { commandNames, componentNames, fObjectOptions } from '@/consts';\r\nimport commandFactory from '@/factory/command';\r\nimport snippet from 'tui-code-snippet';\r\n\r\nconst { JSON_LOADER, TEXT } = componentNames;\r\n\r\nconst command = {\r\n  name: commandNames.LOAD_JSON,\r\n\r\n  execute(graphics, json) {\r\n    const loader = graphics.getComponent(JSON_LOADER);\r\n    const texComp = graphics.getComponent(TEXT);\r\n\r\n    const objects = graphics.removeAll(true).filter((objectItem) => objectItem.type !== 'cropzone');\r\n\r\n    objects.forEach((objectItem) => {\r\n      objectItem.evented = true;\r\n    });\r\n\r\n    this.undoData.objects = objects;\r\n\r\n    return loader.load(json).then((objs) => {\r\n      objs.map((obj) => {\r\n        let selectionStyle = fObjectOptions.SELECTION_STYLE;\r\n        selectionStyle = snippet.extend({}, selectionStyle, {\r\n          originX: 'left',\r\n          originY: 'top',\r\n        });\r\n        obj.set(selectionStyle);\r\n        if (obj.type === 'i-text') {\r\n          texComp.initialize(obj);\r\n        }\r\n\r\n        graphics._addFabricObject(obj);\r\n\r\n        return obj;\r\n      });\r\n\r\n      return objs;\r\n    });\r\n  },\r\n  /**\r\n   * @returns {Promise}\r\n   */\r\n  undo() {\r\n    return Promise.resolve();\r\n  },\r\n};\r\n\r\ncommandFactory.register(command);\r\n\r\nexport default command;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Remove a filter from an image\r\n */\r\nimport commandFactory from '@/factory/command';\r\nimport { componentNames, commandNames } from '@/consts';\r\n\r\nconst { FILTER } = componentNames;\r\n\r\nconst command = {\r\n  name: commandNames.REMOVE_FILTER,\r\n\r\n  /**\r\n   * Remove a filter from an image\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @param {string} type - Filter type\r\n   * @returns {Promise}\r\n   */\r\n  execute(graphics, type) {\r\n    const filterComp = graphics.getComponent(FILTER);\r\n\r\n    this.undoData.options = filterComp.getOptions(type);\r\n\r\n    return filterComp.remove(type);\r\n  },\r\n\r\n  /**\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @param {string} type - Filter type\r\n   * @returns {Promise}\r\n   */\r\n  undo(graphics, type) {\r\n    const filterComp = graphics.getComponent(FILTER);\r\n    const { options } = this.undoData;\r\n\r\n    return filterComp.add(type, options);\r\n  },\r\n};\r\n\r\ncommandFactory.register(command);\r\n\r\nexport default command;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Remove an object\r\n */\r\nimport commandFactory from '@/factory/command';\r\nimport { Promise } from '@/util';\r\nimport { commandNames, rejectMessages } from '@/consts';\r\n\r\nconst command = {\r\n  name: commandNames.REMOVE_OBJECT,\r\n\r\n  /**\r\n   * Remove an object\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @param {number} objId -  object id\r\n   * @returns {Promise}\r\n   */\r\n  execute(graphics, objId) {\r\n    return new Promise((resolve, reject) => {\r\n      this.undoData.objects = graphics.removeObjectById(objId);\r\n      if (this.undoData.objects.length) {\r\n        resolve();\r\n      } else {\r\n        reject(rejectMessages.noObject);\r\n      }\r\n    });\r\n  },\r\n\r\n  /**\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @returns {Promise}\r\n   */\r\n  undo(graphics) {\r\n    graphics.add(this.undoData.objects);\r\n\r\n    return Promise.resolve();\r\n  },\r\n};\r\n\r\ncommandFactory.register(command);\r\n\r\nexport default command;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Resize a canvas\r\n */\r\nimport commandFactory from '@/factory/command';\r\nimport { Promise } from '@/util';\r\nimport { commandNames } from '@/consts';\r\n\r\nconst command = {\r\n  name: commandNames.RESIZE_CANVAS_DIMENSION,\r\n\r\n  /**\r\n   * resize the canvas with given dimension\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @param {{width: number, height: number}} dimension - Max width & height\r\n   * @returns {Promise}\r\n   */\r\n  execute(graphics, dimension) {\r\n    return new Promise((resolve) => {\r\n      this.undoData.size = {\r\n        width: graphics.cssMaxWidth,\r\n        height: graphics.cssMaxHeight,\r\n      };\r\n\r\n      graphics.setCssMaxDimension(dimension);\r\n      graphics.adjustCanvasDimension();\r\n      resolve();\r\n    });\r\n  },\r\n\r\n  /**\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @returns {Promise}\r\n   */\r\n  undo(graphics) {\r\n    graphics.setCssMaxDimension(this.undoData.size);\r\n    graphics.adjustCanvasDimension();\r\n\r\n    return Promise.resolve();\r\n  },\r\n};\r\n\r\ncommandFactory.register(command);\r\n\r\nexport default command;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Rotate an image\r\n */\r\nimport commandFactory from '@/factory/command';\r\nimport { componentNames, commandNames } from '@/consts';\r\n\r\nconst { ROTATION } = componentNames;\r\n\r\n/**\r\n * Cached data for undo\r\n * @type {Object}\r\n */\r\nlet cachedUndoDataForSilent = null;\r\n\r\n/**\r\n * Make undo data\r\n * @param {Component} rotationComp - rotation component\r\n * @returns {object} - undodata\r\n */\r\nfunction makeUndoData(rotationComp) {\r\n  return {\r\n    angle: rotationComp.getCurrentAngle(),\r\n  };\r\n}\r\n\r\nconst command = {\r\n  name: commandNames.ROTATE_IMAGE,\r\n\r\n  /**\r\n   * Rotate an image\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @param {string} type - 'rotate' or 'setAngle'\r\n   * @param {number} angle - angle value (degree)\r\n   * @param {boolean} isSilent - is silent execution or not\r\n   * @returns {Promise}\r\n   */\r\n  execute(graphics, type, angle, isSilent) {\r\n    const rotationComp = graphics.getComponent(ROTATION);\r\n\r\n    if (!this.isRedo) {\r\n      const undoData = makeUndoData(rotationComp);\r\n\r\n      cachedUndoDataForSilent = this.setUndoData(undoData, cachedUndoDataForSilent, isSilent);\r\n    }\r\n\r\n    return rotationComp[type](angle);\r\n  },\r\n\r\n  /**\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @returns {Promise}\r\n   */\r\n  undo(graphics) {\r\n    const rotationComp = graphics.getComponent(ROTATION);\r\n    const [, type, angle] = this.args;\r\n\r\n    if (type === 'setAngle') {\r\n      return rotationComp[type](this.undoData.angle);\r\n    }\r\n\r\n    return rotationComp.rotate(-angle);\r\n  },\r\n};\r\n\r\ncommandFactory.register(command);\r\n\r\nexport default command;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Set object properties\r\n */\r\nimport snippet from 'tui-code-snippet';\r\nimport commandFactory from '@/factory/command';\r\nimport { Promise } from '@/util';\r\nimport { commandNames, rejectMessages } from '@/consts';\r\n\r\nconst command = {\r\n  name: commandNames.SET_OBJECT_PROPERTIES,\r\n\r\n  /**\r\n   * Set object properties\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @param {number} objId -  object id\r\n   * @param {Object} props - properties\r\n   *     @param {string} [props.fill] Color\r\n   *     @param {string} [props.fontFamily] Font type for text\r\n   *     @param {number} [props.fontSize] Size\r\n   *     @param {string} [props.fontStyle] Type of inclination (normal / italic)\r\n   *     @param {string} [props.fontWeight] Type of thicker or thinner looking (normal / bold)\r\n   *     @param {string} [props.textAlign] Type of text align (left / center / right)\r\n   *     @param {string} [props.textDecoration] Type of line (underline / line-through / overline)\r\n   * @returns {Promise}\r\n   */\r\n  execute(graphics, objId, props) {\r\n    const targetObj = graphics.getObject(objId);\r\n\r\n    if (!targetObj) {\r\n      return Promise.reject(rejectMessages.noObject);\r\n    }\r\n\r\n    this.undoData.props = {};\r\n    snippet.forEachOwnProperties(props, (value, key) => {\r\n      this.undoData.props[key] = targetObj[key];\r\n    });\r\n\r\n    graphics.setObjectProperties(objId, props);\r\n\r\n    return Promise.resolve();\r\n  },\r\n\r\n  /**\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @param {number} objId -  object id\r\n   * @returns {Promise}\r\n   */\r\n  undo(graphics, objId) {\r\n    const { props } = this.undoData;\r\n\r\n    graphics.setObjectProperties(objId, props);\r\n\r\n    return Promise.resolve();\r\n  },\r\n};\r\n\r\ncommandFactory.register(command);\r\n\r\nexport default command;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Set object properties\r\n */\r\nimport commandFactory from '@/factory/command';\r\nimport { Promise } from '@/util';\r\nimport { commandNames, rejectMessages } from '@/consts';\r\n\r\nconst command = {\r\n  name: commandNames.SET_OBJECT_POSITION,\r\n\r\n  /**\r\n   * Set object properties\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @param {number} objId -  object id\r\n   * @param {Object} posInfo - position object\r\n   *  @param {number} posInfo.x - x position\r\n   *  @param {number} posInfo.y - y position\r\n   *  @param {string} posInfo.originX - can be 'left', 'center', 'right'\r\n   *  @param {string} posInfo.originY - can be 'top', 'center', 'bottom'\r\n   * @returns {Promise}\r\n   */\r\n  execute(graphics, objId, posInfo) {\r\n    const targetObj = graphics.getObject(objId);\r\n\r\n    if (!targetObj) {\r\n      return Promise.reject(rejectMessages.noObject);\r\n    }\r\n\r\n    this.undoData.objectId = objId;\r\n    this.undoData.props = graphics.getObjectProperties(objId, ['left', 'top']);\r\n\r\n    graphics.setObjectPosition(objId, posInfo);\r\n    graphics.renderAll();\r\n\r\n    return Promise.resolve();\r\n  },\r\n\r\n  /**\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @returns {Promise}\r\n   */\r\n  undo(graphics) {\r\n    const { objectId, props } = this.undoData;\r\n\r\n    graphics.setObjectProperties(objectId, props);\r\n    graphics.renderAll();\r\n\r\n    return Promise.resolve();\r\n  },\r\n};\r\n\r\ncommandFactory.register(command);\r\n\r\nexport default command;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview change selection\r\n */\r\nimport commandFactory from '@/factory/command';\r\nimport { Promise } from '@/util';\r\nimport { commandNames } from '@/consts';\r\nimport { getCachedUndoDataForDimension } from '@/helper/selectionModifyHelper';\r\n\r\nconst command = {\r\n  name: commandNames.CHANGE_SELECTION,\r\n\r\n  execute(graphics, props) {\r\n    if (this.isRedo) {\r\n      props.forEach((prop) => {\r\n        graphics.setObjectProperties(prop.objId, prop);\r\n      });\r\n    } else {\r\n      this.undoData = getCachedUndoDataForDimension();\r\n    }\r\n\r\n    return Promise.resolve();\r\n  },\r\n\r\n  undo(graphics) {\r\n    this.undoData.forEach((datum) => {\r\n      graphics.setObjectProperties(datum.objId, datum);\r\n    });\r\n\r\n    return Promise.resolve();\r\n  },\r\n};\r\n\r\ncommandFactory.register(command);\r\n\r\nexport default command;\r\n","/**\r\n * @author NHN. FE Development Team <dl_javascript@nhn.com>\r\n * @fileoverview Resize an image\r\n */\r\nimport commandFactory from '@/factory/command';\r\nimport { componentNames, commandNames } from '@/consts';\r\n\r\nconst { RESIZE } = componentNames;\r\n\r\nconst command = {\r\n  name: commandNames.RESIZE_IMAGE,\r\n\r\n  /**\r\n   * Resize an image\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @param {object} dimensions - Image Dimensions\r\n   * @returns {Promise}\r\n   */\r\n  execute(graphics, dimensions) {\r\n    const resizeComp = graphics.getComponent(RESIZE);\r\n\r\n    let originalDimensions = resizeComp.getOriginalDimensions();\r\n    if (!originalDimensions) {\r\n      originalDimensions = resizeComp.getCurrentDimensions();\r\n    }\r\n\r\n    this.undoData.dimensions = originalDimensions;\r\n\r\n    return resizeComp.resize(dimensions);\r\n  },\r\n\r\n  /**\r\n   * @param {Graphics} graphics - Graphics instance\r\n   * @returns {Promise}\r\n   */\r\n  undo(graphics) {\r\n    const resizeComp = graphics.getComponent(RESIZE);\r\n\r\n    return resizeComp.resize(this.undoData.dimensions);\r\n  },\r\n};\r\n\r\ncommandFactory.register(command);\r\n\r\nexport default command;\r\n"],"sourceRoot":""}